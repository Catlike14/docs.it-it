---
title: Modello di programmazione asincrona (APM)
ms.date: 03/30/2017
ms.technology: dotnet-standard
helpviewer_keywords:
- ending asynchronous operations
- starting asynchronous operations
- beginning asynchronous operations
- asynchronous programming, ending operations
- asynchronous programming
- stopping asynchronous operations
- asynchronous programming, beginning operations
ms.assetid: c9b3501e-6bc6-40f9-8efd-4b6d9e39ccf0
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 992cc1f60ee3f08131b478d2336321bf87d7ef89
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 05/04/2018
ms.locfileid: "33573789"
---
# <a name="asynchronous-programming-model-apm"></a><span data-ttu-id="ed0d2-102">Modello di programmazione asincrona (APM)</span><span class="sxs-lookup"><span data-stu-id="ed0d2-102">Asynchronous Programming Model (APM)</span></span>
<span data-ttu-id="ed0d2-103">L'implementazione di un'operazione asincrona che usa lo schema progettuale <xref:System.IAsyncResult> avviene mediante due metodi, denominati **Begin***Nomeoperazione* e **End***Nomeoperazione*, che rispettivamente avviano e terminano l'operazione asincrona *Nomeoperazione*.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-103">An asynchronous operation that uses the <xref:System.IAsyncResult> design pattern is implemented as two methods named **Begin***OperationName* and **End***OperationName* that begin and end the asynchronous operation *OperationName* respectively.</span></span> <span data-ttu-id="ed0d2-104">La classe <xref:System.IO.FileStream> fornisce ad esempio i metodi <xref:System.IO.FileStream.BeginRead%2A> e <xref:System.IO.FileStream.EndRead%2A> per la lettura asincrona dei byte da un file.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-104">For example, the <xref:System.IO.FileStream> class provides the <xref:System.IO.FileStream.BeginRead%2A> and <xref:System.IO.FileStream.EndRead%2A> methods to asynchronously read bytes from a file.</span></span> <span data-ttu-id="ed0d2-105">Tali metodi implementano la versione asincrona del metodo <xref:System.IO.FileStream.Read%2A> .</span><span class="sxs-lookup"><span data-stu-id="ed0d2-105">These methods implement the asynchronous version of the <xref:System.IO.FileStream.Read%2A> method.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ed0d2-106">A partire da .NET Framework 4, Task Parallel Library fornisce un nuovo modello di programmazione asincrona e parallela.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-106">Starting with the .NET Framework 4, the Task Parallel Library provides a new model for asynchronous and parallel programming.</span></span> <span data-ttu-id="ed0d2-107">Per altre informazioni, vedere [Task Parallel Library (TPL)](../../../docs/standard/parallel-programming/task-parallel-library-tpl.md) e [Task-based Asynchronous Pattern (TAP)](../../../docs/standard/asynchronous-programming-patterns/task-based-asynchronous-pattern-tap.md).</span><span class="sxs-lookup"><span data-stu-id="ed0d2-107">For more information, see [Task Parallel Library (TPL)](../../../docs/standard/parallel-programming/task-parallel-library-tpl.md) and [Task-based Asynchronous Pattern (TAP)](../../../docs/standard/asynchronous-programming-patterns/task-based-asynchronous-pattern-tap.md)).</span></span>  
  
 <span data-ttu-id="ed0d2-108">Dopo aver chiamato **Begin***Nomeoperazione*, un'applicazione può continuare a eseguire le istruzioni sul thread chiamante mentre l'operazione asincrona viene eseguita su un altro thread.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-108">After calling **Begin***OperationName*, an application can continue executing instructions on the calling thread while the asynchronous operation takes place on a different thread.</span></span> <span data-ttu-id="ed0d2-109">Per ogni chiamata a **Begin***Nomeoperazione*, l'applicazione deve chiamare anche **End***Nomeoperazione* per ottenere i risultati dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-109">For each call to **Begin***OperationName*, the application should also call **End***OperationName* to get the results of the operation.</span></span>  
  
## <a name="beginning-an-asynchronous-operation"></a><span data-ttu-id="ed0d2-110">Avvio di un'operazione asincrona</span><span class="sxs-lookup"><span data-stu-id="ed0d2-110">Beginning an Asynchronous Operation</span></span>  
 <span data-ttu-id="ed0d2-111">Il metodo **Begin***Nomeoperazione* avvia l'operazione asincrona *Nomeoperazione* e restituisce un oggetto che implementa l'interfaccia <xref:System.IAsyncResult>.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-111">The **Begin***OperationName* method begins asynchronous operation *OperationName* and returns an object that implements the <xref:System.IAsyncResult> interface.</span></span> <span data-ttu-id="ed0d2-112">Gli oggetti<xref:System.IAsyncResult> archiviano le informazioni sulle operazioni asincrone.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-112"><xref:System.IAsyncResult> objects store information about an asynchronous operation.</span></span> <span data-ttu-id="ed0d2-113">La tabella seguente illustra le informazioni relative a un'operazione asincrona.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-113">The following table shows information about an asynchronous operation.</span></span>  
  
|<span data-ttu-id="ed0d2-114">Member</span><span class="sxs-lookup"><span data-stu-id="ed0d2-114">Member</span></span>|<span data-ttu-id="ed0d2-115">Descrizione</span><span class="sxs-lookup"><span data-stu-id="ed0d2-115">Description</span></span>|  
|------------|-----------------|  
|<xref:System.IAsyncResult.AsyncState%2A>|<span data-ttu-id="ed0d2-116">Oggetto facoltativo specifico dell'applicazione che contiene informazioni sull'operazione asincrona.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-116">An optional application-specific object that contains information about the asynchronous operation.</span></span>|  
|<xref:System.IAsyncResult.AsyncWaitHandle%2A>|<span data-ttu-id="ed0d2-117">Oggetto <xref:System.Threading.WaitHandle> che può essere usato per bloccare l'esecuzione dell'applicazione fino al completamento dell'operazione asincrona.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-117">A <xref:System.Threading.WaitHandle> that can be used to block application execution until the asynchronous operation completes.</span></span>|  
|<xref:System.IAsyncResult.CompletedSynchronously%2A>|<span data-ttu-id="ed0d2-118">Valore che indica l'eventuale completamento dell'operazione asincrona sul thread usato per chiamare **Begin***Nomeoperazione* anziché su un thread <xref:System.Threading.ThreadPool> diverso.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-118">A value that indicates whether the asynchronous operation completed on the thread used to call **Begin***OperationName* instead of completing on a separate <xref:System.Threading.ThreadPool> thread.</span></span>|  
|<xref:System.IAsyncResult.IsCompleted%2A>|<span data-ttu-id="ed0d2-119">Valore che indica l'eventuale completamento dell'operazione asincrona.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-119">A value that indicates whether the asynchronous operation has completed.</span></span>|  
  
 <span data-ttu-id="ed0d2-120">Un metodo **Begin***Nomeoperazione* accetta tutti i parametri dichiarati nella firma della versione sincrona del metodo passati per valore o per riferimento.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-120">A **Begin***OperationName* method takes any parameters declared in the signature of the synchronous version of the method that are passed by value or by reference.</span></span> <span data-ttu-id="ed0d2-121">Nella firma del metodo **Begin***Nomeoperazione* non sono inclusi parametri out.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-121">Any out parameters are not part of the **Begin***OperationName* method signature.</span></span> <span data-ttu-id="ed0d2-122">Sono inclusi due parametri aggiuntivi nella firma del metodo **Begin***Nomeoperazione*.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-122">The **Begin***OperationName* method signature also includes two additional parameters.</span></span> <span data-ttu-id="ed0d2-123">Il primo dei quali definisce un delegato <xref:System.AsyncCallback> che fa riferimento a un metodo chiamato al completamento dell'operazione asincrona.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-123">The first of these defines an <xref:System.AsyncCallback> delegate that references a method that is called when the asynchronous operation completes.</span></span> <span data-ttu-id="ed0d2-124">Il chiamante può specificare `null` (`Nothing` in Visual Basic) se non vuole richiamare un metodo al termine dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-124">The caller can specify `null` (`Nothing` in Visual Basic) if it does not want a method invoked when the operation completes.</span></span> <span data-ttu-id="ed0d2-125">Il secondo parametro aggiuntivo è un oggetto definito dall'utente</span><span class="sxs-lookup"><span data-stu-id="ed0d2-125">The second additional parameter is a user-defined object.</span></span> <span data-ttu-id="ed0d2-126">che può essere usato per passare informazioni sullo stato specifiche dell'applicazione al metodo richiamato al completamento dell'operazione asincrona.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-126">This object can be used to pass application-specific state information to the method invoked when the asynchronous operation completes.</span></span> <span data-ttu-id="ed0d2-127">Se un metodo **Begin***Nomeoperazione* accetta altri parametri specifici dell'operazione, quale un array di byte per l'archiviazione dei byte letti da un file, l'oggetto <xref:System.AsyncCallback> e l'oggetto stato dell'applicazione saranno gli ultimi parametri nella firma del metodo **Begin***Nomeoperazione*.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-127">If a **Begin***OperationName* method takes additional operation-specific parameters, such as a byte array to store bytes read from a file, the <xref:System.AsyncCallback> and application state object are the last parameters in the **Begin***OperationName* method signature.</span></span>  
  
 <span data-ttu-id="ed0d2-128">**Begin***Nomeoperazione* restituisce immediatamente il controllo al thread chiamante.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-128">**Begin***OperationName* returns control to the calling thread immediately.</span></span> <span data-ttu-id="ed0d2-129">Se il metodo **Begin***Nomeoperazione* genera eccezioni, la generazione delle eccezioni avviene prima dell'avvio dell'operazione asincrona.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-129">If the **Begin***OperationName* method throws exceptions, the exceptions are thrown before the asynchronous operation is started.</span></span> <span data-ttu-id="ed0d2-130">Se il metodo **Begin***Nomeoperazione* genera eccezioni, il metodo di callback non viene richiamato.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-130">If the **Begin***OperationName* method throws exceptions, the callback method is not invoked.</span></span>  
  
## <a name="ending-an-asynchronous-operation"></a><span data-ttu-id="ed0d2-131">Fine di un'operazione asincrona</span><span class="sxs-lookup"><span data-stu-id="ed0d2-131">Ending an Asynchronous Operation</span></span>  
 <span data-ttu-id="ed0d2-132">Il metodo* *End***Nomeoperazione* termina l'operazione asincrona *Nomeoperazione*.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-132">The **End***OperationName* method ends asynchronous operation *OperationName*.</span></span> <span data-ttu-id="ed0d2-133">Il valore restituito dal metodo **End***Nomeoperazione* è dello stesso tipo restituito dalla controparte sincrona ed è specifico dell'operazione asincrona.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-133">The return value of the **End***OperationName* method is the same type returned by its synchronous counterpart and is specific to the asynchronous operation.</span></span> <span data-ttu-id="ed0d2-134">Il metodo <xref:System.IO.FileStream.EndRead%2A> restituisce ad esempio il numero di byte letti da un oggetto <xref:System.IO.FileStream> mentre il metodo <xref:System.Net.Dns.EndGetHostByName%2A> restituisce un oggetto <xref:System.Net.IPHostEntry> contenente le informazioni relative a un computer host.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-134">For example, the <xref:System.IO.FileStream.EndRead%2A> method returns the number of bytes read from a <xref:System.IO.FileStream> and the <xref:System.Net.Dns.EndGetHostByName%2A> method returns an <xref:System.Net.IPHostEntry> object that contains information about a host computer.</span></span> <span data-ttu-id="ed0d2-135">Il metodo **End***Nomeoperazione* accetta tutti i parametri out o ref dichiarati nella firma della versione sincrona del metodo.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-135">The **End***OperationName* method takes any out or ref parameters declared in the signature of the synchronous version of the method.</span></span> <span data-ttu-id="ed0d2-136">Oltre ai parametri provenienti dal metodo sincrono, il metodo **End***Nomeoperazione* comprende anche un parametro <xref:System.IAsyncResult>.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-136">In addition to the parameters from the synchronous method, the **End***OperationName* method also includes an <xref:System.IAsyncResult> parameter.</span></span> <span data-ttu-id="ed0d2-137">I chiamanti devono passare l'istanza restituita dalla chiamata corrispondente al metodo **Begin***Nomeoperazione*.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-137">Callers must pass the instance returned by the corresponding call to **Begin***OperationName*.</span></span>  
  
 <span data-ttu-id="ed0d2-138">Se l'operazione asincrona rappresentata dall'oggetto <xref:System.IAsyncResult> non è stata completata quando viene chiamato il metodo \**End\*\*\*Nomeoperazione*, il metodo *End\*\*\*Nomeoperazione* blocca il thread chiamante fino al completamento dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-138">If the asynchronous operation represented by the <xref:System.IAsyncResult> object has not completed when **End***OperationName* is called, **End***OperationName* blocks the calling thread until the asynchronous operation is complete.</span></span> <span data-ttu-id="ed0d2-139">Le eccezioni generate dall'operazione asincrona vengono generate dal metodo **End***Nomeoperazione*.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-139">Exceptions thrown by the asynchronous operation are thrown from the **End***OperationName* method.</span></span> <span data-ttu-id="ed0d2-140">Non è definito l'effetto della chiamata ripetuta del metodo **End***Nomeoperazione* con lo stesso oggetto <xref:System.IAsyncResult>.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-140">The effect of calling the **End***OperationName* method multiple times with the same <xref:System.IAsyncResult> is not defined.</span></span> <span data-ttu-id="ed0d2-141">Analogamente, anche la chiamata del metodo **End***Nomeoperazione* con un oggetto <xref:System.IAsyncResult> non restituito dal metodo Begin correlato risulta non essere definita.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-141">Likewise, calling the **End***OperationName* method with an <xref:System.IAsyncResult> that was not returned by the related Begin method is also not defined.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ed0d2-142">In questi due scenari non definiti ai responsabili dell'implementazione è consigliata la generazione di <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-142">For either of the undefined scenarios, implementers should consider throwing <xref:System.InvalidOperationException>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ed0d2-143">I responsabili dell'implementazione di questo schema progettuale devono notificare al chiamante il completamento dell'operazione asincrona impostando <xref:System.IAsyncResult.IsCompleted%2A> su true, chiamando il metodo di callback asincrono, se specificato, e segnalando l'oggetto <xref:System.IAsyncResult.AsyncWaitHandle%2A>.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-143">Implementers of this design pattern should notify the caller that the asynchronous operation completed by setting <xref:System.IAsyncResult.IsCompleted%2A> to true, calling the asynchronous callback method (if one was specified) and signaling the <xref:System.IAsyncResult.AsyncWaitHandle%2A>.</span></span>  
  
 <span data-ttu-id="ed0d2-144">Gli sviluppatori di applicazioni dispongono di diverse scelte di progettazione per accedere ai risultati dell'operazione asincrona.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-144">Application developers have several design choices for accessing the results of the asynchronous operation.</span></span> <span data-ttu-id="ed0d2-145">La scelta adeguata dipende dall'eventuale presenza nell'applicazione di istruzioni che possono essere eseguite durante il completamento dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-145">The correct choice depends on whether the application has instructions that can execute while the operation completes.</span></span> <span data-ttu-id="ed0d2-146">Se l'applicazione non consente di eseguire altre attività fino alla ricezione dei risultati dell'operazione asincrona, deve essere bloccata fino a quel momento.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-146">If an application cannot perform any additional work until it receives the results of the asynchronous operation, the application must block until the results are available.</span></span> <span data-ttu-id="ed0d2-147">A tale scopo, sono disponibili i due approcci illustrati di seguito:</span><span class="sxs-lookup"><span data-stu-id="ed0d2-147">To block until an asynchronous operation completes, you can use one of the following approaches:</span></span>  
  
-   <span data-ttu-id="ed0d2-148">Chiamare il metodo **End***Nomeoperazione* dal thread principale dell'applicazione, bloccando l'esecuzione dell'applicazione fino al completamento dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-148">Call **End***OperationName* from the application’s main thread, blocking application execution until the operation is complete.</span></span> <span data-ttu-id="ed0d2-149">Per un esempio relativo all'uso di questa tecnica, vedere [Blocco dell'esecuzione dell'applicazione terminando un'operazione asincrona](../../../docs/standard/asynchronous-programming-patterns/blocking-application-execution-by-ending-an-async-operation.md).</span><span class="sxs-lookup"><span data-stu-id="ed0d2-149">For an example that illustrates this technique, see [Blocking Application Execution by Ending an Async Operation](../../../docs/standard/asynchronous-programming-patterns/blocking-application-execution-by-ending-an-async-operation.md).</span></span>  
  
-   <span data-ttu-id="ed0d2-150">Usare <xref:System.IAsyncResult.AsyncWaitHandle%2A> per bloccare l'esecuzione dell'applicazione fino al completamento di una o più operazioni.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-150">Use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> to block application execution until one or more operations are complete.</span></span> <span data-ttu-id="ed0d2-151">Per un esempio relativo all'uso di questa tecnica, vedere [Blocking Application Execution Using an AsyncWaitHandle](../../../docs/standard/asynchronous-programming-patterns/blocking-application-execution-using-an-asyncwaithandle.md).</span><span class="sxs-lookup"><span data-stu-id="ed0d2-151">For an example that illustrates this technique, see [Blocking Application Execution Using an AsyncWaitHandle](../../../docs/standard/asynchronous-programming-patterns/blocking-application-execution-using-an-asyncwaithandle.md).</span></span>  
  
 <span data-ttu-id="ed0d2-152">Per le applicazioni che non è necessario bloccare durante il completamento dell'operazione asincrona, è possibile usare uno degli approcci seguenti:</span><span class="sxs-lookup"><span data-stu-id="ed0d2-152">Applications that do not need to block while the asynchronous operation completes can use one of the following approaches:</span></span>  
  
-   <span data-ttu-id="ed0d2-153">Eseguire il polling dello stato di completamento dell'operazione verificando periodicamente la proprietà <xref:System.IAsyncResult.IsCompleted%2A> e chiamando il metodo **End***Nomeoperazione* al completamento dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-153">Poll for operation completion status by checking the <xref:System.IAsyncResult.IsCompleted%2A> property periodically and calling **End***OperationName* when the operation is complete.</span></span> <span data-ttu-id="ed0d2-154">Per un esempio relativo all'uso di questa tecnica, vedere [Polling for the Status of an Asynchronous Operation](../../../docs/standard/asynchronous-programming-patterns/polling-for-the-status-of-an-asynchronous-operation.md).</span><span class="sxs-lookup"><span data-stu-id="ed0d2-154">For an example that illustrates this technique, see [Polling for the Status of an Asynchronous Operation](../../../docs/standard/asynchronous-programming-patterns/polling-for-the-status-of-an-asynchronous-operation.md).</span></span>  
  
-   <span data-ttu-id="ed0d2-155">Usare un delegato <xref:System.AsyncCallback> per specificare il metodo da richiamare quando l'operazione viene completata.</span><span class="sxs-lookup"><span data-stu-id="ed0d2-155">Use an <xref:System.AsyncCallback> delegate to specify a method to be invoked when the operation is complete.</span></span> <span data-ttu-id="ed0d2-156">Per un esempio relativo all'uso di questa tecnica, vedere [Using an AsyncCallback Delegate to End an Asynchronous Operation](../../../docs/standard/asynchronous-programming-patterns/using-an-asynccallback-delegate-to-end-an-asynchronous-operation.md).</span><span class="sxs-lookup"><span data-stu-id="ed0d2-156">For an example that illustrates this technique, see [Using an AsyncCallback Delegate to End an Asynchronous Operation](../../../docs/standard/asynchronous-programming-patterns/using-an-asynccallback-delegate-to-end-an-asynchronous-operation.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ed0d2-157">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="ed0d2-157">See Also</span></span>  
 <span data-ttu-id="ed0d2-158">[Event-based Asynchronous Pattern (EAP)](../../../docs/standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-eap.md) (Modello asincrono basato su eventi, EAP)</span><span class="sxs-lookup"><span data-stu-id="ed0d2-158">[Event-based Asynchronous Pattern (EAP)](../../../docs/standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-eap.md)</span></span>  
 [<span data-ttu-id="ed0d2-159">Chiamata sincrona dei metodi asincroni</span><span class="sxs-lookup"><span data-stu-id="ed0d2-159">Calling Synchronous Methods Asynchronously</span></span>](../../../docs/standard/asynchronous-programming-patterns/calling-synchronous-methods-asynchronously.md)  
 [<span data-ttu-id="ed0d2-160">Uso di un oggetto di stato e di un delegato AsyncCallback</span><span class="sxs-lookup"><span data-stu-id="ed0d2-160">Using an AsyncCallback Delegate and State Object</span></span>](../../../docs/standard/asynchronous-programming-patterns/using-an-asynccallback-delegate-and-state-object.md)
