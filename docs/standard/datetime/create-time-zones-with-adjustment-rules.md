---
title: 'Procedura: creare fusi orari con regole di regolazione'
ms.date: 04/10/2017
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- time zones [.NET Framework], creating
- time zones [.NET Framework], and adjustment rules
- adjustment rule [.NET Framework]
ms.assetid: c52ef192-13a9-435f-8015-3b12eae8c47c
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: c63b93e0dc587571605edb305979b8f97bf54cb7
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/04/2018
ms.locfileid: "33576494"
---
# <a name="how-to-create-time-zones-with-adjustment-rules"></a><span data-ttu-id="4d2db-102">Procedura: creare fusi orari con regole di regolazione</span><span class="sxs-lookup"><span data-stu-id="4d2db-102">How to: Create time zones with adjustment rules</span></span>

<span data-ttu-id="4d2db-103">Le informazioni di fuso orario preciso richiesto da un'applicazione potrebbero non essere presente in un determinato sistema per diversi motivi:</span><span class="sxs-lookup"><span data-stu-id="4d2db-103">The precise time zone information that is required by an application may not be present on a particular system for several reasons:</span></span>

* <span data-ttu-id="4d2db-104">Il fuso orario non è mai stato definito nel Registro di sistema del sistema locale.</span><span class="sxs-lookup"><span data-stu-id="4d2db-104">The time zone has never been defined in the local system's registry.</span></span>

* <span data-ttu-id="4d2db-105">Dati sul fuso orario sono stati modificati o rimossi dal Registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="4d2db-105">Data about the time zone has been modified or removed from the registry.</span></span>

* <span data-ttu-id="4d2db-106">Il fuso orario non dispone di informazioni accurate sulle regolazioni del fuso orario per un determinato periodo storico.</span><span class="sxs-lookup"><span data-stu-id="4d2db-106">The time zone does not have accurate information about time zone adjustments for a particular historic period.</span></span>

<span data-ttu-id="4d2db-107">In questi casi, è possibile chiamare il <xref:System.TimeZoneInfo.CreateCustomTimeZone%2A> metodo per definire il fuso orario richiesto dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="4d2db-107">In these cases, you can call the <xref:System.TimeZoneInfo.CreateCustomTimeZone%2A> method to define the time zone required by your application.</span></span> <span data-ttu-id="4d2db-108">È possibile utilizzare l'overload di questo metodo per creare un fuso orario con o senza regole di regolazione.</span><span class="sxs-lookup"><span data-stu-id="4d2db-108">You can use the overloads of this method to create a time zone with or without adjustment rules.</span></span> <span data-ttu-id="4d2db-109">Se il fuso orario supporta l'ora legale, è possibile definire le regolazioni con entrambe le regole di regolazione fissa o mobile.</span><span class="sxs-lookup"><span data-stu-id="4d2db-109">If the time zone supports daylight saving time, you can define adjustments with either fixed or floating adjustment rules.</span></span> <span data-ttu-id="4d2db-110">(Per le definizioni di questi termini, vedere la sezione "Terminologia fuso orario" in [Panoramica sul fuso orario](../../../docs/standard/datetime/time-zone-overview.md).)</span><span class="sxs-lookup"><span data-stu-id="4d2db-110">(For definitions of these terms, see the "Time Zone Terminology" section in [Time zone overview](../../../docs/standard/datetime/time-zone-overview.md).)</span></span>

> [!IMPORTANT]
> <span data-ttu-id="4d2db-111">Fusi orari personalizzati creati tramite la chiamata di <xref:System.TimeZoneInfo.CreateCustomTimeZone%2A> (metodo) non vengono aggiunti al Registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="4d2db-111">Custom time zones created by calling the <xref:System.TimeZoneInfo.CreateCustomTimeZone%2A> method are not added to the registry.</span></span> <span data-ttu-id="4d2db-112">Ma è possibile accedervi solo tramite il riferimento all'oggetto restituito dal <xref:System.TimeZoneInfo.CreateCustomTimeZone%2A> chiamata al metodo.</span><span class="sxs-lookup"><span data-stu-id="4d2db-112">Instead, they can be accessed only through the object reference returned by the <xref:System.TimeZoneInfo.CreateCustomTimeZone%2A> method call.</span></span>

<span data-ttu-id="4d2db-113">In questo argomento viene illustrato come creare un fuso orario con regole di regolazione.</span><span class="sxs-lookup"><span data-stu-id="4d2db-113">This topic shows how to create a time zone with adjustment rules.</span></span> <span data-ttu-id="4d2db-114">Per creare un fuso orario che non supporta regole di regolazione dell'ora legale, vedere [procedura: creare fusi orari senza regole di regolazione](../../../docs/standard/datetime/create-time-zones-without-adjustment-rules.md).</span><span class="sxs-lookup"><span data-stu-id="4d2db-114">To create a time zone that does not support daylight saving time adjustment rules, see [How to: Create Time Zones Without Adjustment Rules](../../../docs/standard/datetime/create-time-zones-without-adjustment-rules.md).</span></span>

### <a name="to-create-a-time-zone-with-floating-adjustment-rules"></a><span data-ttu-id="4d2db-115">Per creare un fuso orario con le regole di regolazione mobili</span><span class="sxs-lookup"><span data-stu-id="4d2db-115">To create a time zone with floating adjustment rules</span></span>

1. <span data-ttu-id="4d2db-116">Per ogni nuova regolazione (che, per ogni transizione da e di nuovo all'ora solare in un intervallo di tempo specifico), eseguire le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="4d2db-116">For each adjustment (that is, for each transition away from and back to standard time over a particular time interval), do the following:</span></span>

    1. <span data-ttu-id="4d2db-117">Definire il tempo di transizione iniziale per la regolazione del fuso orario.</span><span class="sxs-lookup"><span data-stu-id="4d2db-117">Define the starting transition time for the time zone adjustment.</span></span>

       <span data-ttu-id="4d2db-118">È necessario chiamare il <xref:System.TimeZoneInfo.TransitionTime.CreateFloatingDateRule%2A?displayProperty=nameWithType> (metodo) e passare un <xref:System.DateTime> valore che definisce il tempo di transizione, un valore intero che definisce il mese della transizione, un valore intero che definisce la settimana in cui si verifica la transizione, e un <xref:System.DayOfWeek> valore che definisce il giorno della settimana in cui si verifica la transizione.</span><span class="sxs-lookup"><span data-stu-id="4d2db-118">You must call the <xref:System.TimeZoneInfo.TransitionTime.CreateFloatingDateRule%2A?displayProperty=nameWithType> method and pass it a <xref:System.DateTime> value that defines the time of the transition, an integer value that defines the month of the transition, an integer value that defines the week on which the transition occurs, and a <xref:System.DayOfWeek> value that defines the day of the week on which the transition occurs.</span></span> <span data-ttu-id="4d2db-119">Crea un'istanza di questa chiamata al metodo un <xref:System.TimeZoneInfo.TransitionTime> oggetto.</span><span class="sxs-lookup"><span data-stu-id="4d2db-119">This method call instantiates a <xref:System.TimeZoneInfo.TransitionTime> object.</span></span>

    2. <span data-ttu-id="4d2db-120">Definire il tempo di transizione finale per la regolazione del fuso orario.</span><span class="sxs-lookup"><span data-stu-id="4d2db-120">Define the ending transition time for the time zone adjustment.</span></span> <span data-ttu-id="4d2db-121">Questa operazione richiede un'altra chiamata al <xref:System.TimeZoneInfo.TransitionTime.CreateFloatingDateRule%2A?displayProperty=nameWithType> metodo.</span><span class="sxs-lookup"><span data-stu-id="4d2db-121">This requires another call to the <xref:System.TimeZoneInfo.TransitionTime.CreateFloatingDateRule%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="4d2db-122">Questa chiamata al metodo crea un'istanza di un secondo <xref:System.TimeZoneInfo.TransitionTime> oggetto.</span><span class="sxs-lookup"><span data-stu-id="4d2db-122">This method call instantiates a second <xref:System.TimeZoneInfo.TransitionTime> object.</span></span>

    3. <span data-ttu-id="4d2db-123">Chiamare il <xref:System.TimeZoneInfo.AdjustmentRule.CreateAdjustmentRule%2A> metodo e passarlo effettive di inizio e data di fine della regolazione, un <xref:System.TimeSpan> oggetto che definisce la quantità di tempo in cui la transizione e le due <xref:System.TimeZoneInfo.TransitionTime> oggetti che definiscono quando le transizioni da e verso legale ora si verificano.</span><span class="sxs-lookup"><span data-stu-id="4d2db-123">Call the <xref:System.TimeZoneInfo.AdjustmentRule.CreateAdjustmentRule%2A> method and pass it the effective start and end dates of the adjustment, a <xref:System.TimeSpan> object that defines the amount of time in the transition, and the two <xref:System.TimeZoneInfo.TransitionTime> objects that define when the transitions to and from daylight saving time occur.</span></span> <span data-ttu-id="4d2db-124">Crea un'istanza di questa chiamata al metodo un <xref:System.TimeZoneInfo.AdjustmentRule> oggetto.</span><span class="sxs-lookup"><span data-stu-id="4d2db-124">This method call instantiates a <xref:System.TimeZoneInfo.AdjustmentRule> object.</span></span>

    4. <span data-ttu-id="4d2db-125">Assegnare il <xref:System.TimeZoneInfo.AdjustmentRule> oggetto a una matrice di <xref:System.TimeZoneInfo.AdjustmentRule> oggetti.</span><span class="sxs-lookup"><span data-stu-id="4d2db-125">Assign the <xref:System.TimeZoneInfo.AdjustmentRule> object to an array of <xref:System.TimeZoneInfo.AdjustmentRule> objects.</span></span>

2. <span data-ttu-id="4d2db-126">Definire nome visualizzato del fuso orario.</span><span class="sxs-lookup"><span data-stu-id="4d2db-126">Define the time zone's display name.</span></span> <span data-ttu-id="4d2db-127">Il nome visualizzato segue un formato pressoché standard in cui l'offset del fuso orario dall'ora Coordinated Universal Time (UTC) è racchiuso tra parentesi ed è seguito da una stringa che identifica il fuso orario, una o più delle città nel fuso orario, o in uno o più di cou Mo o aree del fuso orario.</span><span class="sxs-lookup"><span data-stu-id="4d2db-127">The display name follows a fairly standard format in which the time zone's offset from Coordinated Universal Time (UTC) is enclosed in parentheses and is followed by a string that identifies the time zone, one or more of the cities in the time zone, or one or more of the countries or regions in the time zone.</span></span>

3. <span data-ttu-id="4d2db-128">Definire il nome dell'ora solare del fuso orario.</span><span class="sxs-lookup"><span data-stu-id="4d2db-128">Define the name of the time zone's standard time.</span></span> <span data-ttu-id="4d2db-129">In genere, questa stringa viene utilizzata anche come identificatore del fuso orario.</span><span class="sxs-lookup"><span data-stu-id="4d2db-129">Typically, this string is also used as the time zone's identifier.</span></span>

4. <span data-ttu-id="4d2db-130">Definire il nome dell'ora legale del fuso orario.</span><span class="sxs-lookup"><span data-stu-id="4d2db-130">Define the name of the time zone's daylight time.</span></span>

5. <span data-ttu-id="4d2db-131">Se si desidera utilizzare un identificatore nome standard del fuso orario diverso, definire l'identificatore del fuso orario.</span><span class="sxs-lookup"><span data-stu-id="4d2db-131">If you want to use a different identifier than the time zone's standard name, define the time zone identifier.</span></span>

6. <span data-ttu-id="4d2db-132">Creare un'istanza di un <xref:System.TimeSpan> oggetto che definisce l'offset del fuso orario dall'ora UTC.</span><span class="sxs-lookup"><span data-stu-id="4d2db-132">Instantiate a <xref:System.TimeSpan> object that defines the time zone's offset from UTC.</span></span> <span data-ttu-id="4d2db-133">Fusi orari con ore in avanti rispetto all'ora UTC hanno un offset positivo.</span><span class="sxs-lookup"><span data-stu-id="4d2db-133">Time zones with times that are later than UTC have a positive offset.</span></span> <span data-ttu-id="4d2db-134">Fusi orari con ore precedenti rispetto all'ora UTC hanno un offset negativo.</span><span class="sxs-lookup"><span data-stu-id="4d2db-134">Time zones with times that are earlier than UTC have a negative offset.</span></span>

7. <span data-ttu-id="4d2db-135">Chiamare il <xref:System.TimeZoneInfo.CreateCustomTimeZone%28System.String%2CSystem.TimeSpan%2CSystem.String%2CSystem.String%2CSystem.String%2CSystem.TimeZoneInfo.AdjustmentRule%5B%5D%29?displayProperty=nameWithType> metodo per creare un'istanza del nuovo fuso orario.</span><span class="sxs-lookup"><span data-stu-id="4d2db-135">Call the <xref:System.TimeZoneInfo.CreateCustomTimeZone%28System.String%2CSystem.TimeSpan%2CSystem.String%2CSystem.String%2CSystem.String%2CSystem.TimeZoneInfo.AdjustmentRule%5B%5D%29?displayProperty=nameWithType> method to instantiate the new time zone.</span></span>

## <a name="example"></a><span data-ttu-id="4d2db-136">Esempio</span><span class="sxs-lookup"><span data-stu-id="4d2db-136">Example</span></span>

<span data-ttu-id="4d2db-137">L'esempio seguente definisce un fuso orario centrale Standard per gli Stati Uniti che include le regole di regolazione per un'ampia gamma di intervalli di tempo da 1918 a quella corrente.</span><span class="sxs-lookup"><span data-stu-id="4d2db-137">The following example defines a Central Standard Time zone for the United States that includes adjustment rules for a variety of time intervals from 1918 to the present.</span></span>

[!code-csharp[System.TimeZone2.CreateTimeZone#5](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.TimeZone2.CreateTimeZone/cs/System.TimeZone2.CreateTimeZone.cs#5)]
[!code-vb[System.TimeZone2.CreateTimeZone#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.TimeZone2.CreateTimeZone/vb/System.TimeZone2.CreateTimeZone.vb#5)]

<span data-ttu-id="4d2db-138">Il fuso orario creato in questo esempio dispone di più regole di regolazione.</span><span class="sxs-lookup"><span data-stu-id="4d2db-138">The time zone created in this example has multiple adjustment rules.</span></span> <span data-ttu-id="4d2db-139">È necessario pertanto verificare che le date di inizio e data di fine di qualsiasi regola di rettifica non si sovrapponga con le date di un'altra regola di rettifica.</span><span class="sxs-lookup"><span data-stu-id="4d2db-139">Care must be taken to ensure that the effective start and end dates of any adjustment rule do not overlap with the dates of another adjustment rule.</span></span> <span data-ttu-id="4d2db-140">Se è presente una sovrapposizione, un <xref:System.InvalidTimeZoneException> viene generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="4d2db-140">If there is an overlap, an <xref:System.InvalidTimeZoneException> is thrown.</span></span>

<span data-ttu-id="4d2db-141">Per le regole di regolazione mobili, il valore 5 viene passato per il `week` parametro il <xref:System.TimeZoneInfo.TransitionTime.CreateFloatingDateRule%2A> metodo per indicare che la transizione si verifica nell'ultima settimana di un determinato mese.</span><span class="sxs-lookup"><span data-stu-id="4d2db-141">For floating adjustment rules, the value 5 is passed to the `week` parameter of the <xref:System.TimeZoneInfo.TransitionTime.CreateFloatingDateRule%2A> method to indicate that the transition occurs on the last week of a particular month.</span></span>

<span data-ttu-id="4d2db-142">Nella creazione della matrice di <xref:System.TimeZoneInfo.AdjustmentRule> oggetti da utilizzare nella <xref:System.TimeZoneInfo.CreateCustomTimeZone%28System.String%2CSystem.TimeSpan%2CSystem.String%2CSystem.String%2CSystem.String%2CSystem.TimeZoneInfo.AdjustmentRule%5B%5D%29?displayProperty=nameWithType> chiamata al metodo, il codice può inizializzare la matrice per la dimensione della richiesta per il numero di modifiche da creare per il fuso orario.</span><span class="sxs-lookup"><span data-stu-id="4d2db-142">In creating the array of <xref:System.TimeZoneInfo.AdjustmentRule> objects to use in the <xref:System.TimeZoneInfo.CreateCustomTimeZone%28System.String%2CSystem.TimeSpan%2CSystem.String%2CSystem.String%2CSystem.String%2CSystem.TimeZoneInfo.AdjustmentRule%5B%5D%29?displayProperty=nameWithType> method call, the code could initialize the array to the size required by the number of adjustments to be created for the time zone.</span></span> <span data-ttu-id="4d2db-143">Al contrario, questo codice di esempio chiama il <xref:System.Collections.Generic.List%601.Add%2A> metodo per aggiungere ogni regola di rettifica per un oggetto generico <xref:System.Collections.Generic.List%601> insieme di <xref:System.TimeZoneInfo.AdjustmentRule> oggetti.</span><span class="sxs-lookup"><span data-stu-id="4d2db-143">Instead, this code example calls the <xref:System.Collections.Generic.List%601.Add%2A> method to add each adjustment rule to a generic <xref:System.Collections.Generic.List%601> collection of <xref:System.TimeZoneInfo.AdjustmentRule> objects.</span></span> <span data-ttu-id="4d2db-144">Il codice chiama quindi il <xref:System.Collections.Generic.List%601.CopyTo%2A> metodo per copiare i membri di questa raccolta nella matrice.</span><span class="sxs-lookup"><span data-stu-id="4d2db-144">The code then calls the <xref:System.Collections.Generic.List%601.CopyTo%2A> method to copy the members of this collection to the array.</span></span>

<span data-ttu-id="4d2db-145">Nell'esempio viene inoltre utilizzata la <xref:System.TimeZoneInfo.TransitionTime.CreateFixedDateRule%2A> metodo per definire regolazioni a data fissa.</span><span class="sxs-lookup"><span data-stu-id="4d2db-145">The example also uses the <xref:System.TimeZoneInfo.TransitionTime.CreateFixedDateRule%2A> method to define fixed-date adjustments.</span></span> <span data-ttu-id="4d2db-146">Questa operazione è simile alla chiamata di <xref:System.TimeZoneInfo.TransitionTime.CreateFloatingDateRule%2A> metodo, ad eccezione del fatto che richiede solo l'ora, mese e giorno parametri di transizione.</span><span class="sxs-lookup"><span data-stu-id="4d2db-146">This is similar to calling the <xref:System.TimeZoneInfo.TransitionTime.CreateFloatingDateRule%2A> method, except that it requires only the time, month, and day of the transition parameters.</span></span>

<span data-ttu-id="4d2db-147">L'esempio è possibile verificarlo utilizzando codice analogo al seguente:</span><span class="sxs-lookup"><span data-stu-id="4d2db-147">The example can be tested using code such as the following:</span></span>

[!code-csharp[System.TimeZone2.CreateTimeZone#7](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.TimeZone2.CreateTimeZone/cs/System.TimeZone2.CreateTimeZone.cs#7)]
[!code-vb[System.TimeZone2.CreateTimeZone#7](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.TimeZone2.CreateTimeZone/vb/System.TimeZone2.CreateTimeZone.vb#7)]

## <a name="compiling-the-code"></a><span data-ttu-id="4d2db-148">Compilazione del codice</span><span class="sxs-lookup"><span data-stu-id="4d2db-148">Compiling the code</span></span>

<span data-ttu-id="4d2db-149">L'esempio presenta i requisiti seguenti:</span><span class="sxs-lookup"><span data-stu-id="4d2db-149">This example requires:</span></span>

* <span data-ttu-id="4d2db-150">Un riferimento a System.Core.dll essere aggiunto al progetto.</span><span class="sxs-lookup"><span data-stu-id="4d2db-150">That a reference to System.Core.dll be added to the project.</span></span>

* <span data-ttu-id="4d2db-151">Che importati spazi dei nomi seguenti:</span><span class="sxs-lookup"><span data-stu-id="4d2db-151">That the following namespaces be imported:</span></span>

  [!code-csharp[System.TimeZone2.CreateTimeZone#6](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.TimeZone2.CreateTimeZone/cs/System.TimeZone2.CreateTimeZone.cs#6)]
  [!code-vb[System.TimeZone2.CreateTimeZone#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.TimeZone2.CreateTimeZone/vb/System.TimeZone2.CreateTimeZone.vb#6)]

## <a name="see-also"></a><span data-ttu-id="4d2db-152">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="4d2db-152">See also</span></span>

<span data-ttu-id="4d2db-153">[Date, ore e fusi orari](../../../docs/standard/datetime/index.md)
[Panoramica sul fuso orario](../../../docs/standard/datetime/time-zone-overview.md)
[procedura: creare fusi orari senza regole di regolazione](../../../docs/standard/datetime/create-time-zones-without-adjustment-rules.md)</span><span class="sxs-lookup"><span data-stu-id="4d2db-153">[Dates, times, and time zones](../../../docs/standard/datetime/index.md)
[Time zone overview](../../../docs/standard/datetime/time-zone-overview.md)
[How to: Create time zones without adjustment rules](../../../docs/standard/datetime/create-time-zones-without-adjustment-rules.md)</span></span>
