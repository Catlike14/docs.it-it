---
title: Copia di nodi esistenti da un documento all'altro
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-standard
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 3caa78c1-3448-4b7b-b83c-228ee857635e
caps.latest.revision: "4"
author: mairaw
ms.author: mairaw
manager: wpickett
ms.openlocfilehash: 0f20e5bd595c8eb49360e58f281a8cf6eda89acf
ms.sourcegitcommit: bd1ef61f4bb794b25383d3d72e71041a5ced172e
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 10/18/2017
---
# <a name="copying-existing-nodes-from-one-document-to-another"></a><span data-ttu-id="9d5a3-102">Copia di nodi esistenti da un documento all'altro</span><span class="sxs-lookup"><span data-stu-id="9d5a3-102">Copying Existing Nodes from One Document to Another</span></span>
<span data-ttu-id="9d5a3-103">Il **ImportNode** metodo è il meccanismo mediante il quale un nodo o un intero sottoalbero di nodi viene copiato da un **XmlDocument** a un altro.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-103">The **ImportNode** method is the mechanism by which a node or entire node subtree is copied from one **XmlDocument** to another.</span></span> <span data-ttu-id="9d5a3-104">Il nodo restituito dalla chiamata è una copia del nodo dal documento di origine, inclusi i valori degli attributi, il nome del nodo, il tipo di nodo e tutti gli attributi relativi allo spazio dei nomi quali il prefisso, il nome locale e l'URI dello spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-104">The node returned from the call is a copy of the node from the source document, including attribute values, the node name, node type, and all namespace-related attributes such as the prefix, local name, and namespace Uniform Resource Identifier (URI).</span></span> <span data-ttu-id="9d5a3-105">Il documento di origine non viene modificato.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-105">The source document is not changed.</span></span> <span data-ttu-id="9d5a3-106">Dopo aver importato il nodo, è necessario aggiungerlo all'albero usando uno dei metodi di inserimento dei nodi.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-106">After you have imported the node, you still have to add it to the tree using one of the methods used to insert nodes.</span></span>  
  
 <span data-ttu-id="9d5a3-107">Quando il nodo viene associato al documento nuovo, quest'ultimo possiede il nodo,</span><span class="sxs-lookup"><span data-stu-id="9d5a3-107">When the node is attached to its new document, the new document owns the node.</span></span> <span data-ttu-id="9d5a3-108">perché ogni nodo, al momento della creazione, ha un documento che lo possiede, anche se i nodi vengono creati in frammenti di documento separati.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-108">The reason is that each node, when created, has an owning document, even if the nodes are created in separate document fragments.</span></span> <span data-ttu-id="9d5a3-109">Questo è un requisito dell'oggetto modello DOM (Document XML) e viene imposto dalla progettazione creazione factory per la **XmlDocument** classe.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-109">This is a requirement of the XML Document Object Model (DOM) and is enforced by the factory creation design on the **XmlDocument** class.</span></span> <span data-ttu-id="9d5a3-110">Ad esempio, **CreateElement**, è l'unico modo per creare nuovi nodi.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-110">For example, **CreateElement**, is the only way to create new nodes.</span></span>  
  
 <span data-ttu-id="9d5a3-111">A seconda del tipo di nodo importato e il valore della *complete* parametro, informazioni aggiuntive a verrà copiata.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-111">Depending on the node type of the imported node and the value of the *deep* parameter, additional information is copied as appropriate.</span></span> <span data-ttu-id="9d5a3-112">Questo metodo tenta di rispecchiare il comportamento previsto nel caso in cui un frammento di codice XML o HTML sia stato copiato da un documento all'altro, tenendo conto del fatto che per il codice XML i due documenti potrebbero avere DTD diverse.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-112">This method attempts to mirror the behavior expected if a fragment of XML or HTML source was copied from one document to another, accounting for the fact that for XML, the two documents may have different document type definitions (DTDs).</span></span>  
  
 <span data-ttu-id="9d5a3-113">Nella tabella seguente viene descritto il comportamento specifico di ogni tipo di nodo che è possibile importare.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-113">The following table describes the specific behavior for each type of node that can be imported.</span></span>  
  
|<span data-ttu-id="9d5a3-114">Tipo di nodo</span><span class="sxs-lookup"><span data-stu-id="9d5a3-114">Node Type</span></span>|<span data-ttu-id="9d5a3-115">*Deep* parametro è true</span><span class="sxs-lookup"><span data-stu-id="9d5a3-115">*deep* parameter is true</span></span>|<span data-ttu-id="9d5a3-116">*Deep* parametro è false</span><span class="sxs-lookup"><span data-stu-id="9d5a3-116">*deep* parameter is false</span></span>|  
|---------------|------------------------------|-------------------------------|  
|<span data-ttu-id="9d5a3-117">XmlAttribute</span><span class="sxs-lookup"><span data-stu-id="9d5a3-117">XmlAttribute</span></span>|<span data-ttu-id="9d5a3-118">Il <xref:System.Xml.XmlAttribute.Specified%2A> è impostato su **true** nel XmlAttribute.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-118">The <xref:System.Xml.XmlAttribute.Specified%2A> is set to **true** on the XmlAttribute.</span></span> <span data-ttu-id="9d5a3-119">I discendenti dell'origine **XmlAttribute** vengono importati in modo ricorsivo e i nodi risultanti vengono riassemblati per formare il sottoalbero corrispondente.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-119">The descendants of the source **XmlAttribute** are recursively imported and the resulting nodes reassembled to form the corresponding subtree.</span></span>|<span data-ttu-id="9d5a3-120">Il *complete* parametro non è applicabile a **XmlAttribute** nodi, in quanto questi restano sempre i relativi nodi figlio con durante l'importazione.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-120">The *deep* parameter does not apply to **XmlAttribute** nodes, because they always carry their child nodes with them when imported.</span></span>|  
|<span data-ttu-id="9d5a3-121">XmlCDataSection</span><span class="sxs-lookup"><span data-stu-id="9d5a3-121">XmlCDataSection</span></span>|<span data-ttu-id="9d5a3-122">Copia il nodo, compresi i dati.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-122">Copies the node, including its data.</span></span>|<span data-ttu-id="9d5a3-123">Copia il nodo, compresi i dati.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-123">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="9d5a3-124">XmlComment</span><span class="sxs-lookup"><span data-stu-id="9d5a3-124">XmlComment</span></span>|<span data-ttu-id="9d5a3-125">Copia il nodo, compresi i dati.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-125">Copies the node, including its data.</span></span>|<span data-ttu-id="9d5a3-126">Copia il nodo, compresi i dati.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-126">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="9d5a3-127">XmlDocumentFragment</span><span class="sxs-lookup"><span data-stu-id="9d5a3-127">XmlDocumentFragment</span></span>|<span data-ttu-id="9d5a3-128">Gli elementi discendenti del nodo di origine vengono importati in modo ricorsivo e i nodi risultanti vengono riassemblati per formare il sottoalbero corrispondente.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-128">The descendants of the source node are recursively imported and the resulting nodes reassembled to form the corresponding subtree.</span></span>|<span data-ttu-id="9d5a3-129">Un oggetto vuoto **XmlDocumentFragment** viene creato.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-129">An empty **XmlDocumentFragment** is created.</span></span>|  
|<span data-ttu-id="9d5a3-130">XmlDocumentType</span><span class="sxs-lookup"><span data-stu-id="9d5a3-130">XmlDocumentType</span></span>|<span data-ttu-id="9d5a3-131">Copia il nodo, compresi i dati.*</span><span class="sxs-lookup"><span data-stu-id="9d5a3-131">Copies the node, including its data.*</span></span>|<span data-ttu-id="9d5a3-132">Copia il nodo, compresi i dati.*</span><span class="sxs-lookup"><span data-stu-id="9d5a3-132">Copies the node, including its data.*</span></span>|  
|<span data-ttu-id="9d5a3-133">XmlElement</span><span class="sxs-lookup"><span data-stu-id="9d5a3-133">XmlElement</span></span>|<span data-ttu-id="9d5a3-134">Gli elementi discendenti dell'elemento di origine vengono importati in modo ricorsivo e i nodi risultanti vengono riassemblati per formare il sottoalbero corrispondente.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-134">The descendants of the source element are recursively imported and the resulting nodes reassembled to form the corresponding subtree.</span></span> <span data-ttu-id="9d5a3-135">**Nota:** gli attributi predefiniti non vengono copiati.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-135">**Note:**  Default attributes are not copied.</span></span> <span data-ttu-id="9d5a3-136">Se il documento verso il quale avviene l'importazione definisce attributi predefiniti per questo nome di elemento, verranno assegnati tali attributi.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-136">If the document being imported into defines default attributes for this element name, those are assigned.</span></span>|<span data-ttu-id="9d5a3-137">Specificato attributo nodi dell'elemento di origine vengono importati e generato **XmlAttribute** nodi vengono collegati al nuovo elemento.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-137">Specified attribute nodes of the source element are imported, and the generated **XmlAttribute** nodes are attached to the new element.</span></span> <span data-ttu-id="9d5a3-138">I nodi discendenti non vengono copiati.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-138">The descendant nodes are not copied.</span></span> <span data-ttu-id="9d5a3-139">**Nota:** gli attributi predefiniti non vengono copiati.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-139">**Note:**  Default attributes are not copied.</span></span> <span data-ttu-id="9d5a3-140">Se il documento verso il quale avviene l'importazione definisce attributi predefiniti per questo nome di elemento, verranno assegnati tali attributi.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-140">If the document being imported into defines default attributes for this element name, those are assigned.</span></span>|  
|<span data-ttu-id="9d5a3-141">XmlEntityReference</span><span class="sxs-lookup"><span data-stu-id="9d5a3-141">XmlEntityReference</span></span>|<span data-ttu-id="9d5a3-142">Poiché i documenti di origine e di destinazione potrebbero essere le entità definite in modo diverso, questo metodo copia solo il **XmlEntityReference** nodo.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-142">Because the source and destination documents could have the entities defined differently, this method only copies the **XmlEntityReference** node.</span></span> <span data-ttu-id="9d5a3-143">Il testo di sostituzione non viene incluso.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-143">The replacement text is not included.</span></span> <span data-ttu-id="9d5a3-144">Se nel documento di destinazione l'entità è definita, viene assegnato il suo valore.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-144">If the destination document has the entity defined, its value is assigned.</span></span>|<span data-ttu-id="9d5a3-145">Poiché i documenti di origine e di destinazione potrebbero essere le entità definite in modo diverso, questo metodo copia solo il **XmlEntityReference** nodo.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-145">Because the source and destination documents could have the entities defined differently, this method only copies the **XmlEntityReference** node.</span></span> <span data-ttu-id="9d5a3-146">Il testo di sostituzione non viene incluso.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-146">The replacement text is not included.</span></span> <span data-ttu-id="9d5a3-147">Se nel documento di destinazione l'entità è definita, viene assegnato il suo valore.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-147">If the destination document has the entity defined, its value is assigned.</span></span>|  
|<span data-ttu-id="9d5a3-148">XmlProcessingInstruction</span><span class="sxs-lookup"><span data-stu-id="9d5a3-148">XmlProcessingInstruction</span></span>|<span data-ttu-id="9d5a3-149">Copia il valore di destinazione e dei dati dal nodo importato.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-149">Copies the target and data value from the imported node.</span></span>|<span data-ttu-id="9d5a3-150">Copia il valore di destinazione e dei dati dal nodo importato.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-150">Copies the target and data value from the imported node.</span></span>|  
|<span data-ttu-id="9d5a3-151">XmlText</span><span class="sxs-lookup"><span data-stu-id="9d5a3-151">XmlText</span></span>|<span data-ttu-id="9d5a3-152">Copia il nodo, compresi i dati.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-152">Copies the node, including its data.</span></span>|<span data-ttu-id="9d5a3-153">Copia il nodo, compresi i dati.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-153">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="9d5a3-154">XmlSignificantWhitespace</span><span class="sxs-lookup"><span data-stu-id="9d5a3-154">XmlSignificantWhitespace</span></span>|<span data-ttu-id="9d5a3-155">Copia il nodo, compresi i dati.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-155">Copies the node, including its data.</span></span>|<span data-ttu-id="9d5a3-156">Copia il nodo, compresi i dati.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-156">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="9d5a3-157">XmlWhitespace</span><span class="sxs-lookup"><span data-stu-id="9d5a3-157">XmlWhitespace</span></span>|<span data-ttu-id="9d5a3-158">Copia il nodo, compresi i dati.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-158">Copies the node, including its data.</span></span>|<span data-ttu-id="9d5a3-159">Copia il nodo, compresi i dati.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-159">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="9d5a3-160">XmlDeclaration</span><span class="sxs-lookup"><span data-stu-id="9d5a3-160">XmlDeclaration</span></span>|<span data-ttu-id="9d5a3-161">Copia il valore di destinazione e dei dati dal nodo importato.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-161">Copies the target and data value from the imported node.</span></span>|<span data-ttu-id="9d5a3-162">Copia il valore di destinazione e dei dati dal nodo importato.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-162">Copies the target and data value from the imported node.</span></span>|  
|<span data-ttu-id="9d5a3-163">Tutti gli altri tipi di nodo</span><span class="sxs-lookup"><span data-stu-id="9d5a3-163">All other node types</span></span>|<span data-ttu-id="9d5a3-164">Questi nodi non possono essere importati.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-164">These node types cannot be imported.</span></span>|<span data-ttu-id="9d5a3-165">Questi nodi non possono essere importati.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-165">These node types cannot be imported.</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="9d5a3-166">Sebbene sia possibile importare nodi DocumentType, un documento può disporre di un unico DocumentType.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-166">Although DocumentType nodes can be imported, a document can only have one DocumentType.</span></span> <span data-ttu-id="9d5a3-167">Pertanto, una volta importato il tipo di documento, prima di inserirlo nell'albero è necessario verificare che non sia presente alcun tipo di documento nel documento stesso.</span><span class="sxs-lookup"><span data-stu-id="9d5a3-167">So, once you have imported the document type, before inserting it into tree you have to make sure that there is no document type in the document.</span></span> <span data-ttu-id="9d5a3-168">Per informazioni sulla rimozione di nodi, vedere [rimozione di nodi, contenuto e valori da un documento XML](../../../../docs/standard/data/xml/removing-nodes-content-and-values-from-an-xml-document.md).</span><span class="sxs-lookup"><span data-stu-id="9d5a3-168">For information on removing nodes, see [Removing Nodes, Content, and Values from an XML Document](../../../../docs/standard/data/xml/removing-nodes-content-and-values-from-an-xml-document.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9d5a3-169">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="9d5a3-169">See Also</span></span>  
 [<span data-ttu-id="9d5a3-170">XML Document Object Model (DOM)</span><span class="sxs-lookup"><span data-stu-id="9d5a3-170">XML Document Object Model (DOM)</span></span>](../../../../docs/standard/data/xml/xml-document-object-model-dom.md)
