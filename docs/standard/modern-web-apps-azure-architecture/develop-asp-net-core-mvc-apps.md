---
title: Sviluppo di applicazioni MVC ASP.NET Core
description: Architettura di moderne applicazioni Web con ASP.NET Core e Azure | lo sviluppo di App di MVC ASP.NET Core
author: ardalis
ms.author: wiwagn
ms.date: 10/07/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.openlocfilehash: 54e7ed6fff9ac709e411d0ac1e345c63fd753201
ms.sourcegitcommit: 43c656811dd38a66a6672084c65d10c0cbbf2015
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 11/22/2017
---
# <a name="develop-aspnet-core-mvc-apps"></a><span data-ttu-id="5bd64-103">Sviluppare applicazioni MVC ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="5bd64-103">Develop ASP.NET Core MVC Apps</span></span>

> <span data-ttu-id="5bd64-104">"Non è importante capire la prima volta.</span><span class="sxs-lookup"><span data-stu-id="5bd64-104">"It's not important to get it right the first time.</span></span> <span data-ttu-id="5bd64-105">È estremamente importante da capire l'ultima volta".</span><span class="sxs-lookup"><span data-stu-id="5bd64-105">It's vitally important to get it right the last time."</span></span>  
> <span data-ttu-id="5bd64-106">_-Andrew risposta e David Thomas_</span><span class="sxs-lookup"><span data-stu-id="5bd64-106">_- Andrew Hunt and David Thomas_</span></span>

## <a name="summary"></a><span data-ttu-id="5bd64-107">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="5bd64-107">Summary</span></span>

<span data-ttu-id="5bd64-108">ASP.NET Core è un framework multipiattaforma, open source per la compilazione di applicazioni web moderne ottimizzato su cloud.</span><span class="sxs-lookup"><span data-stu-id="5bd64-108">ASP.NET Core is a cross-platform, open-source framework for building modern cloud-optimized web applications.</span></span> <span data-ttu-id="5bd64-109">Le app di ASP.NET Core sono lightweight e modulari, con supporto incorporato per l'inserimento di dipendenze, consentendo maggiore testabilità e gestibilità.</span><span class="sxs-lookup"><span data-stu-id="5bd64-109">ASP.NET Core apps are lightweight and modular, with built-in support for dependency injection, enabling in greater testability and maintainability.</span></span> <span data-ttu-id="5bd64-110">Combinata con MVC, che supporta la creazione di API web moderna oltre alle applicazioni basate su Vista, ASP.NET Core è un framework potente con il quale la creazione di applicazioni web aziendali.</span><span class="sxs-lookup"><span data-stu-id="5bd64-110">Combined with MVC, which supports building modern web APIs in addition to view-based apps, ASP.NET Core is a powerful framework with which to build enterprise web applications.</span></span>

## <a name="mapping-requests-to-responses"></a><span data-ttu-id="5bd64-111">Mapping tra le richieste e risposte</span><span class="sxs-lookup"><span data-stu-id="5bd64-111">Mapping Requests to Responses</span></span>

<span data-ttu-id="5bd64-112">Essenzialmente, App ASP.NET Core mappare le richieste in ingresso per le risposte in uscita.</span><span class="sxs-lookup"><span data-stu-id="5bd64-112">At its heart, ASP.NET Core apps map incoming requests to outgoing responses.</span></span> <span data-ttu-id="5bd64-113">Un livello basso, questa operazione viene eseguita con middleware e semplici applicazioni ASP.NET Core e microservizi possono essere costituito esclusivamente middleware personalizzato.</span><span class="sxs-lookup"><span data-stu-id="5bd64-113">At a low level, this is done with middleware, and simple ASP.NET Core apps and microservices may be comprised solely of custom middleware.</span></span> <span data-ttu-id="5bd64-114">Quando si utilizza ASP.NET MVC di base, è possibile utilizzare un livello leggermente più elevato, pensare in termini di *route*, *controller*, e *azioni*.</span><span class="sxs-lookup"><span data-stu-id="5bd64-114">When using ASP.NET Core MVC, you can work at a somewhat higher level, thinking in terms of *routes*, *controllers*, and *actions*.</span></span> <span data-ttu-id="5bd64-115">Ogni richiesta in ingresso viene confrontato con la tabella di routing dell'applicazione e se viene trovata una route corrispondente, il metodo di azione associato (appartenente a un controller) viene chiamato per gestire la richiesta.</span><span class="sxs-lookup"><span data-stu-id="5bd64-115">Each incoming request is compared with the application's routing table, and if a matching route is found, the associated action method (belonging to a controller) is called to handle the request.</span></span> <span data-ttu-id="5bd64-116">Se non viene trovata alcuna route corrispondente, viene chiamato un gestore degli errori (in questo caso, restituire un risultato non trovato).</span><span class="sxs-lookup"><span data-stu-id="5bd64-116">If no matching route is found, an error handler (in this case, returning a NotFound result) is called.</span></span>

<span data-ttu-id="5bd64-117">Le applicazioni MVC ASP.NET Core è possono utilizzare le route convenzionale, route di attributi o entrambi.</span><span class="sxs-lookup"><span data-stu-id="5bd64-117">ASP.NET Core MVC apps can use conventional routes, attribute routes, or both.</span></span> <span data-ttu-id="5bd64-118">Route convenzionale sono definite nel codice, che specifica il routing *convenzioni* utilizzando una sintassi come nell'esempio seguente:</span><span class="sxs-lookup"><span data-stu-id="5bd64-118">Conventional routes are defined in code, specifying routing *conventions* using syntax like in the example below:</span></span>

```csharp
app.UseMvc(routes =>;
{
    routes.MapRoute("default","{controller=Home}/{action=Index}/{id?}");
});
```

<span data-ttu-id="5bd64-119">In questo esempio, una route denominata "default" è stato aggiunto alla tabella di routing.</span><span class="sxs-lookup"><span data-stu-id="5bd64-119">In this example, a route named "default" has been added to the routing table.</span></span> <span data-ttu-id="5bd64-120">Definisce un modello di route con segnaposto per *controller*, *azione*, e *id*. I segnaposto di azione e del controller sono predefinito specificato ("Home" e "Index", rispettivamente), e il segnaposto dell'id è facoltativo (in virtù di un "?" applicata).</span><span class="sxs-lookup"><span data-stu-id="5bd64-120">It defines a route template with placeholders for *controller*, *action*, and *id*. The controller and action placeholders have default specified ("Home" and "Index", respectively), and the id placeholder is optional (by virtue of a "?" applied to it).</span></span> <span data-ttu-id="5bd64-121">La convenzione definite qui gli Stati che la prima parte di una richiesta deve corrispondere al nome del controller, la seconda parte, all'azione e quindi se è necessaria una terza parte rappresenterà un parametro di tipo id.</span><span class="sxs-lookup"><span data-stu-id="5bd64-121">The convention defined here states that the first part of a request should correspond to the name of the controller, the second part to the action, and then if necessary a third part will represent an id parameter.</span></span> <span data-ttu-id="5bd64-122">Le route convenzionale sono in genere definite in un'unica posizione per l'applicazione, come nel metodo configura la classe di avvio.</span><span class="sxs-lookup"><span data-stu-id="5bd64-122">Conventional routes are typically defined in one place for the application, such as in the Configure method in the Startup class.</span></span>

<span data-ttu-id="5bd64-123">Route di attributi vengono applicate a controller e azioni direttamente, anziché specificate a livello globale.</span><span class="sxs-lookup"><span data-stu-id="5bd64-123">Attribute routes are applied to controllers and actions directly, rather than specified globally.</span></span> <span data-ttu-id="5bd64-124">Questo ha il vantaggio di renderli risulta molto più facilmente individuabile quando si cerca un metodo specifico, ma significa che le informazioni di routing non viene mantenute in un'unica posizione nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="5bd64-124">This has the advantage of making them much more discoverable when you're looking at a particular method, but does mean that routing information is not kept in one place in the application.</span></span> <span data-ttu-id="5bd64-125">Route di attributo, è facilmente possibile specificare più route per una determinata azione, nonché combinare le route tra i controller e azioni.</span><span class="sxs-lookup"><span data-stu-id="5bd64-125">With attribute routes, you can easily specify multiple routes for a given action, as well as combine routes between controllers and actions.</span></span> <span data-ttu-id="5bd64-126">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="5bd64-126">For example:</span></span>

```csharp
[Route("Home")]
public class HomeController : Controller
{
    [Route("")] // Combines to define the route template "Home"
    [Route("Index")] // Combines to define route template "Home/Index"
    [Route("/")] // Does not combine, defines the route template ""
    public IActionResult Index() {}
```

<span data-ttu-id="5bd64-127">Le route possono essere specificate in [HttpGet] e separano attributi simili, evitando la necessità di aggiungere [Route\] attributi.</span><span class="sxs-lookup"><span data-stu-id="5bd64-127">Routes can be specified on [HttpGet] and similar attributes, avoiding the need to add separate [Route\] attributes.</span></span> <span data-ttu-id="5bd64-128">Route di attributi possono inoltre utilizzare i token per ridurre la necessità di ripetere i nomi di controller o un'azione, come illustrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="5bd64-128">Attribute routes can also use tokens to reduce the need to repeat controller or action names, as shown below:</span></span>

```csharp
[Route("[controller\]")]
public class ProductsController : Controller
{
    [Route("")] // Matches 'Products'
    [Route("Index")] // Matches 'Products/Index'
    public IActionResult Index()
}
```

<span data-ttu-id="5bd64-129">Una volta che una determinata richiesta è stata trovata per una route, ma prima dell'azione metodo viene chiamato, ASP.NET MVC Core eseguirà [associazione del modello](https://docs.microsoft.com/aspnet/core/mvc/models/model-binding) e [la convalida del modello](https://docs.microsoft.com/aspnet/core/mvc/models/validation) nella richiesta.</span><span class="sxs-lookup"><span data-stu-id="5bd64-129">Once a given request has been matched to a route, but before the action method is called, ASP.NET Core MVC will perform [model binding](https://docs.microsoft.com/aspnet/core/mvc/models/model-binding) and [model validation](https://docs.microsoft.com/aspnet/core/mvc/models/validation) on the request.</span></span> <span data-ttu-id="5bd64-130">Associazione di modelli è responsabile della conversione dei dati HTTP in ingresso nei tipi .NET specificati come parametri del metodo di azione da chiamare.</span><span class="sxs-lookup"><span data-stu-id="5bd64-130">Model binding is responsible for converting incoming HTTP data into the .NET types specified as parameters of the action method to be called.</span></span> <span data-ttu-id="5bd64-131">Ad esempio, se il metodo di azione che prevede un parametro di id int, l'associazione di modelli tenterà di utilizzare questo parametro da un valore fornito come parte della richiesta.</span><span class="sxs-lookup"><span data-stu-id="5bd64-131">For example, if the action method expects an int id parameter, model binding will attempt to provide this parameter from a value provided as part of the request.</span></span> <span data-ttu-id="5bd64-132">A tale scopo, l'associazione di modelli Cerca valori in un form pubblicato, i valori della route se stesso e i valori di stringa di query.</span><span class="sxs-lookup"><span data-stu-id="5bd64-132">To do so, model binding looks for values in a posted form, values in the route itself, and query string values.</span></span> <span data-ttu-id="5bd64-133">Se che viene trovato un valore di id, verrà convertito in un intero prima di essere passata al metodo di azione.</span><span class="sxs-lookup"><span data-stu-id="5bd64-133">Assuming an id value is found, it will be converted to an integer before being passed into the action method.</span></span>

<span data-ttu-id="5bd64-134">Dopo l'associazione del modello, ma prima di chiamare il metodo di azione, si verifica la convalida del modello.</span><span class="sxs-lookup"><span data-stu-id="5bd64-134">After binding the model but before calling the action method, model validation occurs.</span></span> <span data-ttu-id="5bd64-135">Convalida del modello utilizza gli attributi facoltativi nel tipo di modello e contribuisce a garantire che l'oggetto modello fornito sia conforme ai requisiti determinati dati.</span><span class="sxs-lookup"><span data-stu-id="5bd64-135">Model validation uses optional attributes on the model type, and can help ensure that the provided model object conforms to certain data requirements.</span></span> <span data-ttu-id="5bd64-136">Alcuni valori possono essere specificati come richiesto, o limitate a un determinato intervallo numerico o di lunghezza, e così via. Se vengono specificati gli attributi di convalida, ma il modello non è conforme ai relativi requisiti, la proprietà ModelState.IsValid è false e il set di regole di convalida non sarà disponibile per l'invio al client che effettua la richiesta.</span><span class="sxs-lookup"><span data-stu-id="5bd64-136">Certain values may be specified as required, or limited to a certain length or numeric range, etc. If validation attributes are specified but the model does not conform to their requirements, the property ModelState.IsValid will be false, and the set of failing validation rules will be available to send to the client making the request.</span></span>

<span data-ttu-id="5bd64-137">Se si utilizza la convalida del modello, è necessario verificare sempre che il modello sia valido prima di eseguire i comandi di modifica dello stato, per garantire che l'applicazione non sia danneggiato da dati non validi.</span><span class="sxs-lookup"><span data-stu-id="5bd64-137">If you are using model validation, you should be sure to always check that the model is valid before performing any state-altering commands, to ensure your app is not corrupted by invalid data.</span></span> <span data-ttu-id="5bd64-138">È possibile utilizzare un [filtro](https://docs.microsoft.com/aspnet/core/mvc/controllers/filters) per evitare la necessità di aggiungere il codice per questo oggetto per ogni azione.</span><span class="sxs-lookup"><span data-stu-id="5bd64-138">You can use a [filter](https://docs.microsoft.com/aspnet/core/mvc/controllers/filters) to avoid the need to add code for this in every action.</span></span> <span data-ttu-id="5bd64-139">Filtri MVC ASP.NET Core offrono un metodo di intercettazione delle richieste, i gruppi in modo che i criteri comuni e i problemi di montaggio incrociato possono essere applicati in base a una destinazione.</span><span class="sxs-lookup"><span data-stu-id="5bd64-139">ASP.NET Core MVC filters offer a way of intercepting groups of requests, so that common policies and cross-cutting concerns can be applied on a targeted basis.</span></span> <span data-ttu-id="5bd64-140">Filtri possono essere applicati alle singole azioni, intero controller, o a livello globale per un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="5bd64-140">Filters can be applied to individual actions, whole controllers, or globally for an application.</span></span>

<span data-ttu-id="5bd64-141">Per le API web, ASP.NET MVC di base supporta [ *negoziazione del contenuto*](https://docs.microsoft.com/aspnet/core/mvc/models/formatting), che consente le richieste specificare la modalità di formattazione di risposte.</span><span class="sxs-lookup"><span data-stu-id="5bd64-141">For web APIs, ASP.NET Core MVC supports [*content negotiation*](https://docs.microsoft.com/aspnet/core/mvc/models/formatting), allowing requests to specify how responses should be formatted.</span></span> <span data-ttu-id="5bd64-142">In base alle intestazioni fornite nella richiesta, la restituzione di dati di azioni formatterà la risposta in XML, JSON o un altro formato supportato.</span><span class="sxs-lookup"><span data-stu-id="5bd64-142">Based on headers provided in the request, actions returning data will format the response in XML, JSON, or another supported format.</span></span> <span data-ttu-id="5bd64-143">Questa funzionalità consente la stessa API utilizzabile da più client con i requisiti per il formato dati diverso.</span><span class="sxs-lookup"><span data-stu-id="5bd64-143">This feature enables the same API to be used by multiple clients with different data format requirements.</span></span>

> ### <a name="references--mapping-requests-to-responses"></a><span data-ttu-id="5bd64-144">Riferimenti: mapping tra le richieste e risposte</span><span class="sxs-lookup"><span data-stu-id="5bd64-144">References – Mapping Requests to Responses</span></span>
> - <span data-ttu-id="5bd64-145">**Routing per Controller azioni**
> <https://docs.microsoft.com/aspnet/core/mvc/controllers/routing></span><span class="sxs-lookup"><span data-stu-id="5bd64-145">**Routing to Controller Actions**
<https://docs.microsoft.com/aspnet/core/mvc/controllers/routing></span></span>
> - <span data-ttu-id="5bd64-146">**Associazione del modello** https://docs.microsoft.com/aspnet/core/mvc/models/model-binding</span><span class="sxs-lookup"><span data-stu-id="5bd64-146">**Model Binding** https://docs.microsoft.com/aspnet/core/mvc/models/model-binding</span></span>
> - <span data-ttu-id="5bd64-147">**La convalida del modello**
> <https://docs.microsoft.com/aspnet/core/mvc/models/validation></span><span class="sxs-lookup"><span data-stu-id="5bd64-147">**Model Validation**
<https://docs.microsoft.com/aspnet/core/mvc/models/validation></span></span>
> - <span data-ttu-id="5bd64-148">**I filtri** https://docs.microsoft.com/aspnet/core/mvc/controllers/filters</span><span class="sxs-lookup"><span data-stu-id="5bd64-148">**Filters** https://docs.microsoft.com/aspnet/core/mvc/controllers/filters</span></span>

## <a name="working-with-dependencies"></a><span data-ttu-id="5bd64-149">Utilizzo di dipendenze</span><span class="sxs-lookup"><span data-stu-id="5bd64-149">Working with Dependencies</span></span>

<span data-ttu-id="5bd64-150">ASP.NET di base include il supporto incorporato per e utilizza internamente una tecnica nota come [inserimento di dipendenze](https://docs.microsoft.com/aspnet/core/fundamentals/dependency-injection).</span><span class="sxs-lookup"><span data-stu-id="5bd64-150">ASP.NET Core has built-in support for and internally makes use of a technique known as [dependency injection](https://docs.microsoft.com/aspnet/core/fundamentals/dependency-injection).</span></span> <span data-ttu-id="5bd64-151">Inserimento di dipendenze è una tecnica che abilitato accoppiamento debole tra parti diverse di un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="5bd64-151">Dependency injection is a technique that enabled loose coupling between different parts of an application.</span></span> <span data-ttu-id="5bd64-152">Rigida è consigliabile, perché rende più semplice isolare le parti dell'applicazione, consentendo di test o di sostituzione.</span><span class="sxs-lookup"><span data-stu-id="5bd64-152">Looser coupling is desirable because it makes it easier to isolate parts of the application, allowing for testing or replacement.</span></span> <span data-ttu-id="5bd64-153">Rende inoltre meno probabile che una modifica in una parte dell'applicazione avrà un impatto imprevisto in un'altra posizione nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="5bd64-153">It also makes it less likely that a change in one part of the application will have an unexpected impact somewhere else in the application.</span></span> <span data-ttu-id="5bd64-154">Inserimento di dipendenze si basa sul principio di inversione della dipendenza e viene spesso chiave per ottenere il principio di apertura/chiusura.</span><span class="sxs-lookup"><span data-stu-id="5bd64-154">Dependency injection is based on the dependency inversion principle, and is often key to achieving the open/closed principle.</span></span> <span data-ttu-id="5bd64-155">Prestare attenzione quando si valuta il funzionamento dell'applicazione con le relative dipendenze, di [adesive statico](http://deviq.com/static-cling/) codice odore e memorizza il aphorism "[nuovo è glue](http://ardalis.com/new-is-glue)."</span><span class="sxs-lookup"><span data-stu-id="5bd64-155">When evaluating how your application works with its dependencies, beware of the [static cling](http://deviq.com/static-cling/) code smell, and remember the aphorism "[new is glue](http://ardalis.com/new-is-glue)."</span></span>

<span data-ttu-id="5bd64-156">Adesive statico si verifica quando le classi di effettuano chiamate ai metodi statici o accedere a proprietà statiche, che presentano effetti collaterali o dipendenze dall'infrastruttura.</span><span class="sxs-lookup"><span data-stu-id="5bd64-156">Static cling occurs when your classes make calls to static methods, or access static properties, which have side effects or dependencies on infrastructure.</span></span> <span data-ttu-id="5bd64-157">Ad esempio, se si dispone di un metodo che chiama un metodo statico, che a sua volta scrive in un database, il metodo è strettamente al database.</span><span class="sxs-lookup"><span data-stu-id="5bd64-157">For example, if you have a method that calls a static method, which in turn writes to a database, your method is tightly coupled to the database.</span></span> <span data-ttu-id="5bd64-158">Tutto ciò che si interrompe la chiamata al database interromperà il metodo.</span><span class="sxs-lookup"><span data-stu-id="5bd64-158">Anything that breaks that database call will break your method.</span></span> <span data-ttu-id="5bd64-159">Tali metodi di test è notoriamente difficile, poiché tali test richiedono commerciale librerie di simulazione per simulare le chiamate statiche oppure può essere testato solo con un database di prova sul posto.</span><span class="sxs-lookup"><span data-stu-id="5bd64-159">Testing such methods is notoriously difficult, since such tests either require commercial mocking libraries to mock the static calls, or can only be tested with a test database in place.</span></span> <span data-ttu-id="5bd64-160">Chiamate statiche che non dispongono di qualsiasi dipendenza infrastruttura, specialmente quelle che sono completamente indipendenti dallo stato, sono supportate chiamare e avere alcun impatto su accoppiamento o testabilità (oltre l'accoppiamento tra codice per la chiamata statica).</span><span class="sxs-lookup"><span data-stu-id="5bd64-160">Static calls that don't have any dependence on infrastructure, especially those that are completely stateless, are fine to call and have no impact on coupling or testability (beyond coupling code to the static call itself).</span></span>

<span data-ttu-id="5bd64-161">Molti sviluppatori comprenderne i rischi di adesive statico e stato globale, ma verranno comunque stretta tra il codice per le implementazioni specifiche tramite la creazione di istanze diretto.</span><span class="sxs-lookup"><span data-stu-id="5bd64-161">Many developers understand the risks of static cling and global state, but will still tightly couple their code to specific implementations through direct instantiation.</span></span> <span data-ttu-id="5bd64-162">"Nuovo è glue" deve essere un promemoria di questo tipo di controllo e non un condanna generale utilizza la parola chiave new.</span><span class="sxs-lookup"><span data-stu-id="5bd64-162">"New is glue" is meant to be a reminder of this coupling, and not a general condemnation of the use of the new keyword.</span></span> <span data-ttu-id="5bd64-163">Come con chiamate al metodo statico, nuove istanze dei tipi che non hanno dipendenze esterne in genere non è strettamente accoppiato codice per i dettagli di implementazione o rendere più difficile il test.</span><span class="sxs-lookup"><span data-stu-id="5bd64-163">Just as with static method calls, new instances of types that have no external dependencies typically do not tightly couple code to implementation details or make testing more difficult.</span></span> <span data-ttu-id="5bd64-164">Ma ogni volta che viene creata un'istanza di una classe, richiedere solo un breve istante da considerare se è consigliabile codificare quell ' istanza specifica in quella determinata posizione o se ne fosse una progettazione migliore per richiedere tale istanza come dipendenza.</span><span class="sxs-lookup"><span data-stu-id="5bd64-164">But each time a class is instantiated, take just a brief moment to consider whether it makes sense to hard-code that specific instance in that particular location, or if it would be a better design to request that instance as a dependency.</span></span>

### <a name="declare-your-dependencies"></a><span data-ttu-id="5bd64-165">Dichiarare le dipendenze</span><span class="sxs-lookup"><span data-stu-id="5bd64-165">Declare Your Dependencies</span></span>

<span data-ttu-id="5bd64-166">ASP.NET Core si basa su metodi e classi dichiarano le relative dipendenze, che ne fanno richiesta come argomenti.</span><span class="sxs-lookup"><span data-stu-id="5bd64-166">ASP.NET Core is built around having methods and classes declare their dependencies, requesting them as arguments.</span></span> <span data-ttu-id="5bd64-167">Applicazioni ASP.NET vengono in genere impostate in una classe di avvio, che a sua volta è configurato per supportare l'inserimento di dipendenze in diversi momenti.</span><span class="sxs-lookup"><span data-stu-id="5bd64-167">ASP.NET applications are typically set up in a Startup class, which itself is configured to support dependency injection at several points.</span></span> <span data-ttu-id="5bd64-168">Se la classe di avvio ha un costruttore, può richiedere dipendenze mediante il costruttore, come illustrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="5bd64-168">If your Startup class has a constructor, it can request dependencies through the constructor, like so:</span></span>

```csharp
public class Startup
{
    public Startup(IHostingEnvironment env)
    {
        var builder = new ConfigurationBuilder()
        .SetBasePath(env.ContentRootPath)
        .AddJsonFile("appsettings.json", optional: false, reloadOnChange: true)
        .AddJsonFile(\$"appsettings.{env.EnvironmentName}.json", optional: true);
    }
}
```

<span data-ttu-id="5bd64-169">La classe di avvio è interessante in quanto non esistono requisiti per il tipo esplicito.</span><span class="sxs-lookup"><span data-stu-id="5bd64-169">The Startup class is interesting in that there are no explicit type requirements for it.</span></span> <span data-ttu-id="5bd64-170">Non eredita da una classe di base di avvio speciale, né implementa alcuna interfaccia specifico.</span><span class="sxs-lookup"><span data-stu-id="5bd64-170">It doesn't inherit from a special Startup base class, nor does it implement any particular interface.</span></span> <span data-ttu-id="5bd64-171">È possibile assegnare un costruttore o non ed è possibile specificare tutti i parametri del costruttore desiderato.</span><span class="sxs-lookup"><span data-stu-id="5bd64-171">You can give it a constructor, or not, and you can specify as many parameters on the constructor as you want.</span></span> <span data-ttu-id="5bd64-172">Quando l'host web configurati per l'applicazione viene avviata, chiama la classe di avvio che si è indicato l'utilizzo e utilizzerà l'inserimento di dipendenze per popolare le dipendenze che richiede la classe di avvio.</span><span class="sxs-lookup"><span data-stu-id="5bd64-172">When the web host you've configured for your application starts, it will call the Startup class you've told it to use, and will use dependency injection to populate any dependencies the Startup class requires.</span></span> <span data-ttu-id="5bd64-173">Naturalmente, se si richiedono parametri che non sono configurati nel contenitore di servizi utilizzato da ASP.NET Core, si otterrà un'eccezione, ma come soffermeremo dipendenze il contenitore viene a conoscenza, è possibile richiedere desiderato.</span><span class="sxs-lookup"><span data-stu-id="5bd64-173">Of course, if you request parameters that aren't configured in the services container used by ASP.NET Core, you'll get an exception, but as long as you stick to dependencies the container knows about, you can request anything you want.</span></span>

<span data-ttu-id="5bd64-174">Inserimento di dipendenze è incorporata nelle applicazioni ASP.NET Core sin dall'inizio, quando si crea l'istanza di avvio.</span><span class="sxs-lookup"><span data-stu-id="5bd64-174">Dependency injection is built into your ASP.NET Core apps right from the start, when you create the Startup instance.</span></span> <span data-ttu-id="5bd64-175">Non solo per la classe di avvio.</span><span class="sxs-lookup"><span data-stu-id="5bd64-175">It doesn't stop there for the Startup class.</span></span> <span data-ttu-id="5bd64-176">È inoltre possibile richiedere le dipendenze del metodo di configurazione:</span><span class="sxs-lookup"><span data-stu-id="5bd64-176">You can also request dependencies in the Configure method:</span></span>

```csharp
public void Configure(IApplicationBuilder app,
    IHostingEnvironment env,
    ILoggerFactory loggerFactory)
{

}
```

<span data-ttu-id="5bd64-177">Il metodo ConfigureServices è l'eccezione a questo comportamento. è necessario eseguire un solo parametro di tipo IServiceCollection.</span><span class="sxs-lookup"><span data-stu-id="5bd64-177">The ConfigureServices method is the exception to this behavior; it must take just one parameter of type IServiceCollection.</span></span> <span data-ttu-id="5bd64-178">Non debba necessariamente supportano l'inserimento di dipendenze, poiché da un lato è responsabile dell'aggiunta di oggetti per il contenitore dei servizi e l'altro ha accesso a tutti i servizi configurati tramite il parametro IServiceCollection.</span><span class="sxs-lookup"><span data-stu-id="5bd64-178">It doesn't really need to support dependency injection, since on the one hand it is responsible for adding objects to the services container, and on the other it has access to all currently configured services via the IServiceCollection parameter.</span></span> <span data-ttu-id="5bd64-179">Di conseguenza, è possibile utilizzare con le dipendenze definite nella raccolta in ogni parte della classe di avvio, che richiede il servizio necessario come parametro oppure quando si lavora con IServiceCollection in ConfigureServices servizi ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="5bd64-179">Thus, you can work with dependencies defined in the ASP.NET Core services collection in every part of the Startup class, either by requesting the needed service as a parameter or by working with the IServiceCollection in ConfigureServices.</span></span>

> [!NOTE]
> <span data-ttu-id="5bd64-180">Se si desidera verificare alcuni servizi siano disponibili per la classe di avvio, è possibile configurarli tramite WebHostBuilder e il relativo metodo ConfigureServices.</span><span class="sxs-lookup"><span data-stu-id="5bd64-180">If you need to ensure certain services are available to your Startup class, you can configure them using WebHostBuilder and its ConfigureServices method.</span></span>

<span data-ttu-id="5bd64-181">La classe di avvio è un modello di struttura altre parti dell'applicazione ASP.NET di base, dal controller al Middleware ai filtri per i propri servizi.</span><span class="sxs-lookup"><span data-stu-id="5bd64-181">The Startup class is a model for how you should structure other parts of your ASP.NET Core application, from Controllers to Middleware to Filters to your own Services.</span></span> <span data-ttu-id="5bd64-182">In ogni caso, è necessario seguire il [principio dipendenze esplicite](http://deviq.com/explicit-dependencies-principle/), che richiede le dipendenze anziché direttamente la loro creazione e sfruttando l'inserimento di dipendenze in tutta l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="5bd64-182">In each case, you should follow the [Explicit Dependencies Principle](http://deviq.com/explicit-dependencies-principle/), requesting your dependencies rather than directly creating them, and leveraging dependency injection throughout your application.</span></span> <span data-ttu-id="5bd64-183">Prestare attenzione a dove e come creare direttamente le implementazioni, in particolare i servizi e gli oggetti che utilizzano infrastruttura o avere effetti collaterali.</span><span class="sxs-lookup"><span data-stu-id="5bd64-183">Be careful of where and how you directly instantiate implementations, especially services and objects that work with infrastructure or have side effects.</span></span> <span data-ttu-id="5bd64-184">Preferire l'utilizzo di astrazioni definite in base l'applicazione e passati come argomenti a riferimenti hardcoded per tipi specifici di implementazione.</span><span class="sxs-lookup"><span data-stu-id="5bd64-184">Prefer working with abstractions defined in your application core and passed in as arguments to hardcoding references to specific implementation types.</span></span>

## <a name="structuring-the-application"></a><span data-ttu-id="5bd64-185">Strutturare l'applicazione</span><span class="sxs-lookup"><span data-stu-id="5bd64-185">Structuring the Application</span></span>

<span data-ttu-id="5bd64-186">Applicazioni monolitiche in genere presente un solo punto di ingresso.</span><span class="sxs-lookup"><span data-stu-id="5bd64-186">Monolithic applications typically have a single entry point.</span></span> <span data-ttu-id="5bd64-187">Nel caso di un'applicazione web ASP.NET Core, il punto di ingresso sarà il progetto web ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="5bd64-187">In the case of an ASP.NET Core web application, the entry point will be the ASP.NET Core web project.</span></span> <span data-ttu-id="5bd64-188">Tuttavia, non implica che la soluzione deve essere costituito solo un singolo progetto.</span><span class="sxs-lookup"><span data-stu-id="5bd64-188">However, that doesn't mean the solution should consist of just a single project.</span></span> <span data-ttu-id="5bd64-189">È utile suddividere l'applicazione in livelli diversi per seguire la separazione dei compiti.</span><span class="sxs-lookup"><span data-stu-id="5bd64-189">It's useful to break up the application into different layers in order to follow separation of concerns.</span></span> <span data-ttu-id="5bd64-190">Dopo aver suddiviso in livelli, è utile superare le cartelle per separare i progetti, che consentono di ottenere una migliore incapsulamento.</span><span class="sxs-lookup"><span data-stu-id="5bd64-190">Once broken up into layers, it's helpful to go beyond folders to separate projects, which can help achieve better encapsulation.</span></span> <span data-ttu-id="5bd64-191">L'approccio migliore per raggiungere questi obiettivi con un'applicazione ASP.NET Core è una variante dell'architettura pulita descritte nel capitolo 5.</span><span class="sxs-lookup"><span data-stu-id="5bd64-191">The best approach to achieve these goals with an ASP.NET Core application is a variation of the Clean Architecture discussed in chapter 5.</span></span> <span data-ttu-id="5bd64-192">Seguendo questo approccio, la soluzione dell'applicazione verrà essere costituita da librerie separate per l'interfaccia utente, l'infrastruttura e ApplicationCore.</span><span class="sxs-lookup"><span data-stu-id="5bd64-192">Following this approach, the application's solution will be comprised of separate libraries for the UI, Infrastructure, and ApplicationCore.</span></span>

<span data-ttu-id="5bd64-193">Oltre a questi progetti, i progetti di test separato sono inclusi anche (test sono descritto nel capitolo 9).</span><span class="sxs-lookup"><span data-stu-id="5bd64-193">In addition to these projects, separate test projects are included as well (Testing is discussed in Chapter 9).</span></span>

<span data-ttu-id="5bd64-194">Modello a oggetti e le interfacce dell'applicazione devono trovarsi nel progetto ApplicationCore.</span><span class="sxs-lookup"><span data-stu-id="5bd64-194">The application's object model and interfaces should be placed in the ApplicationCore project.</span></span> <span data-ttu-id="5bd64-195">Questo progetto verrà dipendenze con il minor numero possibile, e gli altri progetti nella soluzione verranno farvi riferimento.</span><span class="sxs-lookup"><span data-stu-id="5bd64-195">This project will have as few dependencies as possible, and the other projects in the solution will reference it.</span></span> <span data-ttu-id="5bd64-196">Entità di business che devono essere mantenute sono definite nel progetto ApplicationCore, sono servizi che non dipendono direttamente da infrastruttura.</span><span class="sxs-lookup"><span data-stu-id="5bd64-196">Business entities that need to be persisted are defined in the ApplicationCore project, as are services that do not directly depend on infrastructure.</span></span>

<span data-ttu-id="5bd64-197">Dettagli di implementazione, ad esempio la modalità di esecuzione di persistenza o come è possibile inviare notifiche a un utente, vengono mantenuti nel progetto di infrastruttura.</span><span class="sxs-lookup"><span data-stu-id="5bd64-197">Implementation details, such as how persistence is performed or how notifications might be sent to a user, are kept in the Infrastructure project.</span></span> <span data-ttu-id="5bd64-198">Il progetto farà riferimento specifico dell'implementazione di pacchetti, ad esempio Entity Framework Core, ma non deve esporre informazioni dettagliate su queste implementazioni all'esterno del progetto.</span><span class="sxs-lookup"><span data-stu-id="5bd64-198">This project will reference implementation-specific packages such as Entity Framework Core, but should not expose details about these implementations outside of the project.</span></span> <span data-ttu-id="5bd64-199">Repository e servizi dell'infrastruttura deve implementare le interfacce che sono definite nel progetto ApplicationCore, e le relative implementazioni di persistenza sono responsabili per recuperare e archiviare le entità definite in ApplicationCore.</span><span class="sxs-lookup"><span data-stu-id="5bd64-199">Infrastructure services and repositories should implement interfaces that are defined in the ApplicationCore project, and its persistence implementations are responsible for retrieving and storing entities defined in ApplicationCore.</span></span>

<span data-ttu-id="5bd64-200">Il progetto ASP.NET Core stesso è responsabile di eventuali problemi a livello dell'interfaccia utente, ma non deve includere i dettagli di infrastruttura o logica di business.</span><span class="sxs-lookup"><span data-stu-id="5bd64-200">The ASP.NET Core project itself is responsible for any UI level concerns, but should not include business logic or infrastructure details.</span></span> <span data-ttu-id="5bd64-201">In realtà, in teoria non deve anche presentano una dipendenza nel progetto di infrastruttura, che non è stato introdotto accidentalmente alcuna dipendenza tra i due progetti in modo.</span><span class="sxs-lookup"><span data-stu-id="5bd64-201">In fact, ideally it shouldn't even have a dependency on the Infrastructure project, which will help ensure no dependency between the two projects is introduced accidentally.</span></span> <span data-ttu-id="5bd64-202">Questo può essere ottenuto utilizzando un contenitore DI terze parti come StructureMap, che consente di definire le regole DI nelle classi del Registro di sistema in ogni progetto.</span><span class="sxs-lookup"><span data-stu-id="5bd64-202">This can be achieved using a third-party DI container like StructureMap, which allows you to define DI rules in Registry classes in each project.</span></span>

<span data-ttu-id="5bd64-203">Un altro approccio per l'applicazione dai dettagli di implementazione di separazione è che microservizi la chiamata dell'applicazione, probabilmente distribuiti in singoli contenitori Docker.</span><span class="sxs-lookup"><span data-stu-id="5bd64-203">Another approach to decoupling the application from implementation details is to have the application call microservices, perhaps deployed in individual Docker containers.</span></span> <span data-ttu-id="5bd64-204">Offre anche maggiore separazione delle problematiche e separazione di utilizzo DI tra due progetti, ma presenta una complessità aggiuntiva.</span><span class="sxs-lookup"><span data-stu-id="5bd64-204">This provides even greater separation of concerns and decoupling than leveraging DI between two projects, but has additional complexity.</span></span>

### <a name="feature-organization"></a><span data-ttu-id="5bd64-205">Organizzazione di funzionalità</span><span class="sxs-lookup"><span data-stu-id="5bd64-205">Feature Organization</span></span>

<span data-ttu-id="5bd64-206">Per impostazione predefinita, le applicazioni ASP.NET Core organizzano relativa struttura di cartelle da includere controller e visualizzazioni e spesso ViewModel.</span><span class="sxs-lookup"><span data-stu-id="5bd64-206">By default, ASP.NET Core applications organize their folder structure to include Controllers and Views, and frequently ViewModels.</span></span> <span data-ttu-id="5bd64-207">Il codice lato client per supportare queste strutture sul lato server è in genere archiviato separatamente nella cartella wwwroot.</span><span class="sxs-lookup"><span data-stu-id="5bd64-207">Client-side code to support these server-side structures is typically stored separately in the wwwroot folder.</span></span> <span data-ttu-id="5bd64-208">Tuttavia, applicazioni di grandi dimensioni possono verificarsi problemi con l'organizzazione, poiché spesso l'utilizzo su qualsiasi funzionalità specificata richiede il passaggio tra queste cartelle.</span><span class="sxs-lookup"><span data-stu-id="5bd64-208">However, large applications may encounter problems with this organization, since working on any given feature often requires jumping between these folders.</span></span> <span data-ttu-id="5bd64-209">Questo metodo ottiene più difficile man mano che aumenta il numero di file e le sottocartelle in ogni cartella, comportando una notevole di scorrimento in Esplora soluzioni.</span><span class="sxs-lookup"><span data-stu-id="5bd64-209">This gets more and more difficult as the number of files and subfolders in each folder grows, resulting in a great deal of scrolling through Solution Explorer.</span></span> <span data-ttu-id="5bd64-210">Per risolvere questo problema consiste nell'organizzare il codice dell'applicazione da *funzionalità* anziché mediante il tipo di file.</span><span class="sxs-lookup"><span data-stu-id="5bd64-210">One solution to this problem is to organize application code by *feature* instead of by file type.</span></span> <span data-ttu-id="5bd64-211">Questo stile azienda viene generalmente indicato come cartelle delle funzionalità o sezioni di funzionalità (vedere anche: [sezioni verticale](http://deviq.com/vertical-slices/)).</span><span class="sxs-lookup"><span data-stu-id="5bd64-211">This organizational style is typically referred to as feature folders or feature slices (see also: [Vertical Slices](http://deviq.com/vertical-slices/)).</span></span>

<span data-ttu-id="5bd64-212">Componenti di base di ASP.NET MVC supporta aree a questo scopo.</span><span class="sxs-lookup"><span data-stu-id="5bd64-212">ASP.NET Core MVC supports Areas for this purpose.</span></span> <span data-ttu-id="5bd64-213">Utilizzo delle aree, è possibile creare set distinti di controller e visualizzazioni cartelle (nonché tutti i modelli associati) in ogni cartella di Area.</span><span class="sxs-lookup"><span data-stu-id="5bd64-213">Using areas, you can create separate sets of Controllers and Views folders (as well as any associated models) in each Area folder.</span></span> <span data-ttu-id="5bd64-214">Figura 7-1 mostra una struttura di cartelle di esempio, utilizzando le aree.</span><span class="sxs-lookup"><span data-stu-id="5bd64-214">Figure 7-1 shows an example folder structure, using Areas.</span></span>

![](./media/image7-1.png)

<span data-ttu-id="5bd64-215">Organizzazione di Area di esempio nella figura 7-1</span><span class="sxs-lookup"><span data-stu-id="5bd64-215">Figure 7-1 Sample Area Organization</span></span>

<span data-ttu-id="5bd64-216">Quando si usano le aree, è necessario utilizzare gli attributi per decorare i controller con il nome dell'area a cui appartengono:</span><span class="sxs-lookup"><span data-stu-id="5bd64-216">When using Areas, you must use attributes to decorate your controllers with the name of the area to which they belong:</span></span>

```csharp
[Area("Catalog")]
public class HomeController
{}
```

<span data-ttu-id="5bd64-217">È inoltre necessario aggiungere il supporto di area per la route:</span><span class="sxs-lookup"><span data-stu-id="5bd64-217">You also need to add area support to your routes:</span></span>

```csharp
app.UseMvc(routes =>
{
    // Areas support
    routes.MapRoute(
    name: "areaRoute",
    template: "{area:exists}/{controller=Home}/{action=Index}/{id?}");
    routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
});
```

<span data-ttu-id="5bd64-218">Oltre al supporto incorporato per le aree, è possibile utilizzare la propria struttura di cartelle e le convenzioni al posto di attributi e le route personalizzate.</span><span class="sxs-lookup"><span data-stu-id="5bd64-218">In addition to the built-in support for Areas, you can also use your own folder structure, and conventions in place of attributes and custom routes.</span></span> <span data-ttu-id="5bd64-219">Ciò consentirebbe a cartelle di funzionalità che non includono cartelle separate per le visualizzazioni, controller e così via, mantenendo più piana della gerarchia e rendendo più semplice visualizzare che tutti i relativi file in un'unica posizione per ogni funzionalità.</span><span class="sxs-lookup"><span data-stu-id="5bd64-219">This would allow you to have feature folders that didn't include separate folders for Views, Controllers, etc., keeping the hierarchy flatter and making it easier to see all related files in a single place for each feature.</span></span>

<span data-ttu-id="5bd64-220">ASP.NET Core utilizza tipi incorporati convenzione per controllarne il comportamento.</span><span class="sxs-lookup"><span data-stu-id="5bd64-220">ASP.NET Core uses built-in convention types to control its behavior.</span></span> <span data-ttu-id="5bd64-221">È possibile modificare o sostituire queste convenzioni.</span><span class="sxs-lookup"><span data-stu-id="5bd64-221">You can modify or replace these conventions.</span></span> <span data-ttu-id="5bd64-222">Ad esempio, è possibile creare una convenzione che verrà assegnato automaticamente il nome della funzionalità per un controller specifico in base al relativo spazio dei nomi (che in genere è correlato alla cartella in cui si trova il controller):</span><span class="sxs-lookup"><span data-stu-id="5bd64-222">For example, you can create a convention that will automatically get the feature name for a given controller based on its namespace (which typically correlates to the folder in which the controller is located):</span></span>

```csharp
FeatureConvention : IControllerModelConvention
{
    public void Apply(ControllerModel controller)
    {
        controller.Properties.Add("feature",
        GetFeatureName(controller.ControllerType));
    }

    private string GetFeatureName(TypeInfo controllerType)
    {
        string[] tokens = controllerType.FullName.Split('.');
        if (!tokens.Any(t => t == "Features")) return "";
        string featureName = tokens
        .SkipWhile(t => !t.Equals("features",
        StringComparison.CurrentCultureIgnoreCase))
        .Skip(1)
        .Take(1)
        .FirstOrDefault();
        return featureName;
    }
}
```

<span data-ttu-id="5bd64-223">Specificare quindi questa convenzione come opzione quando si aggiunge il supporto per MVC per l'applicazione in ConfigureServices:</span><span class="sxs-lookup"><span data-stu-id="5bd64-223">You then specify this convention as an option when you add support for MVC to your application in ConfigureServices:</span></span>

```csharp
services.AddMvc(o => o.Conventions.Add(new FeatureConvention()));
```

<span data-ttu-id="5bd64-224">Componenti di base di ASP.NET MVC utilizza anche una convenzione di trovare le viste.</span><span class="sxs-lookup"><span data-stu-id="5bd64-224">ASP.NET Core MVC also uses a convention to locate views.</span></span> <span data-ttu-id="5bd64-225">È possibile eseguirne l'override con una convenzione personalizzata in modo che le visualizzazioni si trovino nelle cartelle di funzionalità (utilizzando il nome della funzionalità fornito da FeatureConvention, sopra).</span><span class="sxs-lookup"><span data-stu-id="5bd64-225">You can override it with a custom convention so that views will be located in your feature folders (using the feature name provided by the FeatureConvention, above).</span></span> <span data-ttu-id="5bd64-226">È possibile approfondire la conoscenza di questo approccio e scaricare un esempio reale dall'articolo MSDN, [gli intervalli di funzionalità per ASP.NET MVC Core](https://msdn.microsoft.com/magazine/mt763233.aspx).</span><span class="sxs-lookup"><span data-stu-id="5bd64-226">You can learn more about this approach and download a working sample from the MSDN article, [Feature Slices for ASP.NET Core MVC](https://msdn.microsoft.com/magazine/mt763233.aspx).</span></span>

### <a name="cross-cutting-concerns"></a><span data-ttu-id="5bd64-227">Problemi di montaggio incrociato</span><span class="sxs-lookup"><span data-stu-id="5bd64-227">Cross-Cutting Concerns</span></span>

<span data-ttu-id="5bd64-228">Applicazioni di aumento delle dimensioni, diventa sempre più importante tenere in considerazione le problematiche a montaggio incrociato per eliminare i duplicati e mantenere la coerenza.</span><span class="sxs-lookup"><span data-stu-id="5bd64-228">As applications grow, it becomes increasingly important to factor out cross-cutting concerns to eliminate duplication and maintain consistency.</span></span> <span data-ttu-id="5bd64-229">Alcuni esempi di problemi di montaggio incrociato nelle applicazioni ASP.NET Core sono l'autenticazione, le regole di convalida del modello, la memorizzazione nella cache di output e gestione degli errori, anche se esistono molti altri.</span><span class="sxs-lookup"><span data-stu-id="5bd64-229">Some examples of cross-cutting concerns in ASP.NET Core applications are authentication, model validation rules, output caching, and error handling, though there are many others.</span></span> <span data-ttu-id="5bd64-230">Componenti di base di ASP.NET MVC [filtri](https://docs.microsoft.com/aspnet/core/mvc/controllers/filters) consentono di eseguire codice prima o dopo alcuni passaggi nella pipeline di elaborazione della richiesta.</span><span class="sxs-lookup"><span data-stu-id="5bd64-230">ASP.NET Core MVC [filters](https://docs.microsoft.com/aspnet/core/mvc/controllers/filters) allow you to run code before or after certain steps in the request processing pipeline.</span></span> <span data-ttu-id="5bd64-231">Ad esempio, un filtro è possibile eseguire prima e dopo l'associazione di modelli, prima e dopo un'azione, o prima e dopo il risultato di un'azione.</span><span class="sxs-lookup"><span data-stu-id="5bd64-231">For instance, a filter can run before and after model binding, before and after an action, or before and after an action's result.</span></span> <span data-ttu-id="5bd64-232">È inoltre possibile utilizzare un filtro di autorizzazione per controllare l'accesso al resto della pipeline.</span><span class="sxs-lookup"><span data-stu-id="5bd64-232">You can also use an authorization filter to control access to the rest of the pipeline.</span></span> <span data-ttu-id="5bd64-233">Viene illustrato nelle figure 7-2 richiesta come flussi di esecuzione tramite i filtri, se configurato.</span><span class="sxs-lookup"><span data-stu-id="5bd64-233">Figures 7-2 shows how request execution flows through filters, if configured.</span></span>

![La richiesta viene elaborata tramite filtri di autorizzazione, filtri delle risorse, associazione di modelli, filtri azione, esecuzione azione e azione di conversione di risultati, i filtri eccezioni, filtri dei risultati e risultati esecuzione.](./media/image7-2.png)

<span data-ttu-id="5bd64-236">Figura 7-2 l'esecuzione della richiesta tramite pipeline di richieste e di filtri.</span><span class="sxs-lookup"><span data-stu-id="5bd64-236">Figure 7-2 Request execution through filters and request pipeline.</span></span>

<span data-ttu-id="5bd64-237">I filtri vengono in genere implementati come attributi, pertanto è possibile applicare azioni o controller.</span><span class="sxs-lookup"><span data-stu-id="5bd64-237">Filters are usually implemented as attributes, so you can apply them controllers or actions.</span></span> <span data-ttu-id="5bd64-238">Quando aggiunta in questo modo, i filtri specificati all'override del livello di azione o di compilazione al momento i filtri specificati a livello di controller, che a loro volta eseguire l'override di filtri globali.</span><span class="sxs-lookup"><span data-stu-id="5bd64-238">When added in this fashion, filters specified at the action level override or build upon filters specified at the controller level, which themselves override global filters.</span></span> <span data-ttu-id="5bd64-239">Ad esempio, il \[Route\] attributo può essere utilizzato per creare le route tra i controller e azioni.</span><span class="sxs-lookup"><span data-stu-id="5bd64-239">For example, the \[Route\] attribute can be used to build up routes between controllers and actions.</span></span> <span data-ttu-id="5bd64-240">Analogamente, autorizzazione può essere configurata a livello di controller e sottoposta a override da singole azioni, come illustrato nell'esempio seguente:</span><span class="sxs-lookup"><span data-stu-id="5bd64-240">Likewise, authorization can be configured at the controller level, and then overridden by individual actions, as the following sample demonstrates:</span></span>

```csharp
[Authorize]
public class AccountController : Controller

{
    [AllowAnonymous]
    public async Task<IActionResult> Login() {}
    public async Task<IActionResult> ForgotPassword() {}
}
```

<span data-ttu-id="5bd64-241">Il primo metodo, l'account di accesso, utilizza il filtro di AllowAnonymous (attributo) per eseguire l'override di filtro autorizza impostato a livello di controller.</span><span class="sxs-lookup"><span data-stu-id="5bd64-241">The first method, Login, uses the AllowAnonymous filter (attribute) to override the Authorize filter set at the controller level.</span></span> <span data-ttu-id="5bd64-242">L'azione ForgotPassword (e qualsiasi altra azione nella classe che non dispone di un attributo AllowAnonymous) richiederà una richiesta autenticata.</span><span class="sxs-lookup"><span data-stu-id="5bd64-242">The ForgotPassword action (and any other action in the class that doesn't have an AllowAnonymous attribute) will require an authenticated request.</span></span>

<span data-ttu-id="5bd64-243">Per eliminare i duplicati nel modulo comuni di gestione degli errori criteri per le API, è possono utilizzare i filtri.</span><span class="sxs-lookup"><span data-stu-id="5bd64-243">Filters can be used to eliminate duplication in the form of common error handling policies for APIs.</span></span> <span data-ttu-id="5bd64-244">Ad esempio, un criterio di API tipico è per restituire una risposta non trovato per le richieste che fanno riferimento a chiavi che non esistono e una risposta richiesta non valida se si verifica un errore di convalida del modello.</span><span class="sxs-lookup"><span data-stu-id="5bd64-244">For example, a typical API policy is to return a NotFound response to requests referencing keys that do not exist, and a BadRequest response if model validation fails.</span></span> <span data-ttu-id="5bd64-245">L'esempio seguente illustra queste due criteri in azione:</span><span class="sxs-lookup"><span data-stu-id="5bd64-245">The following example demonstrates these two policies in action:</span></span>

```csharp
[HttpPut("{id}")]
public async Task<IActionResult> Put(int id, [FromBody]Author author)
{
    if ((await _authorRepository.ListAsync()).All(a => a.Id != id))
    {
        return NotFound(id);
    }
    if (!ModelState.IsValid)
    {
        return BadRequest(ModelState);
    }
    author.Id = id;
    await _authorRepository.UpdateAsync(author);
    return Ok();
}
```

<span data-ttu-id="5bd64-246">Non consentire i metodi di azione accumularsi condizionale codice simile al seguente.</span><span class="sxs-lookup"><span data-stu-id="5bd64-246">Don't allow your action methods to become cluttered with conditional code like this.</span></span> <span data-ttu-id="5bd64-247">In alternativa, estrarre i criteri in filtri che possono essere applicati in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="5bd64-247">Instead, pull the policies into filters that can be applied on an as-needed basis.</span></span> <span data-ttu-id="5bd64-248">In questo esempio, il controllo di convalida del modello, deve verificarsi ogni volta che viene inviato un comando all'API, può essere sostituito dall'attributo seguente:</span><span class="sxs-lookup"><span data-stu-id="5bd64-248">In this example, the model validation check, which should occur any time a command is sent to the API, can be replaced by the following attribute:</span></span>

```csharp
public class ValidateModelAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext context)
    {
        if (!context.ModelState.IsValid)
        {
            context.Result = new BadRequestObjectResult(context.ModelState);
        }
    }
}
```

<span data-ttu-id="5bd64-249">Analogamente, un filtro consente di verificare se un record di restituire un errore 404 prima che l'azione viene eseguita, eliminando la necessità di eseguire questi controlli nell'azione.</span><span class="sxs-lookup"><span data-stu-id="5bd64-249">Likewise, a filter can be used to check if a record exists and return a 404 before the action is executed, eliminating the need to perform these checks in the action.</span></span> <span data-ttu-id="5bd64-250">Dopo avere estratta convenzioni comuni e organizzati la soluzione di separare la logica di business e di codice di infrastruttura dall'interfaccia utente, i metodi di azione MVC devono essere estremamente sottili:</span><span class="sxs-lookup"><span data-stu-id="5bd64-250">Once you've pulled out common conventions and organized your solution to separate infrastructure code and business logic from your UI, your MVC action methods should be extremely thin:</span></span>

```csharp
// PUT api/authors/2/5
[HttpPut("{id}")]
[ValidateAuthorExists]
public async Task<IActionResult> Put(int id, [FromBody]Author author)
{
    await _authorRepository.UpdateAsync(author);
    return Ok();
}
```

<span data-ttu-id="5bd64-251">È possibile leggere informazioni circa l'implementazione di filtri e scaricare un esempio reale dall'articolo MSDN, [reale World ASP.NET Core MVC filtri](https://msdn.microsoft.com/magazine/mt767699.aspx).</span><span class="sxs-lookup"><span data-stu-id="5bd64-251">You can read more about implementing filters and download a working sample from the MSDN article, [Real World ASP.NET Core MVC Filters](https://msdn.microsoft.com/magazine/mt767699.aspx).</span></span>

> ### <a name="references--structuring-applications"></a><span data-ttu-id="5bd64-252">Riferimenti: strutturare applicazioni</span><span class="sxs-lookup"><span data-stu-id="5bd64-252">References – Structuring Applications</span></span>
> - <span data-ttu-id="5bd64-253">**Aree**</span><span class="sxs-lookup"><span data-stu-id="5bd64-253">**Areas**</span></span>  
> <span data-ttu-id="5bd64-254"><https://docs.microsoft.com/ASPNET/core/MVC/Controllers/Areas></span><span class="sxs-lookup"><span data-stu-id="5bd64-254"><https://docs.microsoft.com/aspnet/core/mvc/controllers/areas></span></span>
> - <span data-ttu-id="5bd64-255">**MSDN: gli intervalli di funzionalità per i componenti di base di ASP.NET MVC**
>  <https://msdn.microsoft.com/magazine/mt763233.aspx></span><span class="sxs-lookup"><span data-stu-id="5bd64-255">**MSDN – Feature Slices for ASP.NET Core MVC**
<https://msdn.microsoft.com/magazine/mt763233.aspx></span></span>
> - <span data-ttu-id="5bd64-256">**Filtri**</span><span class="sxs-lookup"><span data-stu-id="5bd64-256">**Filters**</span></span>  
> <span data-ttu-id="5bd64-257"><https://docs.microsoft.com/ASPNET/core/MVC/Controllers/Filters></span><span class="sxs-lookup"><span data-stu-id="5bd64-257"><https://docs.microsoft.com/aspnet/core/mvc/controllers/filters></span></span>
> - <span data-ttu-id="5bd64-258">**MSDN-filtri MVC ASP.NET Core mondo reale**</span><span class="sxs-lookup"><span data-stu-id="5bd64-258">**MSDN – Real World ASP.NET Core MVC Filters**</span></span>  
> <span data-ttu-id="5bd64-259"><https://msdn.microsoft.com/magazine/mt767699.aspx></span><span class="sxs-lookup"><span data-stu-id="5bd64-259"><https://msdn.microsoft.com/magazine/mt767699.aspx></span></span>

## <a name="security"></a><span data-ttu-id="5bd64-260">Sicurezza</span><span class="sxs-lookup"><span data-stu-id="5bd64-260">Security</span></span>

<span data-ttu-id="5bd64-261">Protezione delle applicazioni web è un argomento di grandi dimensioni, con in considerazione numerosi fattori.</span><span class="sxs-lookup"><span data-stu-id="5bd64-261">Securing web applications is a large topic, with many considerations.</span></span> <span data-ttu-id="5bd64-262">Al livello più elementare di protezione prevede che sapere chi provenienti da una determinata richiesta e quindi garantire che la richiesta ha accesso solo a risorse che dovrebbe essere.</span><span class="sxs-lookup"><span data-stu-id="5bd64-262">At its most basic level, security involves ensuring you know who a given request is coming from, and then ensuring that that request only has access to resources it should.</span></span> <span data-ttu-id="5bd64-263">L'autenticazione è il processo di confronto tra le credenziali fornite con una richiesta a quelli di un archivio dati attendibile, per vedere se la richiesta deve essere trattata come proveniente da un'entità nota.</span><span class="sxs-lookup"><span data-stu-id="5bd64-263">Authentication is the process of comparing credentials provided with a request to those in a trusted data store, to see if the request should be treated as coming from a known entity.</span></span> <span data-ttu-id="5bd64-264">L'autorizzazione è il processo di limitare l'accesso a determinate risorse in base all'identità utente.</span><span class="sxs-lookup"><span data-stu-id="5bd64-264">Authorization is the process of restricting access to certain resources based on user identity.</span></span> <span data-ttu-id="5bd64-265">Problemi di sicurezza terzo protegge le richieste di intercettazione di terze parti, per cui è necessario almeno [assicurarsi che SSL viene utilizzato dall'applicazione](https://docs.microsoft.com/aspnet/core/security/enforcing-ssl).</span><span class="sxs-lookup"><span data-stu-id="5bd64-265">A third security concern is protecting requests from eavesdropping by third parties, for which you should at least [ensure that SSL is used by your application](https://docs.microsoft.com/aspnet/core/security/enforcing-ssl).</span></span>

### <a name="authentication"></a><span data-ttu-id="5bd64-266">Autenticazione</span><span class="sxs-lookup"><span data-stu-id="5bd64-266">Authentication</span></span>

<span data-ttu-id="5bd64-267">Identità di ASP.NET Core è un sistema di appartenenze, che è possibile utilizzare per supportare la funzionalità di accesso per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="5bd64-267">ASP.NET Core Identity is a membership system you can use to support login functionality for your application.</span></span> <span data-ttu-id="5bd64-268">Include supporto per gli account utente locale oltre al supporto di provider di accesso esterno dal provider come Account Microsoft, Twitter, Facebook, Google e altro ancora.</span><span class="sxs-lookup"><span data-stu-id="5bd64-268">It has support for local user accounts as well as external login provider support from providers like Microsoft Account, Twitter, Facebook, Google, and more.</span></span> <span data-ttu-id="5bd64-269">Oltre a ASP.NET Identity Core, è possibile utilizzare l'autenticazione di windows o un provider di identità di terze parti come [Identity Server](https://github.com/IdentityServer/IdentityServer4).</span><span class="sxs-lookup"><span data-stu-id="5bd64-269">In addition to ASP.NET Core Identity, your application can use windows authentication, or a third-party identity provider like [Identity Server](https://github.com/IdentityServer/IdentityServer4).</span></span>

<span data-ttu-id="5bd64-270">Identità di ASP.NET Core è incluso in nuovi modelli di progetto se è selezionata l'opzione di account utente.</span><span class="sxs-lookup"><span data-stu-id="5bd64-270">ASP.NET Core Identity is included in new project templates if the Individual User Accounts option is selected.</span></span> <span data-ttu-id="5bd64-271">Questo modello include il supporto per la registrazione, account di accesso, account di accesso esterni, password dimenticate e funzionalità aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="5bd64-271">This template includes support for registration, login, external logins, forgotten passwords, and additional functionality.</span></span>

![](./media/image7-3.png)

<span data-ttu-id="5bd64-272">Figura 7-3 selezionare singoli account utente di disporre di identità preconfigurato.</span><span class="sxs-lookup"><span data-stu-id="5bd64-272">Figure 7-3 Select Individual User Accounts to have Identity preconfigured.</span></span>

<span data-ttu-id="5bd64-273">Nella finestra di avvio, sia in ConfigureServices e configura viene configurato il supporto di identità:</span><span class="sxs-lookup"><span data-stu-id="5bd64-273">Identity support is configured in Startup, both in ConfigureServices and Configure:</span></span>

```csharp
public void ConfigureServices(IServiceCollection services)
{
    // Add framework services.
    services.AddDbContext<ApplicationDbContext>(options =>
    options.UseSqlServer(Configuration.GetConnectionString("DefaultConnection")));
    services.AddIdentity<ApplicationUser, IdentityRole>()
    .AddEntityFrameworkStores<ApplicationDbContext>()
    .AddDefaultTokenProviders();
    services.AddMvc();
}

public void Configure(IApplicationBuilder app)
{
    app.UseStaticFiles();
    app.UseIdentity();
    app.UseMvc(routes =>
    {
        routes.MapRoute(
        name: "default",
        template: "{controller=Home}/{action=Index}/{id?}");
    });
}
```

<span data-ttu-id="5bd64-274">È importante che UseIdentity precedere UseMvc nel metodo di configurazione.</span><span class="sxs-lookup"><span data-stu-id="5bd64-274">It's important that UseIdentity appear before UseMvc in the Configure method.</span></span> <span data-ttu-id="5bd64-275">Quando si configura l'identità in ConfigureServices, si noterà una chiamata a AddDefaultTokenProviders.</span><span class="sxs-lookup"><span data-stu-id="5bd64-275">When configuring Identity in ConfigureServices, you'll notice a call to AddDefaultTokenProviders.</span></span> <span data-ttu-id="5bd64-276">Questo non ha nulla a che fare con i token che possono essere utilizzati per proteggere le comunicazioni web, ma invece fa riferimento ai provider di creazione di richieste che possono essere inviate agli utenti tramite SMS o posta elettronica per consentire di confermare la propria identità.</span><span class="sxs-lookup"><span data-stu-id="5bd64-276">This has nothing to do with tokens that may be used to secure web communications, but instead refers to providers that create prompts that can be sent to users via SMS or email in order for them to confirm their identity.</span></span>

<span data-ttu-id="5bd64-277">Altre informazioni, vedere [la configurazione dell'autenticazione a due fattori](https://docs.microsoft.com/aspnet/core/security/authentication/2fa) e [abilitazione di provider di accesso esterno](https://docs.microsoft.com/aspnet/core/security/authentication/social/) dalla documentazione ufficiale ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="5bd64-277">You can learn more about [configuring two-factor authentication](https://docs.microsoft.com/aspnet/core/security/authentication/2fa) and [enabling external login providers](https://docs.microsoft.com/aspnet/core/security/authentication/social/) from the official ASP.NET Core docs.</span></span>

### <a name="authorization"></a><span data-ttu-id="5bd64-278">Autorizzazione</span><span class="sxs-lookup"><span data-stu-id="5bd64-278">Authorization</span></span>

<span data-ttu-id="5bd64-279">La forma più semplice di autorizzazione è necessario limitare l'accesso a utenti anonimi.</span><span class="sxs-lookup"><span data-stu-id="5bd64-279">The simplest form of authorization involves restricting access to anonymous users.</span></span> <span data-ttu-id="5bd64-280">Questo può essere ottenuto applicando semplicemente il \[Authorize\] attributo determinati controller o azioni.</span><span class="sxs-lookup"><span data-stu-id="5bd64-280">This can be achieved by simply applying the \[Authorize\] attribute to certain controllers or actions.</span></span> <span data-ttu-id="5bd64-281">Se vengono utilizzati i ruoli, l'attributo può essere esteso ulteriormente per limitare l'accesso agli utenti che appartengono a determinati ruoli, come illustrato:</span><span class="sxs-lookup"><span data-stu-id="5bd64-281">If roles are being used, the attribute can be further extended to restrict access to users who belong to certain roles, as shown:</span></span>

```csharp
[Authorize(Roles = "HRManager,Finance")]
public class SalaryController : Controller
{

}
```

<span data-ttu-id="5bd64-282">In questo caso, gli utenti che appartengono ai ruoli HRManager o Finance (oppure entrambe) deve disporre dell'accesso per il SalaryController.</span><span class="sxs-lookup"><span data-stu-id="5bd64-282">In this case, users belonging to either the HRManager or Finance roles (or both) would have access to the SalaryController.</span></span> <span data-ttu-id="5bd64-283">Per richiedere che un utente appartiene a più ruoli (non solo uno di diversi), è possibile applicare l'attributo più volte, specificando un ruolo necessario ogni ora.</span><span class="sxs-lookup"><span data-stu-id="5bd64-283">To require that a user belong to multiple roles (not just one of several), you can apply the attribute multiple times, specifying a required role each time.</span></span>

<span data-ttu-id="5bd64-284">Specificare alcuni set di ruoli come stringhe in numerosi diversi controller e azioni possono causare la ripetizione indesiderata.</span><span class="sxs-lookup"><span data-stu-id="5bd64-284">Specifying certain sets of roles as strings in many different controllers and actions can lead to undesirable repetition.</span></span> <span data-ttu-id="5bd64-285">È possibile configurare criteri di autorizzazione, che incapsulano le regole di autorizzazione, e quindi specificare i criteri anziché singoli ruoli quando si applica il \[Authorize\] attributo:</span><span class="sxs-lookup"><span data-stu-id="5bd64-285">You can configure authorization policies, which encapsulate authorization rules, and then specify the policy instead of individual roles when applying the \[Authorize\] attribute:</span></span>

```csharp
[Authorize(Policy = "CanViewPrivateReport")]
public IActionResult ExecutiveSalaryReport()
{
    return View();
}
```

<span data-ttu-id="5bd64-286">Usando i criteri in questo modo, è possibile separare i tipi di azioni vengano limitate dal ruoli specifici o regole da applicare a esso.</span><span class="sxs-lookup"><span data-stu-id="5bd64-286">Using policies in this way, you can separate the kinds of actions being restricted from the specific roles or rules that apply to it.</span></span> <span data-ttu-id="5bd64-287">In un secondo momento, se si crea un nuovo ruolo che deve avere accesso a determinate risorse, è possibile aggiornare solo un criterio, anziché aggiornare ogni elenco di ruoli in ogni \[Authorize\] attributo.</span><span class="sxs-lookup"><span data-stu-id="5bd64-287">Later, if you create a new role that needs to have access to certain resources, you can just update a policy, rather than updating every list of roles on every \[Authorize\] attribute.</span></span>

#### <a name="claims"></a><span data-ttu-id="5bd64-288">Attestazioni</span><span class="sxs-lookup"><span data-stu-id="5bd64-288">Claims</span></span>

<span data-ttu-id="5bd64-289">Le attestazioni sono coppie nome / valore che rappresentano le proprietà di un utente autenticato.</span><span class="sxs-lookup"><span data-stu-id="5bd64-289">Claims are name value pairs that represent properties of an authenticated user.</span></span> <span data-ttu-id="5bd64-290">Ad esempio, è possibile archiviare il numero di dipendenti degli utenti come attestazione.</span><span class="sxs-lookup"><span data-stu-id="5bd64-290">For example, you might store users' employee number as a claim.</span></span> <span data-ttu-id="5bd64-291">Attestazioni possono quindi essere utilizzate come parte di criteri di autorizzazione.</span><span class="sxs-lookup"><span data-stu-id="5bd64-291">Claims can then be used as part of authorization policies.</span></span> <span data-ttu-id="5bd64-292">È possibile creare un criterio denominato "EmployeeOnly" che richiede l'esistenza di un'attestazione denominata "EmployeeNumber", come illustrato in questo esempio:</span><span class="sxs-lookup"><span data-stu-id="5bd64-292">You could create a policy called "EmployeeOnly" that requires the existence of a claim called "EmployeeNumber", as shown in this example:</span></span>

```csharp
public void ConfigureServices(IServiceCollection services)
{
    services.AddMvc();
    services.AddAuthorization(options =>
    {
        options.AddPolicy("EmployeeOnly", policy => policy.RequireClaim("EmployeeNumber"));
    });
}
```

<span data-ttu-id="5bd64-293">Questo criterio può essere utilizzato con la \[Authorize\] attributo per proteggere qualsiasi controller e/o l'azione, come descritto in precedenza.</span><span class="sxs-lookup"><span data-stu-id="5bd64-293">This policy could then be used with the \[Authorize\] attribute to protect any controller and/or action, as described above.</span></span>

#### <a name="securing-web-apis"></a><span data-ttu-id="5bd64-294">Protezione delle API Web</span><span class="sxs-lookup"><span data-stu-id="5bd64-294">Securing Web APIs</span></span>

<span data-ttu-id="5bd64-295">La maggior parte dei web API deve implementare un sistema di autenticazione basata su token.</span><span class="sxs-lookup"><span data-stu-id="5bd64-295">Most web APIs should implement a token-based authentication system.</span></span> <span data-ttu-id="5bd64-296">L'autenticazione del token è progettato per essere scalabile e senza stato.</span><span class="sxs-lookup"><span data-stu-id="5bd64-296">Token authentication is stateless and designed to be scalable.</span></span> <span data-ttu-id="5bd64-297">In un sistema basato su token di autenticazione, il client deve prima autenticarsi con il provider di autenticazione.</span><span class="sxs-lookup"><span data-stu-id="5bd64-297">In a token-based authentication system, the client must first authenticate with the authentication provider.</span></span> <span data-ttu-id="5bd64-298">Se ha esito positivo, il client ha emesso un token, che è semplicemente una stringa significativa crittograficamente di caratteri.</span><span class="sxs-lookup"><span data-stu-id="5bd64-298">If successful, the client is issued a token, which is simply a cryptographically meaningful string of characters.</span></span> <span data-ttu-id="5bd64-299">Quando il client deve quindi eseguire una richiesta a un'API, questo token viene aggiunto un'intestazione nella richiesta.</span><span class="sxs-lookup"><span data-stu-id="5bd64-299">When the client then needs to issue a request to an API, it adds this token as a header on the request.</span></span> <span data-ttu-id="5bd64-300">Il server di convalida quindi il token nell'intestazione della richiesta prima di completare la richiesta.</span><span class="sxs-lookup"><span data-stu-id="5bd64-300">The server then validates the token found in the request header before completing the request.</span></span> <span data-ttu-id="5bd64-301">Figura 7-4 viene illustrato questo processo.</span><span class="sxs-lookup"><span data-stu-id="5bd64-301">Figure 7-4 demonstrates this process.</span></span>

![TokenAuth](./media/image7-4.png)

<span data-ttu-id="5bd64-303">**Figura 7-4.**</span><span class="sxs-lookup"><span data-stu-id="5bd64-303">**Figure 7-4.**</span></span> <span data-ttu-id="5bd64-304">Autenticazione basata su token per le API Web.</span><span class="sxs-lookup"><span data-stu-id="5bd64-304">Token-based authentication for Web APIs.</span></span>

> ### <a name="references--security"></a><span data-ttu-id="5bd64-305">Riferimenti: sicurezza</span><span class="sxs-lookup"><span data-stu-id="5bd64-305">References – Security</span></span>
> - <span data-ttu-id="5bd64-306">**Panoramica della sicurezza documenti**</span><span class="sxs-lookup"><span data-stu-id="5bd64-306">**Security Docs Overview**</span></span>  
> <span data-ttu-id="5bd64-307">https://docs.microsoft.com/ASPNET/Core/Security/</span><span class="sxs-lookup"><span data-stu-id="5bd64-307">https://docs.microsoft.com/aspnet/core/security/</span></span>
> - <span data-ttu-id="5bd64-308">**Applicazione di SSL in un'applicazione ASP.NET di base**</span><span class="sxs-lookup"><span data-stu-id="5bd64-308">**Enforcing SSL in an ASP.NET Core App**</span></span>  
> <span data-ttu-id="5bd64-309"><https://docs.microsoft.com/ASPNET/Core/Security/Enforcing-SSL></span><span class="sxs-lookup"><span data-stu-id="5bd64-309"><https://docs.microsoft.com/aspnet/core/security/enforcing-ssl></span></span>
> - <span data-ttu-id="5bd64-310">**Introduzione a Identity**</span><span class="sxs-lookup"><span data-stu-id="5bd64-310">**Introduction to Identity**</span></span>  
> <span data-ttu-id="5bd64-311"><https://docs.microsoft.com/ASPNET/Core/Security/Authentication/Identity></span><span class="sxs-lookup"><span data-stu-id="5bd64-311"><https://docs.microsoft.com/aspnet/core/security/authentication/identity></span></span>
> - <span data-ttu-id="5bd64-312">**Introduzione alle autorizzazioni**</span><span class="sxs-lookup"><span data-stu-id="5bd64-312">**Introduction to Authorization**</span></span>  
> <span data-ttu-id="5bd64-313"><https://docs.microsoft.com/ASPNET/Core/Security/Authorization/Introduction></span><span class="sxs-lookup"><span data-stu-id="5bd64-313"><https://docs.microsoft.com/aspnet/core/security/authorization/introduction></span></span>
> - <span data-ttu-id="5bd64-314">**Autenticazione e autorizzazione per App per le API nel servizio App di Azure**</span><span class="sxs-lookup"><span data-stu-id="5bd64-314">**Authentication and Authorization for API Apps in Azure App Service**</span></span>  
> <span data-ttu-id="5bd64-315"><https://docs.microsoft.com/Azure/App-Service-API/App-Service-API-Authentication></span><span class="sxs-lookup"><span data-stu-id="5bd64-315"><https://docs.microsoft.com/azure/app-service-api/app-service-api-authentication></span></span>

## <a name="client-communication"></a><span data-ttu-id="5bd64-316">Comunicazione client</span><span class="sxs-lookup"><span data-stu-id="5bd64-316">Client Communication</span></span>

<span data-ttu-id="5bd64-317">Oltre a servire le pagine e risponde alle richieste di dati tramite l'API web, le applicazioni ASP.NET Core possono comunicare direttamente con i client connessi.</span><span class="sxs-lookup"><span data-stu-id="5bd64-317">In addition to serving pages and responding to requests for data via web APIs, ASP.NET Core apps can communicate directly with connected clients.</span></span> <span data-ttu-id="5bd64-318">Le comunicazioni in uscita è possono utilizzare un'ampia gamma di tecnologie di trasporto, l'oggetto da più comune di WebSocket.</span><span class="sxs-lookup"><span data-stu-id="5bd64-318">This outbound communication can use a variety of transport technologies, the most common being WebSockets.</span></span> <span data-ttu-id="5bd64-319">Componenti di base di ASP.NET SignalR è una libreria che semplifica il tipo di funzionalità di comunicazione client-server in tempo reale alle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="5bd64-319">ASP.NET Core SignalR is a library that makes it simple to kind of real-time server-to-client communication functionality to your applications.</span></span> <span data-ttu-id="5bd64-320">SignalR supporta un'ampia gamma di tecnologie di trasporto, incluse WebSocket e astrae stoccaggi molti dettagli dell'implementazione da parte dello sviluppatore.</span><span class="sxs-lookup"><span data-stu-id="5bd64-320">SignalR supports a variety of transport technologies, including WebSockets, and abstracts away many of the implementation details from the developer.</span></span>

<span data-ttu-id="5bd64-321">Componenti di base di ASP.NET SignalR è attualmente in fase di sviluppo e saranno disponibili nella prossima versione di ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="5bd64-321">ASP.NET Core SignalR is currently under development, and will be available in the next release of ASP.NET Core.</span></span> <span data-ttu-id="5bd64-322">Tuttavia, altri [aprire librerie WebSocket origine](https://github.com/radu-matei/websocket-manager) sono attualmente disponibili.</span><span class="sxs-lookup"><span data-stu-id="5bd64-322">However, other [open source WebSockets libraries](https://github.com/radu-matei/websocket-manager) are currently available.</span></span>

<span data-ttu-id="5bd64-323">Comunicazione client in tempo reale, se tramite WebSockets direttamente o altre tecniche, sono utili per un'ampia gamma di scenari di applicazioni.</span><span class="sxs-lookup"><span data-stu-id="5bd64-323">Real-time client communication, whether using WebSockets directly or other techniques, are useful in a variety of application scenarios.</span></span> <span data-ttu-id="5bd64-324">Di seguito sono riportati alcuni esempi:</span><span class="sxs-lookup"><span data-stu-id="5bd64-324">Some examples include:</span></span>

-   <span data-ttu-id="5bd64-325">Applicazioni di chat in tempo reale</span><span class="sxs-lookup"><span data-stu-id="5bd64-325">Live chat room applications</span></span>

-   <span data-ttu-id="5bd64-326">Monitoraggio delle applicazioni</span><span class="sxs-lookup"><span data-stu-id="5bd64-326">Monitoring applications</span></span>

-   <span data-ttu-id="5bd64-327">Aggiornamenti dello stato di processo</span><span class="sxs-lookup"><span data-stu-id="5bd64-327">Job progress updates</span></span>

-   <span data-ttu-id="5bd64-328">Notifiche</span><span class="sxs-lookup"><span data-stu-id="5bd64-328">Notifications</span></span>

-   <span data-ttu-id="5bd64-329">Applicazioni interattive form</span><span class="sxs-lookup"><span data-stu-id="5bd64-329">Interactive forms applications</span></span>

<span data-ttu-id="5bd64-330">Quando si compila la comunicazione client nelle applicazioni, in genere due componenti sono:</span><span class="sxs-lookup"><span data-stu-id="5bd64-330">When building client communication into your applications, there are typically two components:</span></span>

-   <span data-ttu-id="5bd64-331">Gestione di connessione sul lato server (SignalR Hub, WebSocketManager WebSocketHandler)</span><span class="sxs-lookup"><span data-stu-id="5bd64-331">Server-side connection manager (SignalR Hub, WebSocketManager WebSocketHandler)</span></span>

-   <span data-ttu-id="5bd64-332">Libreria lato client</span><span class="sxs-lookup"><span data-stu-id="5bd64-332">Client-side library</span></span>

<span data-ttu-id="5bd64-333">I client non sono limitati ai browser-App per dispositivi mobili, applicazioni console, e altre App native possono inoltre in grado di comunicare utilizzando/WebSocket SignalR.</span><span class="sxs-lookup"><span data-stu-id="5bd64-333">Clients are not limited to browsers – mobile apps, console apps, and other native apps can also communicate using SignalR/WebSockets.</span></span> <span data-ttu-id="5bd64-334">Il programma semplice seguente restituisce tutto il contenuto inviato a un'applicazione di chat alla console, come parte di un'applicazione di esempio WebSocketManager:</span><span class="sxs-lookup"><span data-stu-id="5bd64-334">The following simple program echoes all content sent to a chat application to the console, as part of a WebSocketManager sample application:</span></span>

```csharp
public class Program
{
    private static Connection _connection;
    public static void Main(string[] args)
    {
        StartConnectionAsync();
        _connection.On("receiveMessage", (arguments) =>;
        {
            Console.WriteLine(\$"{arguments\[0\]} said: {arguments\[1\]}");
        });
        Console.ReadLine();
        StopConnectionAsync();
    }
    
    public static async Task StartConnectionAsync()
    {
        _connection = new Connection();
        await _connection.StartConnectionAsync("ws://localhost:65110/chat");
    }
    
    public static async Task StopConnectionAsync()
    {
        await _connection.StopConnectionAsync();
    }
```

<span data-ttu-id="5bd64-335">Considerare l'esperienza di modi in cui le applicazioni comunicano direttamente con le applicazioni client e considerare se la comunicazione in tempo reale migliorerebbe utente dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="5bd64-335">Consider ways in which your applications communicate directly with client applications, and consider whether real-time communication would improve your app's user experience.</span></span>

> ### <a name="references--client-communication"></a><span data-ttu-id="5bd64-336">Riferimenti: la comunicazione Client</span><span class="sxs-lookup"><span data-stu-id="5bd64-336">References – Client Communication</span></span>
> - <span data-ttu-id="5bd64-337">**Componenti di base di ASP.NET SignalR**</span><span class="sxs-lookup"><span data-stu-id="5bd64-337">**ASP.NET Core SignalR**</span></span>  
> <span data-ttu-id="5bd64-338"><https://github.com/ASPNET/SignalR></span><span class="sxs-lookup"><span data-stu-id="5bd64-338"><https://github.com/aspnet/SignalR></span></span>
> - <span data-ttu-id="5bd64-339">**Gestione di WebSocket**</span><span class="sxs-lookup"><span data-stu-id="5bd64-339">**WebSocket Manager**</span></span>  
> <span data-ttu-id="5bd64-340">https://github.com/Radu-matei/WebSocket-Manager</span><span class="sxs-lookup"><span data-stu-id="5bd64-340">https://github.com/radu-matei/websocket-manager</span></span>

## <a name="domain-driven-design--should-you-apply-it"></a><span data-ttu-id="5bd64-341">Progettazione – basati su dominio deve viene applicato?</span><span class="sxs-lookup"><span data-stu-id="5bd64-341">Domain-Driven Design – Should You Apply It?</span></span>

<span data-ttu-id="5bd64-342">Progettazione basati su dominio (DDD) è un approccio agile per la creazione di software che punta a concentrarsi sul *dominio aziendale*.</span><span class="sxs-lookup"><span data-stu-id="5bd64-342">Domain-Driven Design (DDD) is an agile approach to building software that emphasizes focusing on the *business domain*.</span></span> <span data-ttu-id="5bd64-343">Inserisce l'importanza di comunicazione e l'interazione con expert(s) di dominio di business che può essere correlata per gli sviluppatori di funzionamento del sistema del mondo reale.</span><span class="sxs-lookup"><span data-stu-id="5bd64-343">It places a heavy emphasis on communication and interaction with business domain expert(s) who can relate to the developers how the real-world system works.</span></span> <span data-ttu-id="5bd64-344">Ad esempio, se si sta creando un sistema di transazioni azionarie, l'esperto di dominio potrebbe essere un'esperto broker predefinite.</span><span class="sxs-lookup"><span data-stu-id="5bd64-344">For example, if you're building a system that handles stock trades, your domain expert might be an experienced stock broker.</span></span> <span data-ttu-id="5bd64-345">DDD è progettato per risolvere problemi aziendali complessi e spesso non è appropriato per le applicazioni più piccole e più semplice, come l'investimento della comprensione e modellazione del dominio non è accettabile.</span><span class="sxs-lookup"><span data-stu-id="5bd64-345">DDD is designed to address large, complex business problems, and is often not appropriate for smaller, simpler applications, as the investment in understanding and modeling the domain is not worth it.</span></span>

<span data-ttu-id="5bd64-346">Quando si compila software adotta un approccio DDD, il team (incluso per le persone interessate e i collaboratori) è necessario sviluppare un *linguaggio universale* per lo spazio dei problemi.</span><span class="sxs-lookup"><span data-stu-id="5bd64-346">When building software following a DDD approach, your team (including non-technical stakeholders and contributors) should develop a *ubiquitous language* for the problem space.</span></span> <span data-ttu-id="5bd64-347">Vale a dire la stessa terminologia da utilizzare per il concetto di scenari reali in fase di modellazione, l'equivalente di software e le strutture che potrebbero esistere per mantenere il concetto (ad esempio, le tabelle di database).</span><span class="sxs-lookup"><span data-stu-id="5bd64-347">That is, the same terminology should be used for the real-world concept being modeled, the software equivalent, and any structures that might exist to persist the concept (for example, database tables).</span></span> <span data-ttu-id="5bd64-348">Di conseguenza, i concetti illustrati in linguaggio universale devono costituiscono la base per il *modello di dominio*.</span><span class="sxs-lookup"><span data-stu-id="5bd64-348">Thus, the concepts described in the ubiquitous language should form the basis for your *domain model*.</span></span>

<span data-ttu-id="5bd64-349">Modello di dominio è costituito da oggetti che interagiscono tra loro per rappresentare il comportamento del sistema.</span><span class="sxs-lookup"><span data-stu-id="5bd64-349">Your domain model is comprised of objects that interact with one another to represent the behavior of the system.</span></span> <span data-ttu-id="5bd64-350">Questi oggetti possono rientrano nelle categorie seguenti:</span><span class="sxs-lookup"><span data-stu-id="5bd64-350">These objects may fall into the following categories:</span></span>

-   <span data-ttu-id="5bd64-351">[Entità](http://deviq.com/entity/), che rappresentano gli oggetti con un thread di identità.</span><span class="sxs-lookup"><span data-stu-id="5bd64-351">[Entities](http://deviq.com/entity/), which represent objects with a thread of identity.</span></span> <span data-ttu-id="5bd64-352">Le entità vengono in genere archiviate nella persistenza con una chiave con cui essi possono essere recuperate successivamente.</span><span class="sxs-lookup"><span data-stu-id="5bd64-352">Entities are typically stored in persistence with a key by which they can later be retrieved.</span></span>

-   <span data-ttu-id="5bd64-353">[Funzioni di aggregazione](http://deviq.com/aggregate-pattern/), che rappresentano gruppi di oggetti che devono essere mantenuti come un'unità.</span><span class="sxs-lookup"><span data-stu-id="5bd64-353">[Aggregates](http://deviq.com/aggregate-pattern/), which represent groups of objects that should be persisted as a unit.</span></span>

-   <span data-ttu-id="5bd64-354">[Valore oggetti](http://deviq.com/value-object/), che rappresentano i concetti che possono essere confrontati mediante la somma dei valori delle relative proprietà.</span><span class="sxs-lookup"><span data-stu-id="5bd64-354">[Value objects](http://deviq.com/value-object/), which represent concepts that can be compared on the basis of the sum of their property values.</span></span> <span data-ttu-id="5bd64-355">Ad esempio, DateRange costituito da una data di inizio e di fine.</span><span class="sxs-lookup"><span data-stu-id="5bd64-355">For example, DateRange consisting of a start and end date.</span></span>

-   <span data-ttu-id="5bd64-356">[Eventi del dominio](https://martinfowler.com/eaaDev/DomainEvent.html), che rappresentano operazioni eseguite all'interno del sistema di interesse ad altre parti del sistema.</span><span class="sxs-lookup"><span data-stu-id="5bd64-356">[Domain events](https://martinfowler.com/eaaDev/DomainEvent.html), which represent things happening within the system that are of interest to other parts of the system.</span></span>

<span data-ttu-id="5bd64-357">Si noti che un modello di dominio DDD deve incapsulare un comportamento complesso all'interno del modello.</span><span class="sxs-lookup"><span data-stu-id="5bd64-357">Note that a DDD domain model should encapsulate complex behavior within the model.</span></span> <span data-ttu-id="5bd64-358">Le entità, in particolare, non devono semplicemente essere raccolte di proprietà.</span><span class="sxs-lookup"><span data-stu-id="5bd64-358">Entities, in particular, should not merely be collections of properties.</span></span> <span data-ttu-id="5bd64-359">Quando il modello di dominio non dispone di comportamento e semplicemente rappresenta lo stato del sistema, viene definito un [anemic modello](http://deviq.com/anemic-model/), questo non è auspicabile in DDD.</span><span class="sxs-lookup"><span data-stu-id="5bd64-359">When the domain model lacks behavior and merely represents the state of the system, it is said to be an [anemic model](http://deviq.com/anemic-model/), which is undesirable in DDD.</span></span>

<span data-ttu-id="5bd64-360">Oltre a questi tipi di modello, DDD utilizza in genere un'ampia gamma di modelli:</span><span class="sxs-lookup"><span data-stu-id="5bd64-360">In addition to these model types, DDD typically employs a variety of patterns:</span></span>

-   <span data-ttu-id="5bd64-361">[Repository](http://deviq.com/repository-pattern/), per fornire l'astrazione di dettagli di persistenza.</span><span class="sxs-lookup"><span data-stu-id="5bd64-361">[Repository](http://deviq.com/repository-pattern/), for abstracting persistence details.</span></span>

-   <span data-ttu-id="5bd64-362">[Factory](https://en.wikipedia.org/wiki/Factory_method_pattern), per incapsulare la creazione di oggetti complessi.</span><span class="sxs-lookup"><span data-stu-id="5bd64-362">[Factory](https://en.wikipedia.org/wiki/Factory_method_pattern), for encapsulating complex object creation.</span></span>

-   <span data-ttu-id="5bd64-363">Eventi di dominio, per la separazione di comportamento dipende dal comportamento di trigger.</span><span class="sxs-lookup"><span data-stu-id="5bd64-363">Domain events, for decoupling dependent behavior from triggering behavior.</span></span>

-   <span data-ttu-id="5bd64-364">[Servizi](http://gorodinski.com/blog/2012/04/14/services-in-domain-driven-design-ddd/), per un comportamento complesso incapsulamento e/o i dettagli di implementazione dell'infrastruttura.</span><span class="sxs-lookup"><span data-stu-id="5bd64-364">[Services](http://gorodinski.com/blog/2012/04/14/services-in-domain-driven-design-ddd/), for encapsulating complex behavior and/or infrastructure implementation details.</span></span>

-   <span data-ttu-id="5bd64-365">[Comando](https://en.wikipedia.org/wiki/Command_pattern), inviare i comandi per la separazione e l'esecuzione del comando stesso.</span><span class="sxs-lookup"><span data-stu-id="5bd64-365">[Command](https://en.wikipedia.org/wiki/Command_pattern), for decoupling issuing commands and executing the command itself.</span></span>

-   <span data-ttu-id="5bd64-366">[Specifica](http://deviq.com/specification-pattern/), per incapsulare dettagli di query.</span><span class="sxs-lookup"><span data-stu-id="5bd64-366">[Specification](http://deviq.com/specification-pattern/), for encapsulating query details.</span></span>

<span data-ttu-id="5bd64-367">DDD inoltre consiglia l'uso dell'architettura pulita illustrato in precedenza, consentendo un regime di controllo, incapsulamento e codice che può essere verificato facilmente con unit test.</span><span class="sxs-lookup"><span data-stu-id="5bd64-367">DDD also recommends the use of the Clean Architecture discussed previously, allowing for loose coupling, encapsulation, and code that can easily be verified using unit tests.</span></span>

### <a name="when-should-you-apply-ddd"></a><span data-ttu-id="5bd64-368">Quando si deve applicare DDD</span><span class="sxs-lookup"><span data-stu-id="5bd64-368">When Should You Apply DDD</span></span>

<span data-ttu-id="5bd64-369">DDD è ideale per applicazioni di grandi dimensioni con una complessità di business significativo (non solo tecnico).</span><span class="sxs-lookup"><span data-stu-id="5bd64-369">DDD is well-suited to large applications with significant business (not just technical) complexity.</span></span> <span data-ttu-id="5bd64-370">L'applicazione deve richiedere le informazioni di esperti di dominio.</span><span class="sxs-lookup"><span data-stu-id="5bd64-370">The application should require the knowledge of domain experts.</span></span> <span data-ttu-id="5bd64-371">Dovrebbe esserci un comportamento significativo nel modello di dominio, che rappresenta le regole di business e interazioni oltre sufficiente archiviare e recuperare lo stato corrente di vari record dagli archivi dati.</span><span class="sxs-lookup"><span data-stu-id="5bd64-371">There should be significant behavior in the domain model itself, representing business rules and interactions beyond simply storing and retrieving the current state of various records from data stores.</span></span>

### <a name="when-shouldnt-you-apply-ddd"></a><span data-ttu-id="5bd64-372">Quando non si applicano DDD</span><span class="sxs-lookup"><span data-stu-id="5bd64-372">When Shouldn't You Apply DDD</span></span>

<span data-ttu-id="5bd64-373">DDD prevede gli investimenti nella comunicazione che non può essere garantita per piccole applicazioni o le applicazioni che sono essenzialmente solo CRUD (creazione/lettura/aggiornamento/eliminazione), l'architettura e modellazione.</span><span class="sxs-lookup"><span data-stu-id="5bd64-373">DDD involves investments in modeling, architecture, and communication that may not be warranted for smaller applications or applications that are essentially just CRUD (create/read/update/delete).</span></span> <span data-ttu-id="5bd64-374">Se si sceglie di approccio l'applicazione seguente DDD, ma che il dominio è disponibile un modello anemic con alcun comportamento di trovare, devi riprogettare l'approccio.</span><span class="sxs-lookup"><span data-stu-id="5bd64-374">If you choose to approach your application following DDD, but find that your domain has an anemic model with no behavior, you may need to rethink your approach.</span></span> <span data-ttu-id="5bd64-375">L'applicazione potrebbe non essere necessario DDD oppure potrebbe essere necessaria assistenza refactoring dell'applicazione per incapsulare la logica di business nel modello di dominio, anziché nell'interfaccia utente o di database.</span><span class="sxs-lookup"><span data-stu-id="5bd64-375">Either your application may not need DDD, or you may need assistance refactoring your application to encapsulate business logic in the domain model, rather than in your database or user interface.</span></span>

<span data-ttu-id="5bd64-376">Un approccio ibrido può essere usata solo DDD per le aree transazionale o di più complesse dell'applicazione, ma non per CRUD più semplice o di sola lettura di parti dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="5bd64-376">A hybrid approach would be to only use DDD for the transactional or more complex areas of the application, but not for simpler CRUD or read-only portions of the application.</span></span> <span data-ttu-id="5bd64-377">È necessario che ad esempio, includere i vincoli di un'aggregazione se si sta eseguendo la query di dati per visualizzare un report o per visualizzare i dati per un dashboard.</span><span class="sxs-lookup"><span data-stu-id="5bd64-377">For instance, you needn't have the constraints of an Aggregate if you're querying data to display a report or to visualize data for a dashboard.</span></span> <span data-ttu-id="5bd64-378">È perfettamente accettabile disporre di un modello per la letto separato e più semplice per tali requisiti.</span><span class="sxs-lookup"><span data-stu-id="5bd64-378">It's perfectly acceptable to have a separate, simpler read model for such requirements.</span></span>

> ### <a name="references--domain-driven-design"></a><span data-ttu-id="5bd64-379">Riferimenti: progettazione basati su dominio</span><span class="sxs-lookup"><span data-stu-id="5bd64-379">References – Domain-Driven Design</span></span>
> - <span data-ttu-id="5bd64-380">**DDD in lingua inglese (StackOverflow risposta)**</span><span class="sxs-lookup"><span data-stu-id="5bd64-380">**DDD in Plain English (StackOverflow Answer)**</span></span>  
> <span data-ttu-id="5bd64-381"><https://StackOverflow.com/Questions/1222392/CAN-someone-Explain-Domain-Driven-Design-ddd-in-Plain-English-Please/1222488#1222488></span><span class="sxs-lookup"><span data-stu-id="5bd64-381"><https://stackoverflow.com/questions/1222392/can-someone-explain-domain-driven-design-ddd-in-plain-english-please/1222488#1222488></span></span>

## <a name="deployment"></a><span data-ttu-id="5bd64-382">Distribuzione</span><span class="sxs-lookup"><span data-stu-id="5bd64-382">Deployment</span></span>

<span data-ttu-id="5bd64-383">Esistono alcuni passaggi coinvolti nel processo di distribuzione dell'applicazione ASP.NET di base, indipendentemente dal fatto in cui verrà ospitato.</span><span class="sxs-lookup"><span data-stu-id="5bd64-383">There are a few steps involved in the process of deploying your ASP.NET Core application, regardless of where it will be hosted.</span></span> <span data-ttu-id="5bd64-384">Il primo passaggio consiste nel pubblicare l'applicazione, che può essere eseguita con il dotnet pubblicare comando CLI.</span><span class="sxs-lookup"><span data-stu-id="5bd64-384">The first step is to publish the application, which can be done using the dotnet publish CLI command.</span></span> <span data-ttu-id="5bd64-385">Verrà compilato l'applicazione e inserire tutti i file necessari per eseguire l'applicazione in una cartella designata.</span><span class="sxs-lookup"><span data-stu-id="5bd64-385">This will compile the application and place all of the files needed to run the application into a designated folder.</span></span> <span data-ttu-id="5bd64-386">Quando si distribuisce da Visual Studio, questo passaggio viene eseguito automaticamente.</span><span class="sxs-lookup"><span data-stu-id="5bd64-386">When you deploy from Visual Studio, this step is performed for you automatically.</span></span> <span data-ttu-id="5bd64-387">Cartella di pubblicazione contiene file .exe e DLL per l'applicazione e le relative dipendenze.</span><span class="sxs-lookup"><span data-stu-id="5bd64-387">The publish folder contains .exe and .dll files for the application and its dependencies.</span></span> <span data-ttu-id="5bd64-388">Un'applicazione indipendente includerà inoltre una versione del runtime .NET.</span><span class="sxs-lookup"><span data-stu-id="5bd64-388">A self-contained application will also include a version of the .NET runtime.</span></span> <span data-ttu-id="5bd64-389">Le applicazioni ASP.NET Core includerà anche i file di configurazione, asset client statico e le visualizzazioni MVC.</span><span class="sxs-lookup"><span data-stu-id="5bd64-389">ASP.NET Core applications will also include configuration files, static client assets, and MVC views.</span></span>

<span data-ttu-id="5bd64-390">Applicazioni ASP.NET sono applicazioni console che devono essere avviate quando il server viene avviato e riavviato in caso di arresto anomalo dell'applicazione (o server).</span><span class="sxs-lookup"><span data-stu-id="5bd64-390">ASP.NET Core applications are console applications that must be started when the server boots and restarted if the application (or server) crashes.</span></span> <span data-ttu-id="5bd64-391">Un gestore di processi è utilizzabile per automatizzare il processo.</span><span class="sxs-lookup"><span data-stu-id="5bd64-391">A process manager can be used to automate this process.</span></span> <span data-ttu-id="5bd64-392">I responsabili di processo più comuni per ASP.NET Core sono Nginx e Apache su Linux e IIS o il servizio di Windows in Windows.</span><span class="sxs-lookup"><span data-stu-id="5bd64-392">The most common process managers for ASP.NET Core are Nginx and Apache on Linux and IIS or Windows Service on Windows.</span></span>

<span data-ttu-id="5bd64-393">Oltre a un gestore di processi, le applicazioni ASP.NET Core ospitate nel server web Kestrel devono utilizzare un server proxy inverso.</span><span class="sxs-lookup"><span data-stu-id="5bd64-393">In addition to a process manager, ASP.NET Core applications hosted in the Kestrel web server must use a reverse proxy server.</span></span> <span data-ttu-id="5bd64-394">Un server proxy inverso riceve le richieste HTTP da internet e li inoltra a Kestrel dopo alcune operazioni di gestione preliminare.</span><span class="sxs-lookup"><span data-stu-id="5bd64-394">A reverse proxy server receives HTTP requests from the internet and forwards them to Kestrel after some preliminary handling.</span></span> <span data-ttu-id="5bd64-395">Server proxy inverso forniscono un livello di sicurezza per l'applicazione e sono necessari per le distribuzioni di edge (esposte per il traffico da Internet).</span><span class="sxs-lookup"><span data-stu-id="5bd64-395">Reverse proxy servers provide a layer of security for the application, and are required for edge deployments (exposed to traffic from the Internet).</span></span> <span data-ttu-id="5bd64-396">Kestrel è relativamente nuovo e non dispone ancora di difese contro alcuni attacchi.</span><span class="sxs-lookup"><span data-stu-id="5bd64-396">Kestrel is relatively new and does not yet offer defenses against certain attacks.</span></span> <span data-ttu-id="5bd64-397">Kestrel inoltre non supporta l'hosting di più applicazioni sulla stessa porta, in modo tecniche come intestazioni host non possono essere utilizzate per abilitare l'hosting di più applicazioni sulla stessa porta e indirizzo IP.</span><span class="sxs-lookup"><span data-stu-id="5bd64-397">Kestrel also doesn't support hosting multiple applications on the same port, so techniques like host headers cannot be used with it to enable hosting multiple applications on the same port and IP address.</span></span>

![Kestrel a Internet](./media/image7-5.png)

<span data-ttu-id="5bd64-399">Figura 7-5 ASP.NET ospitati in Kestrel dietro un server proxy inverso</span><span class="sxs-lookup"><span data-stu-id="5bd64-399">Figure 7-5 ASP.NET hosted in Kestrel behind a reverse proxy server</span></span>

<span data-ttu-id="5bd64-400">Un altro scenario in cui un proxy inverso può risultare utile consiste nel proteggere più applicazioni che usano SSL e HTTPS.</span><span class="sxs-lookup"><span data-stu-id="5bd64-400">Another scenario in which a reverse proxy can be helpful is to secure multiple applications using SSL/HTTPS.</span></span> <span data-ttu-id="5bd64-401">In questo caso, sarebbe necessario solo il proxy inverso di avere configurato SSL.</span><span class="sxs-lookup"><span data-stu-id="5bd64-401">In this case, only the reverse proxy would need to have SSL configured.</span></span> <span data-ttu-id="5bd64-402">La comunicazione tra il server proxy inverso Kestrel potrebbe avvenire su HTTP, come illustrato nella figura 7-6.</span><span class="sxs-lookup"><span data-stu-id="5bd64-402">Communication between the reverse proxy server and Kestrel could take place over HTTP, as shown in Figure 7-6.</span></span>

![](./media/image7-6.png)

<span data-ttu-id="5bd64-403">Figura 7-6 ASP.NET ospitato da un server proxy inverso HTTPS protetta</span><span class="sxs-lookup"><span data-stu-id="5bd64-403">Figure 7-6 ASP.NET hosted behind an HTTPS-secured reverse proxy server</span></span>

<span data-ttu-id="5bd64-404">Un approccio sempre più diffuso consiste nell'ospitare l'applicazione ASP.NET Core in un contenitore Docker, che può essere ospitato in locale o distribuito in Azure per l'hosting basato su cloud.</span><span class="sxs-lookup"><span data-stu-id="5bd64-404">An increasingly popular approach is to host your ASP.NET Core application in a Docker container, which then can be hosted locally or deployed to Azure for cloud-based hosting.</span></span> <span data-ttu-id="5bd64-405">Il contenitore Docker potrebbe contenere codice dell'applicazione in esecuzione su Kestrel e sarà distribuito con un server proxy inverso, come illustrato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="5bd64-405">The Docker container could contain your application code, running on Kestrel, and would be deployed behind a reverse proxy server, as shown above.</span></span>

<span data-ttu-id="5bd64-406">Se si ospita l'applicazione in Azure, è possibile utilizzare il Gateway di applicazione di Microsoft Azure come appliance virtuale dedicato per fornire servizi diversi.</span><span class="sxs-lookup"><span data-stu-id="5bd64-406">If you're hosting your application on Azure, you can use Microsoft Azure Application Gateway as a dedicated virtual appliance to provide several services.</span></span> <span data-ttu-id="5bd64-407">Oltre a funge da proxy inverso per le singole applicazioni, Gateway applicazione possono inoltre offrire le funzionalità seguenti:</span><span class="sxs-lookup"><span data-stu-id="5bd64-407">In addition to acting as a reverse proxy for individual applications, Application Gateway can also offer the following features:</span></span>

-   <span data-ttu-id="5bd64-408">Bilanciamento del carico HTTP</span><span class="sxs-lookup"><span data-stu-id="5bd64-408">HTTP load balancing</span></span>

-   <span data-ttu-id="5bd64-409">Offload SSL (SSL solo per Internet)</span><span class="sxs-lookup"><span data-stu-id="5bd64-409">SSL offload (SSL only to Internet)</span></span>

-   <span data-ttu-id="5bd64-410">SSL end-to-End</span><span class="sxs-lookup"><span data-stu-id="5bd64-410">End to End SSL</span></span>

-   <span data-ttu-id="5bd64-411">Routing multisito (consolidare fino a 20 siti su un singolo Gateway applicazione)</span><span class="sxs-lookup"><span data-stu-id="5bd64-411">Multi-site routing (consolidate up to 20 sites on a single Application Gateway)</span></span>

-   <span data-ttu-id="5bd64-412">Firewall applicazione Web</span><span class="sxs-lookup"><span data-stu-id="5bd64-412">Web application firewall</span></span>

-   <span data-ttu-id="5bd64-413">Supporto di WebSocket</span><span class="sxs-lookup"><span data-stu-id="5bd64-413">Websocket support</span></span>

-   <span data-ttu-id="5bd64-414">Diagnostica avanzata</span><span class="sxs-lookup"><span data-stu-id="5bd64-414">Advanced diagnostics</span></span>

<span data-ttu-id="5bd64-415">*Per ulteriori informazioni sulle opzioni di distribuzione di Azure nel capitolo 10.*</span><span class="sxs-lookup"><span data-stu-id="5bd64-415">*Learn more about Azure deployment options in Chapter 10.*</span></span>

> ### <a name="references--deployment"></a><span data-ttu-id="5bd64-416">Riferimenti: distribuzione</span><span class="sxs-lookup"><span data-stu-id="5bd64-416">References – Deployment</span></span>
> - <span data-ttu-id="5bd64-417">**Cenni preliminari sulla distribuzione e hosting**</span><span class="sxs-lookup"><span data-stu-id="5bd64-417">**Hosting and Deployment Overview**</span></span>  
> <span data-ttu-id="5bd64-418"><https://docs.microsoft.com/ASPNET/core/Publishing/></span><span class="sxs-lookup"><span data-stu-id="5bd64-418"><https://docs.microsoft.com/aspnet/core/publishing/></span></span>
> - <span data-ttu-id="5bd64-419">**Quando utilizzare Kestrel con un proxy inverso**</span><span class="sxs-lookup"><span data-stu-id="5bd64-419">**When to use Kestrel with a reverse proxy**</span></span>  
> <span data-ttu-id="5bd64-420"><https://docs.microsoft.com/ASPNET/core/Fundamentals/Servers/kestrel#When-to-Use-kestrel-with-a-reverse-proxy></span><span class="sxs-lookup"><span data-stu-id="5bd64-420"><https://docs.microsoft.com/aspnet/core/fundamentals/servers/kestrel#when-to-use-kestrel-with-a-reverse-proxy></span></span>
> - <span data-ttu-id="5bd64-421">**Host di applicazioni ASP.NET Core in Docker**</span><span class="sxs-lookup"><span data-stu-id="5bd64-421">**Host ASP.NET Core apps in Docker**</span></span>  
> <span data-ttu-id="5bd64-422"><https://docs.microsoft.com/ASPNET/core/Publishing/docker></span><span class="sxs-lookup"><span data-stu-id="5bd64-422"><https://docs.microsoft.com/aspnet/core/publishing/docker></span></span>
> - <span data-ttu-id="5bd64-423">**Introduzione di Gateway applicazione Azure**</span><span class="sxs-lookup"><span data-stu-id="5bd64-423">**Introducing Azure Application Gateway**</span></span>  
> <span data-ttu-id="5bd64-424"><https://docs.microsoft.com/Azure/Application-Gateway/Application-Gateway-Introduction></span><span class="sxs-lookup"><span data-stu-id="5bd64-424"><https://docs.microsoft.com/azure/application-gateway/application-gateway-introduction></span></span>

>[!div class="step-by-step"]
<span data-ttu-id="5bd64-425">[Precedente] (comuni-client-side-web-technologies.md) [Avanti] (work-with-data-in-asp-net-core-apps.md)</span><span class="sxs-lookup"><span data-stu-id="5bd64-425">[Previous] (common-client-side-web-technologies.md) [Next] (work-with-data-in-asp-net-core-apps.md)</span></span>
