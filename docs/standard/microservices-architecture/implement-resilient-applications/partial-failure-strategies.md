---
title: Strategie di gestione degli errori parziali
description: Architettura di Microservizi .NET per le applicazioni nei contenitori .NET | Strategie di gestione degli errori parziali
keywords: Docker, microservizi, ASP.NET, contenitore
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 05/26/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.topic: article
ms.openlocfilehash: ff3bed530b13a9b1822c7cccf5a4d47df6fc6239
ms.sourcegitcommit: bd1ef61f4bb794b25383d3d72e71041a5ced172e
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 10/18/2017
---
# <a name="strategies-for-handling-partial-failure"></a><span data-ttu-id="67e90-104">Strategie di gestione degli errori parziali</span><span class="sxs-lookup"><span data-stu-id="67e90-104">Strategies for handling partial failure</span></span>

<span data-ttu-id="67e90-105">Di seguito sono elencate le strategie per affrontare gli errori parziali.</span><span class="sxs-lookup"><span data-stu-id="67e90-105">Strategies for dealing with partial failures include the following.</span></span>

<span data-ttu-id="67e90-106">**Usare la comunicazione asincrona (ad esempio, comunicazione basata su messaggi) tra microservizi interno**.</span><span class="sxs-lookup"><span data-stu-id="67e90-106">**Use asynchronous communication (for example, message-based communication) across internal microservices**.</span></span> <span data-ttu-id="67e90-107">È consigliabile non creare lunghe catene di chiamate HTTP sincrone tra l'interno microservizi perché tale progettazione corretta infine diventerà la causa principale di interruzioni non valide.</span><span class="sxs-lookup"><span data-stu-id="67e90-107">It is highly advisable not to create long chains of synchronous HTTP calls across the internal microservices because that incorrect design will eventually become the main cause of bad outages.</span></span> <span data-ttu-id="67e90-108">Al contrario, ad eccezione delle comunicazioni front-end tra le applicazioni client e il primo livello di microservizi o granulari per le API gateway, è consigliabile usare solo (basata su messaggi) comunicazione asincrona di una volta dopo la richiesta iniziale / ciclo di risposta, attraverso il microservizi interno.</span><span class="sxs-lookup"><span data-stu-id="67e90-108">On the contrary, except for the front-end communications between the client applications and the first level of microservices or fine-grained API Gateways, it is recommended to use only asynchronous (message-based) communication once past the initial request/response cycle, across the internal microservices.</span></span> <span data-ttu-id="67e90-109">Architetture di basato su eventi e la coerenza eventuale consente di ridurre gli effetti ripple.</span><span class="sxs-lookup"><span data-stu-id="67e90-109">Eventual consistency and event-driven architectures will help to minimize ripple effects.</span></span> <span data-ttu-id="67e90-110">Questi approcci, applicano un livello superiore di autonomia microservizio e pertanto prevenire il problema indicato di seguito.</span><span class="sxs-lookup"><span data-stu-id="67e90-110">These approaches enforce a higher level of microservice autonomy and therefore prevent against the problem noted here.</span></span>

<span data-ttu-id="67e90-111">**Utilizzare i tentativi con backoff esponenziale**.</span><span class="sxs-lookup"><span data-stu-id="67e90-111">**Use retries with exponential backoff**.</span></span> <span data-ttu-id="67e90-112">Questa tecnica consente di evitare breve e verificati errori intermittenti eseguendo chiamate Riprova a eseguire un determinato numero di volte, nel caso in cui il servizio non era disponibile solo per un breve periodo di tempo.</span><span class="sxs-lookup"><span data-stu-id="67e90-112">This technique helps to avoid short and intermittent failures by performing call retries a certain number of times, in case the service was not available only for a short time.</span></span> <span data-ttu-id="67e90-113">Questa situazione può verificarsi a causa di problemi intermittenti della rete o quando un microservizio/contenitore viene spostato su un nodo in un cluster diverso.</span><span class="sxs-lookup"><span data-stu-id="67e90-113">This might occur due to intermittent network issues or when a microservice/container is moved to a different node in a cluster.</span></span> <span data-ttu-id="67e90-114">Tuttavia, se questi tentativi non sono progettati in modo corretto con circuito, è possibile aggravare gli effetti di ripple, infine anche che provocano un [Denial of Service (DoS)](https://en.wikipedia.org/wiki/Denial-of-service_attack).</span><span class="sxs-lookup"><span data-stu-id="67e90-114">However, if these retries are not designed properly with circuit breakers, it can aggravate the ripple effects, ultimately even causing a [Denial of Service (DoS)](https://en.wikipedia.org/wiki/Denial-of-service_attack).</span></span>

<span data-ttu-id="67e90-115">**Risolvere i timeout di rete**.</span><span class="sxs-lookup"><span data-stu-id="67e90-115">**Work around network timeouts**.</span></span> <span data-ttu-id="67e90-116">In generale, i client devono essere progettati non bloccare in modo indefinito e di utilizzare sempre i timeout durante l'attesa di una risposta.</span><span class="sxs-lookup"><span data-stu-id="67e90-116">In general, clients should be designed not to block indefinitely and to always use timeouts when waiting for a response.</span></span> <span data-ttu-id="67e90-117">Utilizzo di timeout assicura che le risorse non sono mai associate per un periodo illimitato.</span><span class="sxs-lookup"><span data-stu-id="67e90-117">Using timeouts ensures that resources are never tied up indefinitely.</span></span>

<span data-ttu-id="67e90-118">**Utilizzare il modello di interruttore**.</span><span class="sxs-lookup"><span data-stu-id="67e90-118">**Use the Circuit Breaker pattern**.</span></span> <span data-ttu-id="67e90-119">In questo approccio, il processo client tiene traccia del numero di richieste non riuscite.</span><span class="sxs-lookup"><span data-stu-id="67e90-119">In this approach, the client process tracks the number of failed requests.</span></span> <span data-ttu-id="67e90-120">Se la frequenza degli errori supera un limite configurato, un trip "interruttore" in modo che i tentativi non riescono immediatamente.</span><span class="sxs-lookup"><span data-stu-id="67e90-120">If the error rate exceeds a configured limit, a “circuit breaker” trips so that further attempts fail immediately.</span></span> <span data-ttu-id="67e90-121">(Se non riesce, un numero elevato di richieste che suggerisce il servizio è disponibile e che l'invio delle richieste è inutile.) Dopo un periodo di timeout, il client deve ripetere l'operazione e, se le nuove richieste hanno esito positivo, chiudere l'interruttore.</span><span class="sxs-lookup"><span data-stu-id="67e90-121">(If a large number of requests are failing, that suggests the service is unavailable and that sending requests is pointless.) After a timeout period, the client should try again and, if the new requests are successful, close the circuit breaker.</span></span>

<span data-ttu-id="67e90-122">**Fornire fallback**.</span><span class="sxs-lookup"><span data-stu-id="67e90-122">**Provide fallbacks**.</span></span> <span data-ttu-id="67e90-123">In questo approccio, il processo client esegue una logica di fallback quando una richiesta ha esito negativo, ad esempio la restituzione di dati memorizzati nella cache o un valore predefinito.</span><span class="sxs-lookup"><span data-stu-id="67e90-123">In this approach, the client process performs fallback logic when a request fails, such as returning cached data or a default value.</span></span> <span data-ttu-id="67e90-124">Questo è un approccio adatto per le query e si è più complesso per gli aggiornamenti o i comandi.</span><span class="sxs-lookup"><span data-stu-id="67e90-124">This is an approach suitable for queries, and is more complex for updates or commands.</span></span>

<span data-ttu-id="67e90-125">**Limitare il numero di richieste in coda**.</span><span class="sxs-lookup"><span data-stu-id="67e90-125">**Limit the number of queued requests**.</span></span> <span data-ttu-id="67e90-126">I client inoltre devono imporre un limite superiore al numero di richieste in attesa che un microservizio client può inviare a un particolare servizio.</span><span class="sxs-lookup"><span data-stu-id="67e90-126">Clients should also impose an upper bound on the number of outstanding requests that a client microservice can send to a particular service.</span></span> <span data-ttu-id="67e90-127">Se è stato raggiunto il limite, è probabilmente inutile effettuare richieste aggiuntive e i tentativi dovrebbero generare immediatamente un errore.</span><span class="sxs-lookup"><span data-stu-id="67e90-127">If the limit has been reached, it is probably pointless to make additional requests, and those attempts should fail immediately.</span></span> <span data-ttu-id="67e90-128">In termini di implementazione, il Polly [isolamento ponte](https://github.com/App-vNext/Polly/wiki/Bulkhead) criteri possono essere usato per soddisfare questo requisito.</span><span class="sxs-lookup"><span data-stu-id="67e90-128">In terms of implementation, the Polly [Bulkhead Isolation](https://github.com/App-vNext/Polly/wiki/Bulkhead) policy can be used to fulfil this requirement.</span></span> <span data-ttu-id="67e90-129">Questo approccio è essenzialmente una limitazione di parallelizzazione con [SemaphoreSlim](https://docs.microsoft.com/dotnet/api/system.threading.semaphoreslim?view=netcore-1.1) dell'implementazione.</span><span class="sxs-lookup"><span data-stu-id="67e90-129">This approach is essentially a parallelization throttle with [SemaphoreSlim](https://docs.microsoft.com/dotnet/api/system.threading.semaphoreslim?view=netcore-1.1) as the implementation.</span></span> <span data-ttu-id="67e90-130">Consente inoltre di una "coda" di fuori di ponte.</span><span class="sxs-lookup"><span data-stu-id="67e90-130">It also permits a "queue" outside the bulkhead.</span></span> <span data-ttu-id="67e90-131">È possibile lasci eccessivo carico anche prima dell'esecuzione in modo proattivo (ad esempio, perché la capacità viene considerata completa).</span><span class="sxs-lookup"><span data-stu-id="67e90-131">You can proactively shed excess load even before execution (for example, because capacity is deemed full).</span></span> <span data-ttu-id="67e90-132">In questo modo la risposta a determinati scenari di errore più velocemente rispetto a un interruttore, poiché l'interruttore è in attesa per gli errori.</span><span class="sxs-lookup"><span data-stu-id="67e90-132">This makes its response to certain failure scenarios faster than a circuit breaker would be, since the circuit breaker waits for the failures.</span></span> <span data-ttu-id="67e90-133">L'oggetto BulkheadPolicy in Polly espone il livello di riempimento di ponte e coda sono offerte eventi in caso di overflow così utilizzabile anche per favorire la scalabilità orizzontale automatica.</span><span class="sxs-lookup"><span data-stu-id="67e90-133">The BulkheadPolicy object in Polly exposes how full the bulkhead and queue are, and offers events on overflow so can also be used to drive automated horizontal scaling.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="67e90-134">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="67e90-134">Additional resources</span></span>

-   <span data-ttu-id="67e90-135">**Modelli di resilienza**
    [*https://docs.microsoft.com/azure/architecture/patterns/category/resiliency*](https://docs.microsoft.com/azure/architecture/patterns/category/resiliency)</span><span class="sxs-lookup"><span data-stu-id="67e90-135">**Resiliency patterns**
[*https://docs.microsoft.com/azure/architecture/patterns/category/resiliency*](https://docs.microsoft.com/azure/architecture/patterns/category/resiliency)</span></span>

-   <span data-ttu-id="67e90-136">**Aggiunta di resilienza e ottimizzazione delle prestazioni**
    [*https://msdn.microsoft.com/en-us/library/jj591574.aspx*](https://msdn.microsoft.com/en-us/library/jj591574.aspx)</span><span class="sxs-lookup"><span data-stu-id="67e90-136">**Adding Resilience and Optimizing Performance**
[*https://msdn.microsoft.com/en-us/library/jj591574.aspx*](https://msdn.microsoft.com/en-us/library/jj591574.aspx)</span></span>

-   <span data-ttu-id="67e90-137">**Ponte.**</span><span class="sxs-lookup"><span data-stu-id="67e90-137">**Bulkhead.**</span></span> <span data-ttu-id="67e90-138">Repository di GitHub.</span><span class="sxs-lookup"><span data-stu-id="67e90-138">GitHub repo.</span></span> <span data-ttu-id="67e90-139">Implementazione con criteri Polly. \\</span><span class="sxs-lookup"><span data-stu-id="67e90-139">Implementation with Polly policy.\\</span></span>
    [<span data-ttu-id="67e90-140">*https://github.com/App-vNext/Polly/Wiki/Bulkhead*</span><span class="sxs-lookup"><span data-stu-id="67e90-140">*https://github.com/App-vNext/Polly/wiki/Bulkhead*</span></span>](https://github.com/App-vNext/Polly/wiki/Bulkhead)

-   <span data-ttu-id="67e90-141">**Progettazione di applicazioni Azure resilienti**
    [*https://docs.microsoft.com/azure/architecture/resiliency/*](https://docs.microsoft.com/azure/architecture/resiliency/)</span><span class="sxs-lookup"><span data-stu-id="67e90-141">**Designing resilient applications for Azure**
[*https://docs.microsoft.com/azure/architecture/resiliency/*](https://docs.microsoft.com/azure/architecture/resiliency/)</span></span>

-   <span data-ttu-id="67e90-142">**Gestione degli errori temporanei**
    <https://docs.microsoft.com/azure/architecture/best-practices/transient-faults></span><span class="sxs-lookup"><span data-stu-id="67e90-142">**Transient fault handling**
<https://docs.microsoft.com/azure/architecture/best-practices/transient-faults></span></span>


>[!div class="step-by-step"]
<span data-ttu-id="67e90-143">[Precedente] (handle-parziale-failure.md) [Avanti] (implementare-tentativi-esponenziale-backoff.md)</span><span class="sxs-lookup"><span data-stu-id="67e90-143">[Previous] (handle-partial-failure.md) [Next] (implement-retries-exponential-backoff.md)</span></span>
