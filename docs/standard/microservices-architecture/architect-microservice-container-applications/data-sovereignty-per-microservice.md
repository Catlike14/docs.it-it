---
title: "Sovranità di dati per ogni microservizio"
description: "Architettura di Microservizi .NET per le applicazioni nei contenitori .NET | Sovranità di dati per ogni microservizio"
keywords: Docker, microservizi, ASP.NET, contenitore
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 05/26/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.topic: article
ms.openlocfilehash: c51daae04215cfa6f5b5b8d2158a8ed1a8949652
ms.sourcegitcommit: c2e216692ef7576a213ae16af2377cd98d1a67fa
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 10/22/2017
---
# <a name="data-sovereignty-per-microservice"></a><span data-ttu-id="b2811-104">Sovranità di dati per ogni microservizio</span><span class="sxs-lookup"><span data-stu-id="b2811-104">Data sovereignty per microservice</span></span>

<span data-ttu-id="b2811-105">Una regola per l'architettura di microservizi importante è che ogni microservizio deve essere proprietaria dominio dati e logica.</span><span class="sxs-lookup"><span data-stu-id="b2811-105">An important rule for microservices architecture is that each microservice must own its domain data and logic.</span></span> <span data-ttu-id="b2811-106">Come proprietario di un'applicazione completa la logica e i dati, pertanto deve ogni microservizio possedere la logica e i dati in un ciclo di vita autonomo, con la distribuzione indipendente per ogni microservizio.</span><span class="sxs-lookup"><span data-stu-id="b2811-106">Just as a full application owns its logic and data, so must each microservice own its logic and data under an autonomous lifecycle, with independent deployment per microservice.</span></span>

<span data-ttu-id="b2811-107">Ciò significa che il modello concettuale del dominio variano tra i sottosistemi o microservizi.</span><span class="sxs-lookup"><span data-stu-id="b2811-107">This means that the conceptual model of the domain will differ between subsystems or microservices.</span></span> <span data-ttu-id="b2811-108">Prendere in considerazione le applicazioni aziendali, customer relationship management (CRM) applicazioni, transazionale acquistano sottosistemi e i sottosistemi di supporto clienti ogni chiamata di dati e gli attributi di entità cliente univoco e ognuno utilizza un altro Contesto associato (BC).</span><span class="sxs-lookup"><span data-stu-id="b2811-108">Consider enterprise applications, where customer relationship management (CRM) applications, transactional purchase subsystems, and customer support subsystems each call on unique customer entity attributes and data, and where each employs a different Bounded Context (BC).</span></span>

<span data-ttu-id="b2811-109">Questo principio è simile in [progettazione basati su dominio (DDD)](https://en.wikipedia.org/wiki/Domain-driven_design), dove ogni [contesto delimitata](https://martinfowler.com/bliki/BoundedContext.html) o sottosistema autonomo o un servizio deve essere proprietaria relativo modello di dominio (dati e logica e il comportamento).</span><span class="sxs-lookup"><span data-stu-id="b2811-109">This principle is similar in [Domain-driven design (DDD)](https://en.wikipedia.org/wiki/Domain-driven_design), where each [Bounded Context](https://martinfowler.com/bliki/BoundedContext.html) or autonomous subsystem or service must own its domain model (data plus logic and behavior).</span></span> <span data-ttu-id="b2811-110">Ogni contesto delimitata DDD è correlata a una business microservizio (uno o più servizi).</span><span class="sxs-lookup"><span data-stu-id="b2811-110">Each DDD Bounded Context correlates to one business microservice (one or several services).</span></span> <span data-ttu-id="b2811-111">(È expand in questo punto, sul modello di contesto limitato nella sezione successiva).</span><span class="sxs-lookup"><span data-stu-id="b2811-111">(We expand on this point about the Bounded Context pattern in the next section.)</span></span>

<span data-ttu-id="b2811-112">D'altra parte, l'approccio tradizionale (dati monolitico) utilizzata in molte applicazioni è disporre di una o pochi database centralizzato.</span><span class="sxs-lookup"><span data-stu-id="b2811-112">On the other hand, the traditional (monolithic data) approach used in many applications is to have a single centralized database or just a few databases.</span></span> <span data-ttu-id="b2811-113">Questo è spesso un database SQL normalizzato che viene utilizzato per l'intera applicazione e tutti i sottosistemi relativo interni, come illustrato nella figura 4-7.</span><span class="sxs-lookup"><span data-stu-id="b2811-113">This is often a normalized SQL database that is used for the whole application and all its internal subsystems, as shown in Figure 4-7.</span></span>

![](./media/image7.png)

<span data-ttu-id="b2811-114">**Figura 4-7**.</span><span class="sxs-lookup"><span data-stu-id="b2811-114">**Figure 4-7**.</span></span> <span data-ttu-id="b2811-115">Confronto di dati sovranità: monolitico database anziché microservizi</span><span class="sxs-lookup"><span data-stu-id="b2811-115">Data sovereignty comparison: monolithic database versus microservices</span></span>

<span data-ttu-id="b2811-116">L'approccio centralizzato database inizialmente è più semplice e sembra per consentire il riutilizzo di entità in sottosistemi diversi per qualsiasi coerente.</span><span class="sxs-lookup"><span data-stu-id="b2811-116">The centralized database approach initially looks simpler and seems to enable reuse of entities in different subsystems to make everything consistent.</span></span> <span data-ttu-id="b2811-117">Ma in realtà che si finisce con le tabelle di grandi dimensioni che gestiscono molti diversi sottosistemi, e che includono gli attributi e le colonne che non sono necessari nella maggior parte dei casi.</span><span class="sxs-lookup"><span data-stu-id="b2811-117">But the reality is you end up with huge tables that serve many different subsystems, and that include attributes and columns that are not needed in most cases.</span></span> <span data-ttu-id="b2811-118">è come provare a utilizzare la mappa fisica stesso per escursionismo un breve riepilogo, richiede un trip giornata car e apprendimento geography.</span><span class="sxs-lookup"><span data-stu-id="b2811-118">it is like trying to use the same physical map for hiking a short trail, taking a day-long car trip, and learning geography.</span></span>

<span data-ttu-id="b2811-119">Un'applicazione monolitica con in genere un solo database relazionale ha due importanti vantaggi: [transazioni ACID](https://en.wikipedia.org/wiki/ACID) e il linguaggio SQL, sia funzionante tra tutte le tabelle e i dati relativi all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="b2811-119">A monolithic application with typically a single relational database has two important benefits: [ACID transactions](https://en.wikipedia.org/wiki/ACID) and the SQL language, both working across all the tables and data related to your application.</span></span> <span data-ttu-id="b2811-120">Questo approccio consente di scrivere facilmente una query che combina i dati da più tabelle.</span><span class="sxs-lookup"><span data-stu-id="b2811-120">This approach provides a way to easily write a query that combines data from multiple tables.</span></span>

<span data-ttu-id="b2811-121">Tuttavia, l'accesso ai dati diventa più complessa quando si passa a un'architettura di microservizi.</span><span class="sxs-lookup"><span data-stu-id="b2811-121">However, data access becomes much more complex when you move to a microservices architecture.</span></span> <span data-ttu-id="b2811-122">Ma anche quando le transazioni ACID possono o devono essere utilizzate all'interno di un microservizio o il contesto limitato, i dati di proprietà di ogni microservizio sono privati per tale microservizio e accessibile solo tramite l'API microservizio.</span><span class="sxs-lookup"><span data-stu-id="b2811-122">But even when ACID transactions can or should be used within a microservice or Bounded Context, the data owned by each microservice is private to that microservice and can only be accessed via its microservice API.</span></span> <span data-ttu-id="b2811-123">Incapsulamento dei dati garantisce che i microservizi ad accoppiamento debole e possono evolvere indipendentemente uno da altro.</span><span class="sxs-lookup"><span data-stu-id="b2811-123">Encapsulating the data ensures that the microservices are loosely coupled and can evolve independently of one another.</span></span> <span data-ttu-id="b2811-124">Se più servizi accedesse agli stessi dati, gli aggiornamenti dello schema sono necessario coordinare gli aggiornamenti a tutti i servizi.</span><span class="sxs-lookup"><span data-stu-id="b2811-124">If multiple services were accessing the same data, schema updates would require coordinated updates to all the services.</span></span> <span data-ttu-id="b2811-125">Ciò causa l'interruzione del ciclo di vita autonomia microservizio.</span><span class="sxs-lookup"><span data-stu-id="b2811-125">This would break the microservice lifecycle autonomy.</span></span> <span data-ttu-id="b2811-126">Ma le strutture di dati distribuiti significa che non è possibile apportare una singola transazione ACID tra microservizi.</span><span class="sxs-lookup"><span data-stu-id="b2811-126">But distributed data structures mean that you cannot make a single ACID transaction across microservices.</span></span> <span data-ttu-id="b2811-127">Questo significa che a sua volta quando un processo di business interessa più microservizi, è necessario utilizzare la coerenza eventuale.</span><span class="sxs-lookup"><span data-stu-id="b2811-127">This in turn means you must use eventual consistency when a business process spans multiple microservices.</span></span> <span data-ttu-id="b2811-128">Questo è molto più difficile da implementare rispetto ai join SQL semplice; Analogamente, molte altre funzionalità di database relazionale non sono disponibili in più microservizi.</span><span class="sxs-lookup"><span data-stu-id="b2811-128">This is much harder to implement than simple SQL joins; similarly, many other relational database features are not available across multiple microservices.</span></span>

<span data-ttu-id="b2811-129">Continua anche, microservizi diversi utilizzano spesso diversi *tipi* di database.</span><span class="sxs-lookup"><span data-stu-id="b2811-129">Going even further, different microservices often use different *kinds* of databases.</span></span> <span data-ttu-id="b2811-130">Archivio applicazioni moderne e processo di diversi tipi di dati e un database relazionale non è sempre la scelta migliore.</span><span class="sxs-lookup"><span data-stu-id="b2811-130">Modern applications store and process diverse kinds of data, and a relational database is not always the best choice.</span></span> <span data-ttu-id="b2811-131">Per alcuni casi d'uso, un database NoSQL come Azure DocumentDB o MongoDB potrebbe disporre di un modello di dati più semplice e offrono migliori prestazioni e scalabilità rispetto a un database SQL, ad esempio SQL Server o Database SQL di Azure.</span><span class="sxs-lookup"><span data-stu-id="b2811-131">For some use cases, a NoSQL database such as Azure DocumentDB or MongoDB might have a more convenient data model and offer better performance and scalability than a SQL database like SQL Server or Azure SQL Database.</span></span> <span data-ttu-id="b2811-132">In altri casi, un database relazionale è ancora l'approccio migliore.</span><span class="sxs-lookup"><span data-stu-id="b2811-132">In other cases, a relational database is still the best approach.</span></span> <span data-ttu-id="b2811-133">Pertanto, le applicazioni basate su microservizi spesso utilizzare una combinazione di database SQL e database NoSQL, talvolta denominato il [polyglot persistenza](http://martinfowler.com/bliki/PolyglotPersistence.html) approccio.</span><span class="sxs-lookup"><span data-stu-id="b2811-133">Therefore, microservices-based applications often use a mixture of SQL and NoSQL databases, which is sometimes called the [polyglot persistence](http://martinfowler.com/bliki/PolyglotPersistence.html) approach.</span></span>

<span data-ttu-id="b2811-134">Un'architettura partizionata, polyglot permanente per l'archivio dati presenta numerosi vantaggi.</span><span class="sxs-lookup"><span data-stu-id="b2811-134">A partitioned, polyglot-persistent architecture for data storage has many benefits.</span></span> <span data-ttu-id="b2811-135">Tra cui servizi loosely-coupled e migliori prestazioni, scalabilità, costi e la gestibilità.</span><span class="sxs-lookup"><span data-stu-id="b2811-135">These include loosely coupled services and better performance, scalability, costs, and manageability.</span></span> <span data-ttu-id="b2811-136">Tuttavia, può causare alcuni problemi di gestione di dati distribuiti, come verrà illustrato "[che identifica i limiti di modello di dominio](#identifying-domain-model-boundaries-for-each-microservice)" più avanti in questo capitolo.</span><span class="sxs-lookup"><span data-stu-id="b2811-136">However, it can introduce some distributed data management challenges, as we will explain in “[Identifying domain-model boundaries](#identifying-domain-model-boundaries-for-each-microservice)” later in this chapter.</span></span>

## <a name="the-relationship-between-microservices-and-the-bounded-context-pattern"></a><span data-ttu-id="b2811-137">La relazione tra microservizi e il criterio di contesto limitato</span><span class="sxs-lookup"><span data-stu-id="b2811-137">The relationship between microservices and the Bounded Context pattern</span></span>

<span data-ttu-id="b2811-138">Il concetto di microservizio deriva il [modello delimitata contesto (BC)](http://martinfowler.com/bliki/BoundedContext.html) in [progettazione basati su dominio (DDD)](https://en.wikipedia.org/wiki/Domain-driven_design).</span><span class="sxs-lookup"><span data-stu-id="b2811-138">The concept of microservice derives from the [Bounded Context (BC) pattern](http://martinfowler.com/bliki/BoundedContext.html) in [domain-driven design (DDD)](https://en.wikipedia.org/wiki/Domain-driven_design).</span></span> <span data-ttu-id="b2811-139">DDD riguarda i modelli di grandi dimensioni suddividendo li in più BCs e siano espliciti sui loro limiti.</span><span class="sxs-lookup"><span data-stu-id="b2811-139">DDD deals with large models by dividing them into multiple BCs and being explicit about their boundaries.</span></span> <span data-ttu-id="b2811-140">Ogni BC deve avere il proprio modello e il database. ogni microservizio appartiene allo stesso modo, i dati correlati.</span><span class="sxs-lookup"><span data-stu-id="b2811-140">Each BC must have its own model and database; likewise, each microservice owns its related data.</span></span> <span data-ttu-id="b2811-141">Inoltre, in genere ogni BC ha il proprio [linguaggio universale](http://martinfowler.com/bliki/UbiquitousLanguage.html) per la comunicazione tra gli sviluppatori di software e gli esperti di dominio.</span><span class="sxs-lookup"><span data-stu-id="b2811-141">In addition, each BC usually has its own [ubiquitous language](http://martinfowler.com/bliki/UbiquitousLanguage.html) to help communication between software developers and domain experts.</span></span>

<span data-ttu-id="b2811-142">Tali condizioni (principalmente le entità di dominio) in linguaggio universale possono avere nomi diversi in contesti diversi delimitata, entità di dominio anche quando diversi condividono la stessa identità (vale a dire l'ID univoco utilizzato per leggere l'entità dall'archiviazione).</span><span class="sxs-lookup"><span data-stu-id="b2811-142">Those terms (mainly domain entities) in the ubiquitous language can have different names in different Bounded Contexts, even when different domain entities share the same identity (that is, the unique ID that is used to read the entity from storage).</span></span> <span data-ttu-id="b2811-143">Ad esempio, in un contesto limitato per il profilo utente, l'entità utente di dominio potrebbe condividere identità con l'entità di dominio dell'acquirente nel contesto limitato di ordinamento.</span><span class="sxs-lookup"><span data-stu-id="b2811-143">For instance, in a user-profile Bounded Context, the User domain entity might share identity with the Buyer domain entity in the ordering Bounded Context.</span></span>

<span data-ttu-id="b2811-144">Un microservizio equivale pertanto un contesto limitato, ma specifica inoltre che è un servizio distribuito.</span><span class="sxs-lookup"><span data-stu-id="b2811-144">A microservice is therefore like a Bounded Context, but it also specifies that it is a distributed service.</span></span> <span data-ttu-id="b2811-145">È compilato come processo separato per ogni contesto delimitata e deve utilizzare i protocolli distribuiti indicati in precedenza, ad esempio HTTP/HTTPS, WebSockets, o [AMQP](https://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol).</span><span class="sxs-lookup"><span data-stu-id="b2811-145">It is built as a separate process for each Bounded Context, and it must use the distributed protocols noted earlier, like HTTP/HTTPS, WebSockets, or [AMQP](https://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol).</span></span> <span data-ttu-id="b2811-146">Criterio di contesto limitato, tuttavia, non specificare se il contesto delimitata è un servizio distribuito o se è semplicemente un limite logico (ad esempio un sottosistema generico) all'interno di un'applicazione monolitico distribuzione.</span><span class="sxs-lookup"><span data-stu-id="b2811-146">The Bounded Context pattern, however, does not specify whether the Bounded Context is a distributed service or if it is simply a logical boundary (such as a generic subsystem) within a monolithic-deployment application.</span></span>

<span data-ttu-id="b2811-147">È importante evidenziare che la definizione di un servizio per ogni contesto delimitata è un buon punto di partenza.</span><span class="sxs-lookup"><span data-stu-id="b2811-147">It is important to highlight that defining a service for each Bounded Context is a good place to start.</span></span> <span data-ttu-id="b2811-148">Ma non si dispone di vincolare la progettazione a esso.</span><span class="sxs-lookup"><span data-stu-id="b2811-148">But you do not have to constrain your design to it.</span></span> <span data-ttu-id="b2811-149">In alcuni casi è necessario progettare un contesto delimitato o microservizio business è costituita da diversi servizi fisici.</span><span class="sxs-lookup"><span data-stu-id="b2811-149">Sometimes you must design a Bounded Context or business microservice composed of several physical services.</span></span> <span data-ttu-id="b2811-150">Ma in definitiva, entrambi i modelli, delimitata contesto e microservizio, ovvero sono strettamente correlati.</span><span class="sxs-lookup"><span data-stu-id="b2811-150">But ultimately, both patterns—Bounded Context and microservice—are closely related.</span></span>

<span data-ttu-id="b2811-151">DDD dei vantaggi di microservizi ottenendo reali limiti sotto forma di microservizi distribuita.</span><span class="sxs-lookup"><span data-stu-id="b2811-151">DDD benefits from microservices by getting real boundaries in the form of distributed microservices.</span></span> <span data-ttu-id="b2811-152">Ma idee come la condivisione non di modello tra microservizi ciò che si desidera anche in un contesto delimitato.</span><span class="sxs-lookup"><span data-stu-id="b2811-152">But ideas like not sharing the model between microservices are what you also want in a Bounded Context.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="b2811-153">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="b2811-153">Additional resources</span></span>

-   <span data-ttu-id="b2811-154">**Chris Richardson. Modello: Per ogni servizio del Database**
    [*http://microservices.io/patterns/data/database-per-service.html*](http://microservices.io/patterns/data/database-per-service.html)</span><span class="sxs-lookup"><span data-stu-id="b2811-154">**Chris Richardson. Pattern: Database per service**
[*http://microservices.io/patterns/data/database-per-service.html*](http://microservices.io/patterns/data/database-per-service.html)</span></span>

-   <span data-ttu-id="b2811-155">**Martin Fowler. BoundedContext**
    [*http://martinfowler.com/bliki/BoundedContext.html*](http://martinfowler.com/bliki/BoundedContext.html)</span><span class="sxs-lookup"><span data-stu-id="b2811-155">**Martin Fowler. BoundedContext**
[*http://martinfowler.com/bliki/BoundedContext.html*](http://martinfowler.com/bliki/BoundedContext.html)</span></span>

-   <span data-ttu-id="b2811-156">**Martin Fowler. PolyglotPersistence**
    [*http://martinfowler.com/bliki/PolyglotPersistence.html*](http://martinfowler.com/bliki/PolyglotPersistence.html)</span><span class="sxs-lookup"><span data-stu-id="b2811-156">**Martin Fowler. PolyglotPersistence**
[*http://martinfowler.com/bliki/PolyglotPersistence.html*](http://martinfowler.com/bliki/PolyglotPersistence.html)</span></span>

-   <span data-ttu-id="b2811-157">**Alberto Brandolini. Progettazione con il Mapping del contesto basata su domini strategico**
    [*https://www.infoq.com/articles/ddd-contextmapping*](https://www.infoq.com/articles/ddd-contextmapping)</span><span class="sxs-lookup"><span data-stu-id="b2811-157">**Alberto Brandolini. Strategic Domain Driven Design with Context Mapping**
[*https://www.infoq.com/articles/ddd-contextmapping*](https://www.infoq.com/articles/ddd-contextmapping)</span></span>


>[!div class="step-by-step"]
<span data-ttu-id="b2811-158">[Precedente] (architecture.md microservizi) [Avanti] (logico-e-fisica-architecture.md)</span><span class="sxs-lookup"><span data-stu-id="b2811-158">[Previous] (microservices-architecture.md) [Next] (logical-versus-physical-architecture.md)</span></span>
