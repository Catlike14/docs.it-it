---
title: Microservizio creazione in evoluzione e controllo delle versioni delle API e i contratti
description: Architettura di Microservizi .NET per le applicazioni nei contenitori .NET | Microservizio creazione in evoluzione e controllo delle versioni delle API e i contratti
keywords: Docker, microservizi, ASP.NET, contenitore
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 05/26/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.topic: article
ms.openlocfilehash: 433711c3479eafd52bf9f5d53faf8e5707c6c624
ms.sourcegitcommit: c2e216692ef7576a213ae16af2377cd98d1a67fa
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 10/22/2017
---
# <a name="creating-evolving-and-versioning-microservice-apis-and-contracts"></a><span data-ttu-id="935ec-104">Microservizio creazione in evoluzione e controllo delle versioni delle API e i contratti</span><span class="sxs-lookup"><span data-stu-id="935ec-104">Creating, evolving, and versioning microservice APIs and contracts</span></span>

<span data-ttu-id="935ec-105">Un microservizio API è un contratto tra il servizio e i relativi client.</span><span class="sxs-lookup"><span data-stu-id="935ec-105">A microservice API is a contract between the service and its clients.</span></span> <span data-ttu-id="935ec-106">Sarà in grado di evolvere in modo indipendente un microservizio solo se non si interrompe il contratto API, motivo per cui il contratto è così importante.</span><span class="sxs-lookup"><span data-stu-id="935ec-106">You will be able to evolve a microservice independently only if you do not break its API contract, which is why the contract is so important.</span></span> <span data-ttu-id="935ec-107">Se si modifica il contratto, avrà impatto sulle applicazioni client o il API Gateway.</span><span class="sxs-lookup"><span data-stu-id="935ec-107">If you change the contract, it will impact your client applications or your API Gateway.</span></span>

<span data-ttu-id="935ec-108">La natura della definizione dell'API dipende dal quale protocollo in uso.</span><span class="sxs-lookup"><span data-stu-id="935ec-108">The nature of the API definition depends on which protocol you are using.</span></span> <span data-ttu-id="935ec-109">Ad esempio, se si utilizza la messaggistica (ad esempio [AMQP](https://www.amqp.org/)), l'API è costituita da tipi di messaggio.</span><span class="sxs-lookup"><span data-stu-id="935ec-109">For instance, if you are using messaging (like [AMQP](https://www.amqp.org/)), the API consists of the message types.</span></span> <span data-ttu-id="935ec-110">Se si utilizza HTTP e servizi, l'API è costituita dagli URL e i formati di richiesta e risposta JSON.</span><span class="sxs-lookup"><span data-stu-id="935ec-110">If you are using HTTP and RESTful services, the API consists of the URLs and the request and response JSON formats.</span></span>

<span data-ttu-id="935ec-111">Tuttavia, anche se si sta con attenzione il contratto iniziale, un'API del servizio sarà necessario cambiare nel tempo.</span><span class="sxs-lookup"><span data-stu-id="935ec-111">However, even if you are thoughtful about your initial contract, a service API will need to change over time.</span></span> <span data-ttu-id="935ec-112">Quando ciò si verifica, e in particolare se l'API è un'API pubblica utilizzata da più applicazioni client, è in genere non è possibile imporre a tutti i client per eseguire l'aggiornamento per il nuovo contratto API.</span><span class="sxs-lookup"><span data-stu-id="935ec-112">When that happens—and especially if your API is a public API consumed by multiple client applications—you typically cannot force all clients to upgrade to your new API contract.</span></span> <span data-ttu-id="935ec-113">In genere, è necessario distribuire in modo incrementale le nuove versioni di un servizio in modo che sia vecchi che nuove versioni di un contratto di servizio sono in esecuzione contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="935ec-113">You usually need to incrementally deploy new versions of a service in a way that both old and new versions of a service contract are running simultaneously.</span></span> <span data-ttu-id="935ec-114">Pertanto, è importante disporre di una strategia per il controllo delle versioni del servizio.</span><span class="sxs-lookup"><span data-stu-id="935ec-114">Therefore, it is important to have a strategy for your service versioning.</span></span>

<span data-ttu-id="935ec-115">Quando le modifiche delle API sono troppo piccole, ad esempio se aggiungere gli attributi o i parametri all'API, i client che usano un'API precedente devono passare e di lavoro con la nuova versione del servizio.</span><span class="sxs-lookup"><span data-stu-id="935ec-115">When the API changes are small, like if you add attributes or parameters to your API, clients that use an older API should switch and work with the new version of the service.</span></span> <span data-ttu-id="935ec-116">Potrebbe essere in grado di fornire i valori predefiniti per tutti gli attributi mancanti necessari e il client potrebbe essere in grado di ignorare eventuali attributi aggiuntivi di risposta.</span><span class="sxs-lookup"><span data-stu-id="935ec-116">You might be able to provide default values for any missing attributes that are required, and the clients might be able to ignore any extra response attributes.</span></span>

<span data-ttu-id="935ec-117">Tuttavia, talvolta è necessario apportare modifiche principali e incompatibili a un'API del servizio.</span><span class="sxs-lookup"><span data-stu-id="935ec-117">However, sometimes you need to make major and incompatible changes to a service API.</span></span> <span data-ttu-id="935ec-118">Poiché potrebbe non essere in grado di imporre applicazioni o servizi client per eseguire immediatamente l'aggiornamento alla nuova versione, un servizio deve supportare le versioni precedenti dell'API per un determinato periodo.</span><span class="sxs-lookup"><span data-stu-id="935ec-118">Because you might not be able to force client applications or services to upgrade immediately to the new version, a service must support older versions of the API for some period.</span></span> <span data-ttu-id="935ec-119">Se si utilizza un meccanismo basato su HTTP, ad esempio REST, un approccio consiste nell'incorporare il numero di versione dell'API nell'URL o in un'intestazione HTTP.</span><span class="sxs-lookup"><span data-stu-id="935ec-119">If you are using an HTTP-based mechanism such as REST, one approach is to embed the API version number in the URL or into a HTTP header.</span></span> <span data-ttu-id="935ec-120">È possibile quindi decidere tra implementa entrambe le versioni del servizio contemporaneamente nella stessa istanza del servizio o istanze diverse che ognuno di gestire una versione dell'API di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="935ec-120">Then you can decide between implementing both versions of the service simultaneously within the same service instance, or deploying different instances that each handle a version of the API.</span></span> <span data-ttu-id="935ec-121">Un approccio valido per questo è il [modello mediatore](https://en.wikipedia.org/wiki/Mediator_pattern) (ad esempio, [MediatR libreria](https://github.com/jbogard/MediatR)) per separare le versioni diverse di implementazione nei gestori indipendenti.</span><span class="sxs-lookup"><span data-stu-id="935ec-121">A good approach for this is the [Mediator pattern](https://en.wikipedia.org/wiki/Mediator_pattern) (for example, [MediatR library](https://github.com/jbogard/MediatR)) to decouple the different implementation versions into independent handlers.</span></span>

<span data-ttu-id="935ec-122">Infine, se si utilizza un'architettura REST, [Hypermedia](https://www.infoq.com/articles/mark-baker-hypermedia) è la soluzione migliore per il controllo delle versioni dei servizi e consentendo evolversi API.</span><span class="sxs-lookup"><span data-stu-id="935ec-122">Finally, if you are using a REST architecture, [Hypermedia](https://www.infoq.com/articles/mark-baker-hypermedia) is the best solution for versioning your services and allowing evolvable APIs.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="935ec-123">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="935ec-123">Additional resources</span></span>

-   <span data-ttu-id="935ec-124">**Scott Hanselman. Controllo delle versioni API Web RESTful Core ASP.NET semplificato**
    <http://www.hanselman.com/blog/ASPNETCoreRESTfulWebAPIVersioningMadeEasy.aspx></span><span class="sxs-lookup"><span data-stu-id="935ec-124">**Scott Hanselman. ASP.NET Core RESTful Web API versioning made easy**
<http://www.hanselman.com/blog/ASPNETCoreRESTfulWebAPIVersioningMadeEasy.aspx></span></span>

-   <span data-ttu-id="935ec-125">**Controllo delle versioni di un'API web RESTful**
    [*https://docs.microsoft.com/azure/architecture/best-practices/api-design#versioning-a-restful-web-api*](https://docs.microsoft.com/azure/architecture/best-practices/api-design#versioning-a-restful-web-api)</span><span class="sxs-lookup"><span data-stu-id="935ec-125">**Versioning a RESTful web API**
[*https://docs.microsoft.com/azure/architecture/best-practices/api-design#versioning-a-restful-web-api*](https://docs.microsoft.com/azure/architecture/best-practices/api-design#versioning-a-restful-web-api)</span></span>

-   <span data-ttu-id="935ec-126">**Roy Fielding. Controllo delle versioni e Hypermedia REST**
    <https://www.infoq.com/articles/roy-fielding-on-versioning></span><span class="sxs-lookup"><span data-stu-id="935ec-126">**Roy Fielding. Versioning, Hypermedia, and REST**
<https://www.infoq.com/articles/roy-fielding-on-versioning></span></span>


>[!div class="step-by-step"]
<span data-ttu-id="935ec-127">[Precedente] (asincrono-messaggio-base-communication.md) [Avanti] (microservizi indirizzabilità-servizio registry.md)</span><span class="sxs-lookup"><span data-stu-id="935ec-127">[Previous] (asynchronous-message-based-communication.md) [Next] (microservices-addressability-service-registry.md)</span></span>
