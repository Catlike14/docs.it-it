---
title: Flusso di lavoro di sviluppo per le app di Docker
description: Architettura di Microservizi .NET per le applicazioni nei contenitori .NET | Flusso di lavoro di sviluppo per le app di Docker
keywords: Docker, microservizi, ASP.NET, contenitore
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 10/18/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.topic: article
ms.openlocfilehash: 5a53aee4261a5a0bfc25b3520c50cf505b84f287
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 11/21/2017
---
# <a name="development-workflow-for-docker-apps"></a><span data-ttu-id="47ca3-104">Flusso di lavoro di sviluppo per le app di Docker</span><span class="sxs-lookup"><span data-stu-id="47ca3-104">Development workflow for Docker apps</span></span>

<span data-ttu-id="47ca3-105">Il ciclo di vita di sviluppo di applicazioni inizia in corrispondenza di ogni macchina di sviluppatore, in cui lo sviluppatore codici l'applicazione utilizzando la lingua desiderata e sottopone a test in locale.</span><span class="sxs-lookup"><span data-stu-id="47ca3-105">The application development lifecycle starts at each developer’s machine, where the developer codes the application using their preferred language and tests it locally.</span></span> <span data-ttu-id="47ca3-106">Indipendentemente da quali lingua, framework e piattaforma sceglie lo sviluppatore, con questo flusso di lavoro, lo sviluppatore è sempre lo sviluppo e test contenitori di Docker, ma in questo modo localmente.</span><span class="sxs-lookup"><span data-stu-id="47ca3-106">No matter which language, framework, and platform the developer chooses, with this workflow, the developer is always developing and testing Docker containers, but doing so locally.</span></span>

<span data-ttu-id="47ca3-107">Ogni contenitore (un'istanza di un'immagine Docker) include i componenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="47ca3-107">Each container (an instance of a Docker image) includes the following components:</span></span>

-   <span data-ttu-id="47ca3-108">Una selezione del sistema operativo (ad esempio, una distribuzione Linux, Windows Nano Server o Windows Server Core).</span><span class="sxs-lookup"><span data-stu-id="47ca3-108">An operating system selection (for example, a Linux distribution, Windows Nano Server, or Windows Server Core).</span></span>

-   <span data-ttu-id="47ca3-109">File aggiunti dallo sviluppatore (file binari dell'applicazione e così via).</span><span class="sxs-lookup"><span data-stu-id="47ca3-109">Files added by the developer (application binaries, etc.).</span></span>

-   <span data-ttu-id="47ca3-110">Informazioni di configurazione (impostazioni di ambiente e le dipendenze).</span><span class="sxs-lookup"><span data-stu-id="47ca3-110">Configuration information (environment settings and dependencies).</span></span>

## <a name="workflow-for-developing-docker-container-based-applications"></a><span data-ttu-id="47ca3-111">Flusso di lavoro per lo sviluppo di applicazioni basate sul contenitore Docker</span><span class="sxs-lookup"><span data-stu-id="47ca3-111">Workflow for developing Docker container-based applications</span></span>

<span data-ttu-id="47ca3-112">Questa sezione viene descritto il *interna ciclo* flusso di lavoro di sviluppo per applicazioni basate sul contenitore Docker.</span><span class="sxs-lookup"><span data-stu-id="47ca3-112">This section describes the *inner-loop* development workflow for Docker container-based applications.</span></span> <span data-ttu-id="47ca3-113">Il flusso di lavoro ciclo interno significa è non tenendo conto del flusso di lavoro più ampia di DevOps e prevede solo il lavoro di sviluppo eseguito sul computer dello sviluppatore.</span><span class="sxs-lookup"><span data-stu-id="47ca3-113">The inner-loop workflow means it is not taking into account the broader DevOps workflow and just focuses on the development work done on the developer’s computer.</span></span> <span data-ttu-id="47ca3-114">I passaggi iniziali per configurare l'ambiente non sono inclusi, in quanto quelle vengono eseguite una sola volta.</span><span class="sxs-lookup"><span data-stu-id="47ca3-114">The initial steps to set up the environment are not included, since those are done only once.</span></span>

<span data-ttu-id="47ca3-115">Un'applicazione è costituita da propri servizi più librerie aggiuntive (dipendenze).</span><span class="sxs-lookup"><span data-stu-id="47ca3-115">An application is composed of your own services plus additional libraries (dependencies).</span></span> <span data-ttu-id="47ca3-116">Di seguito sono indicati i passaggi di base che accettano in genere quando si compila un'applicazione di Docker, come illustrato nella figura 5-1.</span><span class="sxs-lookup"><span data-stu-id="47ca3-116">The following are the basic steps you usually take when building a Docker application, as illustrated in Figure 5-1.</span></span>

![](./media/image1.png)

<span data-ttu-id="47ca3-117">**Figura 5-1.**</span><span class="sxs-lookup"><span data-stu-id="47ca3-117">**Figure 5-1.**</span></span> <span data-ttu-id="47ca3-118">Flusso di lavoro dettagliata per lo sviluppo di App contenitore Docker</span><span class="sxs-lookup"><span data-stu-id="47ca3-118">Step-by-step workflow for developing Docker containerized apps</span></span>

<span data-ttu-id="47ca3-119">In questa guida è descritta in dettaglio l'intero processo e ogni passaggio principale è illustrato concentrandosi su un ambiente di Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="47ca3-119">In this guide, this whole process is detailed and every major step is explained by focusing on a Visual Studio environment.</span></span>

<span data-ttu-id="47ca3-120">Quando si utilizza un approccio di sviluppo editor/CLI (ad esempio, codice di Visual Studio più CLI di Docker in macOS o Windows), è necessario conoscere ogni passaggio, in genere in modo più dettagliato rispetto all'utilizzo di Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="47ca3-120">When you are using an editor/CLI development approach (for example, Visual Studio Code plus Docker CLI on macOS or Windows), you need to know every step, generally in more detail than if you are using Visual Studio.</span></span> <span data-ttu-id="47ca3-121">Per ulteriori informazioni sull'utilizzo in un ambiente di CLI, vedere l'e-book [ciclo di vita dell'applicazione contenitore di Docker con Platforms Microsoft e strumenti](http://aka.ms/dockerlifecycleebook/).</span><span class="sxs-lookup"><span data-stu-id="47ca3-121">For more details about working in a CLI environment, refer to the e-book [Containerized Docker Application lifecycle with Microsoft Platforms and Tools](http://aka.ms/dockerlifecycleebook/).</span></span>

<span data-ttu-id="47ca3-122">Quando si utilizza Visual Studio 2015 o Visual Studio 2017, molti di questi passaggi vengono gestiti automaticamente, che migliora la produttività.</span><span class="sxs-lookup"><span data-stu-id="47ca3-122">When you are using Visual Studio 2015 or Visual Studio 2017, many of those steps are handled for you, which dramatically improves your productivity.</span></span> <span data-ttu-id="47ca3-123">Ciò vale soprattutto quando si utilizza Visual Studio 2017 e le applicazioni multi-contenitore di destinazione.</span><span class="sxs-lookup"><span data-stu-id="47ca3-123">This is especially true when you are using Visual Studio 2017 and targeting multi-container applications.</span></span> <span data-ttu-id="47ca3-124">Ad esempio, con un solo clic, Visual Studio aggiunge il file Dockerfile e docker compose.yml ai progetti con la configurazione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="47ca3-124">For instance, with just one mouse click, Visual Studio adds the Dockerfile and docker-compose.yml file to your projects with the configuration for your application.</span></span> <span data-ttu-id="47ca3-125">Quando si esegue l'applicazione in Visual Studio, crea l'immagine di Docker e si esegue l'applicazione contenitore più direttamente in Docker; consente anche di eseguire il debug di diversi contenitori in una sola volta.</span><span class="sxs-lookup"><span data-stu-id="47ca3-125">When you run the application in Visual Studio, it builds the Docker image and runs the multi-container application directly in Docker; it even allows you to debug several containers at once.</span></span> <span data-ttu-id="47ca3-126">Queste funzionalità verranno migliorare la velocità di sviluppo.</span><span class="sxs-lookup"><span data-stu-id="47ca3-126">These features will boost your development speed.</span></span>

<span data-ttu-id="47ca3-127">Tuttavia, solo perché Visual Studio rende automatici i passaggi non significa che non è necessario sapere cosa è on sotto con Docker.</span><span class="sxs-lookup"><span data-stu-id="47ca3-127">However, just because Visual Studio makes those steps automatic does not mean that you do not need to know what is going on underneath with Docker.</span></span> <span data-ttu-id="47ca3-128">Nelle istruzioni che segue, è pertanto in dettaglio ogni passaggio.</span><span class="sxs-lookup"><span data-stu-id="47ca3-128">Therefore, in the guidance that follows, we detail every step.</span></span>

![](./media/image2.png)

## <a name="step-1-start-coding-and-create-your-initial-application-or-service-baseline"></a><span data-ttu-id="47ca3-129">Passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="47ca3-129">Step 1.</span></span> <span data-ttu-id="47ca3-130">Avviare la codifica e creare l'applicazione iniziale o una linea di base del servizio</span><span class="sxs-lookup"><span data-stu-id="47ca3-130">Start coding and create your initial application or service baseline</span></span>

<span data-ttu-id="47ca3-131">Sviluppo di un'applicazione di Docker è simile a quello che si sviluppa un'applicazione senza Docker.</span><span class="sxs-lookup"><span data-stu-id="47ca3-131">Developing a Docker application is similar to the way you develop an application without Docker.</span></span> <span data-ttu-id="47ca3-132">La differenza è che quando si sviluppa per Docker, si distribuisce e si verifica l'applicazione o i servizi in esecuzione all'interno di contenitori di Docker nell'ambiente locale.</span><span class="sxs-lookup"><span data-stu-id="47ca3-132">The difference is that while developing for Docker, you are deploying and testing your application or services running within Docker containers in your local environment.</span></span> <span data-ttu-id="47ca3-133">Il contenitore può essere un contenitore di Linux o un contenitore di Windows.</span><span class="sxs-lookup"><span data-stu-id="47ca3-133">The container can be either a Linux container or a Windows container.</span></span>

### <a name="set-up-your-local-environment-with-visual-studio"></a><span data-ttu-id="47ca3-134">Configurare l'ambiente locale con Visual Studio</span><span class="sxs-lookup"><span data-stu-id="47ca3-134">Set up your local environment with Visual Studio</span></span>

<span data-ttu-id="47ca3-135">Per iniziare, accertarsi di avere [Docker Community Edition (CE)](https://www.docker.com/community-edition) per Windows installato, come illustrato nelle istruzioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="47ca3-135">To begin, make sure you have [Docker Community Edition (CE)](https://www.docker.com/community-edition) for Windows installed, as explained in the following instructions:</span></span>

[<span data-ttu-id="47ca3-136">Introduzione a Docker CE per Windows</span><span class="sxs-lookup"><span data-stu-id="47ca3-136">Get started with Docker CE for Windows</span></span>](https://docs.docker.com/docker-for-windows/)

<span data-ttu-id="47ca3-137">Inoltre, è necessario Visual Studio 2017, che installata.</span><span class="sxs-lookup"><span data-stu-id="47ca3-137">In addition, you will need Visual Studio 2017 installed.</span></span> <span data-ttu-id="47ca3-138">Questo è preferibile Visual Studio 2015 con Visual Studio Tools per Docker aggiuntivo, poiché Visual Studio 2017 ha più supporto avanzato per Docker, come il supporto per il debug di contenitori.</span><span class="sxs-lookup"><span data-stu-id="47ca3-138">This is preferred over Visual Studio 2015 with the Visual Studio Tools for Docker add-in, because Visual Studio 2017 has more advanced support for Docker, like support for debugging containers.</span></span> <span data-ttu-id="47ca3-139">Visual Studio 2017 include gli strumenti per Docker se è stata selezionata la **.NET Core e Docker** carico di lavoro durante l'installazione, come illustrato nella figura 5-2.</span><span class="sxs-lookup"><span data-stu-id="47ca3-139">Visual Studio 2017 includes the tooling for Docker if you selected the **.NET Core and Docker** workload during installation, as shown in Figure 5-2.</span></span>

![](./media/image3.png)

<span data-ttu-id="47ca3-140">**Figura 5-2**.</span><span class="sxs-lookup"><span data-stu-id="47ca3-140">**Figure 5-2**.</span></span> <span data-ttu-id="47ca3-141">Selezione di **.NET Core e Docker** carico di lavoro durante l'installazione di Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="47ca3-141">Selecting the **.NET Core and Docker** workload during Visual Studio 2017 setup</span></span>

<span data-ttu-id="47ca3-142">È possibile avviare la generazione di codice dell'applicazione in .NET normale (in genere in .NET Core se si prevede di usare i contenitori) anche prima dell'abilitazione di Docker nell'applicazione e la distribuzione e test in Docker.</span><span class="sxs-lookup"><span data-stu-id="47ca3-142">You can start coding your application in plain .NET (usually in .NET Core if you are planning to use containers) even before enabling Docker in your application and deploying and testing in Docker.</span></span> <span data-ttu-id="47ca3-143">Tuttavia, è consigliabile iniziare lavorando Docker appena possibile, perché che sarà l'ambiente reale e di eventuali problemi possono essere individuati appena possibile.</span><span class="sxs-lookup"><span data-stu-id="47ca3-143">However, it is recommended that you start working on Docker as soon as possible, because that will be the real environment and any issues can be discovered as soon as possible.</span></span> <span data-ttu-id="47ca3-144">Questo è consigliabile in quanto Visual Studio rende più facile lavorare con Docker che quasi sembra trasparente, ad esempio durante il debug di applicazioni multi-contenitore da Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="47ca3-144">This is encouraged because Visual Studio makes it so easy to work with Docker that it almost feels transparent—the best example when debugging multi-container applications from Visual Studio.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="47ca3-145">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="47ca3-145">Additional resources</span></span>

-   <span data-ttu-id="47ca3-146">**Introduzione a Docker CE per Windows**
    [*https://docs.docker.com/docker-for-windows/*](https://docs.docker.com/docker-for-windows/)</span><span class="sxs-lookup"><span data-stu-id="47ca3-146">**Get started with Docker CE for Windows**
[*https://docs.docker.com/docker-for-windows/*](https://docs.docker.com/docker-for-windows/)</span></span>

-   <span data-ttu-id="47ca3-147">**Visual Studio 2017**
    [*https://www.visualstudio.com/vs/visual-studio-2017/*](https://www.visualstudio.com/vs/visual-studio-2017/)</span><span class="sxs-lookup"><span data-stu-id="47ca3-147">**Visual Studio 2017**
[*https://www.visualstudio.com/vs/visual-studio-2017/*](https://www.visualstudio.com/vs/visual-studio-2017/)</span></span>

![](./media/image4.png)

## <a name="step-2-create-a-dockerfile-related-to-an-existing-net-base-image"></a><span data-ttu-id="47ca3-148">Passaggio 2.</span><span class="sxs-lookup"><span data-stu-id="47ca3-148">Step 2.</span></span> <span data-ttu-id="47ca3-149">Creare un Dockerfile correlato a un'immagine di base .NET esistente</span><span class="sxs-lookup"><span data-stu-id="47ca3-149">Create a Dockerfile related to an existing .NET base image</span></span>

<span data-ttu-id="47ca3-150">È necessario un Dockerfile per ogni immagine personalizzata che si desidera compilare; è necessario un Dockerfile per ogni contenitore da distribuire, anche se vengono distribuiti automaticamente da Visual Studio oppure manualmente, utilizzando l'interfaccia CLI di Docker (esecuzione di docker e docker-comporre comandi).</span><span class="sxs-lookup"><span data-stu-id="47ca3-150">You need a Dockerfile for each custom image you want to build; you also need a Dockerfile for each container to be deployed, whether you deploy automatically from Visual Studio or manually using the Docker CLI (docker run and docker-compose commands).</span></span> <span data-ttu-id="47ca3-151">Se l'applicazione contiene un singolo servizio personalizzato, è necessario un Dockerfile singolo.</span><span class="sxs-lookup"><span data-stu-id="47ca3-151">If your application contains a single custom service, you need a single Dockerfile.</span></span> <span data-ttu-id="47ca3-152">Se l'applicazione contiene più servizi (come in un'architettura di microservizi), è necessario un Dockerfile per ogni servizio.</span><span class="sxs-lookup"><span data-stu-id="47ca3-152">If your application contains multiple services (as in a microservices architecture), you need one Dockerfile for each service.</span></span>

<span data-ttu-id="47ca3-153">Dockerfile viene inserito nella cartella radice dell'applicazione o del servizio.</span><span class="sxs-lookup"><span data-stu-id="47ca3-153">The Dockerfile is placed in the root folder of your application or service.</span></span> <span data-ttu-id="47ca3-154">Contiene i comandi che indicano come configurare ed eseguire l'applicazione o servizio in un contenitore di Docker.</span><span class="sxs-lookup"><span data-stu-id="47ca3-154">It contains the commands that tell Docker how to set up and run your application or service in a container.</span></span> <span data-ttu-id="47ca3-155">È possibile creare manualmente un Dockerfile nel codice e aggiungerlo al progetto e le dipendenze di .NET.</span><span class="sxs-lookup"><span data-stu-id="47ca3-155">You can manually create a Dockerfile in code and add it to your project along with your .NET dependencies.</span></span>

<span data-ttu-id="47ca3-156">Con Visual Studio e dei relativi strumenti di Docker, questa attività richiede solo pochi clic del mouse.</span><span class="sxs-lookup"><span data-stu-id="47ca3-156">With Visual Studio and its tools for Docker, this task requires only a few mouse clicks.</span></span> <span data-ttu-id="47ca3-157">Quando si crea un nuovo progetto in Visual Studio 2017, è disponibile un'opzione denominata **supporto contenitore abilitare (Docker)**, come illustrato nella figura 5-3.</span><span class="sxs-lookup"><span data-stu-id="47ca3-157">When you create a new project in Visual Studio 2017, there is an option named **Enable Container (Docker) Support**, as shown in Figure 5-3.</span></span>

![](./media/image5.png)

<span data-ttu-id="47ca3-158">**Figura 5-3**.</span><span class="sxs-lookup"><span data-stu-id="47ca3-158">**Figure 5-3**.</span></span> <span data-ttu-id="47ca3-159">Abilitazione del supporto di Docker quando si crea un nuovo progetto in Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="47ca3-159">Enabling Docker Support when creating a new project in Visual Studio 2017</span></span>

<span data-ttu-id="47ca3-160">È inoltre possibile abilitare il supporto di Docker in un progetto nuovo o esistente facendo clic sul file di progetto in Visual Studio e selezionando l'opzione **Aggiungi Docker progetto supporta**, come illustrato nella figura 5-4.</span><span class="sxs-lookup"><span data-stu-id="47ca3-160">You can also enable Docker support on a new or existing project by right-clicking your project file in Visual Studio and selecting the option **Add-Docker Project Support**, as shown in Figure 5-4.</span></span>

![](./media/image6.png)

<span data-ttu-id="47ca3-161">**Figura 5-4**.</span><span class="sxs-lookup"><span data-stu-id="47ca3-161">**Figure 5-4**.</span></span> <span data-ttu-id="47ca3-162">Abilitazione del supporto di Docker in un progetto di Visual Studio 2017 esistente</span><span class="sxs-lookup"><span data-stu-id="47ca3-162">Enabling Docker support in an existing Visual Studio 2017 project</span></span>

<span data-ttu-id="47ca3-163">Questa azione su un progetto (ad esempio, un'applicazione Web ASP.NET o un servizio Web API) aggiunge un Dockerfile per il progetto con la configurazione necessaria.</span><span class="sxs-lookup"><span data-stu-id="47ca3-163">This action on a project (like an ASP.NET Web application or Web API service) adds a Dockerfile to the project with the required configuration.</span></span> <span data-ttu-id="47ca3-164">Viene inoltre aggiunto un file di docker compose.yml per l'intera soluzione.</span><span class="sxs-lookup"><span data-stu-id="47ca3-164">It also adds a docker-compose.yml file for the whole solution.</span></span> <span data-ttu-id="47ca3-165">Nelle sezioni seguenti vengono descritte le informazioni da inserire in ciascuno di questi file.</span><span class="sxs-lookup"><span data-stu-id="47ca3-165">In the following sections, we describe the information that goes into each of those files.</span></span> <span data-ttu-id="47ca3-166">Visual Studio di eseguire questa operazione, ma è utile comprendere cosa deve essere posizionato in un Dockerfile.</span><span class="sxs-lookup"><span data-stu-id="47ca3-166">Visual Studio can do this work for you, but it is useful to understand what goes into a Dockerfile.</span></span>

### <a name="option-a-creating-a-project-using-an-existing-official-net-docker-image"></a><span data-ttu-id="47ca3-167">Opzione a: creazione di un progetto con un'immagine Docker .NET ufficiale esistente</span><span class="sxs-lookup"><span data-stu-id="47ca3-167">Option A: Creating a project using an existing official .NET Docker image</span></span>

<span data-ttu-id="47ca3-168">È in genere creare un'immagine personalizzata per il contenitore all'inizio di un'immagine di base è possibile ottenere da un repository ufficiale al [Hub Docker](https://hub.docker.com/) Registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="47ca3-168">You usually build a custom image for your container on top of a base image you can get from an official repository at the [Docker Hub](https://hub.docker.com/) registry.</span></span> <span data-ttu-id="47ca3-169">Che è esattamente ciò che accade dietro le quinte quando si abilita il supporto di Docker in Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="47ca3-169">That is precisely what happens under the covers when you enable Docker support in Visual Studio.</span></span> <span data-ttu-id="47ca3-170">Il Dockerfile utilizzerà un'immagine aspnetcore esistente.</span><span class="sxs-lookup"><span data-stu-id="47ca3-170">Your Dockerfile will use an existing aspnetcore image.</span></span>

<span data-ttu-id="47ca3-171">In precedenza spiegare le immagini Docker e il repository è possibile utilizzare, a seconda del framework e del sistema operativo scelto.</span><span class="sxs-lookup"><span data-stu-id="47ca3-171">Earlier we explained which Docker images and repos you can use, depending on the framework and OS you have chosen.</span></span> <span data-ttu-id="47ca3-172">Ad esempio, se si desidera utilizzare ASP.NET Core (Linux o Windows), l'immagine da utilizzare è microsoft / aspnetcore:2.0.</span><span class="sxs-lookup"><span data-stu-id="47ca3-172">For instance, if you want to use ASP.NET Core (Linux or Windows), the image to use is microsoft/aspnetcore:2.0.</span></span> <span data-ttu-id="47ca3-173">Pertanto, è sufficiente specificare quale immagine di Docker base da utilizzare per il contenitore.</span><span class="sxs-lookup"><span data-stu-id="47ca3-173">Therefore, you just need to specify what base Docker image you will use for your container.</span></span> <span data-ttu-id="47ca3-174">A tale scopo, l'aggiunta di da microsoft / aspnetcore:2.0 per i Dockerfile.</span><span class="sxs-lookup"><span data-stu-id="47ca3-174">You do that by adding FROM microsoft/aspnetcore:2.0 to your Dockerfile.</span></span> <span data-ttu-id="47ca3-175">Questo verrà eseguito automaticamente da Visual Studio, ma se fosse necessario aggiornare la versione, si aggiorna il valore.</span><span class="sxs-lookup"><span data-stu-id="47ca3-175">This will be automatically performed by Visual Studio, but if you were to update the version, you update this value.</span></span>

<span data-ttu-id="47ca3-176">L'utilizzo di un repository di immagini .NET ufficiale dall'Hub Docker con un numero di versione garantisce che la stessa funzionalità del linguaggio disponibili in tutti i computer (tra cui sviluppo, test e produzione).</span><span class="sxs-lookup"><span data-stu-id="47ca3-176">Using an official .NET image repository from Docker Hub with a version number ensures that the same language features are available on all machines (including development, testing, and production).</span></span>

<span data-ttu-id="47ca3-177">Nell'esempio seguente viene illustrato un esempio di Dockerfile per un contenitore di ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="47ca3-177">The following example shows a sample Dockerfile for an ASP.NET Core container.</span></span>

```
FROM microsoft/aspnetcore:2.0
  
ARG source
  
WORKDIR /app
  
EXPOSE 80
  
COPY ${source:-obj/Docker/publish} .
  
ENTRYPOINT ["dotnet", " MySingleContainerWebApp.dll "]
```

<span data-ttu-id="47ca3-178">In questo caso, il contenitore è basato sulla versione 2.0 dell'immagine di ASP.NET Core Docker ufficiale (multi-arch per Linux e Windows).</span><span class="sxs-lookup"><span data-stu-id="47ca3-178">In this case, the container is based on version 2.0 of the official ASP.NET Core Docker image (multi-arch for Linux and Windows).</span></span> <span data-ttu-id="47ca3-179">Si tratta dell'impostazione `FROM microsoft/aspnetcore:2.0`.</span><span class="sxs-lookup"><span data-stu-id="47ca3-179">This is the setting `FROM microsoft/aspnetcore:2.0`.</span></span> <span data-ttu-id="47ca3-180">(Per ulteriori informazioni su questa immagine di base, vedere il [ASP.NET Core Docker immagine](https://hub.docker.com/r/microsoft/aspnetcore/) pagina e [.NET Core Docker immagine](https://hub.docker.com/r/microsoft/dotnet/) pagina.) Nel documento Dockerfile, è necessario anche indicano a Docker in ascolto sulla porta TCP che verrà utilizzato in fase di esecuzione (in questo caso, la porta 80, come configurato con l'impostazione di ESPORRE).</span><span class="sxs-lookup"><span data-stu-id="47ca3-180">(For further details about this base image, see the [ASP.NET Core Docker Image](https://hub.docker.com/r/microsoft/aspnetcore/) page and the [.NET Core Docker Image](https://hub.docker.com/r/microsoft/dotnet/) page.) In the Dockerfile, you also need to instruct Docker to listen on the TCP port you will use at runtime (in this case, port 80, as configured with the EXPOSE setting).</span></span>

<span data-ttu-id="47ca3-181">È possibile specificare ulteriori impostazioni di configurazione in Dockerfile, a seconda del linguaggio e il framework in uso.</span><span class="sxs-lookup"><span data-stu-id="47ca3-181">You can specify additional configuration settings in the Dockerfile, depending on the language and framework you are using.</span></span> <span data-ttu-id="47ca3-182">Ad esempio, la riga del punto di ingresso con \["dotnet", "MySingleContainerWebApp.dll"\] indica Docker per eseguire un'applicazione .NET Core.</span><span class="sxs-lookup"><span data-stu-id="47ca3-182">For instance, the ENTRYPOINT line with \["dotnet", "MySingleContainerWebApp.dll"\] tells Docker to run a .NET Core application.</span></span> <span data-ttu-id="47ca3-183">Se si utilizza il SDK e .NET Core CLI (dotnet CLI) per compilare ed eseguire l'applicazione .NET, questa impostazione potrebbe essere diversa.</span><span class="sxs-lookup"><span data-stu-id="47ca3-183">If you are using the SDK and the .NET Core CLI (dotnet CLI) to build and run the .NET application, this setting would be different.</span></span> <span data-ttu-id="47ca3-184">La riga inferiore è che la riga del punto di ingresso e altre impostazioni saranno diverse a seconda della lingua e la piattaforma che scelto per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="47ca3-184">The bottom line is that the ENTRYPOINT line and other settings will be different depending on the language and platform you choose for your application.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="47ca3-185">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="47ca3-185">Additional resources</span></span>

-   <span data-ttu-id="47ca3-186">**Creazione di immagini Docker per le applicazioni .NET Core**
    [*https://docs.microsoft.com/dotnet/core/docker/building-net-docker-images*](https://docs.microsoft.com/dotnet/core/docker/building-net-docker-images)</span><span class="sxs-lookup"><span data-stu-id="47ca3-186">**Building Docker Images for .NET Core Applications**
[*https://docs.microsoft.com/dotnet/core/docker/building-net-docker-images*](https://docs.microsoft.com/dotnet/core/docker/building-net-docker-images)</span></span>

-   <span data-ttu-id="47ca3-187">**Compilare la propria immagine**.</span><span class="sxs-lookup"><span data-stu-id="47ca3-187">**Build your own image**.</span></span> <span data-ttu-id="47ca3-188">Nella documentazione ufficiale di Docker.</span><span class="sxs-lookup"><span data-stu-id="47ca3-188">In the official Docker documentation.</span></span>
    [<span data-ttu-id="47ca3-189">*https://docs.docker.com/Engine/tutorials/dockerimages/*</span><span class="sxs-lookup"><span data-stu-id="47ca3-189">*https://docs.docker.com/engine/tutorials/dockerimages/*</span></span>](https://docs.docker.com/engine/tutorials/dockerimages/)

### <a name="using-multi-arch-image-repositories"></a><span data-ttu-id="47ca3-190">Utilizzando repository più arch immagine</span><span class="sxs-lookup"><span data-stu-id="47ca3-190">Using multi-arch image repositories</span></span>

<span data-ttu-id="47ca3-191">Un singolo repository può contenere le varianti della piattaforma, ad esempio un'immagine Linux e un'immagine di Windows.</span><span class="sxs-lookup"><span data-stu-id="47ca3-191">A single repo can contain platform variants, such as a Linux image and a Windows image.</span></span> <span data-ttu-id="47ca3-192">Questa funzionalità consente ai fornitori come Microsoft (creatori di immagine di base) creare un unico repository per coprire più piattaforme (ad esempio Linux e Windows).</span><span class="sxs-lookup"><span data-stu-id="47ca3-192">This feature allows vendors like Microsoft (base image creators) to create a single repo to cover multiple platforms (that is Linux and Windows).</span></span> <span data-ttu-id="47ca3-193">Ad esempio, il [microsoft/dotnet](https://hub.docker.com/r/microsoft/aspnetcore/) repository disponibile nel Registro di sistema Hub Docker offre supporto per Linux e Windows Nano Server con lo stesso nome di repository.</span><span class="sxs-lookup"><span data-stu-id="47ca3-193">For example, the [microsoft/dotnet](https://hub.docker.com/r/microsoft/aspnetcore/) repository available in the Docker Hub registry provides support for Linux and Windows Nano Server by using the same repo name.</span></span>

<span data-ttu-id="47ca3-194">Se si specifica un tag, una piattaforma esplicita come nei casi seguenti:</span><span class="sxs-lookup"><span data-stu-id="47ca3-194">If you specify a tag, targeting a platform that is explicit like in the following cases:</span></span>

-   <span data-ttu-id="47ca3-195">**Microsoft/aspnetcore:2.0.0-jessie**</span><span class="sxs-lookup"><span data-stu-id="47ca3-195">**microsoft/aspnetcore:2.0.0-jessie**</span></span>

        .NET Core 2.0 runtime-only on Linux 

-   <span data-ttu-id="47ca3-196">**Microsoft/aspnetcore:2.0.0-nanoserver**</span><span class="sxs-lookup"><span data-stu-id="47ca3-196">**microsoft/aspnetcore:2.0.0-nanoserver**</span></span>

        .NET Core 2.0 runtime-only on Windows Nano Server

<span data-ttu-id="47ca3-197">Ma e questo è nuovo dal mid 2017, se si specifica il nome dell'immagine stessa, anche con lo stesso tag, le nuove immagini multi-arch (ad esempio, l'immagine di aspnetcore che supporta multi-arch) utilizzerà la versione di Linux o Windows in base all'host Docker del sistema operativo si sta distribuendo , come illustrato nell'esempio seguente:</span><span class="sxs-lookup"><span data-stu-id="47ca3-197">But, and this is new since mid-2017, if you specify the same image name, even with the same tag, the new multi-arch images (like the aspnetcore image which supports multi-arch) will use the Linux or Windows version depending on the Docker host OS you are deploying, as shown in the following example:</span></span>

-   <span data-ttu-id="47ca3-198">**Microsoft / aspnetcore:2.0**</span><span class="sxs-lookup"><span data-stu-id="47ca3-198">**microsoft/aspnetcore:2.0**</span></span>

        Multi-arch: .NET Core 2.0 runtime-only on Linux or Windows Nano Server depending on the Docker host OS

<span data-ttu-id="47ca3-199">In questo modo, quando è effettuare il pull di un'immagine da un host di Windows, effettuerà il pull la variante di Windows e lo stesso nome di immagine il pull da un host Linux estrarrà la variante Linux.</span><span class="sxs-lookup"><span data-stu-id="47ca3-199">This way, when you pull an image from a Windows host, it will pull the Windows variant, and pulling the same image name from a Linux host will pull the Linux variant.</span></span>

### <a name="option-b-creating-your-base-image-from-scratch"></a><span data-ttu-id="47ca3-200">Opzione b: creazione dell'immagine di base da zero</span><span class="sxs-lookup"><span data-stu-id="47ca3-200">Option B: Creating your base image from scratch</span></span>

<span data-ttu-id="47ca3-201">È possibile creare la propria immagine di base di Docker da zero.</span><span class="sxs-lookup"><span data-stu-id="47ca3-201">You can create your own Docker base image from scratch.</span></span> <span data-ttu-id="47ca3-202">Questo scenario non è consigliato per un utente che si avvii con Docker, ma se si desidera impostare i bit specifici della propria immagine di base, è possibile farlo.</span><span class="sxs-lookup"><span data-stu-id="47ca3-202">This scenario is not recommended for someone who is starting with Docker, but if you want to set the specific bits of your own base image, you can do so.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="47ca3-203">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="47ca3-203">Additional resources</span></span>

-   <span data-ttu-id="47ca3-204">**Archiviazione più immagini di .NET Core**.</span><span class="sxs-lookup"><span data-stu-id="47ca3-204">**Multi-arch .NET Core images**.</span></span>
<span data-ttu-id="47ca3-205">https://github.com/dotnet/Announcements/issues/14</span><span class="sxs-lookup"><span data-stu-id="47ca3-205">https://github.com/dotnet/announcements/issues/14</span></span> 
-   <span data-ttu-id="47ca3-206">**Creare un'immagine di base**.</span><span class="sxs-lookup"><span data-stu-id="47ca3-206">**Create a base image**.</span></span> <span data-ttu-id="47ca3-207">Documentazione ufficiale di Docker.</span><span class="sxs-lookup"><span data-stu-id="47ca3-207">Official Docker documentation.</span></span>
    [<span data-ttu-id="47ca3-208">*https://docs.docker.com/Engine/UserGuide/ENG-Image/BaseImages/*</span><span class="sxs-lookup"><span data-stu-id="47ca3-208">*https://docs.docker.com/engine/userguide/eng-image/baseimages/*</span></span>](https://docs.docker.com/engine/userguide/eng-image/baseimages/)

![](./media/image7.png)

## <a name="step-3-create-your-custom-docker-images-and-embed-your-application-or-service-in-them"></a><span data-ttu-id="47ca3-209">Passaggio 3.</span><span class="sxs-lookup"><span data-stu-id="47ca3-209">Step 3.</span></span> <span data-ttu-id="47ca3-210">Creare immagini personalizzate Docker e incorporare l'applicazione o servizio in essi contenuti</span><span class="sxs-lookup"><span data-stu-id="47ca3-210">Create your custom Docker images and embed your application or service in them</span></span>

<span data-ttu-id="47ca3-211">Per ogni servizio dell'applicazione, è necessario creare un'immagine correlata.</span><span class="sxs-lookup"><span data-stu-id="47ca3-211">For each service in your application, you need to create a related image.</span></span> <span data-ttu-id="47ca3-212">Se l'applicazione è costituito da un singolo servizio o applicazione web, è sufficiente una singola immagine.</span><span class="sxs-lookup"><span data-stu-id="47ca3-212">If your application is made up of a single service or web application, you just need a single image.</span></span>

<span data-ttu-id="47ca3-213">Si noti che le immagini Docker vengono create automaticamente per l'utente in Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="47ca3-213">Note that the Docker images are built automatically for you in Visual Studio.</span></span> <span data-ttu-id="47ca3-214">I passaggi seguenti sono solo necessaria per il flusso di lavoro editor/CLI e descritto per maggiore chiarezza su ciò che accade sotto.</span><span class="sxs-lookup"><span data-stu-id="47ca3-214">The following steps are only needed for the editor/CLI workflow and explained for clarity about what happens underneath.</span></span>

<span data-ttu-id="47ca3-215">È, lo sviluppatore di necessario sviluppare e testare localmente finché non si esegue il push e compilato funzionalità o modificare al sistema di controllo del codice sorgente (ad esempio, per GitHub).</span><span class="sxs-lookup"><span data-stu-id="47ca3-215">You, as developer, need to develop and test locally until you push a completed feature or change to your source control system (for example, to GitHub).</span></span> <span data-ttu-id="47ca3-216">Ciò significa che è necessario per le immagini Docker di creare e distribuire i contenitori in un host Docker locale (Windows o Linux VM) ed eseguire, testare e il debug in tali contenitori locale.</span><span class="sxs-lookup"><span data-stu-id="47ca3-216">This means that you need to create the Docker images and deploy containers to a local Docker host (Windows or Linux VM) and run, test, and debug against those local containers.</span></span>

<span data-ttu-id="47ca3-217">Per creare un'immagine personalizzata nell'ambiente locale tramite Docker CLI e il Dockerfile, è possibile utilizzare il comando di compilazione docker, come illustrato nella figura 5-5.</span><span class="sxs-lookup"><span data-stu-id="47ca3-217">To create a custom image in your local environment by using Docker CLI and your Dockerfile, you can use the docker build command, as in Figure 5-5.</span></span>

![](./media/image8.png)

<span data-ttu-id="47ca3-218">**Figura 5-5**.</span><span class="sxs-lookup"><span data-stu-id="47ca3-218">**Figure 5-5**.</span></span> <span data-ttu-id="47ca3-219">Creazione di un'immagine Docker personalizzata</span><span class="sxs-lookup"><span data-stu-id="47ca3-219">Creating a custom Docker image</span></span>

<span data-ttu-id="47ca3-220">Facoltativamente, anziché eseguire direttamente la compilazione docker dalla cartella del progetto, è innanzitutto possibile generare una cartella distribuibile con le librerie .NET necessarie e i file binari eseguendo dotnet pubblicano e quindi utilizzano il comando di compilazione docker.</span><span class="sxs-lookup"><span data-stu-id="47ca3-220">Optionally, instead of directly running docker build from the project folder, you can first generate a deployable folder with the required .NET libraries and binaries by running dotnet publish, and then use the docker build command.</span></span>

<span data-ttu-id="47ca3-221">Si creerà un'immagine di Docker con il nome cesardl/netcore-webapi-microservizio-: prima di docker.</span><span class="sxs-lookup"><span data-stu-id="47ca3-221">This will create a Docker image with the name cesardl/netcore-webapi-microservice-docker:first.</span></span> <span data-ttu-id="47ca3-222">In questo caso,: per primo è un tag che rappresenta una versione specifica.</span><span class="sxs-lookup"><span data-stu-id="47ca3-222">In this case, :first is a tag representing a specific version.</span></span> <span data-ttu-id="47ca3-223">È possibile ripetere questo passaggio per ogni immagine personalizzata, che è necessario creare per l'applicazione di Docker composto.</span><span class="sxs-lookup"><span data-stu-id="47ca3-223">You can repeat this step for each custom image you need to create for your composed Docker application.</span></span>

<span data-ttu-id="47ca3-224">Quando un'applicazione è costituita da più contenitori (ovvero, è un'applicazione multi-contenitore), è inoltre possibile utilizzare il comporre docker backup - comando di compilazione per compilare tutte le immagini correlate con un singolo comando con i metadati esposti nell'oggetto correlato. file compose.yml di docker.</span><span class="sxs-lookup"><span data-stu-id="47ca3-224">When an application is made of multiple containers (that is, it is a multi-container application), you can also use the docker-compose up --build command to build all the related images with a single command by using the metadata exposed in the related docker-compose.yml files.</span></span>

<span data-ttu-id="47ca3-225">È possibile trovare immagini esistenti nel repository locale tramite docker immagini comando, come illustrato nella figura 5-6.</span><span class="sxs-lookup"><span data-stu-id="47ca3-225">You can find the existing images in your local repository by using the docker images command, as shown in Figure 5-6.</span></span>

![](./media/image9.png)

<span data-ttu-id="47ca3-226">**Figura 5-6.**</span><span class="sxs-lookup"><span data-stu-id="47ca3-226">**Figure 5-6.**</span></span> <span data-ttu-id="47ca3-227">Visualizzazione di immagini esistente utilizzando il comando di immagini docker</span><span class="sxs-lookup"><span data-stu-id="47ca3-227">Viewing existing images using the docker images command</span></span>

### <a name="creating-docker-images-with-visual-studio"></a><span data-ttu-id="47ca3-228">La creazione di immagini Docker con Visual Studio</span><span class="sxs-lookup"><span data-stu-id="47ca3-228">Creating Docker images with Visual Studio</span></span>

<span data-ttu-id="47ca3-229">Quando si utilizza Visual Studio per creare un progetto con il supporto di Docker, non creare un'immagine in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="47ca3-229">When you are using Visual Studio to create a project with Docker support, you do not explicitly create an image.</span></span> <span data-ttu-id="47ca3-230">L'immagine viene invece creata automaticamente quando si premere F5 e si esegue l'applicazione dockerized o il servizio.</span><span class="sxs-lookup"><span data-stu-id="47ca3-230">Instead, the image is created for you when you press F5 and run the dockerized application or service.</span></span> <span data-ttu-id="47ca3-231">Questo passaggio è automatico in Visual Studio e non verrà visualizzato il verificarsi, ma è importante conoscere cosa accade in sotto.</span><span class="sxs-lookup"><span data-stu-id="47ca3-231">This step is automatic in Visual Studio, and you will not see it happen, but it is important that you know what is going on underneath.</span></span>

![](./media/image10.png)

## <a name="step-4-define-your-services-in-docker-composeyml-when-building-a-multi-container-docker-application"></a><span data-ttu-id="47ca3-232">Passaggio 4.</span><span class="sxs-lookup"><span data-stu-id="47ca3-232">Step 4.</span></span> <span data-ttu-id="47ca3-233">Definire i servizi in docker compose.yml quando si compila un'applicazione di multi-contenitore Docker</span><span class="sxs-lookup"><span data-stu-id="47ca3-233">Define your services in docker-compose.yml when building a multi-container Docker application</span></span>

<span data-ttu-id="47ca3-234">Il [docker compose.yml](https://docs.docker.com/compose/compose-file/) file consente di definire un set di servizi correlati da distribuire come un'applicazione composta con i comandi di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="47ca3-234">The [docker-compose.yml](https://docs.docker.com/compose/compose-file/) file lets you define a set of related services to be deployed as a composed application with deployment commands.</span></span>

<span data-ttu-id="47ca3-235">Per utilizzare un file docker compose.yml, è necessario creare il file principale o la cartella soluzione radice con contenuto simile a quello nell'esempio seguente:</span><span class="sxs-lookup"><span data-stu-id="47ca3-235">To use a docker-compose.yml file, you need to create the file in your main or root solution folder, with content similar to that in the following example:</span></span>

```yml
version: '3'
  
services:

  webmvc:
    image: eshop/web
    environment:
      - CatalogUrl=http://catalog.api
      - OrderingUrl=http://ordering.api
    ports:
      - "80:80"
    depends_on:
      - catalog.api
      - ordering.api

  catalog.api:
    image: eshop/catalog.api
    environment: 
      - ConnectionString=Server=sql.data;Database=CatalogDB;…
    ports:
      - "81:80"
    depends_on:
      - sql.data

  ordering.api:
    image: eshop/ordering.api
    environment:
      - ConnectionString=Server=sql.data;Database=OrderingDb;…
    ports:
      - "82:80"
    extra_hosts:
      - "CESARDLBOOKVHD:10.0.75.1"
    depends_on:
      - sql.data

  sql.data:
    image: mssql-server-linux:latest
    environment:
      - SA_PASSWORD=Pass@word
      - ACCEPT_EULA=Y
    ports:
      - "5433:1433"

```

<span data-ttu-id="47ca3-236">Si noti che questo file compose.yml di docker è una versione semplificata e di merge.</span><span class="sxs-lookup"><span data-stu-id="47ca3-236">Note that this docker-compose.yml file is a simplified and merged version.</span></span> <span data-ttu-id="47ca3-237">Contiene dati di configurazione statico per ogni contenitore (ad esempio, il nome dell'immagine personalizzata), che viene sempre applicato, nonché le informazioni di configurazione che potrebbero dipendere dall'ambiente di distribuzione, ad esempio la stringa di connessione.</span><span class="sxs-lookup"><span data-stu-id="47ca3-237">It contains static configuration data for each container (like the name of the custom image), which always applies, plus configuration information that might depend on the deployment environment, like the connection string.</span></span> <span data-ttu-id="47ca3-238">Nelle sezioni successive verrà illustrato come è possibile suddividere la configurazione di docker compose.yml in più docker comporre i file e i valori di sostituzione a seconda del tipo di ambiente e l'esecuzione (debug o release).</span><span class="sxs-lookup"><span data-stu-id="47ca3-238">In later sections, you will learn how you can split the docker-compose.yml configuration into multiple docker-compose files and override values depending on the environment and execution type (debug or release).</span></span>

<span data-ttu-id="47ca3-239">Nell'esempio di file docker compose.yml definisce cinque servizi: il servizio webmvc (un'applicazione web), due microservizi (catalog.api e ordering.api) e dati di un contenitore di origine, sql.data, basata su SQL Server per Linux in esecuzione come un contenitore.</span><span class="sxs-lookup"><span data-stu-id="47ca3-239">The docker-compose.yml file example defines five services: the webmvc service (a web application), two microservices (catalog.api and ordering.api), and one data source container, sql.data, based on SQL Server for Linux running as a container.</span></span> <span data-ttu-id="47ca3-240">Ogni servizio viene distribuito come un contenitore, quindi un'immagine di Docker è necessaria per ogni.</span><span class="sxs-lookup"><span data-stu-id="47ca3-240">Each service is deployed as a container, so a Docker image is required for each.</span></span>

<span data-ttu-id="47ca3-241">Il file docker compose.yml specifica non solo i contenitori vengono utilizzati, ma la loro configurazione singolarmente.</span><span class="sxs-lookup"><span data-stu-id="47ca3-241">The docker-compose.yml file specifies not only what containers are being used, but how they are individually configured.</span></span> <span data-ttu-id="47ca3-242">Ad esempio, la webmvc contenitore definizione nel file .yml:</span><span class="sxs-lookup"><span data-stu-id="47ca3-242">For instance, the webmvc container definition in the .yml file:</span></span>

-   <span data-ttu-id="47ca3-243">Usa un eshop preesistente / immagine web: più di recente.</span><span class="sxs-lookup"><span data-stu-id="47ca3-243">Uses a pre-built eshop/web:latest image.</span></span> <span data-ttu-id="47ca3-244">Tuttavia, è inoltre possibile configurare l'immagine per essere compilato come parte di comporre docker esecuzione con una configurazione aggiuntiva in base a una compilazione: sezione nel file docker-compose.</span><span class="sxs-lookup"><span data-stu-id="47ca3-244">However, you could also configure the image to be built as part of the docker-compose execution with an additional configuration based on a build: section in the docker-compose file.</span></span>

-   <span data-ttu-id="47ca3-245">Inizializza le due variabili di ambiente (CatalogUrl e OrderingUrl).</span><span class="sxs-lookup"><span data-stu-id="47ca3-245">Initializes two environment variables (CatalogUrl and OrderingUrl).</span></span>

-   <span data-ttu-id="47ca3-246">Inoltra la porta 80 sul contenitore per la porta esterna 80 sul computer host esposta.</span><span class="sxs-lookup"><span data-stu-id="47ca3-246">Forwards the exposed port 80 on the container to the external port 80 on the host machine.</span></span>

-   <span data-ttu-id="47ca3-247">Collega l'app web per il catalogo e l'ordine di servizio con il dipende\_impostazione.</span><span class="sxs-lookup"><span data-stu-id="47ca3-247">Links the web app to the catalog and ordering service with the depends\_on setting.</span></span> <span data-ttu-id="47ca3-248">In questo modo il servizio di attesa fino a quando non vengono avviati i servizi.</span><span class="sxs-lookup"><span data-stu-id="47ca3-248">This causes the service to wait until those services are started.</span></span>

<span data-ttu-id="47ca3-249">Il file docker compose.yml in una sezione successiva verranno presentati quando trattati come implementare microservizi e App multi-contenitore.</span><span class="sxs-lookup"><span data-stu-id="47ca3-249">We will revisit the docker-compose.yml file in a later section when we cover how to implement microservices and multi-container apps.</span></span>

### <a name="working-with-docker-composeyml-in-visual-studio-2017"></a><span data-ttu-id="47ca3-250">Utilizzo di docker-compose.yml in Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="47ca3-250">Working with docker-compose.yml in Visual Studio 2017</span></span>

<span data-ttu-id="47ca3-251">Quando si aggiunge il supporto di soluzioni di Docker in un progetto di servizio in una soluzione di Visual Studio, come illustrato nella figura 5-7, Visual Studio aggiunge al progetto un Dockerfile e aggiunge una sezione di servizio (progetto) nella soluzione con i file compose.yml di docker.</span><span class="sxs-lookup"><span data-stu-id="47ca3-251">When you add Docker solution support to a service project in a Visual Studio solution, as shown in Figure 5-7, Visual Studio adds a Dockerfile to your project, and it adds a service section (project) in your solution with the docker-compose.yml files.</span></span> <span data-ttu-id="47ca3-252">È un modo semplice per avviare la soluzione più contenitori di composizione.</span><span class="sxs-lookup"><span data-stu-id="47ca3-252">It is an easy way to start composing your multiple-container solution.</span></span> <span data-ttu-id="47ca3-253">È quindi possibile aprire i file di docker compose.yml e aggiornarli con funzionalità aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="47ca3-253">You can then open the docker-compose.yml files and update them with additional features.</span></span>

![](./media/image6.png)

<span data-ttu-id="47ca3-254">**Figura 5-7**.</span><span class="sxs-lookup"><span data-stu-id="47ca3-254">**Figure 5-7**.</span></span> <span data-ttu-id="47ca3-255">Aggiunta del supporto di Docker in Visual Studio 2017 facendo clic su un progetto ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="47ca3-255">Adding Docker support in Visual Studio 2017 by right-clicking an ASP.NET Core project</span></span>

<span data-ttu-id="47ca3-256">Aggiunta del supporto di Docker in Visual Studio non solo Dockerfile vengono aggiunti al progetto, ma aggiunge le informazioni di configurazione a più file docker-compose.yml globali che vengono impostati a livello di soluzione.</span><span class="sxs-lookup"><span data-stu-id="47ca3-256">Adding Docker support in Visual Studio not only adds the Dockerfile to your project, but adds the configuration information to several global docker-compose.yml files that are set at the solution level.</span></span>

<span data-ttu-id="47ca3-257">Dopo aver aggiunto il supporto di Docker per la soluzione in Visual Studio, si noterà anche un nuovo nodo (nel file di progetto di docker compose.dcproj) in Esplora soluzioni che contiene i file di docker-compose.yml aggiunto, come illustrato nella figura 5-8.</span><span class="sxs-lookup"><span data-stu-id="47ca3-257">After you add Docker support to your solution in Visual Studio, you will also see a new node (in the docker-compose.dcproj project file) in Solution Explorer that contains the added docker-compose.yml files, as shown in Figure 5-8.</span></span>

![](./media/image11.PNG)

<span data-ttu-id="47ca3-258">**Figura 5-8**.</span><span class="sxs-lookup"><span data-stu-id="47ca3-258">**Figure 5-8**.</span></span> <span data-ttu-id="47ca3-259">Il **comporre docker** nodo dell'albero aggiunto in Esplora soluzioni di Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="47ca3-259">The **docker-compose** tree node added in Visual Studio 2017 Solution Explorer</span></span>

<span data-ttu-id="47ca3-260">È possibile distribuire un'applicazione multi-contenitore con un file docker-compose.yml singolo utilizzando la composizione docker il comando.</span><span class="sxs-lookup"><span data-stu-id="47ca3-260">You could deploy a multi-container application with a single docker-compose.yml file by using the docker-compose up command.</span></span> <span data-ttu-id="47ca3-261">Tuttavia, Visual Studio aggiunge un gruppo di elementi, è possibile eseguire l'override di valori a seconda dell'ambiente (sviluppo e produzione) e l'esecuzione tipo (release e debug).</span><span class="sxs-lookup"><span data-stu-id="47ca3-261">However, Visual Studio adds a group of them so you can override values depending on the environment (development versus production) and execution type (release versus debug).</span></span> <span data-ttu-id="47ca3-262">Questa funzionalità verrà spiegata nelle sezioni successive.</span><span class="sxs-lookup"><span data-stu-id="47ca3-262">This capability will be explained in later sections.</span></span>

![](./media/image12.png)

## <a name="step-5-build-and-run-your-docker-application"></a><span data-ttu-id="47ca3-263">Passaggio 5.</span><span class="sxs-lookup"><span data-stu-id="47ca3-263">Step 5.</span></span> <span data-ttu-id="47ca3-264">Compilare ed eseguire l'applicazione di Docker</span><span class="sxs-lookup"><span data-stu-id="47ca3-264">Build and run your Docker application</span></span>

<span data-ttu-id="47ca3-265">Se l'applicazione dispone solo di un singolo contenitore, è possibile eseguirlo distribuendola all'host Docker (macchina virtuale o server fisico).</span><span class="sxs-lookup"><span data-stu-id="47ca3-265">If your application only has a single container, you can run it by deploying it to your Docker host (VM or physical server).</span></span> <span data-ttu-id="47ca3-266">Tuttavia, se l'applicazione contiene più servizi, è possibile distribuirlo come un'applicazione composta, utilizzando un unico comando CLI (docker-Scrivi backup), o con Visual Studio, che verrà utilizzato il comando dietro le quinte.</span><span class="sxs-lookup"><span data-stu-id="47ca3-266">However, if your application contains multiple services, you can deploy it as a composed application, either using a single CLI command (docker-compose up), or with Visual Studio, which will use that command under the covers.</span></span> <span data-ttu-id="47ca3-267">Esaminare le diverse opzioni.</span><span class="sxs-lookup"><span data-stu-id="47ca3-267">Let’s look at the different options.</span></span>

### <a name="option-a-running-a-single-container-with-docker-cli"></a><span data-ttu-id="47ca3-268">Opzione a: esecuzione di un singolo contenitore con Docker CLI</span><span class="sxs-lookup"><span data-stu-id="47ca3-268">Option A: Running a single-container with Docker CLI</span></span>

<span data-ttu-id="47ca3-269">È possibile eseguire un contenitore Docker usando il comando docker run, come illustrato nella figura 5-9:</span><span class="sxs-lookup"><span data-stu-id="47ca3-269">You can run a Docker container using the docker run command, as in Figure 5-9:</span></span>

```
  docker run -t -d -p 80:5000 cesardl/netcore-webapi-microservice-docker:first
```

![](./media/image13.png)

<span data-ttu-id="47ca3-270">**Figura 5-9**.</span><span class="sxs-lookup"><span data-stu-id="47ca3-270">**Figure 5-9**.</span></span> <span data-ttu-id="47ca3-271">Esecuzione di un contenitore Docker usando il comando docker run</span><span class="sxs-lookup"><span data-stu-id="47ca3-271">Running a Docker container using the docker run command</span></span>

<span data-ttu-id="47ca3-272">In questo caso, il comando associa la porta interna 5000 del contenitore alla porta 80 del computer host.</span><span class="sxs-lookup"><span data-stu-id="47ca3-272">In this case, the command binds the internal port 5000 of the container to port 80 of the host machine.</span></span> <span data-ttu-id="47ca3-273">Ciò significa che l'host è in ascolto sulla porta 80 e con inoltro alla porta 5000 nel contenitore.</span><span class="sxs-lookup"><span data-stu-id="47ca3-273">This means that the host is listening on port 80 and forwarding to port 5000 on the container.</span></span>

### <a name="option-b-running-a-multi-container-application"></a><span data-ttu-id="47ca3-274">Opzione b: esecuzione di un'applicazione multi-contenitore</span><span class="sxs-lookup"><span data-stu-id="47ca3-274">Option B: Running a multi-container application</span></span>

<span data-ttu-id="47ca3-275">Nella maggior parte degli scenari aziendali, un'applicazione di Docker verrà essere composta da più servizi, ovvero che è necessario eseguire un'applicazione multi-contenitore, come illustrato nella figura 5-10.</span><span class="sxs-lookup"><span data-stu-id="47ca3-275">In most enterprise scenarios, a Docker application will be composed of multiple services, which means you need to run a multi-container application, as shown in Figure 5-10.</span></span>

![](./media/image14.png)

<span data-ttu-id="47ca3-276">**Figura 5-10**.</span><span class="sxs-lookup"><span data-stu-id="47ca3-276">**Figure 5-10**.</span></span> <span data-ttu-id="47ca3-277">Macchina virtuale con i contenitori di Docker distribuito</span><span class="sxs-lookup"><span data-stu-id="47ca3-277">VM with Docker containers deployed</span></span>

#### <a name="running-a-multi-container-application-with-the-docker-cli"></a><span data-ttu-id="47ca3-278">Esecuzione di un'applicazione multi-contenitore con l'interfaccia CLI di Docker</span><span class="sxs-lookup"><span data-stu-id="47ca3-278">Running a multi-container application with the Docker CLI</span></span>

<span data-ttu-id="47ca3-279">Per eseguire un'applicazione multi-contenitore con l'interfaccia CLI di Docker, è possibile eseguire docker-comporre il comando.</span><span class="sxs-lookup"><span data-stu-id="47ca3-279">To run a multi-container application with the Docker CLI, you can run the docker-compose up command.</span></span> <span data-ttu-id="47ca3-280">Questo file di comando utilizza il compose.yml di docker è a livello di soluzione per distribuire un'applicazione multi-contenitore.</span><span class="sxs-lookup"><span data-stu-id="47ca3-280">This command uses the docker-compose.yml file that you have at the solution level to deploy a multi-container application.</span></span> <span data-ttu-id="47ca3-281">Figura 5-11 Mostra i risultati quando si esegue il comando dalla directory del progetto principale, che contiene il file compose.yml di docker.</span><span class="sxs-lookup"><span data-stu-id="47ca3-281">Figure 5-11 shows the results when running the command from your main project directory, which contains the docker-compose.yml file.</span></span>

![](./media/image15.png)

<span data-ttu-id="47ca3-282">**Figura 5-11**.</span><span class="sxs-lookup"><span data-stu-id="47ca3-282">**Figure 5-11**.</span></span> <span data-ttu-id="47ca3-283">Esempio risultati quando si esegue la composizione docker il comando</span><span class="sxs-lookup"><span data-stu-id="47ca3-283">Example results when running the docker-compose up command</span></span>

<span data-ttu-id="47ca3-284">Dopo aver docker-comporre di esecuzione del comando, l'applicazione e i relativi contenitori correlati vengono distribuite in host Docker, come illustrato nella figura 5-10 rappresentazione macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="47ca3-284">After the docker-compose up command runs, the application and its related containers are deployed into your Docker host, as illustrated in the VM representation in Figure 5-10.</span></span>

#### <a name="running-and-debugging-a-multi-container-application-with-visual-studio"></a><span data-ttu-id="47ca3-285">Esecuzione e il debug di un'applicazione multi-contenitore con Visual Studio</span><span class="sxs-lookup"><span data-stu-id="47ca3-285">Running and debugging a multi-container application with Visual Studio</span></span> 

<span data-ttu-id="47ca3-286">Esecuzione di un'applicazione multi-contenitore utilizzando Visual Studio 2017 non è possibile ottenere più semplice.</span><span class="sxs-lookup"><span data-stu-id="47ca3-286">Running a multi-container application using Visual Studio 2017 cannot get simpler.</span></span> <span data-ttu-id="47ca3-287">Non è possibile eseguire solo l'applicazione multi-contenitore, ma si è in grado di eseguire il debug di tutti i relativi contenitori direttamente da Visual Studio impostando punti di interruzione normale.</span><span class="sxs-lookup"><span data-stu-id="47ca3-287">You can not only run the multi-container application, but you are able to debug all its containers directly from Visual Studio by setting regular breakpoints.</span></span>

<span data-ttu-id="47ca3-288">Come accennato in precedenza, ogni volta che si aggiungere il supporto di soluzioni di Docker in un progetto all'interno di una soluzione, il progetto è configurato nel file docker-compose.yml (a livello di soluzione) globale, che consente di eseguire o eseguire il debug in una sola volta l'intera soluzione.</span><span class="sxs-lookup"><span data-stu-id="47ca3-288">As mentioned before, each time you add Docker solution support to a project within a solution, that project is configured in the global (solution-level) docker-compose.yml file, which lets you run or debug the whole solution at once.</span></span> <span data-ttu-id="47ca3-289">Avviare un contenitore per ogni progetto che dispone del supporto di soluzioni di Docker abilitato, Visual Studio ed esegue automaticamente tutti i passaggi interni (dotnet pubblica, compilazione docker, ecc.).</span><span class="sxs-lookup"><span data-stu-id="47ca3-289">Visual Studio will start one container for each project that has Docker solution support enabled, and perform all the internal steps for you (dotnet publish, docker build, etc.).</span></span>

<span data-ttu-id="47ca3-290">L'importante è che, come illustrato nella figura 5-12, in Visual Studio 2017 vi sia un ulteriore **Docker** comando per l'azione con tasto F5.</span><span class="sxs-lookup"><span data-stu-id="47ca3-290">The important point here is that, as shown in Figure 5-12, in Visual Studio 2017 there is an additional **Docker** command for the F5 key action.</span></span> <span data-ttu-id="47ca3-291">Questa opzione consente di eseguire o eseguire il debug di un'applicazione multi-contenitore eseguendo tutti i contenitori che vengono definiti nei file di docker compose.yml a livello di soluzione.</span><span class="sxs-lookup"><span data-stu-id="47ca3-291">This option lets you run or debug a multi-container application by running all the containers that are defined in the docker-compose.yml files at the solution level.</span></span> <span data-ttu-id="47ca3-292">La possibilità di eseguire il debug delle soluzioni più contenitore significa che è possibile impostare più punti di interruzione, ogni punto di interruzione in un progetto diverso (contenitore) e durante il debug da Visual Studio verrà arrestato in corrispondenza dei punti di interruzione definiti in progetti diversi e in esecuzione in contenitori diversi.</span><span class="sxs-lookup"><span data-stu-id="47ca3-292">The ability to debug multiple-container solutions means that you can set several breakpoints, each breakpoint in a different project (container), and while debugging from Visual Studio you will stop at breakpoints defined in different projects and running on different containers.</span></span>

![](./media/image16.png)

<span data-ttu-id="47ca3-293">**Figura 5-12**.</span><span class="sxs-lookup"><span data-stu-id="47ca3-293">**Figure 5-12**.</span></span> <span data-ttu-id="47ca3-294">Le applicazioni di multi-contenitore in esecuzione in Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="47ca3-294">Running multi-container apps in Visual Studio 2017</span></span>

### <a name="additional-resources"></a><span data-ttu-id="47ca3-295">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="47ca3-295">Additional resources</span></span>

-   <span data-ttu-id="47ca3-296">**Distribuire un contenitore ASP.NET in un host Docker remoto**
    [*https://docs.microsoft.com/azure/vs-azure-tools-docker-hosting-web-apps-in-docker*](https://docs.microsoft.com/azure/vs-azure-tools-docker-hosting-web-apps-in-docker)</span><span class="sxs-lookup"><span data-stu-id="47ca3-296">**Deploy an ASP.NET container to a remote Docker host**
[*https://docs.microsoft.com/azure/vs-azure-tools-docker-hosting-web-apps-in-docker*](https://docs.microsoft.com/azure/vs-azure-tools-docker-hosting-web-apps-in-docker)</span></span>

### <a name="a-note-about-testing-and-deploying-with-orchestrators"></a><span data-ttu-id="47ca3-297">Una nota sui test e distribuzione con orchestrators</span><span class="sxs-lookup"><span data-stu-id="47ca3-297">A note about testing and deploying with orchestrators</span></span>

<span data-ttu-id="47ca3-298">Il comporre docker backup e i comandi di docker eseguire (o in esecuzione e i contenitori in Visual Studio di debug) non risultano adeguate per i contenitori di test nell'ambiente di sviluppo.</span><span class="sxs-lookup"><span data-stu-id="47ca3-298">The docker-compose up and docker run commands (or running and debugging the containers in Visual Studio) are adequate for testing containers in your development environment.</span></span> <span data-ttu-id="47ca3-299">Tuttavia, non utilizzare questo approccio se la destinazione è il cluster di Docker e orchestrators Docker Swarm, Mesosphere DC/OS o Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="47ca3-299">But you should not use this approach if you are targeting Docker clusters and orchestrators like Docker Swarm, Mesosphere DC/OS, or Kubernetes.</span></span> <span data-ttu-id="47ca3-300">Se si utilizza un cluster come [Docker Swarm modalità](https://docs.docker.com/engine/swarm/) (disponibile in Docker CE per Windows e Mac dalla versione 1.12), è necessario distribuire e testare con altri comandi, ad esempio [servizio docker creare](https://docs.docker.com/engine/reference/commandline/service_create/) per servizi Single.</span><span class="sxs-lookup"><span data-stu-id="47ca3-300">If you are using a cluster like [Docker Swarm mode](https://docs.docker.com/engine/swarm/) (available in Docker CE for Windows and Mac since version 1.12), you need to deploy and test with additional commands like [docker service create](https://docs.docker.com/engine/reference/commandline/service_create/) for single services.</span></span> <span data-ttu-id="47ca3-301">Se si distribuisce un'applicazione composta da diversi contenitori, utilizzare [docker comporre bundle](https://docs.docker.com/compose/reference/bundle/) e [docker distribuire myBundleFile](https://docs.docker.com/engine/reference/commandline/deploy/) per distribuire l'applicazione come comporre un *stack*.</span><span class="sxs-lookup"><span data-stu-id="47ca3-301">If you are deploying an application composed of several containers, you use [docker compose bundle](https://docs.docker.com/compose/reference/bundle/) and [docker deploy myBundleFile](https://docs.docker.com/engine/reference/commandline/deploy/) to deploy the composed application as a *stack*.</span></span> <span data-ttu-id="47ca3-302">Per ulteriori informazioni, vedere il post di blog [introduzione sperimentale bundle dell'applicazione distribuita](https://blog.docker.com/2016/06/docker-app-bundle/) nella documentazione di Docker.</span><span class="sxs-lookup"><span data-stu-id="47ca3-302">For more information, see the blog post [Introducing Experimental Distributed Application Bundles](https://blog.docker.com/2016/06/docker-app-bundle/) in the Docker documentation.</span></span> <span data-ttu-id="47ca3-303">nel sito di Docker.</span><span class="sxs-lookup"><span data-stu-id="47ca3-303">on the Docker site.</span></span>

<span data-ttu-id="47ca3-304">Per [DC/OS](https://mesosphere.com/blog/2015/09/02/dcos-cli-command-line-tool-datacenter/) e [Kubernetes](http://kubernetes.io/docs/user-guide/deployments/) si usano i comandi di distribuzione diversi e anche gli script.</span><span class="sxs-lookup"><span data-stu-id="47ca3-304">For [DC/OS](https://mesosphere.com/blog/2015/09/02/dcos-cli-command-line-tool-datacenter/) and [Kubernetes](http://kubernetes.io/docs/user-guide/deployments/) you would use different deployment commands and scripts as well.</span></span>

![](./media/image17.png)

## <a name="step-6-test-your-docker-application-using-your-local-docker-host"></a><span data-ttu-id="47ca3-305">Passaggio 6.</span><span class="sxs-lookup"><span data-stu-id="47ca3-305">Step 6.</span></span> <span data-ttu-id="47ca3-306">Testare l'applicazione di Docker con l'host Docker locale</span><span class="sxs-lookup"><span data-stu-id="47ca3-306">Test your Docker application using your local Docker host</span></span>

<span data-ttu-id="47ca3-307">Questo passaggio può variare a seconda di ciò che esegue l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="47ca3-307">This step will vary depending on what your application is doing.</span></span> <span data-ttu-id="47ca3-308">In un'applicazione Web di base .NET semplice che viene distribuita come un singolo contenitore o un servizio, è possibile accedere al servizio aprendo un browser nell'host Docker e passando a un sito, come illustrato nella figura 5-13.</span><span class="sxs-lookup"><span data-stu-id="47ca3-308">In a simple .NET Core Web application that is deployed as a single container or service, you can access the service by opening a browser on the Docker host and navigating to that site as shown in Figure 5-13.</span></span> <span data-ttu-id="47ca3-309">(Se la configurazione in Dockerfile esegue il mapping a una porta dell'host che è diverso da 80 del contenitore, includono il post di host nell'URL).</span><span class="sxs-lookup"><span data-stu-id="47ca3-309">(If the configuration in the Dockerfile maps the container to a port on the host that is anything other than 80, include the host post in the URL.)</span></span>

![](./media/image18.png)

<span data-ttu-id="47ca3-310">**Figura 5-13**.</span><span class="sxs-lookup"><span data-stu-id="47ca3-310">**Figure 5-13**.</span></span> <span data-ttu-id="47ca3-311">Esempio di test dell'applicazione di Docker in locale utilizzando localhost</span><span class="sxs-lookup"><span data-stu-id="47ca3-311">Example of testing your Docker application locally using localhost</span></span>

<span data-ttu-id="47ca3-312">Se l'host locale non fa riferimento a Docker host IP (per impostazione predefinita, quando si usa Docker CE, dovrebbe), per passare al servizio, usare l'indirizzo IP della scheda di rete del computer.</span><span class="sxs-lookup"><span data-stu-id="47ca3-312">If localhost is not pointing to the Docker host IP (by default, when using Docker CE, it should), to navigate to your service, use the IP address of your machine’s network card.</span></span>

<span data-ttu-id="47ca3-313">Si noti che questo URL nel browser utilizza la porta 80 per l'esempio di contenitore specifico vengono trattata.</span><span class="sxs-lookup"><span data-stu-id="47ca3-313">Note that this URL in the browser uses port 80 for the particular container example being discussed.</span></span> <span data-ttu-id="47ca3-314">Tuttavia, internamente le richieste in corso il reindirizzamento alla porta 5000, perché questo è modo è stato distribuito con il comando docker run, come illustrato nel passaggio precedente.</span><span class="sxs-lookup"><span data-stu-id="47ca3-314">However, internally the requests are being redirected to port 5000, because that was how it was deployed with the docker run command, as explained in a previous step.</span></span>

<span data-ttu-id="47ca3-315">È anche possibile testare l'applicazione utilizzando curl dal terminale, come illustrato nella figura 5-14.</span><span class="sxs-lookup"><span data-stu-id="47ca3-315">You can also test the application using curl from the terminal, as shown in Figure 5-14.</span></span> <span data-ttu-id="47ca3-316">In un'installazione di Docker in Windows, il valore predefinito IP dell'Host Docker è sempre 10.0.75.1 aggiunta indirizzo IP effettivo del computer.</span><span class="sxs-lookup"><span data-stu-id="47ca3-316">In a Docker installation on Windows, the default Docker Host IP is always 10.0.75.1 in addition to your machine’s actual IP address.</span></span>

![](./media/image19.png)

<span data-ttu-id="47ca3-317">**Figura 5-14**.</span><span class="sxs-lookup"><span data-stu-id="47ca3-317">**Figure 5-14**.</span></span> <span data-ttu-id="47ca3-318">Esempio di test dell'applicazione di Docker in locale utilizzando curl</span><span class="sxs-lookup"><span data-stu-id="47ca3-318">Example of testing your Docker application locally using curl</span></span>

### <a name="testing-and-debugging-containers-with-visual-studio-2017"></a><span data-ttu-id="47ca3-319">Test e debug di contenitori con Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="47ca3-319">Testing and debugging containers with Visual Studio 2017</span></span>

<span data-ttu-id="47ca3-320">Quando in esecuzione e i contenitori con Visual Studio 2017 di debug, è possibile eseguire il debug dell'applicazione .NET nello stesso modo come si farebbe in esecuzione senza contenitori.</span><span class="sxs-lookup"><span data-stu-id="47ca3-320">When running and debugging the containers with Visual Studio 2017, you can debug the .NET application in much the same way as you would when running without containers.</span></span>

### <a name="testing-and-debugging-without-visual-studio"></a><span data-ttu-id="47ca3-321">Test e debug senza Visual Studio</span><span class="sxs-lookup"><span data-stu-id="47ca3-321">Testing and debugging without Visual Studio</span></span>

<span data-ttu-id="47ca3-322">Se si sta sviluppando utilizzando l'approccio editor/CLI, debug contenitori risulta più difficile e si desideri eseguire il debug tramite la generazione di tracce.</span><span class="sxs-lookup"><span data-stu-id="47ca3-322">If you are developing using the editor/CLI approach, debugging containers is more difficult and you will want to debug by generating traces.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="47ca3-323">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="47ca3-323">Additional resources</span></span>

-   <span data-ttu-id="47ca3-324">**Debug di applicazioni in un contenitore Docker locale**
    [*https://docs.microsoft.com/azure/vs-azure-tools-docker-edit-and-refresh*](https://docs.microsoft.com/azure/vs-azure-tools-docker-edit-and-refresh)</span><span class="sxs-lookup"><span data-stu-id="47ca3-324">**Debugging apps in a local Docker container**
[*https://docs.microsoft.com/azure/vs-azure-tools-docker-edit-and-refresh*](https://docs.microsoft.com/azure/vs-azure-tools-docker-edit-and-refresh)</span></span>

-   <span data-ttu-id="47ca3-325">**Steve Lasker. Compilare, eseguire il Debug, distribuire le app ASP.NET Core con Docker.**</span><span class="sxs-lookup"><span data-stu-id="47ca3-325">**Steve Lasker. Build, Debug, Deploy ASP.NET Core Apps with Docker.**</span></span> <span data-ttu-id="47ca3-326">Video.</span><span class="sxs-lookup"><span data-stu-id="47ca3-326">Video.</span></span>
    [<span data-ttu-id="47ca3-327">*https://channel9.msdn.com/Events/Visual-Studio/Visual-Studio-2017-Launch/T115*</span><span class="sxs-lookup"><span data-stu-id="47ca3-327">*https://channel9.msdn.com/Events/Visual-Studio/Visual-Studio-2017-Launch/T115*</span></span>](https://channel9.msdn.com/Events/Visual-Studio/Visual-Studio-2017-Launch/T115)

## <a name="simplified-workflow-when-developing-containers-with-visual-studio"></a><span data-ttu-id="47ca3-328">Flusso di lavoro semplificata durante lo sviluppo di contenitori con Visual Studio</span><span class="sxs-lookup"><span data-stu-id="47ca3-328">Simplified workflow when developing containers with Visual Studio</span></span>

<span data-ttu-id="47ca3-329">In effetti, il flusso di lavoro quando si utilizza Visual Studio è molto più semplice rispetto a se si utilizza l'approccio editor/CLI.</span><span class="sxs-lookup"><span data-stu-id="47ca3-329">Effectively, the workflow when using Visual Studio is a lot simpler than if you use the editor/CLI approach.</span></span> <span data-ttu-id="47ca3-330">La maggior parte dei passaggi necessari per Docker correlati di Dockerfile e docker compose.yml file sono nascosti o semplificati da Visual Studio, come illustrato nella figura 5-15.</span><span class="sxs-lookup"><span data-stu-id="47ca3-330">Most of the steps required by Docker related to the Dockerfile and docker-compose.yml files are hidden or simplified by Visual Studio, as shown in Figure 5-15.</span></span>

![](./media/image20.png)

<span data-ttu-id="47ca3-331">**Figura 5-15**.</span><span class="sxs-lookup"><span data-stu-id="47ca3-331">**Figure 5-15**.</span></span> <span data-ttu-id="47ca3-332">Flusso di lavoro semplificata durante lo sviluppo con Visual Studio</span><span class="sxs-lookup"><span data-stu-id="47ca3-332">Simplified workflow when developing with Visual Studio</span></span>

<span data-ttu-id="47ca3-333">Inoltre, è necessario eseguire solo una volta al passaggio 2 (supporto per Docker aggiunta ai progetti).</span><span class="sxs-lookup"><span data-stu-id="47ca3-333">In addition, you need to perform step 2 (adding Docker support to your projects) just once.</span></span> <span data-ttu-id="47ca3-334">Pertanto, il flusso di lavoro è simile alle attività di sviluppo normale quando si utilizza .NET per lo sviluppo di altri.</span><span class="sxs-lookup"><span data-stu-id="47ca3-334">Therefore, the workflow is similar to your usual development tasks when using .NET for any other development.</span></span> <span data-ttu-id="47ca3-335">È necessario sapere cosa succede dietro le quinte (il processo di generazione di immagini, quali immagini di base in uso, la distribuzione di contenitori, e così via) e in alcuni casi che è anche necessario modificare il file Dockerfile o compose.yml di docker per personalizzare i comportamenti.</span><span class="sxs-lookup"><span data-stu-id="47ca3-335">You need to know what is going on under the covers (the image build process, what base images you are using, deployment of containers, etc.) and sometimes you will also need to edit the Dockerfile or docker-compose.yml file to customize behaviors.</span></span> <span data-ttu-id="47ca3-336">Ma la maggior parte delle operazioni sia notevolmente semplificato tramite Visual Studio, rendendo è molto più produttivi.</span><span class="sxs-lookup"><span data-stu-id="47ca3-336">But most of the work is greatly simplified by using Visual Studio, making you a lot more productive.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="47ca3-337">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="47ca3-337">Additional resources</span></span>

-   <span data-ttu-id="47ca3-338">**Steve Lasker. Sviluppo di docker .NET con Visual Studio 2017**
    [*https://channel9.msdn.com/Events/Visual-Studio/Visual-Studio-2017-Launch/T111*](https://channel9.msdn.com/Events/Visual-Studio/Visual-Studio-2017-Launch/T111)</span><span class="sxs-lookup"><span data-stu-id="47ca3-338">**Steve Lasker. .NET Docker Development with Visual Studio 2017**
[*https://channel9.msdn.com/Events/Visual-Studio/Visual-Studio-2017-Launch/T111*](https://channel9.msdn.com/Events/Visual-Studio/Visual-Studio-2017-Launch/T111)</span></span>

-   <span data-ttu-id="47ca3-339">**Jeffrey T. Fritz. Inserire un'App di .NET Core in un contenitore con i nuovi strumenti di Docker per Visual Studio**
    [*https://blogs.msdn.microsoft.com/webdev/2016/11/16/new-docker-tools-for-visual-studio/*](https://blogs.msdn.microsoft.com/webdev/2016/11/16/new-docker-tools-for-visual-studio/)</span><span class="sxs-lookup"><span data-stu-id="47ca3-339">**Jeffrey T. Fritz. Put a .NET Core App in a Container with the new Docker Tools for Visual Studio**
[*https://blogs.msdn.microsoft.com/webdev/2016/11/16/new-docker-tools-for-visual-studio/*](https://blogs.msdn.microsoft.com/webdev/2016/11/16/new-docker-tools-for-visual-studio/)</span></span>

## <a name="using-powershell-commands-in-a-dockerfile-to-set-up-windows-containers"></a><span data-ttu-id="47ca3-340">Per impostare i contenitori di Windows utilizza i comandi di PowerShell in un Dockerfile</span><span class="sxs-lookup"><span data-stu-id="47ca3-340">Using PowerShell commands in a Dockerfile to set up Windows Containers</span></span> 

<span data-ttu-id="47ca3-341">[Contenitori di Windows](https://msdn.microsoft.com/en-us/virtualization/windowscontainers/about/about_overview) consentono di convertire le applicazioni di Windows esistenti in immagini Docker e distribuirle con gli stessi strumenti come il resto dell'ecosistema di Docker.</span><span class="sxs-lookup"><span data-stu-id="47ca3-341">[Windows Containers](https://msdn.microsoft.com/en-us/virtualization/windowscontainers/about/about_overview) allow you to convert your existing Windows applications into Docker images and deploy them with the same tools as the rest of the Docker ecosystem.</span></span> <span data-ttu-id="47ca3-342">Per usare i contenitori di Windows, eseguire i comandi di PowerShell in Dockerfile, come illustrato nell'esempio seguente:</span><span class="sxs-lookup"><span data-stu-id="47ca3-342">To use Windows Containers, you run PowerShell commands in the Dockerfile, as shown in the following example:</span></span>

```
FROM microsoft/windowsservercore
  
LABEL Description="IIS" Vendor="Microsoft" Version="10"
  
RUN powershell -Command Add-WindowsFeature Web-Server
  
CMD [ "ping", "localhost", "-t" ]
```

<span data-ttu-id="47ca3-343">In questo caso, ci stiamo utilizzando un'immagine di base di Windows Server Core (impostazione FROM) e l'installazione di IIS con un comando di PowerShell (l'impostazione di esecuzione).</span><span class="sxs-lookup"><span data-stu-id="47ca3-343">In this case, we are using a Windows Server Core base image (the FROM setting) and installing IIS with a PowerShell command (the RUN setting).</span></span> <span data-ttu-id="47ca3-344">In modo analogo, è inoltre possibile utilizzare i comandi di PowerShell per impostare i componenti aggiuntivi quali ASP.NET 4. x, .NET 4.6 o qualsiasi altro software di Windows.</span><span class="sxs-lookup"><span data-stu-id="47ca3-344">In a similar way, you could also use PowerShell commands to set up additional components like ASP.NET 4.x, .NET 4.6, or any other Windows software.</span></span> <span data-ttu-id="47ca3-345">Ad esempio, il comando seguente in un Dockerfile Configura ASP.NET 4.5:</span><span class="sxs-lookup"><span data-stu-id="47ca3-345">For example, the following command in a Dockerfile sets up ASP.NET 4.5:</span></span>

```
RUN powershell add-windowsfeature web-asp-net45
```

### <a name="additional-resources"></a><span data-ttu-id="47ca3-346">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="47ca3-346">Additional resources</span></span>

-   <span data-ttu-id="47ca3-347">**Dockerfile-docker/ASPNET.**</span><span class="sxs-lookup"><span data-stu-id="47ca3-347">**aspnet-docker/Dockerfile.**</span></span> <span data-ttu-id="47ca3-348">Comandi di Powershell di esempio per l'esecuzione da dockerfile per includere funzionalità di Windows.</span><span class="sxs-lookup"><span data-stu-id="47ca3-348">Example Powershell commands to run from dockerfiles to include Windows features.</span></span>
    [<span data-ttu-id="47ca3-349">*https://github.com/Microsoft/ASPNET-docker/BLOB/master/4.6.2/Dockerfile*</span><span class="sxs-lookup"><span data-stu-id="47ca3-349">*https://github.com/Microsoft/aspnet-docker/blob/master/4.6.2/Dockerfile*</span></span>](https://github.com/Microsoft/aspnet-docker/blob/master/4.6.2/Dockerfile)

>[!div class="step-by-step"]
<span data-ttu-id="47ca3-350">[Precedente] (index.md) [Avanti] (... / net-core-single-containers-linux-windows-server-hosts/index.md)</span><span class="sxs-lookup"><span data-stu-id="47ca3-350">[Previous] (index.md) [Next] (../net-core-single-containers-linux-windows-server-hosts/index.md)</span></span>
