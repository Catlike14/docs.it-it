---
title: 'Procedura dettagliata: Incorporamento dei tipi da assembly in Visual Studio (Visual Basic) gestiti | Documenti di Microsoft'
ms.custom: 
ms.date: 2015-07-20
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-visual-basic
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- VB
ms.assetid: 56ed12ba-adff-4e9c-a668-7fcba80c4795
caps.latest.revision: 3
author: stevehoag
ms.author: shoag
translation.priority.mt:
- cs-cz
- pl-pl
- pt-br
- tr-tr
ms.translationtype: Machine Translation
ms.sourcegitcommit: a06bd2a17f1d6c7308fa6337c866c1ca2e7281c0
ms.openlocfilehash: adc58e081cd9b874a841d84b11d92cbffb6ba6b8
ms.contentlocale: it-it
ms.lasthandoff: 03/13/2017

---
# <a name="walkthrough-embedding-types-from-managed-assemblies-in-visual-studio-visual-basic"></a><span data-ttu-id="f110a-102">Procedura dettagliata: Incorporamento dei tipi da assembly gestiti in Visual Studio (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="f110a-102">Walkthrough: Embedding Types from Managed Assemblies in Visual Studio (Visual Basic)</span></span>
<span data-ttu-id="f110a-103">Se si incorporano informazioni sul tipo da un assembly gestito sicuro, è possibile un'associazione debole dei tipi in un'applicazione per ottenere l'indipendenza dalla versione.</span><span class="sxs-lookup"><span data-stu-id="f110a-103">If you embed type information from a strong-named managed assembly, you can loosely couple types in an application to achieve version independence.</span></span> <span data-ttu-id="f110a-104">Vale a dire, il programma può essere scritto per utilizzare tipi di più versioni di una libreria gestita senza dover ricompilare per ogni versione.</span><span class="sxs-lookup"><span data-stu-id="f110a-104">That is, your program can be written to use types from multiple versions of a managed library without having to be recompiled for each version.</span></span>  
  
 <span data-ttu-id="f110a-105">L'incorporamento dei tipi viene spesso utilizzato con l'interoperabilità COM, ad esempio un'applicazione che utilizza gli oggetti di automazione di Microsoft Office.</span><span class="sxs-lookup"><span data-stu-id="f110a-105">Type embedding is frequently used with COM interop, such as an application that uses automation objects from Microsoft Office.</span></span> <span data-ttu-id="f110a-106">Incorporamento di informazioni sul tipo consente la stessa build di un programma per l'utilizzo delle diverse versioni di Microsoft Office in computer diversi.</span><span class="sxs-lookup"><span data-stu-id="f110a-106">Embedding type information enables the same build of a program to work with different versions of Microsoft Office on different computers.</span></span> <span data-ttu-id="f110a-107">Tuttavia, è possibile utilizzare anche incorporamento dei tipi con una soluzione completamente gestita.</span><span class="sxs-lookup"><span data-stu-id="f110a-107">However, you can also use type embedding with a fully managed solution.</span></span>  
  
 <span data-ttu-id="f110a-108">Informazioni sul tipo possono essere incorporati da un assembly che ha le caratteristiche seguenti:</span><span class="sxs-lookup"><span data-stu-id="f110a-108">Type information can be embedded from an assembly that has the following characteristics:</span></span>  
  
-   <span data-ttu-id="f110a-109">L'assembly espone almeno un'interfaccia pubblica.</span><span class="sxs-lookup"><span data-stu-id="f110a-109">The assembly exposes at least one public interface.</span></span>  
  
-   <span data-ttu-id="f110a-110">Le interfacce incorporate vengono annotate con un `ComImport` attributo e un `Guid` attributo (e un GUID univoco).</span><span class="sxs-lookup"><span data-stu-id="f110a-110">The embedded interfaces are annotated with a `ComImport` attribute and a `Guid` attribute (and a unique GUID).</span></span>  
  
-   <span data-ttu-id="f110a-111">L'assembly viene annotato con il `ImportedFromTypeLib` attributo o `PrimaryInteropAssembly` attributo e un livello di assembly `Guid` attributo.</span><span class="sxs-lookup"><span data-stu-id="f110a-111">The assembly is annotated with the `ImportedFromTypeLib` attribute or the `PrimaryInteropAssembly` attribute, and an assembly-level `Guid` attribute.</span></span> <span data-ttu-id="f110a-112">(Per impostazione predefinita, i modelli di progetto Visual Basic includono un livello di assembly `Guid` attributo.)</span><span class="sxs-lookup"><span data-stu-id="f110a-112">(By default, Visual Basic project templates include an assembly-level `Guid` attribute.)</span></span>  
  
 <span data-ttu-id="f110a-113">Dopo aver specificato le interfacce pubbliche che possono essere incorporate, è possibile creare classi di runtime che implementano tali interfacce.</span><span class="sxs-lookup"><span data-stu-id="f110a-113">After you have specified the public interfaces that can be embedded, you can create runtime classes that implement those interfaces.</span></span> <span data-ttu-id="f110a-114">Un programma client può quindi incorporare le informazioni sul tipo per tali interfacce in fase di progettazione facendo riferimento all'assembly che contiene le interfacce pubbliche e l'impostazione di `Embed Interop Types` proprietà di riferimento su `True`.</span><span class="sxs-lookup"><span data-stu-id="f110a-114">A client program can then embed the type information for those interfaces at design time by referencing the assembly that contains the public interfaces and setting the `Embed Interop Types` property of the reference to `True`.</span></span> <span data-ttu-id="f110a-115">Ciò equivale a utilizzando il compilatore della riga di comando e fare riferimento all'assembly utilizzando il `/link` l'opzione del compilatore.</span><span class="sxs-lookup"><span data-stu-id="f110a-115">This is equivalent to using the command line compiler and referencing the assembly by using the `/link` compiler option.</span></span> <span data-ttu-id="f110a-116">Il programma client può quindi caricare le istanze degli oggetti di runtime tipizzati come tali interfacce.</span><span class="sxs-lookup"><span data-stu-id="f110a-116">The client program can then load instances of your runtime objects typed as those interfaces.</span></span> <span data-ttu-id="f110a-117">Se si crea una nuova versione dell'assembly con nome sicuro di runtime, il programma client non devono essere ricompilate con l'assembly di runtime aggiornato.</span><span class="sxs-lookup"><span data-stu-id="f110a-117">If you create a new version of your strong-named runtime assembly, the client program does not have to be recompiled with the updated runtime assembly.</span></span> <span data-ttu-id="f110a-118">Al contrario, il programma client continua a utilizzare qualsiasi versione di assembly di runtime è disponibile, utilizzando le informazioni sul tipo incorporato per le interfacce pubbliche.</span><span class="sxs-lookup"><span data-stu-id="f110a-118">Instead, the client program continues to use whichever version of the runtime assembly is available to it, using the embedded type information for the public interfaces.</span></span>  
  
 <span data-ttu-id="f110a-119">Poiché la funzione principale di incorporamento dei tipi è supporta l'incorporamento di informazioni sui tipi da assembly di interoperabilità COM, le limitazioni seguenti si applicano quando si incorporano informazioni sul tipo in una soluzione completamente gestita:</span><span class="sxs-lookup"><span data-stu-id="f110a-119">Because the primary function of type embedding is to support embedding of type information from COM interop assemblies, the following limitations apply when you embed type information in a fully managed solution:</span></span>  
  
-   <span data-ttu-id="f110a-120">Solo gli attributi specifici per l'interoperabilità COM sono incorporati. altri attributi vengono ignorati.</span><span class="sxs-lookup"><span data-stu-id="f110a-120">Only attributes specific to COM interop are embedded; other attributes are ignored.</span></span>  
  
-   <span data-ttu-id="f110a-121">Se un tipo utilizza parametri generici e il tipo del parametro generico è un tipo incorporato, è Impossibile utilizzare tale tipo attraverso un limite di assembly.</span><span class="sxs-lookup"><span data-stu-id="f110a-121">If a type uses generic parameters and the type of the generic parameter is an embedded type, that type cannot be used across an assembly boundary.</span></span> <span data-ttu-id="f110a-122">Esempi di oltrepassare il limite di un assembly chiama un metodo da un altro assembly o un tipo deriva da un tipo definito in un altro assembly.</span><span class="sxs-lookup"><span data-stu-id="f110a-122">Examples of crossing an assembly boundary include calling a method from another assembly or a deriving a type from a type defined in another assembly.</span></span>  
  
-   <span data-ttu-id="f110a-123">Le costanti non sono incorporate.</span><span class="sxs-lookup"><span data-stu-id="f110a-123">Constants are not embedded.</span></span>  
  
-   <span data-ttu-id="f110a-124">La <xref:System.Collections.Generic.Dictionary%602?displayProperty=fullName>classe non supporta un tipo incorporato come chiave.</xref:System.Collections.Generic.Dictionary%602?displayProperty=fullName></span><span class="sxs-lookup"><span data-stu-id="f110a-124">The <xref:System.Collections.Generic.Dictionary%602?displayProperty=fullName> class does not support an embedded type as a key.</span></span> <span data-ttu-id="f110a-125">È possibile implementare un tipo di dizionario per supportare un tipo incorporato come chiave.</span><span class="sxs-lookup"><span data-stu-id="f110a-125">You can implement your own dictionary type to support an embedded type as a key.</span></span>  
  
 <span data-ttu-id="f110a-126">In questa procedura dettagliata, verranno effettuate le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="f110a-126">In this walkthrough, you will do the following:</span></span>  
  
-   <span data-ttu-id="f110a-127">Creare un assembly con nome sicuro che dispone di un'interfaccia pubblica che contiene informazioni sul tipo che può essere incorporati.</span><span class="sxs-lookup"><span data-stu-id="f110a-127">Create a strong-named assembly that has a public interface that contains type information that can be embedded.</span></span>  
  
-   <span data-ttu-id="f110a-128">Creare un assembly con nome sicuro di runtime che implementa l'interfaccia pubblica.</span><span class="sxs-lookup"><span data-stu-id="f110a-128">Create a strong-named runtime assembly that implements that public interface.</span></span>  
  
-   <span data-ttu-id="f110a-129">Creare un programma client che incorpora le informazioni sul tipo dell'interfaccia pubblica e crea un'istanza della classe da assembly di runtime.</span><span class="sxs-lookup"><span data-stu-id="f110a-129">Create a client program that embeds the type information from the public interface and creates an instance of the class from the runtime assembly.</span></span>  
  
-   <span data-ttu-id="f110a-130">Modificare e ricompilare l'assembly di runtime.</span><span class="sxs-lookup"><span data-stu-id="f110a-130">Modify and rebuild the runtime assembly.</span></span>  
  
-   <span data-ttu-id="f110a-131">Eseguire il programma client per verificare che la nuova versione dell'assembly di runtime viene usata senza dover ricompilare il programma client.</span><span class="sxs-lookup"><span data-stu-id="f110a-131">Run the client program to see that the new version of the runtime assembly is being used without having to recompile the client program.</span></span>  
  
[!INCLUDE[note_settings_general](../../../../csharp/language-reference/compiler-messages/includes/note_settings_general_md.md)]  
  
## <a name="creating-an-interface"></a><span data-ttu-id="f110a-132">Creazione di un'interfaccia</span><span class="sxs-lookup"><span data-stu-id="f110a-132">Creating an Interface</span></span>  
  
#### <a name="to-create-the-type-equivalence-interface-project"></a><span data-ttu-id="f110a-133">Per creare il progetto di interfaccia di equivalenza del tipo</span><span class="sxs-lookup"><span data-stu-id="f110a-133">To create the type equivalence interface project</span></span>  
  
1.  <span data-ttu-id="f110a-134">In Visual Studio, nel **File** dal menu **New** e quindi fare clic su **progetto**.</span><span class="sxs-lookup"><span data-stu-id="f110a-134">In Visual Studio, on the **File** menu, point to **New** and then click **Project**.</span></span>  
  
2.  <span data-ttu-id="f110a-135">Nel **nuovo progetto** della finestra di dialogo di **tipi di progetto** riquadro, assicurarsi che **Windows** è selezionata.</span><span class="sxs-lookup"><span data-stu-id="f110a-135">In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected.</span></span> <span data-ttu-id="f110a-136">Selezionare **libreria di classi** nel **modelli** riquadro.</span><span class="sxs-lookup"><span data-stu-id="f110a-136">Select **Class Library** in the **Templates** pane.</span></span> <span data-ttu-id="f110a-137">Nel **nome** digitare `TypeEquivalenceInterface`, quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="f110a-137">In the **Name** box, type `TypeEquivalenceInterface`, and then click **OK**.</span></span> <span data-ttu-id="f110a-138">Viene creato il nuovo progetto.</span><span class="sxs-lookup"><span data-stu-id="f110a-138">The new project is created.</span></span>  
  
3.  <span data-ttu-id="f110a-139">In **Esplora**, il file Class1. vb e fare clic su **rinominare**.</span><span class="sxs-lookup"><span data-stu-id="f110a-139">In **Solution Explorer**, right-click the Class1.vb file and click **Rename**.</span></span> <span data-ttu-id="f110a-140">Rinominare il file in `ISampleInterface.vb` e premere INVIO.</span><span class="sxs-lookup"><span data-stu-id="f110a-140">Rename the file to `ISampleInterface.vb` and press ENTER.</span></span> <span data-ttu-id="f110a-141">Ridenominazione del file verrà anche rinominare la classe come `ISampleInterface`.</span><span class="sxs-lookup"><span data-stu-id="f110a-141">Renaming the file will also rename the class to `ISampleInterface`.</span></span> <span data-ttu-id="f110a-142">Questa classe rappresenterà l'interfaccia pubblica per la classe.</span><span class="sxs-lookup"><span data-stu-id="f110a-142">This class will represent the public interface for the class.</span></span>  
  
4.  <span data-ttu-id="f110a-143">Pulsante destro del mouse sul progetto TypeEquivalenceInterface e fare clic su **proprietà**.</span><span class="sxs-lookup"><span data-stu-id="f110a-143">Right-click the TypeEquivalenceInterface project and click **Properties**.</span></span> <span data-ttu-id="f110a-144">Fare clic sulla scheda **Compila**.</span><span class="sxs-lookup"><span data-stu-id="f110a-144">Click the **Compile** tab.</span></span> <span data-ttu-id="f110a-145">Impostare il percorso di output a un percorso valido sul computer di sviluppo, ad esempio `C:\TypeEquivalenceSample`.</span><span class="sxs-lookup"><span data-stu-id="f110a-145">Set the output path to a valid location on your development computer, such as `C:\TypeEquivalenceSample`.</span></span> <span data-ttu-id="f110a-146">Questo percorso verrà utilizzato anche in un passaggio successivo in questa procedura dettagliata.</span><span class="sxs-lookup"><span data-stu-id="f110a-146">This location will also be used in a later step in this walkthrough.</span></span>  
  
5.  <span data-ttu-id="f110a-147">Durante la modifica delle proprietà del progetto, scegliere il **firma** scheda.</span><span class="sxs-lookup"><span data-stu-id="f110a-147">While still editing the project properties, click the **Signing** tab.</span></span> <span data-ttu-id="f110a-148">Selezionare il **firmare l'assembly** (opzione).</span><span class="sxs-lookup"><span data-stu-id="f110a-148">Select the **Sign the assembly** option.</span></span> <span data-ttu-id="f110a-149">Nel **Scegli un file chiave con nome sicuro** elenco, fare clic su ** <New...> **.</New...></span><span class="sxs-lookup"><span data-stu-id="f110a-149">In the **Choose a strong name key file** list, click **<New...>**.</span></span> <span data-ttu-id="f110a-150">Nel **nome file di chiave** digitare `key.snk`.</span><span class="sxs-lookup"><span data-stu-id="f110a-150">In the **Key file name** box, type `key.snk`.</span></span> <span data-ttu-id="f110a-151">Cancella il **Proteggi file di chiave con una password** casella di controllo.</span><span class="sxs-lookup"><span data-stu-id="f110a-151">Clear the **Protect my key file with a password** check box.</span></span> <span data-ttu-id="f110a-152">Fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="f110a-152">Click **OK**.</span></span>  
  
6.  <span data-ttu-id="f110a-153">Aprire il file vb.</span><span class="sxs-lookup"><span data-stu-id="f110a-153">Open the ISampleInterface.vb file.</span></span> <span data-ttu-id="f110a-154">Aggiungere il codice seguente al file di classe ISampleInterface per creare l'interfaccia ISampleInterface.</span><span class="sxs-lookup"><span data-stu-id="f110a-154">Add the following code to the ISampleInterface class file to create the ISampleInterface interface.</span></span>  
  
<span data-ttu-id="f110a-155"><CodeContentPlaceHolder>0</CodeContentPlaceHolder></span><span class="sxs-lookup"><span data-stu-id="f110a-155"><CodeContentPlaceHolder>0</CodeContentPlaceHolder></span></span>  
7.  <span data-ttu-id="f110a-156">Nel **strumenti** menu, fare clic su **crea Guid**.</span><span class="sxs-lookup"><span data-stu-id="f110a-156">On the **Tools** menu, click **Create Guid**.</span></span> <span data-ttu-id="f110a-157">Nel **Crea GUID** la finestra di dialogo, fare clic su **il formato del Registro di sistema** e quindi fare clic su **copia**.</span><span class="sxs-lookup"><span data-stu-id="f110a-157">In the **Create GUID** dialog box, click **Registry Format** and then click **Copy**.</span></span> <span data-ttu-id="f110a-158">Fare clic su **Esci**.</span><span class="sxs-lookup"><span data-stu-id="f110a-158">Click **Exit**.</span></span>  
  
8.  <span data-ttu-id="f110a-159">Nel `Guid` attributo, eliminare il GUID di esempio e incollare il GUID copiato dal **Crea GUID** la finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="f110a-159">In the `Guid` attribute, delete the sample GUID and paste in the GUID that you copied from the **Create GUID** dialog box.</span></span> <span data-ttu-id="f110a-160">Rimuovere le parentesi graffe ({}) dal GUID copiato.</span><span class="sxs-lookup"><span data-stu-id="f110a-160">Remove the braces ({}) from the copied GUID.</span></span>  
  
9. <span data-ttu-id="f110a-161">Nel **progetto** menu, fare clic su **Mostra tutti i file**.</span><span class="sxs-lookup"><span data-stu-id="f110a-161">On the **Project** menu, click **Show All Files**.</span></span>  
  
10. <span data-ttu-id="f110a-162">In **Esplora**, espandere il **progetto** cartella.</span><span class="sxs-lookup"><span data-stu-id="f110a-162">In **Solution Explorer**, expand the **My Project** folder.</span></span> <span data-ttu-id="f110a-163">Fare doppio clic il file AssemblyInfo. vb.</span><span class="sxs-lookup"><span data-stu-id="f110a-163">Double-click the AssemblyInfo.vb.</span></span> <span data-ttu-id="f110a-164">Aggiungere l'attributo seguente al file.</span><span class="sxs-lookup"><span data-stu-id="f110a-164">Add the following attribute to the file.</span></span>  
  
<span data-ttu-id="f110a-165"><CodeContentPlaceHolder>1</CodeContentPlaceHolder></span><span class="sxs-lookup"><span data-stu-id="f110a-165"><CodeContentPlaceHolder>1</CodeContentPlaceHolder></span></span>  
     <span data-ttu-id="f110a-166">Salvare il file.</span><span class="sxs-lookup"><span data-stu-id="f110a-166">Save the file.</span></span>  
  
11. <span data-ttu-id="f110a-167">Salvare il progetto.</span><span class="sxs-lookup"><span data-stu-id="f110a-167">Save the project.</span></span>  
  
12. <span data-ttu-id="f110a-168">Pulsante destro del mouse sul progetto TypeEquivalenceInterface e fare clic su **Build**.</span><span class="sxs-lookup"><span data-stu-id="f110a-168">Right-click the TypeEquivalenceInterface project and click **Build**.</span></span> <span data-ttu-id="f110a-169">Il file con estensione dll della libreria di classi viene compilato e salvato nel percorso di output di compilazione specificata (ad esempio, C:\TypeEquivalenceSample).</span><span class="sxs-lookup"><span data-stu-id="f110a-169">The class library .dll file is compiled and saved to the specified build output path (for example, C:\TypeEquivalenceSample).</span></span>  
  
## <a name="creating-a-runtime-class"></a><span data-ttu-id="f110a-170">Creazione di una classe di Runtime</span><span class="sxs-lookup"><span data-stu-id="f110a-170">Creating a Runtime Class</span></span>  
  
#### <a name="to-create-the-type-equivalence-runtime-project"></a><span data-ttu-id="f110a-171">Per creare il progetto di runtime di equivalenza del tipo</span><span class="sxs-lookup"><span data-stu-id="f110a-171">To create the type equivalence runtime project</span></span>  
  
1.  <span data-ttu-id="f110a-172">In Visual Studio, nel **File** dal menu **New** e quindi fare clic su **progetto**.</span><span class="sxs-lookup"><span data-stu-id="f110a-172">In Visual Studio, on the **File** menu, point to **New** and then click **Project**.</span></span>  
  
2.  <span data-ttu-id="f110a-173">Nel **nuovo progetto** della finestra di dialogo di **tipi di progetto** riquadro, assicurarsi che **Windows** è selezionata.</span><span class="sxs-lookup"><span data-stu-id="f110a-173">In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected.</span></span> <span data-ttu-id="f110a-174">Selezionare **libreria di classi** nel **modelli** riquadro.</span><span class="sxs-lookup"><span data-stu-id="f110a-174">Select **Class Library** in the **Templates** pane.</span></span> <span data-ttu-id="f110a-175">Nel **nome** digitare `TypeEquivalenceRuntime`, quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="f110a-175">In the **Name** box, type `TypeEquivalenceRuntime`, and then click **OK**.</span></span> <span data-ttu-id="f110a-176">Viene creato il nuovo progetto.</span><span class="sxs-lookup"><span data-stu-id="f110a-176">The new project is created.</span></span>  
  
3.  <span data-ttu-id="f110a-177">In **Esplora**, il file Class1. vb e fare clic su **rinominare**.</span><span class="sxs-lookup"><span data-stu-id="f110a-177">In **Solution Explorer**, right-click the Class1.vb file and click **Rename**.</span></span> <span data-ttu-id="f110a-178">Rinominare il file in `SampleClass.vb` e premere INVIO.</span><span class="sxs-lookup"><span data-stu-id="f110a-178">Rename the file to `SampleClass.vb` and press ENTER.</span></span> <span data-ttu-id="f110a-179">Ridenominazione del file consente inoltre di rinominare la classe `SampleClass`.</span><span class="sxs-lookup"><span data-stu-id="f110a-179">Renaming the file also renames the class to `SampleClass`.</span></span> <span data-ttu-id="f110a-180">Questa classe implementerà il `ISampleInterface` interfaccia.</span><span class="sxs-lookup"><span data-stu-id="f110a-180">This class will implement the `ISampleInterface` interface.</span></span>  
  
4.  <span data-ttu-id="f110a-181">Pulsante destro del mouse sul progetto TypeEquivalenceRuntime e fare clic su **proprietà**.</span><span class="sxs-lookup"><span data-stu-id="f110a-181">Right-click the TypeEquivalenceRuntime project and click **Properties**.</span></span> <span data-ttu-id="f110a-182">Fare clic sulla scheda **Compila**.</span><span class="sxs-lookup"><span data-stu-id="f110a-182">Click the **Compile** tab.</span></span> <span data-ttu-id="f110a-183">Impostare il percorso di output nello stesso percorso usato nel progetto TypeEquivalenceInterface, ad esempio, `C:\TypeEquivalenceSample`.</span><span class="sxs-lookup"><span data-stu-id="f110a-183">Set the output path to the same location you used in the TypeEquivalenceInterface project, for example, `C:\TypeEquivalenceSample`.</span></span>  
  
5.  <span data-ttu-id="f110a-184">Durante la modifica delle proprietà del progetto, scegliere il **firma** scheda.</span><span class="sxs-lookup"><span data-stu-id="f110a-184">While still editing the project properties, click the **Signing** tab.</span></span> <span data-ttu-id="f110a-185">Selezionare il **firmare l'assembly** (opzione).</span><span class="sxs-lookup"><span data-stu-id="f110a-185">Select the **Sign the assembly** option.</span></span> <span data-ttu-id="f110a-186">Nel **Scegli un file chiave con nome sicuro** elenco, fare clic su ** <New...> **.</New...></span><span class="sxs-lookup"><span data-stu-id="f110a-186">In the **Choose a strong name key file** list, click **<New...>**.</span></span> <span data-ttu-id="f110a-187">Nel **nome file di chiave** digitare `key.snk`.</span><span class="sxs-lookup"><span data-stu-id="f110a-187">In the **Key file name** box, type `key.snk`.</span></span> <span data-ttu-id="f110a-188">Cancella il **Proteggi file di chiave con una password** casella di controllo.</span><span class="sxs-lookup"><span data-stu-id="f110a-188">Clear the **Protect my key file with a password** check box.</span></span> <span data-ttu-id="f110a-189">Fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="f110a-189">Click **OK**.</span></span>  
  
6.  <span data-ttu-id="f110a-190">Pulsante destro del mouse sul progetto TypeEquivalenceRuntime e fare clic su **Aggiungi riferimento**.</span><span class="sxs-lookup"><span data-stu-id="f110a-190">Right-click the TypeEquivalenceRuntime project and click **Add Reference**.</span></span> <span data-ttu-id="f110a-191">Fare clic su di **Sfoglia** scheda e passare alla cartella del percorso di output.</span><span class="sxs-lookup"><span data-stu-id="f110a-191">Click the **Browse** tab and browse to the output path folder.</span></span> <span data-ttu-id="f110a-192">Selezionare il file TypeEquivalenceInterface. dll e fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="f110a-192">Select the TypeEquivalenceInterface.dll file and click **OK**.</span></span>  
  
7.  <span data-ttu-id="f110a-193">Nel **progetto** menu, fare clic su **Mostra tutti i file**.</span><span class="sxs-lookup"><span data-stu-id="f110a-193">On the **Project** menu, click **Show All Files**.</span></span>  
  
8.  <span data-ttu-id="f110a-194">In **Esplora**, espandere il **riferimenti** cartella.</span><span class="sxs-lookup"><span data-stu-id="f110a-194">In **Solution Explorer**, expand the **References** folder.</span></span> <span data-ttu-id="f110a-195">Selezionare il riferimento TypeEquivalenceInterface.</span><span class="sxs-lookup"><span data-stu-id="f110a-195">Select the TypeEquivalenceInterface reference.</span></span> <span data-ttu-id="f110a-196">Nella finestra proprietà per il riferimento TypeEquivalenceInterface, impostare il **versione specifica** proprietà **False**.</span><span class="sxs-lookup"><span data-stu-id="f110a-196">In the Properties window for the TypeEquivalenceInterface reference, set the **Specific Version** property to **False**.</span></span>  
  
9. <span data-ttu-id="f110a-197">Aggiungere il codice seguente al file di classe SampleClass per creare la classe SampleClass.</span><span class="sxs-lookup"><span data-stu-id="f110a-197">Add the following code to the SampleClass class file to create the SampleClass class.</span></span>  
  
<span data-ttu-id="f110a-198"><CodeContentPlaceHolder>2</CodeContentPlaceHolder></span><span class="sxs-lookup"><span data-stu-id="f110a-198"><CodeContentPlaceHolder>2</CodeContentPlaceHolder></span></span>  
10. <span data-ttu-id="f110a-199">Salvare il progetto.</span><span class="sxs-lookup"><span data-stu-id="f110a-199">Save the project.</span></span>  
  
11. <span data-ttu-id="f110a-200">Pulsante destro del mouse sul progetto TypeEquivalenceRuntime e fare clic su **Build**.</span><span class="sxs-lookup"><span data-stu-id="f110a-200">Right-click the TypeEquivalenceRuntime project and click **Build**.</span></span> <span data-ttu-id="f110a-201">Il file con estensione dll della libreria di classi viene compilato e salvato nel percorso di output di compilazione specificata (ad esempio, C:\TypeEquivalenceSample).</span><span class="sxs-lookup"><span data-stu-id="f110a-201">The class library .dll file is compiled and saved to the specified build output path (for example, C:\TypeEquivalenceSample).</span></span>  
  
## <a name="creating-a-client-project"></a><span data-ttu-id="f110a-202">Creazione di un progetto Client</span><span class="sxs-lookup"><span data-stu-id="f110a-202">Creating a Client Project</span></span>  
  
#### <a name="to-create-the-type-equivalence-client-project"></a><span data-ttu-id="f110a-203">Per creare il progetto client di equivalenza del tipo</span><span class="sxs-lookup"><span data-stu-id="f110a-203">To create the type equivalence client project</span></span>  
  
1.  <span data-ttu-id="f110a-204">In Visual Studio, nel **File** dal menu **New** e quindi fare clic su **progetto**.</span><span class="sxs-lookup"><span data-stu-id="f110a-204">In Visual Studio, on the **File** menu, point to **New** and then click **Project**.</span></span>  
  
2.  <span data-ttu-id="f110a-205">Nel **nuovo progetto** della finestra di dialogo di **tipi di progetto** riquadro, assicurarsi che **Windows** è selezionata.</span><span class="sxs-lookup"><span data-stu-id="f110a-205">In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected.</span></span> <span data-ttu-id="f110a-206">Selezionare **applicazione Console** nel **modelli** riquadro.</span><span class="sxs-lookup"><span data-stu-id="f110a-206">Select **Console Application** in the **Templates** pane.</span></span> <span data-ttu-id="f110a-207">Nel **nome** digitare `TypeEquivalenceClient`, quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="f110a-207">In the **Name** box, type `TypeEquivalenceClient`, and then click **OK**.</span></span> <span data-ttu-id="f110a-208">Viene creato il nuovo progetto.</span><span class="sxs-lookup"><span data-stu-id="f110a-208">The new project is created.</span></span>  
  
3.  <span data-ttu-id="f110a-209">Pulsante destro del mouse sul progetto TypeEquivalenceClient e fare clic su **proprietà**.</span><span class="sxs-lookup"><span data-stu-id="f110a-209">Right-click the TypeEquivalenceClient project and click **Properties**.</span></span> <span data-ttu-id="f110a-210">Fare clic sulla scheda **Compila**.</span><span class="sxs-lookup"><span data-stu-id="f110a-210">Click the **Compile** tab.</span></span> <span data-ttu-id="f110a-211">Impostare il percorso di output nello stesso percorso usato nel progetto TypeEquivalenceInterface, ad esempio, `C:\TypeEquivalenceSample`.</span><span class="sxs-lookup"><span data-stu-id="f110a-211">Set the output path to the same location you used in the TypeEquivalenceInterface project, for example, `C:\TypeEquivalenceSample`.</span></span>  
  
4.  <span data-ttu-id="f110a-212">Pulsante destro del mouse sul progetto TypeEquivalenceClient e fare clic su **Aggiungi riferimento**.</span><span class="sxs-lookup"><span data-stu-id="f110a-212">Right-click the TypeEquivalenceClient project and click **Add Reference**.</span></span> <span data-ttu-id="f110a-213">Fare clic su di **Sfoglia** scheda e passare alla cartella del percorso di output.</span><span class="sxs-lookup"><span data-stu-id="f110a-213">Click the **Browse** tab and browse to the output path folder.</span></span> <span data-ttu-id="f110a-214">Selezionare il file TypeEquivalenceInterface. dll (non TypeEquivalenceRuntime. dll) e fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="f110a-214">Select the TypeEquivalenceInterface.dll file (not the TypeEquivalenceRuntime.dll) and click **OK**.</span></span>  
  
5.  <span data-ttu-id="f110a-215">Nel **progetto** menu, fare clic su **Mostra tutti i file**.</span><span class="sxs-lookup"><span data-stu-id="f110a-215">On the **Project** menu, click **Show All Files**.</span></span>  
  
6.  <span data-ttu-id="f110a-216">In **Esplora**, espandere il **riferimenti** cartella.</span><span class="sxs-lookup"><span data-stu-id="f110a-216">In **Solution Explorer**, expand the **References** folder.</span></span> <span data-ttu-id="f110a-217">Selezionare il riferimento TypeEquivalenceInterface.</span><span class="sxs-lookup"><span data-stu-id="f110a-217">Select the TypeEquivalenceInterface reference.</span></span> <span data-ttu-id="f110a-218">Nella finestra proprietà per il riferimento TypeEquivalenceInterface, impostare il **Embed Interop Types** proprietà **True**.</span><span class="sxs-lookup"><span data-stu-id="f110a-218">In the Properties window for the TypeEquivalenceInterface reference, set the **Embed Interop Types** property to **True**.</span></span>  
  
7.  <span data-ttu-id="f110a-219">Aggiungere il codice seguente al file Module1. vb per creare il programma client.</span><span class="sxs-lookup"><span data-stu-id="f110a-219">Add the following code to the Module1.vb file to create the client program.</span></span>  
  
<span data-ttu-id="f110a-220"><CodeContentPlaceHolder>3</CodeContentPlaceHolder></span><span class="sxs-lookup"><span data-stu-id="f110a-220"><CodeContentPlaceHolder>3</CodeContentPlaceHolder></span></span>  
8.  <span data-ttu-id="f110a-221">Premere CTRL + F5 per compilare ed eseguire il programma.</span><span class="sxs-lookup"><span data-stu-id="f110a-221">Press CTRL+F5 to build and run the program.</span></span>  
  
## <a name="modifying-the-interface"></a><span data-ttu-id="f110a-222">Modifica dell'interfaccia</span><span class="sxs-lookup"><span data-stu-id="f110a-222">Modifying the Interface</span></span>  
  
#### <a name="to-modify-the-interface"></a><span data-ttu-id="f110a-223">Per modificare l'interfaccia</span><span class="sxs-lookup"><span data-stu-id="f110a-223">To modify the interface</span></span>  
  
1.  <span data-ttu-id="f110a-224">In Visual Studio, nel **File** dal menu **aprire**, quindi fare clic su **progetto/soluzione**.</span><span class="sxs-lookup"><span data-stu-id="f110a-224">In Visual Studio, on the **File** menu, point to **Open**, and then click **Project/Solution**.</span></span>  
  
2.  <span data-ttu-id="f110a-225">Nel **Apri progetto** la finestra di dialogo, fare clic sul progetto TypeEquivalenceInterface, quindi fare clic su **proprietà**.</span><span class="sxs-lookup"><span data-stu-id="f110a-225">In the **Open Project** dialog box, right-click the TypeEquivalenceInterface project, and then click **Properties**.</span></span> <span data-ttu-id="f110a-226">Fare clic sulla scheda **Applicazione** .</span><span class="sxs-lookup"><span data-stu-id="f110a-226">Click the **Application** tab.</span></span> <span data-ttu-id="f110a-227">Fare clic su di **informazioni sull'Assembly** pulsante.</span><span class="sxs-lookup"><span data-stu-id="f110a-227">Click the **Assembly Information** button.</span></span> <span data-ttu-id="f110a-228">Modifica il **versione dell'Assembly** e **versione File** valori `2.0.0.0`.</span><span class="sxs-lookup"><span data-stu-id="f110a-228">Change the **Assembly Version** and **File Version** values to `2.0.0.0`.</span></span>  
  
3.  <span data-ttu-id="f110a-229">Aprire il file vb.</span><span class="sxs-lookup"><span data-stu-id="f110a-229">Open the ISampleInterface.vb file.</span></span> <span data-ttu-id="f110a-230">Aggiungere la riga di codice seguente all'interfaccia ISampleInterface.</span><span class="sxs-lookup"><span data-stu-id="f110a-230">Add the following line of code to the ISampleInterface interface.</span></span>  
  
<span data-ttu-id="f110a-231"><CodeContentPlaceHolder>4</CodeContentPlaceHolder></span><span class="sxs-lookup"><span data-stu-id="f110a-231"><CodeContentPlaceHolder>4</CodeContentPlaceHolder></span></span>  
     <span data-ttu-id="f110a-232">Salvare il file.</span><span class="sxs-lookup"><span data-stu-id="f110a-232">Save the file.</span></span>  
  
4.  <span data-ttu-id="f110a-233">Salvare il progetto.</span><span class="sxs-lookup"><span data-stu-id="f110a-233">Save the project.</span></span>  
  
5.  <span data-ttu-id="f110a-234">Pulsante destro del mouse sul progetto TypeEquivalenceInterface e fare clic su **Build**.</span><span class="sxs-lookup"><span data-stu-id="f110a-234">Right-click the TypeEquivalenceInterface project and click **Build**.</span></span> <span data-ttu-id="f110a-235">Una nuova versione del file. dll della libreria di classe viene compilata e salvata nel percorso di output di compilazione specificato (ad esempio, C:\TypeEquivalenceSample).</span><span class="sxs-lookup"><span data-stu-id="f110a-235">A new version of the class library .dll file is compiled and saved in the specified build output path (for example, C:\TypeEquivalenceSample).</span></span>  
  
## <a name="modifying-the-runtime-class"></a><span data-ttu-id="f110a-236">Modifica la classe di Runtime</span><span class="sxs-lookup"><span data-stu-id="f110a-236">Modifying the Runtime Class</span></span>  
  
#### <a name="to-modify-the-runtime-class"></a><span data-ttu-id="f110a-237">Per modificare la classe di runtime</span><span class="sxs-lookup"><span data-stu-id="f110a-237">To modify the runtime class</span></span>  
  
1.  <span data-ttu-id="f110a-238">In Visual Studio, nel **File** dal menu **aprire**, quindi fare clic su **progetto/soluzione**.</span><span class="sxs-lookup"><span data-stu-id="f110a-238">In Visual Studio, on the **File** menu, point to **Open**, and then click **Project/Solution**.</span></span>  
  
2.  <span data-ttu-id="f110a-239">Nel **Apri progetto** finestra di dialogo, fare clic sul progetto TypeEquivalenceRuntime e scegliere **proprietà**.</span><span class="sxs-lookup"><span data-stu-id="f110a-239">In the **Open Project** dialog box, right-click the TypeEquivalenceRuntime project and click **Properties**.</span></span> <span data-ttu-id="f110a-240">Fare clic sulla scheda **Applicazione** .</span><span class="sxs-lookup"><span data-stu-id="f110a-240">Click the **Application** tab.</span></span> <span data-ttu-id="f110a-241">Fare clic su di **informazioni sull'Assembly** pulsante.</span><span class="sxs-lookup"><span data-stu-id="f110a-241">Click the **Assembly Information** button.</span></span> <span data-ttu-id="f110a-242">Modifica il **versione dell'Assembly** e **versione File** valori `2.0.0.0`.</span><span class="sxs-lookup"><span data-stu-id="f110a-242">Change the **Assembly Version** and **File Version** values to `2.0.0.0`.</span></span>  
  
3.  <span data-ttu-id="f110a-243">Aprire il SampleClass.vbfile.</span><span class="sxs-lookup"><span data-stu-id="f110a-243">Open the SampleClass.vbfile.</span></span> <span data-ttu-id="f110a-244">Aggiungere le seguenti righe di codice alla classe SampleClass.</span><span class="sxs-lookup"><span data-stu-id="f110a-244">Add the following lines of code to the SampleClass class.</span></span>  
  
```vb  
Public Function GetDate() As DateTime Implements ISampleInterface.GetDate  
    Return Now  
End Function  
```  
  
     Save the file.  
  
4.  <span data-ttu-id="f110a-245">Salvare il progetto.</span><span class="sxs-lookup"><span data-stu-id="f110a-245">Save the project.</span></span>  
  
5.  <span data-ttu-id="f110a-246">Pulsante destro del mouse sul progetto TypeEquivalenceRuntime e fare clic su **Build**.</span><span class="sxs-lookup"><span data-stu-id="f110a-246">Right-click the TypeEquivalenceRuntime project and click **Build**.</span></span> <span data-ttu-id="f110a-247">Una versione aggiornata del file. dll della libreria di classe viene compilata e salvata nel percorso di output di compilazione specificata in precedenza (ad esempio, C:\TypeEquivalenceSample).</span><span class="sxs-lookup"><span data-stu-id="f110a-247">An updated version of the class library .dll file is compiled and saved in the previously specified build output path (for example, C:\TypeEquivalenceSample).</span></span>  
  
6.  <span data-ttu-id="f110a-248">In Esplora File, aprire la cartella del percorso di output (ad esempio, C:\TypeEquivalenceSample).</span><span class="sxs-lookup"><span data-stu-id="f110a-248">In File Explorer, open the output path folder (for example, C:\TypeEquivalenceSample).</span></span> <span data-ttu-id="f110a-249">Fare doppio clic su TypeEquivalenceClient.exe per eseguire il programma.</span><span class="sxs-lookup"><span data-stu-id="f110a-249">Double-click the TypeEquivalenceClient.exe to run the program.</span></span> <span data-ttu-id="f110a-250">Il programma rifletterà la nuova versione dell'assembly TypeEquivalenceRuntime senza essere stato ricompilato.</span><span class="sxs-lookup"><span data-stu-id="f110a-250">The program will reflect the new version of the TypeEquivalenceRuntime assembly without having been recompiled.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f110a-251">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="f110a-251">See Also</span></span>  
 <span data-ttu-id="f110a-252">[/Link (Visual Basic)](../../../../visual-basic/reference/command-line-compiler/link.md) </span><span class="sxs-lookup"><span data-stu-id="f110a-252">[/link (Visual Basic)](../../../../visual-basic/reference/command-line-compiler/link.md) </span></span>  
<span data-ttu-id="f110a-253"> [Concetti di programmazione](../../../../visual-basic/programming-guide/concepts/index.md) </span><span class="sxs-lookup"><span data-stu-id="f110a-253"> [Programming Concepts](../../../../visual-basic/programming-guide/concepts/index.md) </span></span>  
<span data-ttu-id="f110a-254"> [Programmazione con assembly](http://msdn.microsoft.com/library/25918b15-701d-42c7-95fc-c290d08648d6) </span><span class="sxs-lookup"><span data-stu-id="f110a-254"> [Programming with Assemblies](http://msdn.microsoft.com/library/25918b15-701d-42c7-95fc-c290d08648d6) </span></span>  
<span data-ttu-id="f110a-255"> [Gli assembly e Global Assembly Cache (Visual Basic)](../../../../visual-basic/programming-guide/concepts/assemblies-gac/index.md)</span><span class="sxs-lookup"><span data-stu-id="f110a-255"> [Assemblies and the Global Assembly Cache (Visual Basic)](../../../../visual-basic/programming-guide/concepts/assemblies-gac/index.md)</span></span>

