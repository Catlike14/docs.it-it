---
title: "Risoluzione dei problemi di interoperabilità (Visual Basic) | Documenti di Microsoft"
ms.custom: 
ms.date: 2015-07-20
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-visual-basic
ms.topic: article
dev_langs:
- VB
helpviewer_keywords:
- interop, deploying assemblies
- assemblies [Visual Basic]
- interop, installing assemblies that share components
- COM objects, troubleshooting
- interop, sharing components
- troubleshooting interoperability
- interoperability, troubleshooting
- COM interop, troubleshooting
- assemblies [Visual Basic], deploying
- troubleshooting Visual Basic, interoperability
- interop assemblies
- interoperability, sharing components
- shared components, using with assemblies
ms.assetid: b324cc1e-b03c-4f39-aea6-6a6d5bfd0e37
caps.latest.revision: 21
author: dotnet-bot
ms.author: dotnetcontent
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
ms.translationtype: Machine Translation
ms.sourcegitcommit: 9f5b8ebb69c9206ff90b05e748c64d29d82f7a16
ms.openlocfilehash: f4a906b685ac02e89eb1dd94d538be3288b03ca1
ms.contentlocale: it-it
ms.lasthandoff: 04/12/2017

---
# <a name="troubleshooting-interoperability-visual-basic"></a><span data-ttu-id="9a1d0-102">Risoluzione dei problemi relativi all'interoperabilità (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="9a1d0-102">Troubleshooting Interoperability (Visual Basic)</span></span>
<span data-ttu-id="9a1d0-103">Durante l'interazione tra COM e il codice gestito del [!INCLUDE[dnprdnshort](../../../csharp/getting-started/includes/dnprdnshort_md.md)], è possibile riscontrare uno o più dei seguenti problemi comuni.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-103">When you interoperate between COM and the managed code of the [!INCLUDE[dnprdnshort](../../../csharp/getting-started/includes/dnprdnshort_md.md)], you may encounter one or more of the following common issues.</span></span>  
  
##  <span data-ttu-id="9a1d0-104"><a name="vbconinteroperabilitymarshalinganchor1"></a>Marshalling di interoperabilità</span><span class="sxs-lookup"><span data-stu-id="9a1d0-104"><a name="vbconinteroperabilitymarshalinganchor1"></a> Interop Marshaling</span></span>  
 <span data-ttu-id="9a1d0-105">In alcuni casi, potrebbe essere necessario utilizzare i tipi di dati che non sono in parte il [!INCLUDE[dnprdnshort](../../../csharp/getting-started/includes/dnprdnshort_md.md)].</span><span class="sxs-lookup"><span data-stu-id="9a1d0-105">At times, you may have to use data types that are not part of the [!INCLUDE[dnprdnshort](../../../csharp/getting-started/includes/dnprdnshort_md.md)].</span></span> <span data-ttu-id="9a1d0-106">Gli assembly di interoperabilità gestiscono la maggior parte del lavoro per gli oggetti COM, ma potrebbe essere necessario controllare i tipi di dati che vengono utilizzati quando gli oggetti gestiti esposti a COM.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-106">Interop assemblies handle most of the work for COM objects, but you may have to control the data types that are used when managed objects are exposed to COM.</span></span> <span data-ttu-id="9a1d0-107">Ad esempio, è necessario specificare le strutture nelle librerie di classi di `BStr` tipo nelle stringhe inviate a oggetti COM creati mediante Visual Basic 6.0 e versioni precedenti non gestito.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-107">For example, structures in class libraries must specify the `BStr` unmanaged type on strings sent to COM objects created by Visual Basic 6.0 and earlier versions.</span></span> <span data-ttu-id="9a1d0-108">In questi casi, è possibile utilizzare il <xref:System.Runtime.InteropServices.MarshalAsAttribute>attributo in modo tipi gestiti vengano esposti come tipi non gestiti.</xref:System.Runtime.InteropServices.MarshalAsAttribute></span><span class="sxs-lookup"><span data-stu-id="9a1d0-108">In such cases, you can use the <xref:System.Runtime.InteropServices.MarshalAsAttribute> attribute to cause managed types to be exposed as unmanaged types.</span></span>  
  
##  <span data-ttu-id="9a1d0-109"><a name="vbconinteroperabilitymarshalinganchor2"></a>Esportazione di stringhe a lunghezza fissa in codice non gestito</span><span class="sxs-lookup"><span data-stu-id="9a1d0-109"><a name="vbconinteroperabilitymarshalinganchor2"></a> Exporting Fixed-Length Strings to Unmanaged Code</span></span>  
 <span data-ttu-id="9a1d0-110">In Visual Basic 6.0 e versioni precedenti, le stringhe vengono esportate in oggetti COM come sequenze di byte senza un carattere di terminazione null.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-110">In Visual Basic 6.0 and earlier versions, strings are exported to COM objects as sequences of bytes without a null termination character.</span></span> <span data-ttu-id="9a1d0-111">Per la compatibilità con altri linguaggi, [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)] include un carattere di terminazione durante l'esportazione di stringhe.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-111">For compatibility with other languages, [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)] includes a termination character when exporting strings.</span></span> <span data-ttu-id="9a1d0-112">È il modo migliore per risolvere questo problema di incompatibilità per esportare le stringhe senza carattere di terminazione come matrici di `Byte` o `Char`.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-112">The best way to address this incompatibility is to export strings that lack the termination character as arrays of `Byte` or `Char`.</span></span>  
  
##  <span data-ttu-id="9a1d0-113"><a name="vbconinteroperabilitymarshalinganchor3"></a>L'esportazione delle gerarchie di ereditarietà</span><span class="sxs-lookup"><span data-stu-id="9a1d0-113"><a name="vbconinteroperabilitymarshalinganchor3"></a> Exporting Inheritance Hierarchies</span></span>  
 <span data-ttu-id="9a1d0-114">Gerarchie appiattire out quando esposti come oggetti COM di classe gestita.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-114">Managed class hierarchies flatten out when exposed as COM objects.</span></span> <span data-ttu-id="9a1d0-115">Ad esempio, se si definisce una classe base con un membro e quindi ereditare la classe di base in una classe derivata che viene esposto come un oggetto COM, i client che utilizzano la classe derivata dell'oggetto COM non sarà in grado di utilizzare i membri ereditati.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-115">For example, if you define a base class with a member, and then inherit the base class in a derived class that is exposed as a COM object, clients that use the derived class in the COM object will not be able to use the inherited members.</span></span> <span data-ttu-id="9a1d0-116">Membri della classe base è possibile accedere da oggetti COM solo come istanze di una classe base e quindi solo se la classe di base viene inoltre creata come oggetto COM.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-116">Base class members can be accessed from COM objects only as instances of a base class, and then only if the base class is also created as a COM object.</span></span>  
  
## <a name="overloaded-methods"></a><span data-ttu-id="9a1d0-117">Metodi di overload</span><span class="sxs-lookup"><span data-stu-id="9a1d0-117">Overloaded Methods</span></span>  
 <span data-ttu-id="9a1d0-118">Sebbene sia possibile creare metodi di overload con [!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)], non sono supportate da COM.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-118">Although you can create overloaded methods with [!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)], they are not supported by COM.</span></span> <span data-ttu-id="9a1d0-119">Quando una classe che contiene metodi di overload viene esposta come oggetto COM, vengono generati nuovi nomi per i metodi di overload.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-119">When a class that contains overloaded methods is exposed as a COM object, new method names are generated for the overloaded methods.</span></span>  
  
 <span data-ttu-id="9a1d0-120">Ad esempio, si consideri una classe che dispone di due overload di `Synch` metodo.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-120">For example, consider a class that has two overloads of the `Synch` method.</span></span> <span data-ttu-id="9a1d0-121">Quando la classe viene esposta come oggetto COM, i nuovi nomi di metodo generato potrebbero essere `Synch` e `Synch_2`.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-121">When the class is exposed as a COM object, the new generated method names could be `Synch` and `Synch_2`.</span></span>  
  
 <span data-ttu-id="9a1d0-122">La ridenominazione può causare due problemi per i consumer dell'oggetto COM.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-122">The renaming can cause two problems for consumers of the COM object.</span></span>  
  
1.  <span data-ttu-id="9a1d0-123">I client potrebbero non prevedere i nomi di metodo generato.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-123">Clients might not expect the generated method names.</span></span>  
  
2.  <span data-ttu-id="9a1d0-124">I nomi di metodo generato nella classe esposta come oggetto COM possono cambiare quando vengono aggiunti nuovi overload per la classe o la relativa classe base.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-124">The generated method names in the class exposed as a COM object can change when new overloads are added to the class or its base class.</span></span> <span data-ttu-id="9a1d0-125">Ciò può provocare problemi di controllo delle versioni.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-125">This can cause versioning problems.</span></span>  
  
 <span data-ttu-id="9a1d0-126">Per risolvere entrambi i problemi, assegnare a ogni metodo di un nome univoco, anziché utilizzare l'overload, quando si sviluppano oggetti che verranno esposti come oggetti COM.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-126">To solve both problems, give each method a unique name, instead of using overloading, when you develop objects that will be exposed as COM objects.</span></span>  
  
##  <span data-ttu-id="9a1d0-127"><a name="vbconinteroperabilitymarshalinganchor4"></a>Utilizzo di oggetti COM tramite assembly di interoperabilità</span><span class="sxs-lookup"><span data-stu-id="9a1d0-127"><a name="vbconinteroperabilitymarshalinganchor4"></a> Use of COM Objects Through Interop Assemblies</span></span>  
 <span data-ttu-id="9a1d0-128">Utilizzare assembly di interoperabilità come se fossero in sostituzione di codice gestito per gli oggetti COM che rappresentano.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-128">You use interop assemblies almost as if they are managed code replacements for the COM objects they represent.</span></span> <span data-ttu-id="9a1d0-129">Tuttavia, poiché si tratta di wrapper e gli oggetti COM non effettivi, esistono alcune differenze tra l'utilizzo di assembly di interoperabilità e gli assembly standard.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-129">However, because they are wrappers and not actual COM objects, there are some differences between using interop assemblies and standard assemblies.</span></span> <span data-ttu-id="9a1d0-130">Le differenze includono l'esposizione di classi e tipi di dati per i parametri e valori restituiti.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-130">These areas of difference include the exposure of classes, and data types for parameters and return values.</span></span>  
  
##  <span data-ttu-id="9a1d0-131"><a name="vbconinteroperabilitymarshalinganchor5"></a>Classi esposte come entrambe le interfacce e classi</span><span class="sxs-lookup"><span data-stu-id="9a1d0-131"><a name="vbconinteroperabilitymarshalinganchor5"></a> Classes Exposed as Both Interfaces and Classes</span></span>  
 <span data-ttu-id="9a1d0-132">A differenza delle classi in assembly standard, le classi COM vengono esposte nell'assembly di interoperabilità come un'interfaccia e una classe che rappresenta la classe COM.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-132">Unlike classes in standard assemblies, COM classes are exposed in interop assemblies as both an interface and a class that represents the COM class.</span></span> <span data-ttu-id="9a1d0-133">Il nome dell'interfaccia è identico a quello della classe COM.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-133">The interface's name is identical to that of the COM class.</span></span> <span data-ttu-id="9a1d0-134">Il nome della classe di interoperabilità è uguale a quello della classe COM originale, ma con la parola "Classe" aggiunto.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-134">The name of the interop class is the same as that of the original COM class, but with the word "Class" appended.</span></span> <span data-ttu-id="9a1d0-135">Ad esempio, si supponga di che avere un progetto con un riferimento a un assembly di interoperabilità per un oggetto COM.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-135">For example, suppose you have a project with a reference to an interop assembly for a COM object.</span></span> <span data-ttu-id="9a1d0-136">Se la classe COM è denominata `MyComClass`, IntelliSense e il Visualizzatore Mostra un'interfaccia denominata `MyComClass` e una classe denominata `MyComClassClass`.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-136">If the COM class is named `MyComClass`, IntelliSense and the Object Browser show an interface named `MyComClass` and a class named `MyComClassClass`.</span></span>  
  
##  <span data-ttu-id="9a1d0-137"><a name="vbconinteroperabilitymarshalinganchor6"></a>Creazione di istanze di classi .NET Framework</span><span class="sxs-lookup"><span data-stu-id="9a1d0-137"><a name="vbconinteroperabilitymarshalinganchor6"></a> Creating Instances of a .NET Framework Class</span></span>  
 <span data-ttu-id="9a1d0-138">In genere viene creata un'istanza di un [!INCLUDE[dnprdnshort](../../../csharp/getting-started/includes/dnprdnshort_md.md)] usando il `New` istruzione con un nome di classe.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-138">Generally, you create an instance of a [!INCLUDE[dnprdnshort](../../../csharp/getting-started/includes/dnprdnshort_md.md)] class using the `New` statement with a class name.</span></span> <span data-ttu-id="9a1d0-139">Quando una classe COM rappresentata da un assembly di interoperabilità è un caso in cui è possibile utilizzare il `New` istruzione con un'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-139">Having a COM class represented by an interop assembly is the one case in which you can use the `New` statement with an interface.</span></span> <span data-ttu-id="9a1d0-140">A meno che non si utilizza la classe COM con un `Inherits` istruzione, è possibile utilizzare l'interfaccia come se fosse una classe.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-140">Unless you are using the COM class with an `Inherits` statement, you can use the interface just as you would a class.</span></span> <span data-ttu-id="9a1d0-141">Il codice seguente viene illustrato come creare un `Command` oggetto in un progetto che contiene un riferimento all'oggetto Microsoft ActiveX Data oggetti 2.8 libreria COM:</span><span class="sxs-lookup"><span data-stu-id="9a1d0-141">The following code demonstrates how to create a `Command` object in a project that has a reference to the Microsoft ActiveX Data Objects 2.8 Library COM object:</span></span>  
  
 <span data-ttu-id="9a1d0-142">[!code-vb[VbVbalrInterop&#20;](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_1.vb)]</span><span class="sxs-lookup"><span data-stu-id="9a1d0-142">[!code-vb[VbVbalrInterop#20](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_1.vb)]</span></span>  
  
 <span data-ttu-id="9a1d0-143">Tuttavia, se si utilizza la classe COM come base per una classe derivata, è necessario utilizzare la classe di interoperabilità che rappresenta la classe COM, come nel codice seguente:</span><span class="sxs-lookup"><span data-stu-id="9a1d0-143">However, if you are using the COM class as the base for a derived class, you must use the interop class that represents the COM class, as in the following code:</span></span>  
  
 <span data-ttu-id="9a1d0-144">[!code-vb[VbVbalrInterop numero&21;](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_2.vb)]</span><span class="sxs-lookup"><span data-stu-id="9a1d0-144">[!code-vb[VbVbalrInterop#21](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_2.vb)]</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9a1d0-145">Assembly di interoperabilità implementano in modo implicito interfacce che rappresentano classi COM.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-145">Interop assemblies implicitly implement interfaces that represent COM classes.</span></span> <span data-ttu-id="9a1d0-146">Non è consigliabile provare a utilizzare il `Implements` comporterà l'istruzione per implementare queste interfacce o un errore.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-146">You should not try to use the `Implements` statement to implement these interfaces or an error will result.</span></span>  
  
##  <span data-ttu-id="9a1d0-147"><a name="vbconinteroperabilitymarshalinganchor7"></a>Tipi di dati per i parametri e valori restituiti</span><span class="sxs-lookup"><span data-stu-id="9a1d0-147"><a name="vbconinteroperabilitymarshalinganchor7"></a> Data Types for Parameters and Return Values</span></span>  
 <span data-ttu-id="9a1d0-148">A differenza dei membri dell'assembly standard, i membri di assembly di interoperabilità possono includere tipi di dati che differiscono da quelli utilizzati nella dichiarazione dell'oggetto originale.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-148">Unlike members of standard assemblies, interop assembly members may have data types that differ from those used in the  original object declaration.</span></span> <span data-ttu-id="9a1d0-149">Anche se gli assembly di interoperabilità convertono implicita dei tipi COM in tipi di common language runtime compatibili, è necessario prestare attenzione ai tipi di dati che vengono utilizzati da entrambi i lati per evitare errori di runtime.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-149">Although interop assemblies implicitly convert COM types to compatible common language runtime types, you should pay attention to the data types that are used by both sides to prevent runtime errors.</span></span> <span data-ttu-id="9a1d0-150">Ad esempio, negli oggetti COM creati in Visual Basic 6.0 e versioni precedenti, i valori di tipo `Integer` presuppongono il [!INCLUDE[dnprdnshort](../../../csharp/getting-started/includes/dnprdnshort_md.md)] tipo equivalente, `Short`.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-150">For example, in COM objects created in Visual Basic 6.0 and earlier versions, values of type `Integer` assume the [!INCLUDE[dnprdnshort](../../../csharp/getting-started/includes/dnprdnshort_md.md)] equivalent type, `Short`.</span></span> <span data-ttu-id="9a1d0-151">È consigliabile che utilizzare il Visualizzatore oggetti per esaminare le caratteristiche dei membri importati prima di utilizzarli.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-151">It is recommended that you use the Object Browser to examine the characteristics of imported members before you use them.</span></span>  
  
##  <span data-ttu-id="9a1d0-152"><a name="vbconinteroperabilitymarshalinganchor8"></a>Metodi COM a livello di modulo</span><span class="sxs-lookup"><span data-stu-id="9a1d0-152"><a name="vbconinteroperabilitymarshalinganchor8"></a> Module level COM methods</span></span>  
 <span data-ttu-id="9a1d0-153">Molti oggetti COM vengono utilizzati creando un'istanza di una classe COM utilizzando il `New` (parola chiave) e quindi chiamando i metodi dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-153">Most COM objects are used by creating an instance of a COM class using the `New` keyword and then calling methods of the object.</span></span> <span data-ttu-id="9a1d0-154">Un'eccezione a questa regola riguarda oggetti COM che contengono `AppObj` o `GlobalMultiUse` classi COM.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-154">One exception to this rule involves COM objects that contain `AppObj` or `GlobalMultiUse` COM classes.</span></span> <span data-ttu-id="9a1d0-155">Tali classi assomigliano ai metodi a livello di modulo in [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)] classi.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-155">Such classes resemble module level methods in [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)] classes.</span></span> <span data-ttu-id="9a1d0-156">Visual Basic 6.0 e versioni precedenti in modo implicito creano istanze di tali oggetti è la prima volta che viene chiamato uno dei relativi metodi.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-156">Visual Basic 6.0 and earlier versions implicitly create instances of such objects for you the first time that you call one of their methods.</span></span> <span data-ttu-id="9a1d0-157">In Visual Basic 6.0, ad esempio, è possibile aggiungere un riferimento alla libreria oggetti Microsoft DAO 3.6 e chiamare il `DBEngine` metodo senza prima creare un'istanza:</span><span class="sxs-lookup"><span data-stu-id="9a1d0-157">For example, in Visual Basic 6.0 you can add a reference to the Microsoft DAO 3.6 Object Library and call the `DBEngine` method without first creating an instance:</span></span>  
  
```  
Dim db As DAO.Database  
' Open the database.  
Set db = DBEngine.OpenDatabase("C:\nwind.mdb")  
' Use the database object.  
```  
  
 [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)]<span data-ttu-id="9a1d0-158">è necessario creare istanze di oggetti COM sempre prima di poter utilizzare i relativi metodi.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-158"> requires that you always create instances of COM objects before you can use their methods.</span></span> <span data-ttu-id="9a1d0-159">Utilizzare questi metodi in [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)], dichiarare una variabile della classe desiderata e utilizzare la parola chiave new per assegnare l'oggetto per la variabile oggetto.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-159">To use these methods in [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)], declare a variable of the desired class and use the new keyword to assign the object to the object variable.</span></span> <span data-ttu-id="9a1d0-160">Il `Shared` parola chiave può essere utilizzata quando si desidera assicurarsi che viene creata solo un'istanza della classe.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-160">The `Shared` keyword can be used when you want to make sure that only one instance of the class is created.</span></span>  
  
 <span data-ttu-id="9a1d0-161">[!code-vb[VbVbalrInterop&#23;](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_3.vb)]</span><span class="sxs-lookup"><span data-stu-id="9a1d0-161">[!code-vb[VbVbalrInterop#23](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_3.vb)]</span></span>  
  
##  <span data-ttu-id="9a1d0-162"><a name="vbconinteroperabilitymarshalinganchor9"></a>Errori non gestiti nei gestori eventi</span><span class="sxs-lookup"><span data-stu-id="9a1d0-162"><a name="vbconinteroperabilitymarshalinganchor9"></a> Unhandled Errors in Event Handlers</span></span>  
 <span data-ttu-id="9a1d0-163">Un problema di interoperabilità comune riguarda gli errori nei gestori eventi che gestiscono gli eventi generati da oggetti COM.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-163">One common interop problem involves errors in event handlers that handle events raised by COM objects.</span></span> <span data-ttu-id="9a1d0-164">Tali errori vengono ignorati a meno che non un controllo specifico degli errori utilizzando `On Error` o `Try...Catch...Finally` istruzioni.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-164">Such errors are ignored unless you specifically check for errors using `On Error` or `Try...Catch...Finally` statements.</span></span> <span data-ttu-id="9a1d0-165">Ad esempio, l'esempio seguente è da un [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)] progetto che contiene un riferimento all'oggetto Microsoft ActiveX Data oggetti 2.8 libreria COM.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-165">For example, the following example is from a [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)] project that has a reference to the Microsoft ActiveX Data Objects 2.8 Library COM object.</span></span>  
  
 <span data-ttu-id="9a1d0-166">[!code-vb[VbVbalrInterop&#24;](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_4.vb)]</span><span class="sxs-lookup"><span data-stu-id="9a1d0-166">[!code-vb[VbVbalrInterop#24](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_4.vb)]</span></span>  
  
 <span data-ttu-id="9a1d0-167">In questo esempio viene generato un errore nel modo previsto.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-167">This example raises an error as expected.</span></span> <span data-ttu-id="9a1d0-168">Tuttavia, se si tenta dello stesso esempio senza il `Try...Catch...Finally` blocco, l'errore viene ignorato se è stato utilizzato il `OnError Resume Next` istruzione.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-168">However, if you try the same example without the `Try...Catch...Finally` block, the error is ignored as if you used the `OnError Resume Next` statement.</span></span> <span data-ttu-id="9a1d0-169">Senza la gestione degli errori, la divisione per zero non riuscirà automaticamente.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-169">Without error handling, the division by zero silently fails.</span></span> <span data-ttu-id="9a1d0-170">Poiché tali errori non generano mai errori di eccezione non gestita, è importante utilizzare qualche forma di gestione delle eccezioni nei gestori eventi che gestiscono gli eventi da oggetti COM.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-170">Because such errors never raise unhandled exception errors, it is important that you use some form of exception handling in event handlers that handle events from COM objects.</span></span>  
  
### <a name="understanding-com-interop-errors"></a><span data-ttu-id="9a1d0-171">Informazioni sugli errori di interoperabilità COM</span><span class="sxs-lookup"><span data-stu-id="9a1d0-171">Understanding COM interop errors</span></span>  
 <span data-ttu-id="9a1d0-172">Senza la gestione degli errori, le chiamate all'interoperabilità spesso generano errori che forniscono informazioni insufficienti.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-172">Without error handling, interop calls often generate errors that provide little information.</span></span> <span data-ttu-id="9a1d0-173">Se possibile, utilizzare gestione per fornire ulteriori informazioni sui problemi quando si verificano errori strutturata.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-173">Whenever possible, use structured error handling to provide more information about problems when they occur.</span></span> <span data-ttu-id="9a1d0-174">Può essere particolarmente utile quando si esegue il debug di applicazioni.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-174">This can be especially helpful when you debug applications.</span></span> <span data-ttu-id="9a1d0-175">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="9a1d0-175">For example:</span></span>  
  
 <span data-ttu-id="9a1d0-176">[!code-vb[VbVbalrInterop&#25;](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_5.vb)]</span><span class="sxs-lookup"><span data-stu-id="9a1d0-176">[!code-vb[VbVbalrInterop#25](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_5.vb)]</span></span>  
  
 <span data-ttu-id="9a1d0-177">È possibile trovare informazioni quali la descrizione dell'errore, HRESULT e l'origine degli errori COM esaminando il contenuto dell'oggetto eccezione.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-177">You can find information such as the error description, HRESULT, and the source of COM errors by examining the contents of the exception object.</span></span>  
  
##  <span data-ttu-id="9a1d0-178"><a name="vbconinteroperabilitymarshalinganchor10"></a>Problemi relativi al controllo ActiveX</span><span class="sxs-lookup"><span data-stu-id="9a1d0-178"><a name="vbconinteroperabilitymarshalinganchor10"></a> ActiveX Control Issues</span></span>  
 <span data-ttu-id="9a1d0-179">Utilizzano la maggior parte dei controlli ActiveX che funzionano con Visual Basic 6.0 [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)] senza problemi.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-179">Most ActiveX controls that work with Visual Basic 6.0 work with [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)] without trouble.</span></span> <span data-ttu-id="9a1d0-180">Le principali eccezioni sono controlli contenitore, o che visivamente contengono altri controlli.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-180">The main exceptions are container controls, or controls that visually contain other controls.</span></span> <span data-ttu-id="9a1d0-181">Alcuni esempi di controlli precedenti che non funzionano correttamente con [!INCLUDE[vsprvs](../../../csharp/includes/vsprvs_md.md)] sono i seguenti:</span><span class="sxs-lookup"><span data-stu-id="9a1d0-181">Some examples of older controls that do not work correctly with [!INCLUDE[vsprvs](../../../csharp/includes/vsprvs_md.md)] are as follows:</span></span>  
  
-   <span data-ttu-id="9a1d0-182">Controllo di Microsoft Forms 2.0 Frame</span><span class="sxs-lookup"><span data-stu-id="9a1d0-182">Microsoft Forms 2.0 Frame control</span></span>  
  
-   <span data-ttu-id="9a1d0-183">Controllo di scorrimento, noto anche come il controllo di selezione</span><span class="sxs-lookup"><span data-stu-id="9a1d0-183">Up-Down control, also known as the spin control</span></span>  
  
-   <span data-ttu-id="9a1d0-184">Schede Sheridan</span><span class="sxs-lookup"><span data-stu-id="9a1d0-184">Sheridan Tab Control</span></span>  
  
 <span data-ttu-id="9a1d0-185">Sono disponibili solo alcune soluzioni per problemi di controlli ActiveX non supportati.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-185">There are only a few workarounds for unsupported ActiveX control problems.</span></span> <span data-ttu-id="9a1d0-186">È possibile migrare i controlli esistenti a [!INCLUDE[vsprvs](../../../csharp/includes/vsprvs_md.md)] se si è proprietari del codice sorgente originale.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-186">You can migrate existing controls to [!INCLUDE[vsprvs](../../../csharp/includes/vsprvs_md.md)] if you own the original source code.</span></span> <span data-ttu-id="9a1d0-187">In caso contrario, è possibile controllare con fornitori di software per l'aggiornamento. NET-compatibile con le versioni dei controlli per sostituire non supportati controlli ActiveX.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-187">Otherwise, you can check with software vendors for updated .NET-compatible versions of controls to replace unsupported ActiveX controls.</span></span>  
  
##  <span data-ttu-id="9a1d0-188"><a name="vbconinteroperabilitymarshalinganchor11"></a>Passaggio di proprietà ReadOnly di controlli ByRef</span><span class="sxs-lookup"><span data-stu-id="9a1d0-188"><a name="vbconinteroperabilitymarshalinganchor11"></a> Passing ReadOnly Properties of Controls ByRef</span></span>  
 [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)]<span data-ttu-id="9a1d0-189">talvolta genera errori COM, ad esempio "Error 0x800A017F CTL_E_SETNOTSUPPORTED" quando si passa `ReadOnly` le proprietà di alcuni controlli ActiveX meno recenti come `ByRef` parametri alle altre procedure.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-189"> sometimes raises COM errors such as "Error 0x800A017F CTL_E_SETNOTSUPPORTED" when you pass `ReadOnly` properties of some older ActiveX controls as `ByRef` parameters to other procedures.</span></span> <span data-ttu-id="9a1d0-190">Chiamate di routine simili da Visual Basic 6.0 non generano un errore e i parametri vengono considerati come se passati per valore.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-190">Similar procedure calls from Visual Basic 6.0 do not raise an error, and the parameters are treated as if you passed them by value.</span></span> <span data-ttu-id="9a1d0-191">Il messaggio di errore visualizzato in [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)] è l'oggetto COM che indica che si sta tentando di modificare una proprietà che non dispone di una proprietà `Set` procedura.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-191">The error message you see in [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)] is the COM object reporting that you are trying to change a property that does not have a property `Set` procedure.</span></span>  
  
 <span data-ttu-id="9a1d0-192">Se si dispone di accesso per la routine chiamata, è possibile impedire l'errore utilizzando il `ByVal` parola chiave per dichiarare i parametri che accettano `ReadOnly` proprietà.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-192">If you have access to the procedure being called, you can prevent this error by using the `ByVal` keyword to declare parameters that accept `ReadOnly` properties.</span></span> <span data-ttu-id="9a1d0-193">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="9a1d0-193">For example:</span></span>  
  
 <span data-ttu-id="9a1d0-194">[!code-vb[&#26; VbVbalrInterop](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_6.vb)]</span><span class="sxs-lookup"><span data-stu-id="9a1d0-194">[!code-vb[VbVbalrInterop#26](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_6.vb)]</span></span>  
  
 <span data-ttu-id="9a1d0-195">Se non si ha accesso al codice sorgente per la routine chiamata, è possibile forzare la proprietà può essere passato per valore mediante l'aggiunta di un set aggiuntivo di parentesi quadre intorno alla routine chiamante.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-195">If you do not have access to the source code for the procedure being called, you can force the property to be passed by value by adding an extra set of brackets around the calling procedure.</span></span> <span data-ttu-id="9a1d0-196">In un progetto che contiene un riferimento all'oggetto Microsoft ActiveX Data oggetti 2.8 libreria COM, ad esempio, è possibile utilizzare:</span><span class="sxs-lookup"><span data-stu-id="9a1d0-196">For example, in a project that has a reference to the Microsoft ActiveX Data Objects 2.8 Library COM object, you can use:</span></span>  
  
 <span data-ttu-id="9a1d0-197">[!code-vb[VbVbalrInterop&#27;](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_7.vb)]</span><span class="sxs-lookup"><span data-stu-id="9a1d0-197">[!code-vb[VbVbalrInterop#27](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_7.vb)]</span></span>  
  
##  <span data-ttu-id="9a1d0-198"><a name="vbconinteroperabilitymarshalinganchor12"></a>Distribuzione di assembly che espongono l'interoperabilità</span><span class="sxs-lookup"><span data-stu-id="9a1d0-198"><a name="vbconinteroperabilitymarshalinganchor12"></a> Deploying Assemblies That Expose Interop</span></span>  
 <span data-ttu-id="9a1d0-199">Distribuzione di assembly che espongono interfacce COM presenta alcune difficoltà specifiche.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-199">Deploying assemblies that expose COM interfaces presents some unique challenges.</span></span> <span data-ttu-id="9a1d0-200">Ad esempio, un potenziale problema si verifica quando applicazioni separate che fanno riferimento allo stesso assembly COM.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-200">For example, a potential problem occurs when separate applications reference the same COM assembly.</span></span> <span data-ttu-id="9a1d0-201">Questa situazione è comune quando si installa una nuova versione di un assembly e un'altra applicazione utilizza ancora la versione precedente dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-201">This situation is common when a new version of an assembly is installed and another application is still using the old version of the assembly.</span></span> <span data-ttu-id="9a1d0-202">Se si disinstalla un assembly che condivide una DLL, sarà possibile involontariamente renderla disponibile ad altri assembly.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-202">If you uninstall an assembly that shares a DLL, you can unintentionally make it unavailable to the other assemblies.</span></span>  
  
 <span data-ttu-id="9a1d0-203">Per evitare questo problema, è necessario installare gli assembly condivisi alla Global Assembly Cache (GAC) e utilizzare un modulo unione per il componente.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-203">To avoid this problem, you should install shared assemblies to the Global Assembly Cache (GAC) and use a MergeModule for the component.</span></span> <span data-ttu-id="9a1d0-204">Se non è possibile installare l'applicazione nella Global Assembly Cache, deve essere installato in CommonFilesFolder in una sottodirectory specifica della versione.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-204">If you cannot install the application in the GAC, it should be installed to CommonFilesFolder in a version-specific subdirectory.</span></span>  
  
 <span data-ttu-id="9a1d0-205">Gli assembly che non sono condivisi devono trovarsi side-by-side nella directory dell'applicazione chiamante.</span><span class="sxs-lookup"><span data-stu-id="9a1d0-205">Assemblies that are not shared should be located side by side in the directory with the calling application.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9a1d0-206">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="9a1d0-206">See Also</span></span>  
 <span data-ttu-id="9a1d0-207"><xref:System.Runtime.InteropServices.MarshalAsAttribute></xref:System.Runtime.InteropServices.MarshalAsAttribute></span><span class="sxs-lookup"><span data-stu-id="9a1d0-207"><xref:System.Runtime.InteropServices.MarshalAsAttribute></span></span>   
<span data-ttu-id="9a1d0-208"> [Interoperabilità COM](../../../visual-basic/programming-guide/com-interop/index.md) </span><span class="sxs-lookup"><span data-stu-id="9a1d0-208"> [COM Interop](../../../visual-basic/programming-guide/com-interop/index.md) </span></span>  
<span data-ttu-id="9a1d0-209"> [Tlbimp.exe (Type Library Importer)](http://msdn.microsoft.com/library/ec0a8d63-11b3-4acd-b398-da1e37e97382) </span><span class="sxs-lookup"><span data-stu-id="9a1d0-209"> [Tlbimp.exe (Type Library Importer)](http://msdn.microsoft.com/library/ec0a8d63-11b3-4acd-b398-da1e37e97382) </span></span>  
<span data-ttu-id="9a1d0-210"> [Tlbexp.exe (Type Library Exporter)](http://msdn.microsoft.com/library/a487d61b-d166-467b-a7ca-d8b52fbff42d) </span><span class="sxs-lookup"><span data-stu-id="9a1d0-210"> [Tlbexp.exe (Type Library Exporter)](http://msdn.microsoft.com/library/a487d61b-d166-467b-a7ca-d8b52fbff42d) </span></span>  
<span data-ttu-id="9a1d0-211"> [Procedura dettagliata: Implementazione dell'ereditarietà con gli oggetti COM](../../../visual-basic/programming-guide/com-interop/walkthrough-implementing-inheritance-with-com-objects.md) </span><span class="sxs-lookup"><span data-stu-id="9a1d0-211"> [Walkthrough: Implementing Inheritance with COM Objects](../../../visual-basic/programming-guide/com-interop/walkthrough-implementing-inheritance-with-com-objects.md) </span></span>  
<span data-ttu-id="9a1d0-212"> [Inherits (istruzione)](../../../visual-basic/language-reference/statements/inherits-statement.md) </span><span class="sxs-lookup"><span data-stu-id="9a1d0-212"> [Inherits Statement](../../../visual-basic/language-reference/statements/inherits-statement.md) </span></span>  
<span data-ttu-id="9a1d0-213"> [Global Assembly Cache](http://msdn.microsoft.com/library/cf5eacd0-d3ec-4879-b6da-5fd5e4372202)</span><span class="sxs-lookup"><span data-stu-id="9a1d0-213"> [Global Assembly Cache](http://msdn.microsoft.com/library/cf5eacd0-d3ec-4879-b6da-5fd5e4372202)</span></span>
