---
title: Matrici in Visual Basic
ms.custom: 
ms.date: 07/20/2015
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology: devlang-visual-basic
ms.topic: article
f1_keywords: vb.Array
helpviewer_keywords:
- arrays [Visual Basic]
- Visual Basic, arrays
ms.assetid: dbf29737-b589-4443-bee6-a27588d9c67e
caps.latest.revision: "47"
author: dotnet-bot
ms.author: dotnetcontent
ms.openlocfilehash: 04deeccd19fd4edb3f2c88310d660eedf5c707d5
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 11/21/2017
---
# <a name="arrays-in-visual-basic"></a><span data-ttu-id="07c45-102">Matrici in Visual Basic</span><span class="sxs-lookup"><span data-stu-id="07c45-102">Arrays in Visual Basic</span></span>
<span data-ttu-id="07c45-103">Una matrice è costituita da un insieme di valori logicamente correlati tra loro, ad esempio il numero degli studenti iscritti a ciascun anno scolastico di una scuola elementare.</span><span class="sxs-lookup"><span data-stu-id="07c45-103">An array is a set of values that are logically related to each other, such as the number of students in each grade in a grammar school.</span></span>  <span data-ttu-id="07c45-104">Per informazioni sulle matrici in Visual Basic for Applications (VBA), vedere la [documentazione di riferimento del linguaggio](https://msdn.microsoft.com/library/office/gg264383\(v=office.14\).aspx).</span><span class="sxs-lookup"><span data-stu-id="07c45-104">If you are looking for help on arrays in Visual Basic for Applications (VBA), see the [language reference](https://msdn.microsoft.com/library/office/gg264383\(v=office.14\).aspx).</span></span>  
  
 <span data-ttu-id="07c45-105">Una matrice permette di fare riferimento ai valori correlati tramite lo stesso nome e usare un numero, denominato indice, per distinguere i valori.</span><span class="sxs-lookup"><span data-stu-id="07c45-105">By using an array, you can refer to these related values by the same name, and use a number that’s called an index or subscript to tell them apart.</span></span> <span data-ttu-id="07c45-106">I singoli valori sono denominati elementi della matrice</span><span class="sxs-lookup"><span data-stu-id="07c45-106">The individual values are called the elements of the array.</span></span> <span data-ttu-id="07c45-107">e sono contigui, dall'indice 0 al valore di indice più alto.</span><span class="sxs-lookup"><span data-stu-id="07c45-107">They’re contiguous from index 0 through the highest index value.</span></span>  
  
 <span data-ttu-id="07c45-108">A differenza di una matrice, una variabile che contiene un singolo valore è denominata variabile *scalare* .</span><span class="sxs-lookup"><span data-stu-id="07c45-108">In contrast to an array, a variable that contain a single value is called a *scalar* variable.</span></span>  
  
 <span data-ttu-id="07c45-109">Di seguito sono riportati alcuni esempi:</span><span class="sxs-lookup"><span data-stu-id="07c45-109">Some quick examples before explanation:</span></span>  
  
```vb  
'Declare a single-dimension array of 5 values  
Dim numbers(4) As Integer   
  
'Declare a single-dimension array and set array element values  
Dim numbers = New Integer() {1, 2, 4, 8}  
  
'Redefine the size of an existing array retaining the current values  
ReDim Preserve numbers(15)  
  
'Redefine the size of an existing array, resetting the values  
ReDim numbers(15)  
  
'Declare a multi-dimensional array  
Dim matrix(5, 5) As Double  
  
'Declare a multi-dimensional array and set array element values  
Dim matrix = New Integer(4, 4) {{1, 2}, {3, 4}, {5, 6}, {7, 8}}  
  
'Declare a jagged array  
Dim sales()() As Double = New Double(11)() {}  
```  
  
 <span data-ttu-id="07c45-110">**Contenuto dell'argomento**</span><span class="sxs-lookup"><span data-stu-id="07c45-110">**In this topic**</span></span>  
  
-   [<span data-ttu-id="07c45-111">Elementi di matrice in una matrice semplice</span><span class="sxs-lookup"><span data-stu-id="07c45-111">Array Elements in a Simple Array</span></span>](#BKMK_ArrayElements)  
  
-   [<span data-ttu-id="07c45-112">Creazione di una matrice</span><span class="sxs-lookup"><span data-stu-id="07c45-112">Creating an Array</span></span>](#BKMK_CreatingAnArray)  
  
-   [<span data-ttu-id="07c45-113">Archiviazione di valori in una matrice</span><span class="sxs-lookup"><span data-stu-id="07c45-113">Storing Values in an Array</span></span>](#BKMK_StoringValues)  
  
-   [<span data-ttu-id="07c45-114">Popolamento di una matrice con valori iniziali</span><span class="sxs-lookup"><span data-stu-id="07c45-114">Populating an Array with Initial Values</span></span>](#BKMK_Populating)  
  
    -   [<span data-ttu-id="07c45-115">Valori letterali di matrice annidati</span><span class="sxs-lookup"><span data-stu-id="07c45-115">Nested Array Literals</span></span>](#BKMK_NestedArrayLiterals)  
  
-   [<span data-ttu-id="07c45-116">Scorrimento di una matrice</span><span class="sxs-lookup"><span data-stu-id="07c45-116">Iterating Through an Array</span></span>](#BKMK_Iterating)  
  
-   [<span data-ttu-id="07c45-117">Matrici come valori e parametri restituiti</span><span class="sxs-lookup"><span data-stu-id="07c45-117">Arrays as Return Values and Parameters</span></span>](#BKMK_ReturnValues)  
  
-   [<span data-ttu-id="07c45-118">Matrici irregolari</span><span class="sxs-lookup"><span data-stu-id="07c45-118">Jagged Arrays</span></span>](#BKMK_JaggedArrays)  
  
-   [<span data-ttu-id="07c45-119">Matrici di lunghezza zero</span><span class="sxs-lookup"><span data-stu-id="07c45-119">Zero-Length Arrays</span></span>](#BKMK_ZeroLength)  
  
-   [<span data-ttu-id="07c45-120">Dimensione della matrice</span><span class="sxs-lookup"><span data-stu-id="07c45-120">Array Size</span></span>](#BKMK_ArraySize)  
  
-   [<span data-ttu-id="07c45-121">Tipi di matrice e altri tipi</span><span class="sxs-lookup"><span data-stu-id="07c45-121">Array Types and Other Types</span></span>](#BKMK_ArrayTypes)  
  
-   [<span data-ttu-id="07c45-122">Raccolte come alternativa alle matrici</span><span class="sxs-lookup"><span data-stu-id="07c45-122">Collections as an Alternative to Arrays</span></span>](#BKMK_Collections)  
  
##  <span data-ttu-id="07c45-123"><a name="BKMK_ArrayElements"></a> Elementi di matrice in una matrice semplice</span><span class="sxs-lookup"><span data-stu-id="07c45-123"><a name="BKMK_ArrayElements"></a> Array Elements in a Simple Array</span></span>  
 <span data-ttu-id="07c45-124">L'esempio seguente descrive come dichiarare una variabile di matrice che deve contenere il numero degli studenti iscritti a ciascun anno scolastico di una scuola elementare.</span><span class="sxs-lookup"><span data-stu-id="07c45-124">The following example declares an array variable to hold the number of students in each grade in a grammar school.</span></span>  
  
 [!code-vb[VbVbalrArrays#2](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#2)]  
  
 <span data-ttu-id="07c45-125">La matrice `students` dell'esempio precedente contiene sette elementi.</span><span class="sxs-lookup"><span data-stu-id="07c45-125">The array `students` in the preceding example contains seven elements.</span></span> <span data-ttu-id="07c45-126">Gli indici degli elementi sono compresi tra 0 e 6.</span><span class="sxs-lookup"><span data-stu-id="07c45-126">The indexes of the elements range from 0 through 6.</span></span> <span data-ttu-id="07c45-127">L'uso di questa matrice è più semplice rispetto alla dichiarazione di sette variabili.</span><span class="sxs-lookup"><span data-stu-id="07c45-127">Having this array is simpler than declaring seven variables.</span></span>  
  
 <span data-ttu-id="07c45-128">La figura seguente illustra la matrice `students`.</span><span class="sxs-lookup"><span data-stu-id="07c45-128">The following illustration shows the array `students`.</span></span> <span data-ttu-id="07c45-129">Per ogni elemento della matrice:</span><span class="sxs-lookup"><span data-stu-id="07c45-129">For each element of the array:</span></span>  
  
-   <span data-ttu-id="07c45-130">L'indice dell'elemento rappresenta l'anno scolastico (l'indice 0 rappresenta l'asilo).</span><span class="sxs-lookup"><span data-stu-id="07c45-130">The index of the element represents the grade (index 0 represents kindergarten).</span></span>  
  
-   <span data-ttu-id="07c45-131">Il valore contenuto nell'elemento rappresenta il numero degli studenti iscritti a tale anno scolastico.</span><span class="sxs-lookup"><span data-stu-id="07c45-131">The value that’s contained in the element represents the number of students in that grade.</span></span>  
  
 <span data-ttu-id="07c45-132">![Immagine di matrice che illustra il numero di studenti](../../../../visual-basic/programming-guide/language-features/arrays/media/arrayexampleschool.gif "ArrayExampleSchool")</span><span class="sxs-lookup"><span data-stu-id="07c45-132">![Picture of array showing numbers of students](../../../../visual-basic/programming-guide/language-features/arrays/media/arrayexampleschool.gif "ArrayExampleSchool")</span></span>  
<span data-ttu-id="07c45-133">Elementi della matrice "students"</span><span class="sxs-lookup"><span data-stu-id="07c45-133">Elements of the "students" array</span></span>  
  
 <span data-ttu-id="07c45-134">L'esempio seguente illustra come fare riferimento al primo, al secondo e all'ultimo elemento della matrice `students`.</span><span class="sxs-lookup"><span data-stu-id="07c45-134">The following example shows how to refer to the first, second, and last element of the array `students`.</span></span>  
  
 [!code-vb[VbVbalrArrays#3](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#3)]  
  
 <span data-ttu-id="07c45-135">Per fare riferimento all'intera matrice è sufficiente usare il nome della variabile di matrice senza indici.</span><span class="sxs-lookup"><span data-stu-id="07c45-135">You can refer to the array as a whole by using just the array variable name without indexes.</span></span>  
  
 <span data-ttu-id="07c45-136">La matrice `students` nell'esempio precedente usa un unico indice ed è detta unidimensionale.</span><span class="sxs-lookup"><span data-stu-id="07c45-136">The array `students` in the preceding example uses one index and is said to be one-dimensional.</span></span> <span data-ttu-id="07c45-137">Una matrice che usa più indici è detta multidimensionale.</span><span class="sxs-lookup"><span data-stu-id="07c45-137">An array that uses more than one index or subscript is called multidimensional.</span></span> <span data-ttu-id="07c45-138">Per altre informazioni, vedere il resto di questo argomento e [Array Dimensions in Visual Basic](../../../../visual-basic/programming-guide/language-features/arrays/array-dimensions.md).</span><span class="sxs-lookup"><span data-stu-id="07c45-138">For more information, see the rest of this topic and [Array Dimensions in Visual Basic](../../../../visual-basic/programming-guide/language-features/arrays/array-dimensions.md).</span></span>  
  
##  <span data-ttu-id="07c45-139"><a name="BKMK_CreatingAnArray"></a> Creazione di una matrice</span><span class="sxs-lookup"><span data-stu-id="07c45-139"><a name="BKMK_CreatingAnArray"></a> Creating an Array</span></span>  
 <span data-ttu-id="07c45-140">La dimensione di una matrice può essere definita in vari modi.</span><span class="sxs-lookup"><span data-stu-id="07c45-140">You can define the size of an array several ways.</span></span> <span data-ttu-id="07c45-141">È possibile specificare la dimensione quando la matrice viene dichiarata, come illustra l'esempio seguente.</span><span class="sxs-lookup"><span data-stu-id="07c45-141">You can supply the size when the array is declared, as the following example shows.</span></span>  
  
 [!code-vb[VbVbalrArrays#12](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#12)]  
  
 <span data-ttu-id="07c45-142">È anche possibile usare la clausola `New` per specificare la dimensione della matrice quando viene creata, come illustra l'esempio seguente.</span><span class="sxs-lookup"><span data-stu-id="07c45-142">You can also use a `New` clause to supply the size of an array when it’s created, as the following example shows.</span></span>  
  
 [!code-vb[VbVbalrArrays#11](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#11)]  
  
 <span data-ttu-id="07c45-143">Se è disponibile una matrice esistente, è possibile ridefinirne la dimensione usando l'istruzione `Redim` .</span><span class="sxs-lookup"><span data-stu-id="07c45-143">If you have an existing array, you can redefine its size by using the `Redim` statement.</span></span> <span data-ttu-id="07c45-144">È possibile specificare che l'istruzione `Redim` mantenga i valori attualmente presenti nella matrice oppure fare in modo che crei una matrice vuota.</span><span class="sxs-lookup"><span data-stu-id="07c45-144">You can specify that the `Redim` statement should keep the values that are in the array, or you can specify that it create an empty array.</span></span> <span data-ttu-id="07c45-145">L'esempio seguente illustra vari modi di usare l'istruzione `Redim` per modificare la dimensione di una matrice esistente.</span><span class="sxs-lookup"><span data-stu-id="07c45-145">The following example shows different uses of the `Redim` statement to modify the size of an existing array.</span></span>  
  
 [!code-vb[VbVbalrArrays#13](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#13)]  
  
 <span data-ttu-id="07c45-146">Per altre informazioni, vedere [Istruzione ReDim](../../../../visual-basic/language-reference/statements/redim-statement.md).</span><span class="sxs-lookup"><span data-stu-id="07c45-146">For more information, see [ReDim Statement](../../../../visual-basic/language-reference/statements/redim-statement.md).</span></span>  
  
##  <span data-ttu-id="07c45-147"><a name="BKMK_StoringValues"></a> Archiviazione di valori in una matrice</span><span class="sxs-lookup"><span data-stu-id="07c45-147"><a name="BKMK_StoringValues"></a> Storing Values in an Array</span></span>  
 <span data-ttu-id="07c45-148">È possibile accedere a ogni posizione in una matrice usando un indice di tipo `Integer`.</span><span class="sxs-lookup"><span data-stu-id="07c45-148">You can access each location in an array by using an index of type `Integer`.</span></span> <span data-ttu-id="07c45-149">È possibile archiviare e recuperare i valori in una matrice facendo riferimento a ogni posizione della matrice tramite il relativo indice racchiuso tra parentesi.</span><span class="sxs-lookup"><span data-stu-id="07c45-149">You can store and retrieve values in an array by referencing each array location by using its index enclosed in parentheses.</span></span> <span data-ttu-id="07c45-150">Gli indici per le matrici multidimensionali sono separati da virgole (,).</span><span class="sxs-lookup"><span data-stu-id="07c45-150">Indexes for multi-dimensional arrays are separated by commas (,).</span></span> <span data-ttu-id="07c45-151">È necessario un indice per ogni dimensione della matrice.</span><span class="sxs-lookup"><span data-stu-id="07c45-151">You need one index for each array dimension.</span></span> <span data-ttu-id="07c45-152">L'esempio seguente illustra alcune istruzioni che consentono di inserire valori nelle matrici.</span><span class="sxs-lookup"><span data-stu-id="07c45-152">The following example shows some statements that store values in arrays.</span></span>  
  
 [!code-vb[VbVbalrArrays#5](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#5)]  
  
 <span data-ttu-id="07c45-153">L'esempio seguente illustra alcune istruzioni che consentono di ottenere valori dalle matrici.</span><span class="sxs-lookup"><span data-stu-id="07c45-153">The following example shows some statements that get values from arrays.</span></span>  
  
 [!code-vb[VbVbalrArrays#6](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#6)]  
  
##  <span data-ttu-id="07c45-154"><a name="BKMK_Populating"></a> Popolamento di una matrice con valori iniziali</span><span class="sxs-lookup"><span data-stu-id="07c45-154"><a name="BKMK_Populating"></a> Populating an Array with Initial Values</span></span>  
 <span data-ttu-id="07c45-155">Usando un valore letterale di matrice, è possibile creare una matrice contenente un set iniziale di valori.</span><span class="sxs-lookup"><span data-stu-id="07c45-155">By using an array literal, you can create an array that contains an initial set of values.</span></span> <span data-ttu-id="07c45-156">Un valore letterale di matrice è costituito da un elenco di valori delimitati da virgole racchiusi tra parentesi graffe (`{}`).</span><span class="sxs-lookup"><span data-stu-id="07c45-156">An array literal consists of a list of comma-separated values that are enclosed in braces (`{}`).</span></span>  
  
 <span data-ttu-id="07c45-157">Quando si usa un valore letterale di matrice per creare una matrice, è possibile specificare il tipo o usare l'inferenza del tipo per determinare il tipo di matrice.</span><span class="sxs-lookup"><span data-stu-id="07c45-157">When you create an array by using an array literal, you can either supply the array type or use type inference to determine the array type.</span></span> <span data-ttu-id="07c45-158">Il codice seguente illustra entrambe le opzioni.</span><span class="sxs-lookup"><span data-stu-id="07c45-158">The following code shows both options.</span></span>  
  
 [!code-vb[VbVbalrCollectionInitializers#3](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#3)]  
  
 <span data-ttu-id="07c45-159">Quando si usa l'inferenza del tipo, il tipo della matrice viene determinato dal tipo dominante nell'elenco di valori fornito per il valore letterale di matrice.</span><span class="sxs-lookup"><span data-stu-id="07c45-159">When you use type inference, the type of the array is determined by the dominant type in the list of values that’s supplied for the array literal.</span></span> <span data-ttu-id="07c45-160">Il tipo dominante è un tipo univoco in cui tutti gli altri tipi nel valore letterale di matrice possono ampliarsi.</span><span class="sxs-lookup"><span data-stu-id="07c45-160">The dominant type is a unique type to which all other types in the array literal can widen.</span></span> <span data-ttu-id="07c45-161">Se non è possibile determinare il tipo univoco, il tipo dominante è il tipo univoco in cui possono restringersi tutti gli altri tipi nella matrice.</span><span class="sxs-lookup"><span data-stu-id="07c45-161">If this unique type can’t be determined, the dominant type is the unique type to which all other types in the array can narrow.</span></span> <span data-ttu-id="07c45-162">Se nessuno di questi tipi univoci può essere determinato, il tipo dominante è `Object`.</span><span class="sxs-lookup"><span data-stu-id="07c45-162">If neither of these unique types can be determined, the dominant type is `Object`.</span></span> <span data-ttu-id="07c45-163">Se, ad esempio, l'elenco di valori fornito al valore letterale di matrice contiene valori di tipo `Integer`, `Long`e `Double`, la matrice risultante è di tipo `Double`.</span><span class="sxs-lookup"><span data-stu-id="07c45-163">For example, if the list of values that’s supplied to the array literal contains values of type `Integer`, `Long`, and `Double`, the resulting array is of type `Double`.</span></span> <span data-ttu-id="07c45-164">Sia `Integer` che `Long` possono ampliarsi solo nel tipo `Double`.</span><span class="sxs-lookup"><span data-stu-id="07c45-164">Both `Integer` and `Long` widen only to `Double`.</span></span> <span data-ttu-id="07c45-165">`Double` è pertanto il tipo dominante.</span><span class="sxs-lookup"><span data-stu-id="07c45-165">Therefore, `Double` is the dominant type.</span></span> <span data-ttu-id="07c45-166">Per altre informazioni, vedere [Widening and Narrowing Conversions](../../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md).</span><span class="sxs-lookup"><span data-stu-id="07c45-166">For more information, see [Widening and Narrowing Conversions](../../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md).</span></span> <span data-ttu-id="07c45-167">Queste regole di inferenza si applicano ai tipi dedotti per le matrici che sono variabili locali definite in un membro di classe.</span><span class="sxs-lookup"><span data-stu-id="07c45-167">These inference rules apply to types that are inferred for arrays that are local variables that are defined in a class member.</span></span> <span data-ttu-id="07c45-168">Anche se è possibile usare valori letterali di matrice quando si creano variabili a livello di classe, non è possibile usare l'inferenza del tipo a livello di classe.</span><span class="sxs-lookup"><span data-stu-id="07c45-168">Although you can use array literals when you create class-level variables, you can’t use type inference at the class level.</span></span> <span data-ttu-id="07c45-169">Di conseguenza, i valori letterali di matrice specificati a livello di classe consentono di dedurre i valori forniti per il valore letterale di matrice come tipo `Object`.</span><span class="sxs-lookup"><span data-stu-id="07c45-169">As a result, array literals that are specified at the class level infer the values that are supplied for the array literal as type `Object`.</span></span>  
  
 <span data-ttu-id="07c45-170">È possibile specificare in modo esplicito il tipo di elementi in una matrice creata usando un valore letterale di matrice.</span><span class="sxs-lookup"><span data-stu-id="07c45-170">You can explicitly specify the type of the elements in an array that’s created by using an array literal.</span></span> <span data-ttu-id="07c45-171">In tal caso, i valori nel valore letterale di matrice devono potersi ampliare al tipo degli elementi della matrice.</span><span class="sxs-lookup"><span data-stu-id="07c45-171">In this case, the values in the array literal must widen to the type of the elements of the array.</span></span> <span data-ttu-id="07c45-172">L'esempio di codice seguente consente di creare una matrice di tipo `Double` da un elenco di numeri interi.</span><span class="sxs-lookup"><span data-stu-id="07c45-172">The following code example creates an array of type `Double` from a list of integers.</span></span>  
  
 [!code-vb[VbVbalrCollectionInitializers#4](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#4)]  
  
###  <span data-ttu-id="07c45-173"><a name="BKMK_NestedArrayLiterals"></a> Valori letterali di matrice annidati</span><span class="sxs-lookup"><span data-stu-id="07c45-173"><a name="BKMK_NestedArrayLiterals"></a> Nested Array Literals</span></span>  
 <span data-ttu-id="07c45-174">È possibile creare una matrice multidimensionale tramite valori letterali di matrice annidati.</span><span class="sxs-lookup"><span data-stu-id="07c45-174">You can create a multidimensional array by using nested array literals.</span></span> <span data-ttu-id="07c45-175">Questi valori devono avere una dimensione e un numero di dimensioni, o rango, coerenti con la matrice risultante.</span><span class="sxs-lookup"><span data-stu-id="07c45-175">Nested array literals must have a dimension and number of dimensions, or rank, that’s consistent with the resulting array.</span></span> <span data-ttu-id="07c45-176">L'esempio di codice seguente consente di creare una matrice bidimensionale di numeri interi usando un valore letterale di matrice.</span><span class="sxs-lookup"><span data-stu-id="07c45-176">The following code example creates a two-dimensional array of integers by using an array literal.</span></span>  
  
 [!code-vb[VbVbalrCollectionInitializers#7](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#7)]  
  
 <span data-ttu-id="07c45-177">Nell'esempio precedente, si verifica un errore se il numero di elementi nei valori letterali di matrice annidati non corrisponde.</span><span class="sxs-lookup"><span data-stu-id="07c45-177">In the previous example, an error would occur if the number of elements in the nested array literals didn’t match.</span></span> <span data-ttu-id="07c45-178">Si può verificare un errore anche nel caso in cui la variabile di matrice venga dichiarata in modo esplicito come diversa da bidimensionale.</span><span class="sxs-lookup"><span data-stu-id="07c45-178">An error would also occur if you explicitly declared the array variable to be other than two-dimensional.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="07c45-179">Per evitare di generare un errore quando si specificano valori letterali di matrice annidati di dimensioni diverse, è possibile racchiudere i valori letterali di matrice interni tra parentesi.</span><span class="sxs-lookup"><span data-stu-id="07c45-179">You can avoid an error when you supply nested array literals of different dimensions by enclosing the inner array literals in parentheses.</span></span> <span data-ttu-id="07c45-180">Le parentesi forzano la valutazione dell'espressione del valore letterale di matrice e i valori risultanti vengono usati con il valore letterale di matrice esterno, come mostra il codice seguente.</span><span class="sxs-lookup"><span data-stu-id="07c45-180">The parentheses force the array literal expression to be evaluated, and the resulting values are used with the outer array literal, as the following code shows.</span></span>  
  
 [!code-vb[VbVbalrCollectionInitializers#11](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#11)]  
  
 <span data-ttu-id="07c45-181">Quando si crea una matrice multidimensionale tramite valori letterali di matrice annidati, è possibile usare l'inferenza del tipo.</span><span class="sxs-lookup"><span data-stu-id="07c45-181">When you create a multidimensional array by using nested array literals, you can use type inference.</span></span> <span data-ttu-id="07c45-182">Quando si usa l'inferenza del tipo, il tipo dedotto è il tipo dominante per tutti i valori in tutti i valori letterali di matrice per un livello di annidamento.</span><span class="sxs-lookup"><span data-stu-id="07c45-182">When you use type inference, the inferred type is the dominant type for all the values in all the array literals for a nesting level.</span></span> <span data-ttu-id="07c45-183">L'esempio di codice seguente consente di creare una matrice bidimensionale di tipo `Double` da valori di tipo `Integer` e `Double`.</span><span class="sxs-lookup"><span data-stu-id="07c45-183">The following code example creates a two-dimensional array of type `Double` from values that are of type `Integer` and `Double`.</span></span>  
  
 [!code-vb[VbVbalrCollectionInitializers#8](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#8)]  
  
 <span data-ttu-id="07c45-184">Per altri esempi, vedere [Procedura: inizializzare una variabile di matrice in Visual Basic](../../../../visual-basic/programming-guide/language-features/arrays/how-to-initialize-an-array-variable.md).</span><span class="sxs-lookup"><span data-stu-id="07c45-184">For additional examples, see [How to: Initialize an Array Variable in Visual Basic](../../../../visual-basic/programming-guide/language-features/arrays/how-to-initialize-an-array-variable.md).</span></span>  
  
##  <span data-ttu-id="07c45-185"><a name="BKMK_Iterating"></a> Scorrimento di una matrice</span><span class="sxs-lookup"><span data-stu-id="07c45-185"><a name="BKMK_Iterating"></a> Iterating Through an Array</span></span>  
 <span data-ttu-id="07c45-186">Quando si scorre una matrice, è possibile accedere a ogni elemento nella matrice dall'indice più basso all'indice più alto.</span><span class="sxs-lookup"><span data-stu-id="07c45-186">When you iterate through an array, you access each element in the array from the lowest index to the highest index.</span></span>  
  
 <span data-ttu-id="07c45-187">L'esempio seguente illustra come scorrere una matrice unidimensionale usando l'[istruzione For...Next](../../../../visual-basic/language-reference/statements/for-next-statement.md).</span><span class="sxs-lookup"><span data-stu-id="07c45-187">The following example iterates through a one-dimensional array by using the [For...Next Statement](../../../../visual-basic/language-reference/statements/for-next-statement.md).</span></span> <span data-ttu-id="07c45-188">Il metodo <xref:System.Array.GetUpperBound%2A> restituisce il valore più alto che l'indice possa avere.</span><span class="sxs-lookup"><span data-stu-id="07c45-188">The <xref:System.Array.GetUpperBound%2A> method returns the highest value that the index can have.</span></span> <span data-ttu-id="07c45-189">Il valore più basso dell'indice è sempre 0.</span><span class="sxs-lookup"><span data-stu-id="07c45-189">The lowest index value is always 0.</span></span>  
  
 [!code-vb[VbVbalrArrays#41](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#41)]  
  
 <span data-ttu-id="07c45-190">L'esempio seguente illustra come scorrere una matrice multidimensionale usando un'istruzione `For...Next` .</span><span class="sxs-lookup"><span data-stu-id="07c45-190">The following example iterates through a multidimensional array by using a `For...Next` statement.</span></span> <span data-ttu-id="07c45-191">Il metodo <xref:System.Array.GetUpperBound%2A> ha un parametro che specifica la dimensione.</span><span class="sxs-lookup"><span data-stu-id="07c45-191">The <xref:System.Array.GetUpperBound%2A> method has a parameter that specifies the dimension.</span></span> <span data-ttu-id="07c45-192">`GetUpperBound(0)` restituisce il valore di indice massimo per la prima dimensione e `GetUpperBound(1)` restituisce il valore di indice massimo per la seconda dimensione.</span><span class="sxs-lookup"><span data-stu-id="07c45-192">`GetUpperBound(0)` returns the high index value for the first dimension, and `GetUpperBound(1)` returns the high index value for the second dimension.</span></span>  
  
 [!code-vb[VbVbalrArrays#42](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#42)]  
  
 <span data-ttu-id="07c45-193">L'esempio seguente illustra come scorrere una matrice unidimensionale usando un'[istruzione For Each...Next](../../../../visual-basic/language-reference/statements/for-each-next-statement.md).</span><span class="sxs-lookup"><span data-stu-id="07c45-193">The following example iterates through a one-dimensional array by using a [For Each...Next Statement](../../../../visual-basic/language-reference/statements/for-each-next-statement.md).</span></span>  
  
 [!code-vb[VbVbalrArrays#43](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#43)]  
  
 <span data-ttu-id="07c45-194">L'esempio seguente illustra come scorrere una matrice multidimensionale usando un'istruzione `For Each...Next` .</span><span class="sxs-lookup"><span data-stu-id="07c45-194">The following example iterates through a multidimensional array by using a `For Each...Next` statement.</span></span> <span data-ttu-id="07c45-195">Per avere un controllo maggiore sugli elementi di una matrice multidimensionale è preferibile usare un'istruzione `For…Next` annidata, come nell'esempio precedente, anziché un'istruzione `For Each…Next` .</span><span class="sxs-lookup"><span data-stu-id="07c45-195">However, you have more control over the elements of a multidimensional array if you use a nested `For…Next` statement, as in a previous example, instead of a `For Each…Next` statement.</span></span>  
  
 [!code-vb[VbVbalrArrays#44](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#44)]  
  
##  <span data-ttu-id="07c45-196"><a name="BKMK_ReturnValues"></a> Matrici come valori e parametri restituiti</span><span class="sxs-lookup"><span data-stu-id="07c45-196"><a name="BKMK_ReturnValues"></a> Arrays as Return Values and Parameters</span></span>  
 <span data-ttu-id="07c45-197">Per restituire una matrice da una routine `Function`, specificare il tipo di dati della matrice e il numero di dimensioni come tipo restituito dell'[istruzione Function](../../../../visual-basic/language-reference/statements/function-statement.md).</span><span class="sxs-lookup"><span data-stu-id="07c45-197">To return an array from a `Function` procedure, specify the array data type and the number of dimensions as the return type of the [Function Statement](../../../../visual-basic/language-reference/statements/function-statement.md).</span></span> <span data-ttu-id="07c45-198">All'interno della funzione dichiarare una variabile di matrice locale con lo stesso tipo di dati degli elementi e lo stesso numero di dimensioni.</span><span class="sxs-lookup"><span data-stu-id="07c45-198">Within the function, declare a local array variable with same data type and number of dimensions.</span></span> <span data-ttu-id="07c45-199">Includere la variabile di matrice locale senza parentesi nell'[istruzione Return](../../../../visual-basic/language-reference/statements/return-statement.md).</span><span class="sxs-lookup"><span data-stu-id="07c45-199">In the [Return Statement](../../../../visual-basic/language-reference/statements/return-statement.md), include the local array variable without parentheses.</span></span>  
  
 <span data-ttu-id="07c45-200">Per specificare una matrice come parametro in una routine `Sub` o `Function` , definire il parametro come matrice con un tipo di dati e un numero di dimensioni specificati.</span><span class="sxs-lookup"><span data-stu-id="07c45-200">To specify an array as a parameter to a `Sub` or `Function` procedure, define the parameter as an array with a specified data type and number of dimensions.</span></span> <span data-ttu-id="07c45-201">Nella chiamata alla routine, inviare una variabile di matrice con lo stesso tipo di dati e numero di dimensioni.</span><span class="sxs-lookup"><span data-stu-id="07c45-201">In the call to the procedure, send an array variable with the same data type and number of dimensions.</span></span>  
  
 <span data-ttu-id="07c45-202">Nell'esempio seguente, la funzione `GetNumbers` restituisce un `Integer()`.</span><span class="sxs-lookup"><span data-stu-id="07c45-202">In the following example, the `GetNumbers` function returns an `Integer()`.</span></span> <span data-ttu-id="07c45-203">Questo tipo di matrice è una matrice unidimensionale di tipo `Integer`.</span><span class="sxs-lookup"><span data-stu-id="07c45-203">This array type is a one dimensional array of type `Integer`.</span></span> <span data-ttu-id="07c45-204">La routine `ShowNumbers` accetta un argomento `Integer()` .</span><span class="sxs-lookup"><span data-stu-id="07c45-204">The `ShowNumbers` procedure accepts an `Integer()` argument.</span></span>  
  
 [!code-vb[VbVbalrArrays#51](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#51)]  
  
 <span data-ttu-id="07c45-205">Nell'esempio seguente, la funzione `GetNumbersMultiDim` restituisce un `Integer(,)`.</span><span class="sxs-lookup"><span data-stu-id="07c45-205">In the following example, the `GetNumbersMultiDim` function returns an `Integer(,)`.</span></span> <span data-ttu-id="07c45-206">Questo tipo di matrice è una matrice bidimensionale di tipo `Integer`.</span><span class="sxs-lookup"><span data-stu-id="07c45-206">This array type is a two dimensional array of type `Integer`.</span></span>  <span data-ttu-id="07c45-207">La routine `ShowNumbersMultiDim` accetta un argomento `Integer(,)` .</span><span class="sxs-lookup"><span data-stu-id="07c45-207">The `ShowNumbersMultiDim` procedure accepts an `Integer(,)` argument.</span></span>  
  
 [!code-vb[VbVbalrArrays#52](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#52)]  
  
##  <span data-ttu-id="07c45-208"><a name="BKMK_JaggedArrays"></a> Matrici irregolari</span><span class="sxs-lookup"><span data-stu-id="07c45-208"><a name="BKMK_JaggedArrays"></a> Jagged Arrays</span></span>  
 <span data-ttu-id="07c45-209">Una matrice in cui gli elementi sono costituiti da altre matrici è detta matrice di matrici o matrice irregolare.</span><span class="sxs-lookup"><span data-stu-id="07c45-209">An array that holds other arrays as elements is known as an array of arrays or a jagged array.</span></span> <span data-ttu-id="07c45-210">Una matrice irregolare e ogni elemento di una matrice irregolare possono avere una o più dimensioni.</span><span class="sxs-lookup"><span data-stu-id="07c45-210">A jagged array and each element in a jagged array can have one or more dimensions.</span></span> <span data-ttu-id="07c45-211">In alcuni casi la struttura dei dati nell'applicazione è bidimensionale, ma non rettangolare.</span><span class="sxs-lookup"><span data-stu-id="07c45-211">Sometimes the data structure in your application is two-dimensional but not rectangular.</span></span>  
  
 <span data-ttu-id="07c45-212">L'esempio seguente illustra una matrice di mesi, in cui ogni elemento della matrice è costituito da una matrice di giorni.</span><span class="sxs-lookup"><span data-stu-id="07c45-212">The following example has an array of months, each element of which is an array of days.</span></span> <span data-ttu-id="07c45-213">Poiché il numero di giorni varia a seconda del mese, gli elementi non formano una matrice bidimensionale rettangolare.</span><span class="sxs-lookup"><span data-stu-id="07c45-213">Because different months have different numbers of days, the elements don’t form a rectangular two-dimensional array.</span></span> <span data-ttu-id="07c45-214">In tal caso si usa una matrice irregolare anziché una matrice multidimensionale.</span><span class="sxs-lookup"><span data-stu-id="07c45-214">Therefore, a jagged array is used instead of a multidimensional array.</span></span>  
  
 [!code-vb[VbVbalrArrays#21](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#21)]  
  
##  <span data-ttu-id="07c45-215"><a name="BKMK_ZeroLength"></a> Matrici di lunghezza zero</span><span class="sxs-lookup"><span data-stu-id="07c45-215"><a name="BKMK_ZeroLength"></a> Zero-Length Arrays</span></span>  
 <span data-ttu-id="07c45-216">Una matrice che non contiene elementi viene definita anche matrice di lunghezza zero.</span><span class="sxs-lookup"><span data-stu-id="07c45-216">An array that contains no elements is also called a zero-length array.</span></span> <span data-ttu-id="07c45-217">Il valore di una variabile che contiene una matrice di lunghezza zero non è `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="07c45-217">A variable that holds a zero-length array doesn’t have the value `Nothing`.</span></span> <span data-ttu-id="07c45-218">Per creare una matrice senza elementi, dichiarare una delle dimensioni della matrice come -1, come illustra l'esempio seguente.</span><span class="sxs-lookup"><span data-stu-id="07c45-218">To create an array that has no elements, declare one of the array's dimensions to be -1, as the following example shows.</span></span>  
  
 [!code-vb[VbVbalrArrays#14](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#14)]  
  
 <span data-ttu-id="07c45-219">Potrebbe essere necessario creare una matrice di lunghezza zero nelle circostanze seguenti:</span><span class="sxs-lookup"><span data-stu-id="07c45-219">You might need to create a zero-length array under the following circumstances:</span></span>  
  
-   <span data-ttu-id="07c45-220">Senza correre il rischio di un'eccezione <xref:System.NullReferenceException> , il codice deve accedere ai membri della classe <xref:System.Array> , ad esempio <xref:System.Array.Length%2A> o <xref:System.Array.Rank%2A>oppure chiamare una funzione [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] come <xref:Microsoft.VisualBasic.Information.UBound%2A>.</span><span class="sxs-lookup"><span data-stu-id="07c45-220">Without risking a <xref:System.NullReferenceException> exception, your code must access members of the <xref:System.Array> class, such as <xref:System.Array.Length%2A> or <xref:System.Array.Rank%2A>, or call a [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] function such as <xref:Microsoft.VisualBasic.Information.UBound%2A>.</span></span>  
  
-   <span data-ttu-id="07c45-221">È consigliabile semplificare il codice che la usa escludendo la verifica della presenza di `Nothing` come caso particolare.</span><span class="sxs-lookup"><span data-stu-id="07c45-221">You want to keep the consuming code simpler by not having to check for `Nothing` as a special case.</span></span>  
  
-   <span data-ttu-id="07c45-222">Il codice interagisce con un'API (Application Programming Interface) che richiede il passaggio di una matrice di lunghezza zero a una o più routine oppure che restituisce una matrice di lunghezza zero da una o più routine.</span><span class="sxs-lookup"><span data-stu-id="07c45-222">Your code interacts with an application programming interface (API) that either requires you to pass a zero-length array to one or more procedures or returns a zero-length array from one or more procedures.</span></span>  
  
##  <span data-ttu-id="07c45-223"><a name="BKMK_ArraySize"></a> Dimensione della matrice</span><span class="sxs-lookup"><span data-stu-id="07c45-223"><a name="BKMK_ArraySize"></a> Array Size</span></span>  
 <span data-ttu-id="07c45-224">La dimensione di una matrice è il prodotto delle lunghezze di tutte le relative dimensioni</span><span class="sxs-lookup"><span data-stu-id="07c45-224">The size of an array is the product of the lengths of all its dimensions.</span></span> <span data-ttu-id="07c45-225">e rappresenta il numero totale di elementi attualmente contenuti nella matrice.</span><span class="sxs-lookup"><span data-stu-id="07c45-225">It represents the total number of elements currently contained in the array.</span></span>  
  
 <span data-ttu-id="07c45-226">L'esempio seguente illustra come dichiarare una matrice tridimensionale.</span><span class="sxs-lookup"><span data-stu-id="07c45-226">The following example declares a three-dimensional array.</span></span>  
  
```vb
Dim prices(3, 4, 5) As Long  
```  
  
 <span data-ttu-id="07c45-227">La dimensione complessiva della matrice nella variabile `prices` è (3 + 1) x (4 + 1) x (5 + 1) = 120.</span><span class="sxs-lookup"><span data-stu-id="07c45-227">The overall size of the array in variable `prices` is (3 + 1) x (4 + 1) x (5 + 1) = 120.</span></span>  
  
 <span data-ttu-id="07c45-228">È possibile determinare le dimensioni di una matrice usando la proprietà <xref:System.Array.Length%2A>.</span><span class="sxs-lookup"><span data-stu-id="07c45-228">You can find the size of an array by using the <xref:System.Array.Length%2A> property.</span></span> <span data-ttu-id="07c45-229">È possibile determinare la lunghezza di ogni dimensione di una matrice multidimensionale usando il metodo <xref:System.Array.GetLength%2A> .</span><span class="sxs-lookup"><span data-stu-id="07c45-229">You can find the length of each dimension of a multi-dimensional array by using the <xref:System.Array.GetLength%2A> method.</span></span>  
  
 <span data-ttu-id="07c45-230">Per ridimensionare una variabile di matrice è possibile assegnare un nuovo oggetto matrice o usare l'istruzione `ReDim` .</span><span class="sxs-lookup"><span data-stu-id="07c45-230">You can resize an array variable by assigning a new array object to it or by using the `ReDim` statement.</span></span>  
  
 <span data-ttu-id="07c45-231">Di seguito sono indicati alcuni elementi importanti relativi alla dimensione di una matrice.</span><span class="sxs-lookup"><span data-stu-id="07c45-231">There are several things to keep in mind when dealing with the size of an array.</span></span>  
  
|||  
|---|---|  
|<span data-ttu-id="07c45-232">Lunghezza delle dimensioni</span><span class="sxs-lookup"><span data-stu-id="07c45-232">Dimension Length</span></span>|<span data-ttu-id="07c45-233">L'indice di ogni dimensione è compreso tra 0 e il relativo limite superiore.</span><span class="sxs-lookup"><span data-stu-id="07c45-233">The index of each dimension is 0-based, which means it ranges from 0 through its upper bound.</span></span> <span data-ttu-id="07c45-234">La lunghezza di una determinata dimensione è quindi maggiore di 1 rispetto al limite superiore dichiarato di tale dimensione.</span><span class="sxs-lookup"><span data-stu-id="07c45-234">Therefore, the length of a given dimension is greater by 1 than the declared upper bound for that dimension.</span></span>|  
|<span data-ttu-id="07c45-235">Limiti di lunghezza</span><span class="sxs-lookup"><span data-stu-id="07c45-235">Length Limits</span></span>|<span data-ttu-id="07c45-236">La lunghezza di ogni dimensione di una matrice è limitata al valore massimo del tipo di dati `Integer`, ovvero (2 ^ 31) - 1.</span><span class="sxs-lookup"><span data-stu-id="07c45-236">The length of every dimension of an array is limited to the maximum value of the `Integer` data type, which is (2 ^ 31) - 1.</span></span> <span data-ttu-id="07c45-237">La dimensione totale di una matrice, tuttavia, è limitata anche dalla memoria disponibile nel sistema.</span><span class="sxs-lookup"><span data-stu-id="07c45-237">However, the total size of an array is also limited by the memory available on your system.</span></span> <span data-ttu-id="07c45-238">Se si tenta di inizializzare una matrice che supera la quantità di RAM disponibile, Common Language Runtime genera un'eccezione <xref:System.OutOfMemoryException> .</span><span class="sxs-lookup"><span data-stu-id="07c45-238">If you attempt to initialize an array that exceeds the amount of available RAM, the common language runtime throws an <xref:System.OutOfMemoryException> exception.</span></span>|  
|<span data-ttu-id="07c45-239">Dimensione ed elementi della matrice</span><span class="sxs-lookup"><span data-stu-id="07c45-239">Size and Element Size</span></span>|<span data-ttu-id="07c45-240">La dimensione di una matrice è indipendente dal tipo di dati dei relativi elementi.</span><span class="sxs-lookup"><span data-stu-id="07c45-240">An array's size is independent of the data type of its elements.</span></span> <span data-ttu-id="07c45-241">La dimensione rappresenta sempre il numero totale di elementi e non il numero di byte necessari per la loro archiviazione.</span><span class="sxs-lookup"><span data-stu-id="07c45-241">The size always represents the total number of elements, not the number of bytes that they consume in storage.</span></span>|  
|<span data-ttu-id="07c45-242">Consumo di memoria</span><span class="sxs-lookup"><span data-stu-id="07c45-242">Memory Consumption</span></span>|<span data-ttu-id="07c45-243">Non è possibile fare ipotesi sulla modalità di archiviazione di una matrice in memoria.</span><span class="sxs-lookup"><span data-stu-id="07c45-243">It is not safe to make any assumptions regarding how an array is stored in memory.</span></span> <span data-ttu-id="07c45-244">L'archiviazione dipende dalla larghezza dei dati delle diverse piattaforme. Di conseguenza, è possibile che l'archiviazione di una stessa matrice richieda più memoria in un sistema a 64 bit che in un sistema a 32 bit.</span><span class="sxs-lookup"><span data-stu-id="07c45-244">Storage varies on platforms of different data widths, so the same array can consume more memory on a 64-bit system than on a 32-bit system.</span></span> <span data-ttu-id="07c45-245">A seconda della configurazione di sistema al momento dell'inizializzazione di una matrice, Common Language Runtime (CLR) può assegnare la memoria in modo da compattare al massimo gli elementi oppure in modo da allinearli tutti in base ai limiti dell'hardware.</span><span class="sxs-lookup"><span data-stu-id="07c45-245">Depending on system configuration when you initialize an array, the common language runtime (CLR) can assign storage either to pack elements as close together as possible, or to align them all on natural hardware boundaries.</span></span> <span data-ttu-id="07c45-246">Per le informazioni di controllo di una matrice è richiesto un sovraccarico di archiviazione che aumenta con ogni dimensione aggiunta.</span><span class="sxs-lookup"><span data-stu-id="07c45-246">Also, an array requires a storage overhead for its control information, and this overhead increases with each added dimension.</span></span>|  
  
##  <span data-ttu-id="07c45-247"><a name="BKMK_ArrayTypes"></a> Tipi di matrice e altri tipi</span><span class="sxs-lookup"><span data-stu-id="07c45-247"><a name="BKMK_ArrayTypes"></a> Array Types and Other Types</span></span>  
 <span data-ttu-id="07c45-248">Ogni matrice ha un tipo di dati, diverso da quello dei relativi elementi.</span><span class="sxs-lookup"><span data-stu-id="07c45-248">Every array has a data type, but it differs from the data type of its elements.</span></span> <span data-ttu-id="07c45-249">Non esiste un singolo tipo di dati per tutte le matrici.</span><span class="sxs-lookup"><span data-stu-id="07c45-249">There is no single data type for all arrays.</span></span> <span data-ttu-id="07c45-250">Il tipo di dati di una matrice viene invece determinato dal numero di dimensioni, o *rango*, della matrice e dal tipo di dati degli elementi nella matrice.</span><span class="sxs-lookup"><span data-stu-id="07c45-250">Instead, the data type of an array is determined by the number of dimensions, or *rank*, of the array, and the data type of the elements in the array.</span></span> <span data-ttu-id="07c45-251">Due variabili di matrice hanno lo stesso tipo di dati solo se hanno lo stesso numero di dimensioni e i relativi elementi includono lo stesso tipo di dati.</span><span class="sxs-lookup"><span data-stu-id="07c45-251">Two array variables are considered to be of the same data type only when they have the same rank and their elements have the same data type.</span></span> <span data-ttu-id="07c45-252">La lunghezza delle dimensioni in una matrice non influisce sul tipo di dati della matrice.</span><span class="sxs-lookup"><span data-stu-id="07c45-252">The lengths of the dimensions in an array do not influence the array data type.</span></span>  
  
 <span data-ttu-id="07c45-253">Ogni matrice eredita dalla classe <xref:System.Array?displayProperty=nameWithType>. È possibile dichiarare una variabile di tipo `Array`, ma non è possibile creare una matrice di tipo `Array`.</span><span class="sxs-lookup"><span data-stu-id="07c45-253">Every array inherits from the <xref:System.Array?displayProperty=nameWithType> class, and you can declare a variable to be of type `Array`, but you cannot create an array of type `Array`.</span></span> <span data-ttu-id="07c45-254">L'[istruzione ReDim](../../../../visual-basic/language-reference/statements/redim-statement.md) non può inoltre operare su una variabile dichiarata di tipo `Array`.</span><span class="sxs-lookup"><span data-stu-id="07c45-254">Also, the [ReDim Statement](../../../../visual-basic/language-reference/statements/redim-statement.md) cannot operate on a variable declared as type `Array`.</span></span> <span data-ttu-id="07c45-255">Per questi motivi, e per garantire l'indipendenza dai tipi, è consigliabile dichiarare ogni matrice con un tipo specifico, ad esempio `Integer` nell'esempio precedente.</span><span class="sxs-lookup"><span data-stu-id="07c45-255">For these reasons, and for type safety, it is advisable to declare every array as a specific type, such as `Integer` in the preceding example.</span></span>  
  
 <span data-ttu-id="07c45-256">È possibile determinare il tipo di dati di una matrice o dei relativi elementi in diversi modi.</span><span class="sxs-lookup"><span data-stu-id="07c45-256">You can find out the data type of either an array or its elements in several ways.</span></span>  
  
-   <span data-ttu-id="07c45-257">È possibile chiamare il metodo <xref:System.Object.GetType%2A?displayProperty=nameWithType> sulla variabile per ricevere un oggetto <xref:System.Type> per il tipo della variabile in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="07c45-257">You can call the <xref:System.Object.GetType%2A?displayProperty=nameWithType> method on the variable to receive a <xref:System.Type> object for the run-time type of the variable.</span></span> <span data-ttu-id="07c45-258">Nelle proprietà e nei metodi dell'oggetto <xref:System.Type> sono presenti informazioni complete.</span><span class="sxs-lookup"><span data-stu-id="07c45-258">The <xref:System.Type> object holds extensive information in its properties and methods.</span></span>  
  
-   <span data-ttu-id="07c45-259">È possibile passare la variabile alla funzione <xref:Microsoft.VisualBasic.Information.TypeName%2A> per ricevere un oggetto `String` contenente il nome del tipo in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="07c45-259">You can pass the variable to the <xref:Microsoft.VisualBasic.Information.TypeName%2A> function to receive a `String` containing the name of run-time type.</span></span>  
  
-   <span data-ttu-id="07c45-260">È possibile passare la variabile alla funzione <xref:Microsoft.VisualBasic.Information.VarType%2A> per ricevere un valore `VariantType` che rappresenta la classificazione del tipo della variabile.</span><span class="sxs-lookup"><span data-stu-id="07c45-260">You can pass the variable to the <xref:Microsoft.VisualBasic.Information.VarType%2A> function to receive a `VariantType` value representing the type classification of the variable.</span></span>  
  
 <span data-ttu-id="07c45-261">L'esempio seguente chiama la funzione `TypeName` per determinare il tipo della matrice e il tipo degli elementi nella matrice.</span><span class="sxs-lookup"><span data-stu-id="07c45-261">The following example calls the `TypeName` function to determine the type of the array and the type of the elements in the array.</span></span> <span data-ttu-id="07c45-262">Il tipo di matrice è `Integer(,)` e gli elementi nella matrice sono di tipo `Integer`.</span><span class="sxs-lookup"><span data-stu-id="07c45-262">The array type is `Integer(,)` and the elements in the array are of type `Integer`.</span></span>  
  
 [!code-vb[VbVbalrArrays#15](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#15)]  
  
##  <span data-ttu-id="07c45-263"><a name="BKMK_Collections"></a> Raccolte come alternativa alle matrici</span><span class="sxs-lookup"><span data-stu-id="07c45-263"><a name="BKMK_Collections"></a> Collections as an Alternative to Arrays</span></span>  
 <span data-ttu-id="07c45-264">Le matrici sono estremamente utili per la creazione e l'uso di un numero fisso di oggetti fortemente tipizzati.</span><span class="sxs-lookup"><span data-stu-id="07c45-264">Arrays are most useful for creating and working with a fixed number of strongly typed objects.</span></span> <span data-ttu-id="07c45-265">Le raccolte consentono di lavorare in modo più flessibile con gruppi di oggetti.</span><span class="sxs-lookup"><span data-stu-id="07c45-265">Collections provide a more flexible way to work with groups of objects.</span></span> <span data-ttu-id="07c45-266">A differenza delle matrici, il gruppo di oggetti con cui si lavora può aumentare e diminuire in modo dinamico in base alle esigenze dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="07c45-266">Unlike arrays, the group of objects that you work with can grow and shrink dynamically as the needs of the application change.</span></span>  
  
 <span data-ttu-id="07c45-267">Per modificare la dimensione di una matrice, è necessario usare l'[istruzione ReDim](../../../../visual-basic/language-reference/statements/redim-statement.md).</span><span class="sxs-lookup"><span data-stu-id="07c45-267">If you need to change the size of an array, you must use the [ReDim Statement](../../../../visual-basic/language-reference/statements/redim-statement.md).</span></span> <span data-ttu-id="07c45-268">In questo modo, [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] crea una nuova matrice e la matrice precedente viene rilasciata per l'eliminazione.</span><span class="sxs-lookup"><span data-stu-id="07c45-268">When you do this, [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] creates a new array and releases the previous array for disposal.</span></span> <span data-ttu-id="07c45-269">Questa operazione causa un aumento del tempo di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="07c45-269">This takes execution time.</span></span> <span data-ttu-id="07c45-270">Di conseguenza, se il numero degli elementi usati cambia spesso oppure non è possibile prevedere il numero massimo di elementi necessari, è preferibile usare una raccolta per ottenere prestazioni migliori.</span><span class="sxs-lookup"><span data-stu-id="07c45-270">Therefore, if the number of items you are working with changes frequently, or you cannot predict the maximum number of items you need, you might obtain better performance using a collection.</span></span>  
  
 <span data-ttu-id="07c45-271">Per alcune raccolte è possibile assegnare una chiave a qualsiasi oggetto inserito nella raccolta in modo da recuperare rapidamente l'oggetto usando la chiave.</span><span class="sxs-lookup"><span data-stu-id="07c45-271">For some collections, you can assign a key to any object that you put into the collection so that you can quickly retrieve the object by using the key.</span></span>  
  
 <span data-ttu-id="07c45-272">Se la raccolta contiene elementi di un solo tipo di dati, è possibile usare una delle classi nello spazio dei nomi <xref:System.Collections.Generic?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="07c45-272">If your collection contains elements of only one data type, you can use one of the classes in the <xref:System.Collections.Generic?displayProperty=nameWithType> namespace.</span></span> <span data-ttu-id="07c45-273">In una raccolta generica viene imposta l'indipendenza dai tipi, in modo da impedire che vengano aggiunti altri tipi di dati alla raccolta.</span><span class="sxs-lookup"><span data-stu-id="07c45-273">A generic collection enforces type safety so that no other data type can be added to it.</span></span> <span data-ttu-id="07c45-274">Quando si recupera un elemento da una raccolta generica, non è necessario determinarne il tipo di dati né convertirlo.</span><span class="sxs-lookup"><span data-stu-id="07c45-274">When you retrieve an element from a generic collection, you do not have to determine its data type or convert it.</span></span>  
  
 <span data-ttu-id="07c45-275">Per altre informazioni sulle raccolte, vedere [Raccolte](http://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b).</span><span class="sxs-lookup"><span data-stu-id="07c45-275">For more information about collections, see [Collections](http://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b).</span></span>  
  
### <a name="example"></a><span data-ttu-id="07c45-276">Esempio</span><span class="sxs-lookup"><span data-stu-id="07c45-276">Example</span></span>  
 <span data-ttu-id="07c45-277">L'esempio seguente usa la classe generica <xref:System.Collections.Generic.List%601?displayProperty=nameWithType> di [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] per creare una raccolta di oggetti `Customer`.</span><span class="sxs-lookup"><span data-stu-id="07c45-277">The following example uses the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] generic class <xref:System.Collections.Generic.List%601?displayProperty=nameWithType> to create a list collection of `Customer` objects.</span></span>  
  
 [!code-vb[VbVbalrArrays#1](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#1)]  
  
 <span data-ttu-id="07c45-278">La dichiarazione della raccolta `CustomerFile` specifica che la raccolta può contenere soltanto elementi di tipo `Customer`</span><span class="sxs-lookup"><span data-stu-id="07c45-278">The declaration of the `CustomerFile` collection specifies that it can contain elements only of type `Customer`.</span></span> <span data-ttu-id="07c45-279">e definisce anche una capacità iniziale di 200 elementi.</span><span class="sxs-lookup"><span data-stu-id="07c45-279">It also provides for an initial capacity of 200 elements.</span></span> <span data-ttu-id="07c45-280">La routine `AddNewCustomer` controlla la validità del nuovo elemento e quindi lo aggiunge alla raccolta.</span><span class="sxs-lookup"><span data-stu-id="07c45-280">The procedure `AddNewCustomer` checks the new element for validity and then adds it to the collection.</span></span> <span data-ttu-id="07c45-281">La routine `PrintCustomers` usa un ciclo `For Each` per attraversare la raccolta e visualizzarne gli elementi.</span><span class="sxs-lookup"><span data-stu-id="07c45-281">The procedure `PrintCustomers` uses a `For Each` loop to traverse the collection and display its elements.</span></span>  
  
## <a name="related-topics"></a><span data-ttu-id="07c45-282">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="07c45-282">Related Topics</span></span>  
  
|<span data-ttu-id="07c45-283">Termine</span><span class="sxs-lookup"><span data-stu-id="07c45-283">Term</span></span>|<span data-ttu-id="07c45-284">Definizione</span><span class="sxs-lookup"><span data-stu-id="07c45-284">Definition</span></span>|  
|----------|----------------|  
|[<span data-ttu-id="07c45-285">Array Dimensions in Visual Basic</span><span class="sxs-lookup"><span data-stu-id="07c45-285">Array Dimensions in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/arrays/array-dimensions.md)|<span data-ttu-id="07c45-286">Illustra il numero di dimensioni, o rango, e le dimensioni delle matrici.</span><span class="sxs-lookup"><span data-stu-id="07c45-286">Explains rank and dimensions in arrays.</span></span>|  
|[<span data-ttu-id="07c45-287">Procedura: Inizializzare una variabile di matrice in Visual Basic</span><span class="sxs-lookup"><span data-stu-id="07c45-287">How to: Initialize an Array Variable in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/arrays/how-to-initialize-an-array-variable.md)|<span data-ttu-id="07c45-288">Descrive come popolare le matrici con valori iniziali.</span><span class="sxs-lookup"><span data-stu-id="07c45-288">Describes how to populate arrays with initial values.</span></span>|  
|[<span data-ttu-id="07c45-289">Procedura: Ordinare una matrice in Visual Basic</span><span class="sxs-lookup"><span data-stu-id="07c45-289">How to: Sort An Array in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/arrays/how-to-sort-an-array.md)|<span data-ttu-id="07c45-290">Illustra come ordinare alfabeticamente gli elementi di una matrice.</span><span class="sxs-lookup"><span data-stu-id="07c45-290">Shows how to sort the elements of an array alphabetically.</span></span>|  
|[<span data-ttu-id="07c45-291">Procedura: Assegnare una matrice a un'altra matrice</span><span class="sxs-lookup"><span data-stu-id="07c45-291">How to: Assign One Array to Another Array</span></span>](../../../../visual-basic/programming-guide/language-features/arrays/how-to-assign-one-array-to-another-array.md)|<span data-ttu-id="07c45-292">Descrive regole e passaggi per l'assegnazione di una matrice a un'altra variabile di matrice.</span><span class="sxs-lookup"><span data-stu-id="07c45-292">Describes the rules and steps for assigning an array to another array variable.</span></span>|  
|[<span data-ttu-id="07c45-293">Risoluzione dei problemi relativi alle matrici</span><span class="sxs-lookup"><span data-stu-id="07c45-293">Troubleshooting Arrays</span></span>](../../../../visual-basic/programming-guide/language-features/arrays/troubleshooting-arrays.md)|<span data-ttu-id="07c45-294">Illustra alcuni problemi comuni che si verificano quando si usano le matrici.</span><span class="sxs-lookup"><span data-stu-id="07c45-294">Discusses some common problems that arise when working with arrays.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="07c45-295">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="07c45-295">See Also</span></span>  
 <xref:System.Array>  
 [<span data-ttu-id="07c45-296">Istruzione Dim</span><span class="sxs-lookup"><span data-stu-id="07c45-296">Dim Statement</span></span>](../../../../visual-basic/language-reference/statements/dim-statement.md)  
 [<span data-ttu-id="07c45-297">Istruzione ReDim</span><span class="sxs-lookup"><span data-stu-id="07c45-297">ReDim Statement</span></span>](../../../../visual-basic/language-reference/statements/redim-statement.md)
