---
title: Istruzione For Each...Next (Visual Basic)
ms.date: 07/20/2015
f1_keywords:
- vb.ForEach
- vb.ForEachNext
- vb.Each
- ForEachNext
helpviewer_keywords:
- infinite loops
- Next statement [Visual Basic], For Each...Next
- endless loops
- loop structures [Visual Basic], For Each...Next
- loops, endless
- Each keyword [Visual Basic]
- instructions, repeating
- For Each statement [Visual Basic]
- collections, instruction repetition
- loops, infinite
- For Each...Next statements
- For keyword [Visual Basic], For Each...Next statements
- Exit statement [Visual Basic], For Each...Next statements
- iteration
ms.assetid: ebce3120-95c3-42b1-b70b-fa7da40c75e2
ms.openlocfilehash: ec7e5196bcb939631f4bf426f2e94cddc0c88a9a
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/04/2018
ms.locfileid: "33605381"
---
# <a name="for-eachnext-statement-visual-basic"></a><span data-ttu-id="42b77-102">Istruzione For Each...Next (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="42b77-102">For Each...Next Statement (Visual Basic)</span></span>
<span data-ttu-id="42b77-103">Ripete un gruppo di istruzioni per ogni elemento in una raccolta.</span><span class="sxs-lookup"><span data-stu-id="42b77-103">Repeats a group of statements for each element in a collection.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="42b77-104">Sintassi</span><span class="sxs-lookup"><span data-stu-id="42b77-104">Syntax</span></span>  
  
```  
For Each element [ As datatype ] In group  
    [ statements ]  
    [ Continue For ]  
    [ statements ]  
    [ Exit For ]  
    [ statements ]  
Next [ element ]  
```  
  
## <a name="parts"></a><span data-ttu-id="42b77-105">Parti</span><span class="sxs-lookup"><span data-stu-id="42b77-105">Parts</span></span>  
  
|<span data-ttu-id="42b77-106">Termine</span><span class="sxs-lookup"><span data-stu-id="42b77-106">Term</span></span>|<span data-ttu-id="42b77-107">Definizione</span><span class="sxs-lookup"><span data-stu-id="42b77-107">Definition</span></span>|  
|---|---|  
|`element`|<span data-ttu-id="42b77-108">Obbligatorio nel `For Each` istruzione.</span><span class="sxs-lookup"><span data-stu-id="42b77-108">Required in the `For Each` statement.</span></span> <span data-ttu-id="42b77-109">Facoltativo nel `Next` istruzione.</span><span class="sxs-lookup"><span data-stu-id="42b77-109">Optional in the `Next` statement.</span></span> <span data-ttu-id="42b77-110">Variabile.</span><span class="sxs-lookup"><span data-stu-id="42b77-110">Variable.</span></span> <span data-ttu-id="42b77-111">Utilizzato per scorrere gli elementi della raccolta.</span><span class="sxs-lookup"><span data-stu-id="42b77-111">Used to iterate through the elements of the collection.</span></span>|  
|`datatype`|<span data-ttu-id="42b77-112">Obbligatorio se `element` non è già dichiarato.</span><span class="sxs-lookup"><span data-stu-id="42b77-112">Required if `element` isn't already declared.</span></span> <span data-ttu-id="42b77-113">Tipo di dati di `element`.</span><span class="sxs-lookup"><span data-stu-id="42b77-113">Data type of `element`.</span></span>|  
|`group`|<span data-ttu-id="42b77-114">Obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="42b77-114">Required.</span></span> <span data-ttu-id="42b77-115">Una variabile con un tipo che è un tipo di raccolta o un oggetto.</span><span class="sxs-lookup"><span data-stu-id="42b77-115">A variable with a type that's a collection type or Object.</span></span> <span data-ttu-id="42b77-116">Fa riferimento alla raccolta in cui il `statements` devono essere ripetute.</span><span class="sxs-lookup"><span data-stu-id="42b77-116">Refers to the collection over which the `statements` are to be repeated.</span></span>|  
|`statements`|<span data-ttu-id="42b77-117">Facoltativo.</span><span class="sxs-lookup"><span data-stu-id="42b77-117">Optional.</span></span> <span data-ttu-id="42b77-118">Uno o più istruzioni tra `For Each` e `Next` eseguiti su ogni elemento `group`.</span><span class="sxs-lookup"><span data-stu-id="42b77-118">One or more statements between `For Each` and `Next` that run on each item in `group`.</span></span>|  
|`Continue For`|<span data-ttu-id="42b77-119">Facoltativo.</span><span class="sxs-lookup"><span data-stu-id="42b77-119">Optional.</span></span> <span data-ttu-id="42b77-120">Trasferisce il controllo all'inizio del `For Each` ciclo.</span><span class="sxs-lookup"><span data-stu-id="42b77-120">Transfers control to the start of the `For Each` loop.</span></span>|  
|`Exit For`|<span data-ttu-id="42b77-121">Facoltativo.</span><span class="sxs-lookup"><span data-stu-id="42b77-121">Optional.</span></span> <span data-ttu-id="42b77-122">Trasferisce il controllo fuori il `For Each` ciclo.</span><span class="sxs-lookup"><span data-stu-id="42b77-122">Transfers control out of the `For Each` loop.</span></span>|  
|`Next`|<span data-ttu-id="42b77-123">Obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="42b77-123">Required.</span></span> <span data-ttu-id="42b77-124">Termina la definizione di `For Each` ciclo.</span><span class="sxs-lookup"><span data-stu-id="42b77-124">Terminates the definition of the `For Each` loop.</span></span>|  
  
## <a name="simple-example"></a><span data-ttu-id="42b77-125">Esempio semplice</span><span class="sxs-lookup"><span data-stu-id="42b77-125">Simple Example</span></span>  
 <span data-ttu-id="42b77-126">Utilizzare un `For Each`... `Next` ciclo quando si desidera ripetere un set di istruzioni per ogni elemento di una raccolta o una matrice.</span><span class="sxs-lookup"><span data-stu-id="42b77-126">Use a `For Each`...`Next` loop when you want to repeat a set of statements for each element of a collection or array.</span></span>  
  
> [!TIP]
>  <span data-ttu-id="42b77-127">Oggetto [per... Istruzione successiva](../../../visual-basic/language-reference/statements/for-next-statement.md) funziona bene quando è possibile associare una variabile di controllo di ogni iterazione di un ciclo e determinare i valori iniziale e finale della variabile.</span><span class="sxs-lookup"><span data-stu-id="42b77-127">A [For...Next Statement](../../../visual-basic/language-reference/statements/for-next-statement.md) works well when you can associate each iteration of a loop with a control variable and determine that variable's initial and final values.</span></span> <span data-ttu-id="42b77-128">Tuttavia, quando si sta utilizzando una raccolta, il concetto di valori iniziale e finale non è significativo, e non si conosce necessariamente la raccolta è il numero di elementi.</span><span class="sxs-lookup"><span data-stu-id="42b77-128">However, when you are dealing with a collection, the concept of initial and final values isn't meaningful, and you don't necessarily know how many elements the collection has.</span></span> <span data-ttu-id="42b77-129">In questo tipo di case, un `For Each`... `Next` ciclo è spesso una scelta migliore.</span><span class="sxs-lookup"><span data-stu-id="42b77-129">In this kind of case, a `For Each`...`Next` loop is often a better choice.</span></span>  
  
 <span data-ttu-id="42b77-130">Nell'esempio seguente, il `For Each`...`Next`</span><span class="sxs-lookup"><span data-stu-id="42b77-130">In the following example, the `For Each`…`Next`</span></span> <span data-ttu-id="42b77-131">istruzione esegue l'iterazione attraverso tutti gli elementi di una raccolta di elenchi.</span><span class="sxs-lookup"><span data-stu-id="42b77-131">statement iterates through all the elements of a List collection.</span></span>  
  
 [!code-vb[VbVbalrStatements#121](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_1.vb)]  
  
 <span data-ttu-id="42b77-132">Per ulteriori esempi, vedere [raccolte](../../../standard/collections/index.md) e [matrici](../../../visual-basic/programming-guide/language-features/arrays/index.md).</span><span class="sxs-lookup"><span data-stu-id="42b77-132">For more examples, see [Collections](../../../standard/collections/index.md) and [Arrays](../../../visual-basic/programming-guide/language-features/arrays/index.md).</span></span>  
  
## <a name="nested-loops"></a><span data-ttu-id="42b77-133">Nested Loops</span><span class="sxs-lookup"><span data-stu-id="42b77-133">Nested Loops</span></span>  
 <span data-ttu-id="42b77-134">È possibile annidare `For Each` cicli inserendo un ciclo all'interno di un altro.</span><span class="sxs-lookup"><span data-stu-id="42b77-134">You can nest `For Each` loops by putting one loop within another.</span></span>  
  
 <span data-ttu-id="42b77-135">Nell'esempio seguente viene nidificata `For Each`...`Next`</span><span class="sxs-lookup"><span data-stu-id="42b77-135">The following example demonstrates nested `For Each`…`Next`</span></span> <span data-ttu-id="42b77-136">strutture.</span><span class="sxs-lookup"><span data-stu-id="42b77-136">structures.</span></span>  
  
 [!code-vb[VbVbalrStatements#122](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_2.vb)]  
  
 <span data-ttu-id="42b77-137">Quando si nidificano cicli, ogni ciclo deve essere associato un unico `element` variabile.</span><span class="sxs-lookup"><span data-stu-id="42b77-137">When you nest loops, each loop must have a unique `element` variable.</span></span>  
  
 <span data-ttu-id="42b77-138">È inoltre possibile annidare tipi diversi di strutture di controllo all'interno di altro.</span><span class="sxs-lookup"><span data-stu-id="42b77-138">You can also nest different kinds of control structures within each other.</span></span> <span data-ttu-id="42b77-139">Per ulteriori informazioni, vedere [strutture di controllo nidificate](../../../visual-basic/programming-guide/language-features/control-flow/nested-control-structures.md).</span><span class="sxs-lookup"><span data-stu-id="42b77-139">For more information, see [Nested Control Structures](../../../visual-basic/programming-guide/language-features/control-flow/nested-control-structures.md).</span></span>  
  
## <a name="exit-for-and-continue-for"></a><span data-ttu-id="42b77-140">Per quindi continuare per</span><span class="sxs-lookup"><span data-stu-id="42b77-140">Exit For and Continue For</span></span>  
 <span data-ttu-id="42b77-141">Il [Exit For](../../../visual-basic/language-reference/statements/exit-statement.md) istruzione provoca l'esecuzione uscire dall'installazione di `For`...`Next`</span><span class="sxs-lookup"><span data-stu-id="42b77-141">The [Exit For](../../../visual-basic/language-reference/statements/exit-statement.md) statement causes execution to exit the `For`…`Next`</span></span> <span data-ttu-id="42b77-142">ciclo e trasferisce il controllo all'istruzione che segue il `Next` istruzione.</span><span class="sxs-lookup"><span data-stu-id="42b77-142">loop and transfers control to the statement that follows the `Next` statement.</span></span>  
  
 <span data-ttu-id="42b77-143">Il `Continue For` istruzione trasferisce immediatamente il controllo all'iterazione successiva del ciclo.</span><span class="sxs-lookup"><span data-stu-id="42b77-143">The `Continue For` statement transfers control immediately to the next iteration of the loop.</span></span> <span data-ttu-id="42b77-144">Per ulteriori informazioni, vedere [istruzione Continue](../../../visual-basic/language-reference/statements/continue-statement.md).</span><span class="sxs-lookup"><span data-stu-id="42b77-144">For more information, see [Continue Statement](../../../visual-basic/language-reference/statements/continue-statement.md).</span></span>  
  
 <span data-ttu-id="42b77-145">Nell'esempio seguente viene illustrato come utilizzare il `Continue For` e `Exit For` istruzioni.</span><span class="sxs-lookup"><span data-stu-id="42b77-145">The following example shows how to use the `Continue For` and `Exit For` statements.</span></span>  
  
 [!code-vb[VbVbalrStatements#123](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_3.vb)]  
  
 <span data-ttu-id="42b77-146">È possibile inserire un numero qualsiasi di `Exit For` le istruzioni in un `For Each` ciclo.</span><span class="sxs-lookup"><span data-stu-id="42b77-146">You can put any number of `Exit For` statements in a `For Each` loop.</span></span> <span data-ttu-id="42b77-147">Se utilizzato all'interno di cicli `For Each` cicli, `Exit For` di chiudere il controllo più interno di ciclo e i trasferimenti del successivo livello superiore di annidamento dell'esecuzione.</span><span class="sxs-lookup"><span data-stu-id="42b77-147">When used within nested `For Each` loops, `Exit For` causes execution to exit the innermost loop and transfers control to the next higher level of nesting.</span></span>  
  
 <span data-ttu-id="42b77-148">`Exit For` viene spesso utilizzata dopo una versione di valutazione di una determinata condizione, ad esempio, in un `If`... `Then`... `Else` struttura.</span><span class="sxs-lookup"><span data-stu-id="42b77-148">`Exit For` is often used after an evaluation of some condition, for example, in an `If`...`Then`...`Else` structure.</span></span> <span data-ttu-id="42b77-149">Si potrebbe voler usare `Exit For` per le condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="42b77-149">You might want to use `Exit For` for the following conditions:</span></span>  
  
-   <span data-ttu-id="42b77-150">Continuare a eseguire l'iterazione è necessaria oppure è impossibile.</span><span class="sxs-lookup"><span data-stu-id="42b77-150">Continuing to iterate is unnecessary or impossible.</span></span> <span data-ttu-id="42b77-151">Ciò potrebbe essere causato da un valore errato o una richiesta di terminazione.</span><span class="sxs-lookup"><span data-stu-id="42b77-151">This might be caused by an erroneous value or a termination request.</span></span>  
  
-   <span data-ttu-id="42b77-152">Un'eccezione viene rilevata un `Try`... `Catch`... `Finally`. È possibile utilizzare `Exit For` alla fine del `Finally` blocco.</span><span class="sxs-lookup"><span data-stu-id="42b77-152">An exception is caught in a `Try`...`Catch`...`Finally`. You might use `Exit For` at the end of the `Finally` block.</span></span>  
  
-   <span data-ttu-id="42b77-153">Esiste un ciclo infinito, ovvero un ciclo che è stato possibile eseguire un numero elevato o persino infinito di volte.</span><span class="sxs-lookup"><span data-stu-id="42b77-153">There an endless loop, which is a loop that could run a large or even infinite number of times.</span></span> <span data-ttu-id="42b77-154">Se si rileva una condizione, è possibile utilizzare `Exit For` per interrompere il ciclo.</span><span class="sxs-lookup"><span data-stu-id="42b77-154">If you detect such a condition, you can use `Exit For` to escape the loop.</span></span> <span data-ttu-id="42b77-155">Per ulteriori informazioni, vedere [si... Istruzione di ciclo](../../../visual-basic/language-reference/statements/do-loop-statement.md).</span><span class="sxs-lookup"><span data-stu-id="42b77-155">For more information, see [Do...Loop Statement](../../../visual-basic/language-reference/statements/do-loop-statement.md).</span></span>  
  
## <a name="iterators"></a><span data-ttu-id="42b77-156">Iterators</span><span class="sxs-lookup"><span data-stu-id="42b77-156">Iterators</span></span>  
 <span data-ttu-id="42b77-157">Si utilizza un *iteratore* per eseguire un'iterazione personalizzata su una raccolta.</span><span class="sxs-lookup"><span data-stu-id="42b77-157">You use an *iterator* to perform a custom iteration over a collection.</span></span> <span data-ttu-id="42b77-158">Un iteratore può essere una funzione o un `Get` della funzione di accesso.</span><span class="sxs-lookup"><span data-stu-id="42b77-158">An iterator can be a function or a `Get` accessor.</span></span> <span data-ttu-id="42b77-159">Usa un `Yield` istruzione per restituire ogni elemento della raccolta uno alla volta.</span><span class="sxs-lookup"><span data-stu-id="42b77-159">It uses a `Yield` statement to return each element of the collection one at a time.</span></span>  
  
 <span data-ttu-id="42b77-160">Per chiamare un iteratore di un `For Each...Next` istruzione.</span><span class="sxs-lookup"><span data-stu-id="42b77-160">You call an iterator by using a `For Each...Next` statement.</span></span> <span data-ttu-id="42b77-161">Ogni iterazione del ciclo `For Each` chiama l'iteratore.</span><span class="sxs-lookup"><span data-stu-id="42b77-161">Each iteration of the `For Each` loop calls the iterator.</span></span> <span data-ttu-id="42b77-162">Quando un `Yield` nell'iteratore, l'espressione viene raggiunta l'istruzione di `Yield` viene restituita l'istruzione e viene mantenuta la posizione corrente nel codice.</span><span class="sxs-lookup"><span data-stu-id="42b77-162">When a `Yield` statement is reached in the iterator, the expression in the `Yield` statement is returned, and the current location in code is retained.</span></span> <span data-ttu-id="42b77-163">L'esecuzione viene ripresa a partire da quella posizione la volta successiva che viene chiamato l'iteratore.</span><span class="sxs-lookup"><span data-stu-id="42b77-163">Execution is restarted from that location the next time that the iterator is called.</span></span>  
  
 <span data-ttu-id="42b77-164">L'esempio seguente usa una funzione iteratore.</span><span class="sxs-lookup"><span data-stu-id="42b77-164">The following example uses an iterator function.</span></span> <span data-ttu-id="42b77-165">La funzione iteratore ha un `Yield` istruzione all'interno di un [per... Avanti](../../../visual-basic/language-reference/statements/for-next-statement.md) ciclo.</span><span class="sxs-lookup"><span data-stu-id="42b77-165">The iterator function has a `Yield` statement that's inside a [For…Next](../../../visual-basic/language-reference/statements/for-next-statement.md) loop.</span></span> <span data-ttu-id="42b77-166">Nel `ListEvenNumbers` (metodo), ogni iterazione del `For Each` corpo dell'istruzione crea una chiamata alla funzione iteratore, che consente di passare alla successiva `Yield` istruzione.</span><span class="sxs-lookup"><span data-stu-id="42b77-166">In the `ListEvenNumbers` method, each iteration of the `For Each` statement body creates a call to the iterator function, which proceeds to the next `Yield` statement.</span></span>  
  
 [!code-vb[VbVbalrStatements#127](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_4.vb)]  
  
 <span data-ttu-id="42b77-167">Per ulteriori informazioni, vedere [iteratori](../../programming-guide/concepts/iterators.md), [istruzione Yield](../../../visual-basic/language-reference/statements/yield-statement.md), e [iteratore](../../../visual-basic/language-reference/modifiers/iterator.md).</span><span class="sxs-lookup"><span data-stu-id="42b77-167">For more information, see [Iterators](../../programming-guide/concepts/iterators.md), [Yield Statement](../../../visual-basic/language-reference/statements/yield-statement.md), and [Iterator](../../../visual-basic/language-reference/modifiers/iterator.md).</span></span>  
  
## <a name="technical-implementation"></a><span data-ttu-id="42b77-168">Implementazione tecnica</span><span class="sxs-lookup"><span data-stu-id="42b77-168">Technical Implementation</span></span>  
 <span data-ttu-id="42b77-169">Quando un `For Each`...`Next`</span><span class="sxs-lookup"><span data-stu-id="42b77-169">When a `For Each`…`Next`</span></span> <span data-ttu-id="42b77-170">istruzione viene eseguita, Visual Basic restituisce solo una volta, prima di avvia il ciclo di raccolta.</span><span class="sxs-lookup"><span data-stu-id="42b77-170">statement runs, Visual Basic evaluates the collection only one time, before the loop starts.</span></span> <span data-ttu-id="42b77-171">Se il blocco di istruzioni `element` o `group`, queste modifiche non influiscono sull'iterazione del ciclo.</span><span class="sxs-lookup"><span data-stu-id="42b77-171">If your statement block changes `element` or `group`, these changes don't affect the iteration of the loop.</span></span>  
  
 <span data-ttu-id="42b77-172">Quando tutti gli elementi nella raccolta sono stati assegnati a `element`, `For Each` ciclo viene arrestata e il controllo passa all'istruzione che segue il `Next` istruzione.</span><span class="sxs-lookup"><span data-stu-id="42b77-172">When all the elements in the collection have been successively assigned to `element`, the `For Each` loop stops and control passes to the statement following the `Next` statement.</span></span>  
  
 <span data-ttu-id="42b77-173">Se `element` non è stata dichiarata all'esterno di questo ciclo, è necessario dichiararla nel `For Each` istruzione.</span><span class="sxs-lookup"><span data-stu-id="42b77-173">If `element` hasn't been declared outside this loop, you must declare it in the `For Each` statement.</span></span> <span data-ttu-id="42b77-174">È possibile dichiarare il tipo di `element` in modo esplicito utilizzando un `As` istruzione oppure è possibile basarsi sull'inferenza del tipo per assegnare il tipo.</span><span class="sxs-lookup"><span data-stu-id="42b77-174">You can declare the type of `element` explicitly by using an `As` statement, or you can rely on type inference to assign the type.</span></span> <span data-ttu-id="42b77-175">In entrambi i casi, l'ambito di `element` è il corpo del ciclo.</span><span class="sxs-lookup"><span data-stu-id="42b77-175">In either case, the scope of `element` is the body of the loop.</span></span> <span data-ttu-id="42b77-176">Tuttavia, non è possibile dichiarare `element` all'esterno e all'interno del ciclo.</span><span class="sxs-lookup"><span data-stu-id="42b77-176">However, you cannot declare `element` both outside and inside the loop.</span></span>  
  
 <span data-ttu-id="42b77-177">È possibile specificare facoltativamente `element` nel `Next` istruzione.</span><span class="sxs-lookup"><span data-stu-id="42b77-177">You can optionally specify `element` in the `Next` statement.</span></span> <span data-ttu-id="42b77-178">Per migliorare la leggibilità del programma, soprattutto se hanno annidati `For Each` cicli.</span><span class="sxs-lookup"><span data-stu-id="42b77-178">This improves the readability of your program, especially if you have nested `For Each` loops.</span></span> <span data-ttu-id="42b77-179">È necessario specificare la stessa variabile di quello che viene visualizzato nel corrispondente `For Each` istruzione.</span><span class="sxs-lookup"><span data-stu-id="42b77-179">You must specify the same variable as the one that appears in the corresponding `For Each` statement.</span></span>  
  
 <span data-ttu-id="42b77-180">È possibile evitare di modificare il valore di `element` all'interno di un ciclo.</span><span class="sxs-lookup"><span data-stu-id="42b77-180">You might want to avoid changing the value of `element` inside a loop.</span></span> <span data-ttu-id="42b77-181">In questo modo può rendere più difficili da leggere e il debug del codice.</span><span class="sxs-lookup"><span data-stu-id="42b77-181">Doing this can make it more difficult to read and debug your code.</span></span> <span data-ttu-id="42b77-182">Modifica del valore di `group` non influenza la raccolta o sui suoi elementi, che sono stati determinati quando il ciclo prima di tutto è stato immesso.</span><span class="sxs-lookup"><span data-stu-id="42b77-182">Changing the value of `group` doesn't affect the collection or its elements, which were determined when the loop was first entered.</span></span>  
  
 <span data-ttu-id="42b77-183">Quando si eseguono la nidificazione di cicli, se un `Next` viene rilevata un'istruzione di un livello di nidificazione esterno prima di `Next` di un livello interno, il compilatore segnalerà un errore.</span><span class="sxs-lookup"><span data-stu-id="42b77-183">When you're nesting loops, if a `Next` statement of an outer nesting level is encountered before the `Next` of an inner level, the compiler signals an error.</span></span> <span data-ttu-id="42b77-184">Tuttavia, il compilatore può rilevare questa sovrapposizione errore solo se si specifica `element` in ogni `Next` istruzione.</span><span class="sxs-lookup"><span data-stu-id="42b77-184">However, the compiler can detect this overlapping error only if you specify `element` in every `Next` statement.</span></span>  
  
 <span data-ttu-id="42b77-185">Se il codice dipende attraversa una raccolta in un ordine specifico, un `For Each`... `Next` ciclo non è la scelta migliore, a meno che non si conoscano le caratteristiche dell'oggetto enumeratore esposto dall'insieme.</span><span class="sxs-lookup"><span data-stu-id="42b77-185">If your code depends on traversing a collection in a particular order, a `For Each`...`Next` loop isn't the best choice, unless you know the characteristics of the enumerator object the collection exposes.</span></span> <span data-ttu-id="42b77-186">L'ordine di scorrimento non è determinata da Visual Basic, ma dal <xref:System.Collections.IEnumerator.MoveNext%2A> metodo dell'oggetto enumeratore.</span><span class="sxs-lookup"><span data-stu-id="42b77-186">The order of traversal isn't determined by Visual Basic, but by the <xref:System.Collections.IEnumerator.MoveNext%2A> method of the enumerator object.</span></span> <span data-ttu-id="42b77-187">Di conseguenza, potrebbe essere in grado di prevedere quale elemento della raccolta è il primo da restituire in `element`, o che è in attesa di essere restituiti dopo un determinato elemento.</span><span class="sxs-lookup"><span data-stu-id="42b77-187">Therefore, you might not be able to predict which element of the collection is the first to be returned in `element`, or which is the next to be returned after a given element.</span></span> <span data-ttu-id="42b77-188">È possibile ottenere risultati più affidabili utilizzando una struttura di ciclo diversa, ad esempio `For`... `Next` o `Do`... `Loop`.</span><span class="sxs-lookup"><span data-stu-id="42b77-188">You might achieve more reliable results using a different loop structure, such as `For`...`Next` or `Do`...`Loop`.</span></span>  
  
 <span data-ttu-id="42b77-189">Il tipo di dati `element` deve essere in modo che il tipo di dati degli elementi di `group` può essere convertito a esso.</span><span class="sxs-lookup"><span data-stu-id="42b77-189">The data type of `element` must be such that the data type of the elements of `group` can be converted to it.</span></span>  
  
 <span data-ttu-id="42b77-190">Il tipo di dati `group` deve essere un tipo di riferimento che fa riferimento a una raccolta o una matrice che è enumerabile.</span><span class="sxs-lookup"><span data-stu-id="42b77-190">The data type of `group` must be a reference type that refers to a collection or an array that's enumerable.</span></span> <span data-ttu-id="42b77-191">In genere ciò significa che `group` fa riferimento a un oggetto che implementa il <xref:System.Collections.IEnumerable> interfaccia del `System.Collections` dello spazio dei nomi o <xref:System.Collections.Generic.IEnumerable%601> interfaccia del `System.Collections.Generic` dello spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="42b77-191">Most commonly this means that `group` refers to an object that implements the <xref:System.Collections.IEnumerable> interface of the `System.Collections` namespace or the <xref:System.Collections.Generic.IEnumerable%601> interface of the `System.Collections.Generic` namespace.</span></span> <span data-ttu-id="42b77-192">`System.Collections.IEnumerable` definisce il <xref:System.Collections.IEnumerable.GetEnumerator%2A> metodo, che restituisce un oggetto enumeratore per la raccolta.</span><span class="sxs-lookup"><span data-stu-id="42b77-192">`System.Collections.IEnumerable` defines the <xref:System.Collections.IEnumerable.GetEnumerator%2A> method, which returns an enumerator object for the collection.</span></span> <span data-ttu-id="42b77-193">Implementa l'oggetto enumeratore di `System.Collections.IEnumerator` interfaccia del `System.Collections` dello spazio dei nomi ed espone il <xref:System.Collections.IEnumerator.Current%2A> proprietà e <xref:System.Collections.IEnumerator.Reset%2A> e <xref:System.Collections.IEnumerator.MoveNext%2A> metodi.</span><span class="sxs-lookup"><span data-stu-id="42b77-193">The enumerator object implements the `System.Collections.IEnumerator` interface of the `System.Collections` namespace and exposes the <xref:System.Collections.IEnumerator.Current%2A> property and the <xref:System.Collections.IEnumerator.Reset%2A> and <xref:System.Collections.IEnumerator.MoveNext%2A> methods.</span></span> <span data-ttu-id="42b77-194">Visual Basic utilizzati per scorrere la raccolta.</span><span class="sxs-lookup"><span data-stu-id="42b77-194">Visual Basic uses these to traverse the collection.</span></span>  
  
### <a name="narrowing-conversions"></a><span data-ttu-id="42b77-195">conversioni verso un tipo di dati più piccolo</span><span class="sxs-lookup"><span data-stu-id="42b77-195">Narrowing Conversions</span></span>  
 <span data-ttu-id="42b77-196">Quando `Option Strict` è impostato su `On`, le conversioni di restrizione in genere provocano errori del compilatore.</span><span class="sxs-lookup"><span data-stu-id="42b77-196">When `Option Strict` is set to `On`, narrowing conversions ordinarily cause compiler errors.</span></span> <span data-ttu-id="42b77-197">In un `For Each` istruzione, tuttavia, le conversioni da elementi `group` per `element` vengono valutate ed eseguite in fase di esecuzione, mentre gli errori del compilatore causati da conversioni di restrizione vengono eliminati.</span><span class="sxs-lookup"><span data-stu-id="42b77-197">In a `For Each` statement, however, conversions from the elements in `group` to `element` are evaluated and performed at run time, and compiler errors caused by narrowing conversions are suppressed.</span></span>  
  
 <span data-ttu-id="42b77-198">Nell'esempio seguente, l'assegnazione di `m` come valore iniziale per `n` non viene compilato quando `Option Strict` si trova in quanto la conversione di un `Long` per un `Integer` è una conversione di narrowing.</span><span class="sxs-lookup"><span data-stu-id="42b77-198">In the following example, the assignment of `m` as the initial value for `n` doesn't compile when `Option Strict` is on because the conversion of a `Long` to an `Integer` is a narrowing conversion.</span></span> <span data-ttu-id="42b77-199">Nel `For Each` istruzione, non è tuttavia alcun errore del compilatore segnalato, anche se l'assegnazione al `number` richiede la conversione da stesso `Long` a `Integer`.</span><span class="sxs-lookup"><span data-stu-id="42b77-199">In the `For Each` statement, however, no compiler error is reported, even though the assignment to `number` requires the same conversion from `Long` to `Integer`.</span></span> <span data-ttu-id="42b77-200">Nel `For Each` si verifica un errore di run-time di istruzione che contiene un numero elevato, quando <xref:Microsoft.VisualBasic.CompilerServices.Conversions.ToInteger%2A> viene applicato per il numero di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="42b77-200">In the `For Each` statement that contains a large number, a run-time error occurs when <xref:Microsoft.VisualBasic.CompilerServices.Conversions.ToInteger%2A> is applied to the large number.</span></span>  
  
 [!code-vb[VbVbalrStatements#89](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_5.vb)]  
  
### <a name="ienumerator-calls"></a><span data-ttu-id="42b77-201">Chiamate di IEnumerator</span><span class="sxs-lookup"><span data-stu-id="42b77-201">IEnumerator Calls</span></span>  
 <span data-ttu-id="42b77-202">Quando l'esecuzione di un `For Each`... `Next` ciclo viene avviato, verifica di Visual Basic che `group` fa riferimento a un oggetto collection valido.</span><span class="sxs-lookup"><span data-stu-id="42b77-202">When execution of a `For Each`...`Next` loop starts, Visual Basic verifies that `group` refers to a valid collection object.</span></span> <span data-ttu-id="42b77-203">In caso contrario, viene generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="42b77-203">If not, it throws an exception.</span></span> <span data-ttu-id="42b77-204">In caso contrario, chiama il <xref:System.Collections.IEnumerator.MoveNext%2A> (metodo) e <xref:System.Collections.IEnumerator.Current%2A> proprietà dell'oggetto enumeratore per restituire il primo elemento.</span><span class="sxs-lookup"><span data-stu-id="42b77-204">Otherwise, it calls the <xref:System.Collections.IEnumerator.MoveNext%2A> method and the <xref:System.Collections.IEnumerator.Current%2A> property of the enumerator object to return the first element.</span></span> <span data-ttu-id="42b77-205">Se `MoveNext` non indica che è presente alcun elemento successivo, vale a dire, se la raccolta è vuota, il `For Each` ciclo viene arrestata e il controllo passa all'istruzione che segue il `Next` istruzione.</span><span class="sxs-lookup"><span data-stu-id="42b77-205">If `MoveNext` indicates that there is no next element, that is, if the collection is empty, the `For Each` loop stops and control passes to the statement following the `Next` statement.</span></span> <span data-ttu-id="42b77-206">In caso contrario, Visual Basic imposta `element` per il primo elemento e viene eseguito il blocco di istruzioni.</span><span class="sxs-lookup"><span data-stu-id="42b77-206">Otherwise, Visual Basic sets `element` to the first element and runs the statement block.</span></span>  
  
 <span data-ttu-id="42b77-207">Ogni volta che rileva Visual Basic il `Next` istruzione, viene restituito per il `For Each` istruzione.</span><span class="sxs-lookup"><span data-stu-id="42b77-207">Each time Visual Basic encounters the `Next` statement, it returns to the `For Each` statement.</span></span> <span data-ttu-id="42b77-208">Chiama nuovamente `MoveNext` e `Current` per restituire l'elemento successivo e nuovamente eseguito il blocco o arresta il ciclo in base al risultato.</span><span class="sxs-lookup"><span data-stu-id="42b77-208">Again it calls `MoveNext` and `Current` to return the next element, and again it either runs the block or stops the loop depending on the result.</span></span> <span data-ttu-id="42b77-209">Questo processo continua fino a `MoveNext` indica che è presente alcun elemento successivo o `Exit For` viene rilevata un'istruzione.</span><span class="sxs-lookup"><span data-stu-id="42b77-209">This process continues until `MoveNext` indicates that there is no next element or an `Exit For` statement is encountered.</span></span>  
  
 <span data-ttu-id="42b77-210">**Modifica della raccolta.**</span><span class="sxs-lookup"><span data-stu-id="42b77-210">**Modifying the Collection.**</span></span> <span data-ttu-id="42b77-211">L'oggetto enumeratore restituito da <xref:System.Collections.IEnumerable.GetEnumerator%2A> in genere non è possibile modificare la raccolta mediante l'aggiunta, eliminazione, la sostituzione o il riordino di elementi.</span><span class="sxs-lookup"><span data-stu-id="42b77-211">The enumerator object returned by <xref:System.Collections.IEnumerable.GetEnumerator%2A> normally doesn't let you change the collection by adding, deleting, replacing, or reordering any elements.</span></span> <span data-ttu-id="42b77-212">Se si modifica la raccolta dopo aver iniziato una `For Each`... `Next` ciclo, l'oggetto enumeratore viene invalidato e al successivo tentativo di accedere a un elemento provoca un <xref:System.InvalidOperationException> eccezione.</span><span class="sxs-lookup"><span data-stu-id="42b77-212">If you change the collection after you have initiated a `For Each`...`Next` loop, the enumerator object becomes invalid, and the next attempt to access an element causes an <xref:System.InvalidOperationException> exception.</span></span>  
  
 <span data-ttu-id="42b77-213">Tuttavia, il blocco di modifica non è determinato da Visual Basic, ma piuttosto dall'implementazione del <xref:System.Collections.IEnumerable> interfaccia.</span><span class="sxs-lookup"><span data-stu-id="42b77-213">However, this blocking of modification isn't determined by Visual Basic, but rather by the implementation of the <xref:System.Collections.IEnumerable> interface.</span></span> <span data-ttu-id="42b77-214">È possibile implementare `IEnumerable` in modo che consente la modifica durante l'iterazione.</span><span class="sxs-lookup"><span data-stu-id="42b77-214">It is possible to implement `IEnumerable` in a way that allows for modification during iteration.</span></span> <span data-ttu-id="42b77-215">Se si prevede di eseguire tale modifica dinamica, assicurarsi di aver compreso le caratteristiche del `IEnumerable` implementazione per la raccolta in uso.</span><span class="sxs-lookup"><span data-stu-id="42b77-215">If you are considering doing such dynamic modification, make sure that you understand the characteristics of the `IEnumerable` implementation on the collection you are using.</span></span>  
  
 <span data-ttu-id="42b77-216">**Modifica di elementi della raccolta.**</span><span class="sxs-lookup"><span data-stu-id="42b77-216">**Modifying Collection Elements.**</span></span> <span data-ttu-id="42b77-217">Il <xref:System.Collections.IEnumerator.Current%2A> è di proprietà dell'oggetto enumeratore [ReadOnly](../../../visual-basic/language-reference/modifiers/readonly.md), e restituisce una copia locale di ogni elemento della raccolta.</span><span class="sxs-lookup"><span data-stu-id="42b77-217">The <xref:System.Collections.IEnumerator.Current%2A> property of the enumerator object is [ReadOnly](../../../visual-basic/language-reference/modifiers/readonly.md), and it returns a local copy of each collection element.</span></span> <span data-ttu-id="42b77-218">Ciò significa che non è possibile modificare gli elementi in un `For Each`... `Next` ciclo.</span><span class="sxs-lookup"><span data-stu-id="42b77-218">This means that you cannot modify the elements themselves in a `For Each`...`Next` loop.</span></span> <span data-ttu-id="42b77-219">Le eventuali modifiche apportate influenzano solo la copia locale di `Current` e non sono riflesse nella raccolta sottostante.</span><span class="sxs-lookup"><span data-stu-id="42b77-219">Any modification you make affects only the local copy from `Current` and isn't reflected back into the underlying collection.</span></span> <span data-ttu-id="42b77-220">Tuttavia, se un elemento è un tipo riferimento, è possibile modificare i membri dell'istanza a cui fa riferimento.</span><span class="sxs-lookup"><span data-stu-id="42b77-220">However, if an element is a reference type, you can modify the members of the instance to which it points.</span></span> <span data-ttu-id="42b77-221">L'esempio seguente modifica il `BackColor` membro di ogni `thisControl` elemento.</span><span class="sxs-lookup"><span data-stu-id="42b77-221">The following example modifies the `BackColor` member of each `thisControl` element.</span></span> <span data-ttu-id="42b77-222">Tuttavia, non è possibile, modificare `thisControl` stesso.</span><span class="sxs-lookup"><span data-stu-id="42b77-222">You cannot, however, modify `thisControl` itself.</span></span>  
  
```vb  
Sub lightBlueBackground(ByVal thisForm As System.Windows.Forms.Form)  
    For Each thisControl As System.Windows.Forms.Control In thisForm.Controls  
        thisControl.BackColor = System.Drawing.Color.LightBlue  
    Next thisControl  
End Sub  
```  
  
 <span data-ttu-id="42b77-223">Nell'esempio precedente è possibile modificare il `BackColor` membro di ogni `thisControl` elemento, anche se non è possibile modificare `thisControl` stesso.</span><span class="sxs-lookup"><span data-stu-id="42b77-223">The previous example can modify the `BackColor` member of each `thisControl` element, although it cannot modify `thisControl` itself.</span></span>  
  
 <span data-ttu-id="42b77-224">**Attraversamento di matrici.**</span><span class="sxs-lookup"><span data-stu-id="42b77-224">**Traversing Arrays.**</span></span> <span data-ttu-id="42b77-225">Perché il <xref:System.Array> classe implementa il <xref:System.Collections.IEnumerable> tutte le matrici di interfaccia, espongono il <xref:System.Array.GetEnumerator%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="42b77-225">Because the <xref:System.Array> class implements the <xref:System.Collections.IEnumerable> interface, all arrays expose the <xref:System.Array.GetEnumerator%2A> method.</span></span> <span data-ttu-id="42b77-226">Ciò significa che è possibile scorrere una matrice con un `For Each`... `Next` ciclo.</span><span class="sxs-lookup"><span data-stu-id="42b77-226">This means that you can iterate through an array with a `For Each`...`Next` loop.</span></span> <span data-ttu-id="42b77-227">Tuttavia, è possibile leggere solo gli elementi della matrice.</span><span class="sxs-lookup"><span data-stu-id="42b77-227">However, you can only read the array elements.</span></span> <span data-ttu-id="42b77-228">È possibile modificarle.</span><span class="sxs-lookup"><span data-stu-id="42b77-228">You cannot change them.</span></span>  
  
## <a name="example"></a><span data-ttu-id="42b77-229">Esempio</span><span class="sxs-lookup"><span data-stu-id="42b77-229">Example</span></span>  
 <span data-ttu-id="42b77-230">Nell'esempio seguente vengono elencate tutte le cartelle nella directory c:\. utilizzando la <xref:System.IO.DirectoryInfo> classe.</span><span class="sxs-lookup"><span data-stu-id="42b77-230">The following example lists all the folders in the C:\ directory by using the <xref:System.IO.DirectoryInfo> class.</span></span>  
  
 [!code-vb[VbVbalrStatements#124](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_6.vb)]  
  
## <a name="example"></a><span data-ttu-id="42b77-231">Esempio</span><span class="sxs-lookup"><span data-stu-id="42b77-231">Example</span></span>  
 <span data-ttu-id="42b77-232">L'esempio seguente illustra una procedura per ordinare una raccolta.</span><span class="sxs-lookup"><span data-stu-id="42b77-232">The following example illustrates a procedure for sorting a collection.</span></span> <span data-ttu-id="42b77-233">Nell'esempio vengono ordinate le istanze di un `Car` classe archiviati in un <xref:System.Collections.Generic.List%601>.</span><span class="sxs-lookup"><span data-stu-id="42b77-233">The example sorts instances of a `Car` class that are stored in a <xref:System.Collections.Generic.List%601>.</span></span> <span data-ttu-id="42b77-234">La classe `Car` implementa l'interfaccia <xref:System.IComparable%601>, che richiede l'implementazione del metodo <xref:System.IComparable%601.CompareTo%2A>.</span><span class="sxs-lookup"><span data-stu-id="42b77-234">The `Car` class implements the <xref:System.IComparable%601> interface, which requires that the <xref:System.IComparable%601.CompareTo%2A> method be implemented.</span></span>  
  
 <span data-ttu-id="42b77-235">Ogni chiamata al <xref:System.IComparable%601.CompareTo%2A> metodo effettua un unico confronto che viene utilizzato per l'ordinamento.</span><span class="sxs-lookup"><span data-stu-id="42b77-235">Each call to the <xref:System.IComparable%601.CompareTo%2A> method makes a single comparison that's used for sorting.</span></span> <span data-ttu-id="42b77-236">Il codice scritto dall'utente presente nel metodo `CompareTo` restituisce un valore per ogni confronto dell'oggetto corrente con un altro oggetto.</span><span class="sxs-lookup"><span data-stu-id="42b77-236">User-written code in the `CompareTo` method returns a value for each comparison of the current object with another object.</span></span> <span data-ttu-id="42b77-237">Il valore restituito è minore di zero se l'oggetto corrente è inferiore all'altro oggetto, maggiore di zero se l'oggetto corrente è superiore all'altro oggetto e zero se sono uguali.</span><span class="sxs-lookup"><span data-stu-id="42b77-237">The value returned is less than zero if the current object is less than the other object, greater than zero if the current object is greater than the other object, and zero if they are equal.</span></span> <span data-ttu-id="42b77-238">In questo modo è possibile definire nel codice i criteri di maggiore, minore e uguale.</span><span class="sxs-lookup"><span data-stu-id="42b77-238">This enables you to define in code the criteria for greater than, less than, and equal.</span></span>  
  
 <span data-ttu-id="42b77-239">Nel metodo `ListCars` l'istruzione `cars.Sort()` ordina l'elenco.</span><span class="sxs-lookup"><span data-stu-id="42b77-239">In the `ListCars` method, the `cars.Sort()` statement sorts the list.</span></span> <span data-ttu-id="42b77-240">Questa chiamata al metodo <xref:System.Collections.Generic.List%601.Sort%2A> di <xref:System.Collections.Generic.List%601> determina la chiamata automatica al metodo `CompareTo` per gli oggetti `Car` in `List`.</span><span class="sxs-lookup"><span data-stu-id="42b77-240">This call to the <xref:System.Collections.Generic.List%601.Sort%2A> method of the <xref:System.Collections.Generic.List%601> causes the `CompareTo` method to be called automatically for the `Car` objects in the `List`.</span></span>  
  
 [!code-vb[VbVbalrStatements#125](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_7.vb)]  
  
## <a name="see-also"></a><span data-ttu-id="42b77-241">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="42b77-241">See Also</span></span>  
 [<span data-ttu-id="42b77-242">Raccolte</span><span class="sxs-lookup"><span data-stu-id="42b77-242">Collections</span></span>](../../../standard/collections/index.md)  
 [<span data-ttu-id="42b77-243">Istruzione For...Next</span><span class="sxs-lookup"><span data-stu-id="42b77-243">For...Next Statement</span></span>](../../../visual-basic/language-reference/statements/for-next-statement.md)  
 [<span data-ttu-id="42b77-244">Strutture di ciclo</span><span class="sxs-lookup"><span data-stu-id="42b77-244">Loop Structures</span></span>](../../../visual-basic/programming-guide/language-features/control-flow/loop-structures.md)  
 [<span data-ttu-id="42b77-245">Istruzione While...End While</span><span class="sxs-lookup"><span data-stu-id="42b77-245">While...End While Statement</span></span>](../../../visual-basic/language-reference/statements/while-end-while-statement.md)  
 [<span data-ttu-id="42b77-246">Istruzione Do...Loop</span><span class="sxs-lookup"><span data-stu-id="42b77-246">Do...Loop Statement</span></span>](../../../visual-basic/language-reference/statements/do-loop-statement.md)  
 [<span data-ttu-id="42b77-247">Conversioni di ampliamento e restrizione</span><span class="sxs-lookup"><span data-stu-id="42b77-247">Widening and Narrowing Conversions</span></span>](../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)  
 [<span data-ttu-id="42b77-248">Inizializzatori di oggetto: tipi denominati e tipi anonimi</span><span class="sxs-lookup"><span data-stu-id="42b77-248">Object Initializers: Named and Anonymous Types</span></span>](../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md)  
 [<span data-ttu-id="42b77-249">Inizializzatori di raccolta</span><span class="sxs-lookup"><span data-stu-id="42b77-249">Collection Initializers</span></span>](../../../visual-basic/programming-guide/language-features/collection-initializers/index.md)  
 [<span data-ttu-id="42b77-250">Array</span><span class="sxs-lookup"><span data-stu-id="42b77-250">Arrays</span></span>](../../../visual-basic/programming-guide/language-features/arrays/index.md)
