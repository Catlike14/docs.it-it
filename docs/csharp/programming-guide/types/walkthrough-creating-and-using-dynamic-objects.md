---
title: 'Procedura dettagliata: creazione e utilizzo di oggetti dinamici (C# e Visual Basic)'
ms.date: 2015-07-20
ms.prod: .net
ms.technology:
- devlang-csharp
ms.topic: article
dev_langs:
- CSharp
helpviewer_keywords:
- dynamic objects [Visual Basic]
- dynamic objects
- dynamic objects [C#]
ms.assetid: 568f1645-1305-4906-8625-5d77af81e04f
caps.latest.revision: 22
author: BillWagner
ms.author: wiwagn
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
ms.translationtype: HT
ms.sourcegitcommit: d74c1d0760d4e776c2cf4c7dea1dac060c85a83c
ms.openlocfilehash: 19701ede37845249cf4d50a34eb4ab487cdeb76b
ms.contentlocale: it-it
ms.lasthandoff: 09/05/2017

---
# <a name="walkthrough-creating-and-using-dynamic-objects-c-and-visual-basic"></a><span data-ttu-id="501a8-102">Procedura dettagliata: creazione e utilizzo di oggetti dinamici (C# e Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="501a8-102">Walkthrough: Creating and Using Dynamic Objects (C# and Visual Basic)</span></span>
<span data-ttu-id="501a8-103">Gli oggetti dinamici espongono i membri, ad esempio proprietà e metodi, in fase di esecuzione anziché in fase di compilazione.</span><span class="sxs-lookup"><span data-stu-id="501a8-103">Dynamic objects expose members such as properties and methods at run time, instead of in at compile time.</span></span> <span data-ttu-id="501a8-104">In questo modo è possibile creare oggetti da usare con le strutture che non corrispondono a un tipo o formato statico.</span><span class="sxs-lookup"><span data-stu-id="501a8-104">This enables you to create objects to work with structures that do not match a static type or format.</span></span> <span data-ttu-id="501a8-105">Ad esempio, è possibile usare un oggetto dinamico per fare riferimento al modello a oggetti documenti (DOM, Document Object Model) HTML, che può contenere qualsiasi combinazione di attributi ed elementi di markup HTML validi.</span><span class="sxs-lookup"><span data-stu-id="501a8-105">For example, you can use a dynamic object to reference the HTML Document Object Model (DOM), which can contain any combination of valid HTML markup elements and attributes.</span></span> <span data-ttu-id="501a8-106">Poiché ogni documento HTML è univoco, i membri per un particolare documento HTML vengono determinati in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="501a8-106">Because each HTML document is unique, the members for a particular HTML document are determined at run time.</span></span> <span data-ttu-id="501a8-107">Un metodo comune per fare riferimento a un attributo di un elemento HTML consiste nel passare il nome dell'attributo al metodo `GetProperty` dell'elemento.</span><span class="sxs-lookup"><span data-stu-id="501a8-107">A common method to reference an attribute of an HTML element is to pass the name of the attribute to the `GetProperty` method of the element.</span></span> <span data-ttu-id="501a8-108">Per fare riferimento all'attributo `id` dell'elemento HTML `<div id="Div1">`, per prima cosa è necessario ottenere un riferimento all'elemento `<div>` e quindi usare `divElement.GetProperty("id")`.</span><span class="sxs-lookup"><span data-stu-id="501a8-108">To reference the `id` attribute of the HTML element `<div id="Div1">`, you first obtain a reference to the `<div>` element, and then use `divElement.GetProperty("id")`.</span></span> <span data-ttu-id="501a8-109">Se si usa un oggetto dinamico, è possibile fare riferimento all'attributo `id` come `divElement.id`.</span><span class="sxs-lookup"><span data-stu-id="501a8-109">If you use a dynamic object, you can reference the `id` attribute as `divElement.id`.</span></span>  
  
 <span data-ttu-id="501a8-110">Gli oggetti dinamici offrono anche un comodo accesso a linguaggi dinamici come IronPython e IronRuby.</span><span class="sxs-lookup"><span data-stu-id="501a8-110">Dynamic objects also provide convenient access to dynamic languages such as IronPython and IronRuby.</span></span> <span data-ttu-id="501a8-111">È possibile usare un oggetto dinamico per fare riferimento a uno script dinamico che viene interpretato in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="501a8-111">You can use a dynamic object to refer to a dynamic script that is interpreted at run time.</span></span>  
  
 <span data-ttu-id="501a8-112">Si fa riferimento a un oggetto dinamico usando l'associazione tardiva.</span><span class="sxs-lookup"><span data-stu-id="501a8-112">You reference a dynamic object by using late binding.</span></span> <span data-ttu-id="501a8-113">In C# specificare il tipo di un oggetto ad associazione tardiva come `dynamic`.</span><span class="sxs-lookup"><span data-stu-id="501a8-113">In C#, you specify the type of a late-bound object as `dynamic`.</span></span> <span data-ttu-id="501a8-114">In [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] specificare il tipo di un oggetto ad associazione tardiva come `Object`.</span><span class="sxs-lookup"><span data-stu-id="501a8-114">In [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)], you specify the type of a late-bound object as `Object`.</span></span> <span data-ttu-id="501a8-115">Per altre informazioni, vedere [dynamic](../../../csharp/language-reference/keywords/dynamic.md) e [Associazione anticipata e tardiva](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md).</span><span class="sxs-lookup"><span data-stu-id="501a8-115">For more information, see [dynamic](../../../csharp/language-reference/keywords/dynamic.md) and [Early and Late Binding](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md).</span></span>  
  
 <span data-ttu-id="501a8-116">È possibile creare oggetti dinamici personalizzati usando le classi dello spazio dei nomi <xref:System.Dynamic?displayProperty=fullName>.</span><span class="sxs-lookup"><span data-stu-id="501a8-116">You can create custom dynamic objects by using the classes in the <xref:System.Dynamic?displayProperty=fullName> namespace.</span></span> <span data-ttu-id="501a8-117">Ad esempio, è possibile creare un oggetto <xref:System.Dynamic.ExpandoObject> e specificare i membri di tale oggetto in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="501a8-117">For example, you can create an <xref:System.Dynamic.ExpandoObject> and specify the members of that object at run time.</span></span> <span data-ttu-id="501a8-118">È anche possibile creare un proprio tipo che eredita la classe <xref:System.Dynamic.DynamicObject>.</span><span class="sxs-lookup"><span data-stu-id="501a8-118">You can also create your own type that inherits the <xref:System.Dynamic.DynamicObject> class.</span></span> <span data-ttu-id="501a8-119">È quindi possibile eseguire l'override dei membri della classe <xref:System.Dynamic.DynamicObject> per rendere disponibili funzionalità dinamiche in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="501a8-119">You can then override the members of the <xref:System.Dynamic.DynamicObject> class to provide run-time dynamic functionality.</span></span>  
  
 <span data-ttu-id="501a8-120">In questa procedura verranno illustrate le attività seguenti:</span><span class="sxs-lookup"><span data-stu-id="501a8-120">In this walkthrough you will perform the following tasks:</span></span>  
  
-   <span data-ttu-id="501a8-121">Creare un oggetto personalizzato che espone dinamicamente il contenuto di un file di testo come proprietà di un oggetto.</span><span class="sxs-lookup"><span data-stu-id="501a8-121">Create a custom object that dynamically exposes the contents of a text file as properties of an object.</span></span>  
  
-   <span data-ttu-id="501a8-122">Creare un progetto che usa una libreria `IronPython`.</span><span class="sxs-lookup"><span data-stu-id="501a8-122">Create a project that uses an `IronPython` library.</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="501a8-123">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="501a8-123">Prerequisites</span></span>  
 <span data-ttu-id="501a8-124">Per completare questa procedura, è necessario avere IronPython 2.6.1 per .NET 4.0.</span><span class="sxs-lookup"><span data-stu-id="501a8-124">You need IronPython 2.6.1 for .NET 4.0 to complete this walkthrough.</span></span> <span data-ttu-id="501a8-125">È possibile scaricare IronPython 2.6.1 per .NET 4.0 da [CodePlex](http://go.microsoft.com/fwlink/?LinkId=187223).</span><span class="sxs-lookup"><span data-stu-id="501a8-125">You can download IronPython 2.6.1 for .NET 4.0 from [CodePlex](http://go.microsoft.com/fwlink/?LinkId=187223).</span></span>  
  
[!INCLUDE[note_settings_general](~/includes/note-settings-general-md.md)]  
  
## <a name="creating-a-custom-dynamic-object"></a><span data-ttu-id="501a8-126">Creare un oggetto dinamico personalizzato</span><span class="sxs-lookup"><span data-stu-id="501a8-126">Creating a Custom Dynamic Object</span></span>  
 <span data-ttu-id="501a8-127">Il primo progetto creato in questa procedura dettagliata definisce un oggetto dinamico personalizzato che esegue la ricerca del contenuto di un file di testo.</span><span class="sxs-lookup"><span data-stu-id="501a8-127">The first project that you create in this walkthrough defines a custom dynamic object that searches the contents of a text file.</span></span> <span data-ttu-id="501a8-128">Il testo da cercare viene specificato dal nome di una proprietà dinamica.</span><span class="sxs-lookup"><span data-stu-id="501a8-128">Text to search for is specified by the name of a dynamic property.</span></span> <span data-ttu-id="501a8-129">Ad esempio, se il codice chiamante specifica `dynamicFile.Sample`, la classe dinamica restituisce un elenco generico di stringhe che contiene tutte le righe del file che iniziano con "Sample".</span><span class="sxs-lookup"><span data-stu-id="501a8-129">For example, if calling code specifies `dynamicFile.Sample`, the dynamic class returns a generic list of strings that contains all of the lines from the file that begin with "Sample".</span></span> <span data-ttu-id="501a8-130">La ricerca non fa distinzione tra maiuscole e minuscole.</span><span class="sxs-lookup"><span data-stu-id="501a8-130">The search is case-insensitive.</span></span> <span data-ttu-id="501a8-131">La classe dinamica supporta inoltre due argomenti facoltativi.</span><span class="sxs-lookup"><span data-stu-id="501a8-131">The dynamic class also supports two optional arguments.</span></span> <span data-ttu-id="501a8-132">Il primo argomento è un valore di enumerazione dell'opzione di ricerca che indica che la classe dinamica deve cercare le corrispondenze all'inizio della riga, alla fine della riga o in un punto qualsiasi nella riga.</span><span class="sxs-lookup"><span data-stu-id="501a8-132">The first argument is a search option enum value that specifies that the dynamic class should search for matches at the start of the line, the end of the line, or anywhere in the line.</span></span> <span data-ttu-id="501a8-133">Il secondo argomento specifica che la classe dinamica deve eliminare gli spazi iniziali e finali da ogni riga prima di eseguire la ricerca.</span><span class="sxs-lookup"><span data-stu-id="501a8-133">The second argument specifies that the dynamic class should trim leading and trailing spaces from each line before searching.</span></span> <span data-ttu-id="501a8-134">Ad esempio, se il codice chiamante specifica `dynamicFile.Sample(StringSearchOption.Contains)`, la classe dinamica cerca "Sample" in qualsiasi punto di una riga.</span><span class="sxs-lookup"><span data-stu-id="501a8-134">For example, if calling code specifies `dynamicFile.Sample(StringSearchOption.Contains)`, the dynamic class searches for "Sample" anywhere in a line.</span></span> <span data-ttu-id="501a8-135">Se il codice chiamante specifica `dynamicFile.Sample(StringSearchOption.StartsWith, false)`, la classe dinamica cerca "Sample" all'inizio di ogni riga e non rimuove gli spazi iniziali e finali.</span><span class="sxs-lookup"><span data-stu-id="501a8-135">If calling code specifies `dynamicFile.Sample(StringSearchOption.StartsWith, false)`, the dynamic class searches for "Sample" at the start of each line, and does not remove leading and trailing spaces.</span></span> <span data-ttu-id="501a8-136">Il comportamento predefinito della classe dinamica è cercare una corrispondenza all'inizio di ogni riga e rimuovere gli spazi iniziali e finali.</span><span class="sxs-lookup"><span data-stu-id="501a8-136">The default behavior of the dynamic class is to search for a match at the start of each line and to remove leading and trailing spaces.</span></span>  
  
#### <a name="to-create-a-custom-dynamic-class"></a><span data-ttu-id="501a8-137">Per creare una classe dinamica personalizzata</span><span class="sxs-lookup"><span data-stu-id="501a8-137">To create a custom dynamic class</span></span>  
  
1.  <span data-ttu-id="501a8-138">Avviare [!INCLUDE[vsprvs](~/includes/vsprvs-md.md)].</span><span class="sxs-lookup"><span data-stu-id="501a8-138">Start [!INCLUDE[vsprvs](~/includes/vsprvs-md.md)].</span></span>  
  
2.  <span data-ttu-id="501a8-139">Scegliere **Nuovo** dal menu **File** , quindi scegliere **Progetto**.</span><span class="sxs-lookup"><span data-stu-id="501a8-139">On the **File** menu, point to **New** and then click **Project**.</span></span>  
  
3.  <span data-ttu-id="501a8-140">Nel riquadro **Tipi di progetto** della finestra di dialogo **Nuovo progetto** verificare che sia selezionata l'opzione **Windows**.</span><span class="sxs-lookup"><span data-stu-id="501a8-140">In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected.</span></span> <span data-ttu-id="501a8-141">Selezionare **Applicazione console** nel riquadro **Modelli**.</span><span class="sxs-lookup"><span data-stu-id="501a8-141">Select **Console Application** in the **Templates** pane.</span></span> <span data-ttu-id="501a8-142">Nella casella **Nome** digitare `DynamicSample` e quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="501a8-142">In the **Name** box, type `DynamicSample`, and then click **OK**.</span></span> <span data-ttu-id="501a8-143">Il nuovo progetto viene creato.</span><span class="sxs-lookup"><span data-stu-id="501a8-143">The new project is created.</span></span>  
  
4.  <span data-ttu-id="501a8-144">Fare clic con il pulsante destro del mouse sul progetto DynamicSample e scegliere **Aggiungi**, quindi fare clic su **Classe**.</span><span class="sxs-lookup"><span data-stu-id="501a8-144">Right-click the DynamicSample project and point to **Add**, and then click **Class**.</span></span> <span data-ttu-id="501a8-145">Nella casella **Nome** digitare `ReadOnlyFile`, quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="501a8-145">In the **Name** box, type `ReadOnlyFile`, and then click **OK**.</span></span> <span data-ttu-id="501a8-146">Viene aggiunto un nuovo file che contiene la classe ReadOnlyFile.</span><span class="sxs-lookup"><span data-stu-id="501a8-146">A new file is added that contains the ReadOnlyFile class.</span></span>  
  
5.  <span data-ttu-id="501a8-147">Nella parte superiore del file ReadOnlyFile.cs o ReadOnlyFile.vb aggiungere il codice seguente per importare gli spazi dei nomi <xref:System.IO?displayProperty=fullName> e <xref:System.Dynamic?displayProperty=fullName>.</span><span class="sxs-lookup"><span data-stu-id="501a8-147">At the top of the ReadOnlyFile.cs or ReadOnlyFile.vb file, add the following code to import the <xref:System.IO?displayProperty=fullName> and <xref:System.Dynamic?displayProperty=fullName> namespaces.</span></span>  
  
     <span data-ttu-id="501a8-148">[!code-cs[VbDynamicWalkthrough#1](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_1.cs)]</span><span class="sxs-lookup"><span data-stu-id="501a8-148">[!code-cs[VbDynamicWalkthrough#1](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_1.cs)]</span></span>

     <span data-ttu-id="501a8-149">[!code-vb[VbDynamicWalkthrough#1](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_1.vb)]</span><span class="sxs-lookup"><span data-stu-id="501a8-149">[!code-vb[VbDynamicWalkthrough#1](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_1.vb)]</span></span>  
  
6.  <span data-ttu-id="501a8-150">L'oggetto dinamico personalizzato usa un'enumerazione per determinare i criteri di ricerca.</span><span class="sxs-lookup"><span data-stu-id="501a8-150">The custom dynamic object uses an enum to determine the search criteria.</span></span> <span data-ttu-id="501a8-151">Prima dell'istruzione di classe, aggiungere la seguente definizione di enumerazione.</span><span class="sxs-lookup"><span data-stu-id="501a8-151">Before the class statement, add the following enum definition.</span></span>  
  
     <span data-ttu-id="501a8-152">[!code-cs[VbDynamicWalkthrough#2](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_2.cs)]</span><span class="sxs-lookup"><span data-stu-id="501a8-152">[!code-cs[VbDynamicWalkthrough#2](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_2.cs)]</span></span>

     <span data-ttu-id="501a8-153">[!code-vb[VbDynamicWalkthrough#2](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_2.vb)]</span><span class="sxs-lookup"><span data-stu-id="501a8-153">[!code-vb[VbDynamicWalkthrough#2](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_2.vb)]</span></span>  
  
7.  <span data-ttu-id="501a8-154">Aggiornare la dichiarazione di classe per ereditare la classe `DynamicObject`, come illustrato nell'esempio di codice seguente.</span><span class="sxs-lookup"><span data-stu-id="501a8-154">Update the class statement to inherit the `DynamicObject` class, as shown in the following code example.</span></span>  
  
     <span data-ttu-id="501a8-155">[!code-cs[VbDynamicWalkthrough#3](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_3.cs)]</span><span class="sxs-lookup"><span data-stu-id="501a8-155">[!code-cs[VbDynamicWalkthrough#3](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_3.cs)]</span></span>

     <span data-ttu-id="501a8-156">[!code-vb[VbDynamicWalkthrough#3](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_3.vb)]</span><span class="sxs-lookup"><span data-stu-id="501a8-156">[!code-vb[VbDynamicWalkthrough#3](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_3.vb)]</span></span>  
  
8.  <span data-ttu-id="501a8-157">Aggiungere il codice seguente alla classe `ReadOnlyFile` per definire un campo privato per il percorso del file e un costruttore per la classe `ReadOnlyFile`.</span><span class="sxs-lookup"><span data-stu-id="501a8-157">Add the following code to the `ReadOnlyFile` class to define a private field for the file path and a constructor for the `ReadOnlyFile` class.</span></span>  
  
     <span data-ttu-id="501a8-158">[!code-cs[VbDynamicWalkthrough#4](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_4.cs)]</span><span class="sxs-lookup"><span data-stu-id="501a8-158">[!code-cs[VbDynamicWalkthrough#4](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_4.cs)]</span></span>
     
     <span data-ttu-id="501a8-159">[!code-vb[VbDynamicWalkthrough#4](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_4.vb)]</span><span class="sxs-lookup"><span data-stu-id="501a8-159">[!code-vb[VbDynamicWalkthrough#4](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_4.vb)]</span></span>  
  
9. <span data-ttu-id="501a8-160">Aggiungere il metodo `GetPropertyValue` seguente alla classe `ReadOnlyFile`.</span><span class="sxs-lookup"><span data-stu-id="501a8-160">Add the following `GetPropertyValue` method to the `ReadOnlyFile` class.</span></span> <span data-ttu-id="501a8-161">Il metodo `GetPropertyValue` accetta come input i criteri di ricerca e restituisce le righe di un file di testo che soddisfano tali criteri di ricerca.</span><span class="sxs-lookup"><span data-stu-id="501a8-161">The `GetPropertyValue` method takes, as input, search criteria and returns the lines from a text file that match that search criteria.</span></span> <span data-ttu-id="501a8-162">I metodi dinamici specificati dalla classe `ReadOnlyFile` chiamano il metodo `GetPropertyValue` per recuperare i rispettivi risultati.</span><span class="sxs-lookup"><span data-stu-id="501a8-162">The dynamic methods provided by the `ReadOnlyFile` class call the `GetPropertyValue` method to retrieve their respective results.</span></span>  
  
     <span data-ttu-id="501a8-163">[!code-cs[VbDynamicWalkthrough#5](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_5.cs)]</span><span class="sxs-lookup"><span data-stu-id="501a8-163">[!code-cs[VbDynamicWalkthrough#5](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_5.cs)]</span></span>
     
     <span data-ttu-id="501a8-164">[!code-vb[VbDynamicWalkthrough#5](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_5.vb)]</span><span class="sxs-lookup"><span data-stu-id="501a8-164">[!code-vb[VbDynamicWalkthrough#5](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_5.vb)]</span></span>  
  
10. <span data-ttu-id="501a8-165">Dopo il metodo `GetPropertyValue` aggiungere il codice seguente per eseguire l'override del metodo <xref:System.Dynamic.DynamicObject.TryGetMember%2A> della classe <xref:System.Dynamic.DynamicObject>.</span><span class="sxs-lookup"><span data-stu-id="501a8-165">After the `GetPropertyValue` method, add the following code to override the <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method of the <xref:System.Dynamic.DynamicObject> class.</span></span> <span data-ttu-id="501a8-166">Il metodo <xref:System.Dynamic.DynamicObject.TryGetMember%2A> viene chiamato quando viene richiesto un membro di una classe dinamica e non vengono specificati argomenti.</span><span class="sxs-lookup"><span data-stu-id="501a8-166">The <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method is called when a member of a dynamic class is requested and no arguments are specified.</span></span> <span data-ttu-id="501a8-167">L'argomento `binder` contiene informazioni relative al membro a cui viene fatto riferimento e l'argomento `result` fa riferimento al risultato restituito per il membro specificato.</span><span class="sxs-lookup"><span data-stu-id="501a8-167">The `binder` argument contains information about the referenced member, and the `result` argument references the result returned for the specified member.</span></span> <span data-ttu-id="501a8-168">Il metodo <xref:System.Dynamic.DynamicObject.TryGetMember%2A> restituisce un valore booleano che restituisce `true` se il membro richiesto esiste, altrimenti restituisce `false`.</span><span class="sxs-lookup"><span data-stu-id="501a8-168">The <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method returns a Boolean value that returns `true` if the requested member exists; otherwise it returns `false`.</span></span>  
  
     <span data-ttu-id="501a8-169">[!code-cs[VbDynamicWalkthrough#6](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_6.cs)]</span><span class="sxs-lookup"><span data-stu-id="501a8-169">[!code-cs[VbDynamicWalkthrough#6](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_6.cs)]</span></span>
     
     <span data-ttu-id="501a8-170">[!code-vb[VbDynamicWalkthrough#6](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_6.vb)]</span><span class="sxs-lookup"><span data-stu-id="501a8-170">[!code-vb[VbDynamicWalkthrough#6](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_6.vb)]</span></span>  
  
11. <span data-ttu-id="501a8-171">Dopo il metodo `TryGetMember` aggiungere il codice seguente per eseguire l'override del metodo <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> della classe <xref:System.Dynamic.DynamicObject>.</span><span class="sxs-lookup"><span data-stu-id="501a8-171">After the `TryGetMember` method, add the following code to override the <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method of the <xref:System.Dynamic.DynamicObject> class.</span></span> <span data-ttu-id="501a8-172">Il metodo <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> viene chiamato quando viene richiesto un membro di una classe dinamica con argomenti.</span><span class="sxs-lookup"><span data-stu-id="501a8-172">The <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method is called when a member of a dynamic class is requested with arguments.</span></span> <span data-ttu-id="501a8-173">L'argomento `binder` contiene informazioni relative al membro a cui viene fatto riferimento e l'argomento `result` fa riferimento al risultato restituito per il membro specificato.</span><span class="sxs-lookup"><span data-stu-id="501a8-173">The `binder` argument contains information about the referenced member, and the `result` argument references the result returned for the specified member.</span></span> <span data-ttu-id="501a8-174">L'argomento `args` contiene una matrice degli argomenti passati al membro.</span><span class="sxs-lookup"><span data-stu-id="501a8-174">The `args` argument contains an array of the arguments that are passed to the member.</span></span> <span data-ttu-id="501a8-175">Il metodo <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> restituisce un valore booleano che restituisce `true` se il membro richiesto esiste, altrimenti restituisce `false`.</span><span class="sxs-lookup"><span data-stu-id="501a8-175">The <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method returns a Boolean value that returns `true` if the requested member exists; otherwise it returns `false`.</span></span>  
  
     <span data-ttu-id="501a8-176">La versione personalizzata del metodo `TryInvokeMember` prevede che il primo argomento sia un valore dell'enumerazione `StringSearchOption` definita in un passaggio precedente.</span><span class="sxs-lookup"><span data-stu-id="501a8-176">The custom version of the `TryInvokeMember` method expects the first argument to be a value from the `StringSearchOption` enum that you defined in a previous step.</span></span> <span data-ttu-id="501a8-177">Il metodo `TryInvokeMember` prevede che il secondo argomento sia un valore booleano.</span><span class="sxs-lookup"><span data-stu-id="501a8-177">The `TryInvokeMember` method expects the second argument to be a Boolean value.</span></span> <span data-ttu-id="501a8-178">Se uno o entrambi gli argomenti sono valori validi, vengono passati al metodo `GetPropertyValue` per recuperare i risultati.</span><span class="sxs-lookup"><span data-stu-id="501a8-178">If one or both arguments are valid values, they are passed to the `GetPropertyValue` method to retrieve the results.</span></span>  
  
     <span data-ttu-id="501a8-179">[!code-cs[VbDynamicWalkthrough#7](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_7.cs)]</span><span class="sxs-lookup"><span data-stu-id="501a8-179">[!code-cs[VbDynamicWalkthrough#7](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_7.cs)]</span></span>
     
     <span data-ttu-id="501a8-180">[!code-vb[VbDynamicWalkthrough#7](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_7.vb)]</span><span class="sxs-lookup"><span data-stu-id="501a8-180">[!code-vb[VbDynamicWalkthrough#7](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_7.vb)]</span></span>  
  
12. <span data-ttu-id="501a8-181">Salvare e chiudere il file.</span><span class="sxs-lookup"><span data-stu-id="501a8-181">Save and close the file.</span></span>  
  
#### <a name="to-create-a-sample-text-file"></a><span data-ttu-id="501a8-182">Per creare un file di testo di esempio</span><span class="sxs-lookup"><span data-stu-id="501a8-182">To create a sample text file</span></span>  
  
1.  <span data-ttu-id="501a8-183">Fare clic con il pulsante destro del mouse sul progetto DynamicSample e scegliere **Aggiungi**, quindi fare clic su **Nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="501a8-183">Right-click the DynamicSample project and point to **Add**, and then click **New Item**.</span></span> <span data-ttu-id="501a8-184">Nel riquadro **Modelli installati** selezionare **Generale**, quindi il modello **File di testo**.</span><span class="sxs-lookup"><span data-stu-id="501a8-184">In the **Installed Templates** pane, select **General**, and then select the **Text File** template.</span></span> <span data-ttu-id="501a8-185">Lasciare il nome predefinito TextFile1.txt nella casella **Nome** e quindi fare clic su **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="501a8-185">Leave the default name of TextFile1.txt in the **Name** box, and then click **Add**.</span></span> <span data-ttu-id="501a8-186">Un nuovo file di testo viene aggiunto al progetto.</span><span class="sxs-lookup"><span data-stu-id="501a8-186">A new text file is added to the project.</span></span>  
  
2.  <span data-ttu-id="501a8-187">Copiare il testo seguente nel file TextFile1.txt.</span><span class="sxs-lookup"><span data-stu-id="501a8-187">Copy the following text to the TextFile1.txt file.</span></span>  
  
    ```  
    List of customers and suppliers  
  
    Supplier: Lucerne Publishing (http://www.lucernepublishing.com/)  
    Customer: Preston, Chris  
    Customer: Hines, Patrick  
    Customer: Cameron, Maria  
    Supplier: Graphic Design Institute (http://www.graphicdesigninstitute.com/)   
    Supplier: Fabrikam, Inc. (http://www.fabrikam.com/)   
    Customer: Seubert, Roxanne  
    Supplier: Proseware, Inc. (http://www.proseware.com/)   
    Customer: Adolphi, Stephan  
    Customer: Koch, Paul  
    ```  
  
3.  <span data-ttu-id="501a8-188">Salvare e chiudere il file.</span><span class="sxs-lookup"><span data-stu-id="501a8-188">Save and close the file.</span></span>  
  
#### <a name="to-create-a-sample-application-that-uses-the-custom-dynamic-object"></a><span data-ttu-id="501a8-189">Per creare un'applicazione di esempio che usa l'oggetto dinamico personalizzato</span><span class="sxs-lookup"><span data-stu-id="501a8-189">To create a sample application that uses the custom dynamic object</span></span>  
  
1.  <span data-ttu-id="501a8-190">In **Esplora Soluzioni** fare doppio clic sul file Module1.vb se si usa [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] o sul file Program.cs se si usa Visual C#.</span><span class="sxs-lookup"><span data-stu-id="501a8-190">In **Solution Explorer**, double-click the Module1.vb file if you are using [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] or the Program.cs file if you are using Visual C#.</span></span>  
  
2.  <span data-ttu-id="501a8-191">Aggiungere il seguente codice alla routine Main per creare un'istanza della classe `ReadOnlyFile` per il file TextFile1.txt.</span><span class="sxs-lookup"><span data-stu-id="501a8-191">Add the following code to the Main procedure to create an instance of the `ReadOnlyFile` class for the TextFile1.txt file.</span></span> <span data-ttu-id="501a8-192">Il codice usa l'associazione tardiva per chiamare i membri dinamici e recuperare le righe di testo che contengono la stringa "Customer".</span><span class="sxs-lookup"><span data-stu-id="501a8-192">The code uses late binding to call dynamic members and retrieve lines of text that contain the string "Customer".</span></span>  
  
     <span data-ttu-id="501a8-193">[!code-cs[VbDynamicWalkthrough#8](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_8.cs)]</span><span class="sxs-lookup"><span data-stu-id="501a8-193">[!code-cs[VbDynamicWalkthrough#8](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_8.cs)]</span></span>
     
     <span data-ttu-id="501a8-194">[!code-vb[VbDynamicWalkthrough#8](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_8.vb)]</span><span class="sxs-lookup"><span data-stu-id="501a8-194">[!code-vb[VbDynamicWalkthrough#8](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_8.vb)]</span></span>  
  
3.  <span data-ttu-id="501a8-195">Salvare il file e premere CTRL+F5 per compilare ed eseguire l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="501a8-195">Save the file and press CTRL+F5 to build and run the application.</span></span>  
  
## <a name="calling-a-dynamic-language-library"></a><span data-ttu-id="501a8-196">Chiamare una libreria di linguaggio dinamico</span><span class="sxs-lookup"><span data-stu-id="501a8-196">Calling a Dynamic Language Library</span></span>  
 <span data-ttu-id="501a8-197">Il progetto successivo di questa procedura dettagliata accede a una libreria scritta nel linguaggio dinamico IronPython.</span><span class="sxs-lookup"><span data-stu-id="501a8-197">The next project that you create in this walkthrough accesses a library that is written in the dynamic language IronPython.</span></span> <span data-ttu-id="501a8-198">Prima di creare il progetto, è necessario installare IronPython 2.6.1 per .NET 4.0.</span><span class="sxs-lookup"><span data-stu-id="501a8-198">Before you create this project, you must have IronPython 2.6.1 for .NET 4.0 installed.</span></span> <span data-ttu-id="501a8-199">È possibile scaricare IronPython 2.6.1 per .NET 4.0 da [CodePlex](http://go.microsoft.com/fwlink/?LinkId=187223).</span><span class="sxs-lookup"><span data-stu-id="501a8-199">You can download IronPython 2.6.1 for .NET 4.0 from [CodePlex](http://go.microsoft.com/fwlink/?LinkId=187223).</span></span>  
  
#### <a name="to-create-a-custom-dynamic-class"></a><span data-ttu-id="501a8-200">Per creare una classe dinamica personalizzata</span><span class="sxs-lookup"><span data-stu-id="501a8-200">To create a custom dynamic class</span></span>  
  
1.  <span data-ttu-id="501a8-201">In [!INCLUDE[vsprvs](~/includes/vsprvs-md.md)] scegliere **Nuovo** dal menu **File** e quindi fare clic su **Progetto**.</span><span class="sxs-lookup"><span data-stu-id="501a8-201">In [!INCLUDE[vsprvs](~/includes/vsprvs-md.md)], on the **File** menu, point to **New** and then click **Project**.</span></span>  
  
2.  <span data-ttu-id="501a8-202">Nel riquadro **Tipi di progetto** della finestra di dialogo **Nuovo progetto** verificare che sia selezionata l'opzione **Windows**.</span><span class="sxs-lookup"><span data-stu-id="501a8-202">In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected.</span></span> <span data-ttu-id="501a8-203">Selezionare **Applicazione console** nel riquadro **Modelli**.</span><span class="sxs-lookup"><span data-stu-id="501a8-203">Select **Console Application** in the **Templates** pane.</span></span> <span data-ttu-id="501a8-204">Nella casella **Nome** digitare `DynamicIronPythonSample` e quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="501a8-204">In the **Name** box, type `DynamicIronPythonSample`, and then click **OK**.</span></span> <span data-ttu-id="501a8-205">Il nuovo progetto viene creato.</span><span class="sxs-lookup"><span data-stu-id="501a8-205">The new project is created.</span></span>  
  
3.  <span data-ttu-id="501a8-206">Se si usa [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)], fare clic con il pulsante destro del mouse sul progetto DynamicIronPythonSample e quindi fare clic su **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="501a8-206">If you are using [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)], right-click the DynamicIronPythonSample project and then click **Properties**.</span></span> <span data-ttu-id="501a8-207">Fare clic sulla scheda **Riferimenti**. Fare clic sul pulsante **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="501a8-207">Click the **References** tab. Click the **Add** button.</span></span> <span data-ttu-id="501a8-208">Se si usa Visual C#, in **Esplora soluzioni** fare clic con il pulsante destro del mouse sulla cartella **Riferimenti** e quindi fare clic su **Aggiungi riferimento**.</span><span class="sxs-lookup"><span data-stu-id="501a8-208">If you are using Visual C#, in **Solution Explorer**, right-click the **References** folder and then click **Add Reference**.</span></span>  
  
4.  <span data-ttu-id="501a8-209">Nella scheda **Sfoglia** passare alla cartella in cui sono installate le librerie di IronPython.</span><span class="sxs-lookup"><span data-stu-id="501a8-209">On the **Browse** tab, browse to the folder where the IronPython libraries are installed.</span></span> <span data-ttu-id="501a8-210">Ad esempio, C:\Programmi\IronPython 2.6 for .NET 4.0.</span><span class="sxs-lookup"><span data-stu-id="501a8-210">For example, C:\Program Files\IronPython 2.6 for .NET 4.0.</span></span> <span data-ttu-id="501a8-211">Selezionare le librerie **IronPython.dll**, **IronPython.Modules.dll**, **Microsoft.Scripting.dll** e **Microsoft.Dynamic.dll**.</span><span class="sxs-lookup"><span data-stu-id="501a8-211">Select the **IronPython.dll**, **IronPython.Modules.dll**, **Microsoft.Scripting.dll**, and **Microsoft.Dynamic.dll** libraries.</span></span> <span data-ttu-id="501a8-212">Fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="501a8-212">Click **OK**.</span></span>  
  
5.  <span data-ttu-id="501a8-213">Se si usa [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)], modificare il file Module1.vb.</span><span class="sxs-lookup"><span data-stu-id="501a8-213">If you are using [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)], edit the Module1.vb file.</span></span> <span data-ttu-id="501a8-214">Se si usa Visual C#, modificare il file Program.cs.</span><span class="sxs-lookup"><span data-stu-id="501a8-214">If you are using Visual C#, edit the Program.cs file.</span></span>  
  
6.  <span data-ttu-id="501a8-215">Nella parte superiore del file aggiungere il codice seguente per importare gli spazi dei nomi `Microsoft.Scripting.Hosting` e `IronPython.Hosting` dalle librerie di IronPython.</span><span class="sxs-lookup"><span data-stu-id="501a8-215">At the top of the file, add the following code to import the `Microsoft.Scripting.Hosting` and `IronPython.Hosting` namespaces from the IronPython libraries.</span></span>  
  
     <span data-ttu-id="501a8-216">[!code-cs[VbDynamicWalkthroughIronPython#1](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_9.cs)]</span><span class="sxs-lookup"><span data-stu-id="501a8-216">[!code-cs[VbDynamicWalkthroughIronPython#1](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_9.cs)]</span></span>
     
     <span data-ttu-id="501a8-217">[!code-vb[VbDynamicWalkthroughIronPython#1](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_9.vb)]</span><span class="sxs-lookup"><span data-stu-id="501a8-217">[!code-vb[VbDynamicWalkthroughIronPython#1](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_9.vb)]</span></span>  
  
7.  <span data-ttu-id="501a8-218">Nel metodo Main aggiungere il codice seguente per creare un nuovo oggetto `Microsoft.Scripting.Hosting.ScriptRuntime` per ospitare le librerie di IronPython.</span><span class="sxs-lookup"><span data-stu-id="501a8-218">In the Main method, add the following code to create a new `Microsoft.Scripting.Hosting.ScriptRuntime` object to host the IronPython libraries.</span></span> <span data-ttu-id="501a8-219">L'oggetto `ScriptRuntime` carica il modulo di libreria random.py di IronPython.</span><span class="sxs-lookup"><span data-stu-id="501a8-219">The `ScriptRuntime` object loads the IronPython library module random.py.</span></span>  
  
     <span data-ttu-id="501a8-220">[!code-cs[VbDynamicWalkthroughIronPython#2](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_10.cs)]</span><span class="sxs-lookup"><span data-stu-id="501a8-220">[!code-cs[VbDynamicWalkthroughIronPython#2](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_10.cs)]</span></span>
     
     <span data-ttu-id="501a8-221">[!code-vb[VbDynamicWalkthroughIronPython#2](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_10.vb)]</span><span class="sxs-lookup"><span data-stu-id="501a8-221">[!code-vb[VbDynamicWalkthroughIronPython#2](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_10.vb)]</span></span>  
  
8.  <span data-ttu-id="501a8-222">Dopo il codice che carica il modulo random.py, aggiungere il codice seguente per creare una matrice di numeri interi.</span><span class="sxs-lookup"><span data-stu-id="501a8-222">After the code to load the random.py module, add the following code to create an array of integers.</span></span> <span data-ttu-id="501a8-223">La matrice viene passata al metodo `shuffle` del modulo random.py, che ordina i valori nella matrice in modo casuale.</span><span class="sxs-lookup"><span data-stu-id="501a8-223">The array is passed to the `shuffle` method of the random.py module, which randomly sorts the values in the array.</span></span>  
  
     <span data-ttu-id="501a8-224">[!code-cs[VbDynamicWalkthroughIronPython#3](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_11.cs)]</span><span class="sxs-lookup"><span data-stu-id="501a8-224">[!code-cs[VbDynamicWalkthroughIronPython#3](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_11.cs)]</span></span>
     
     <span data-ttu-id="501a8-225">[!code-vb[VbDynamicWalkthroughIronPython#3](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_11.vb)]</span><span class="sxs-lookup"><span data-stu-id="501a8-225">[!code-vb[VbDynamicWalkthroughIronPython#3](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_11.vb)]</span></span>  
  
9. <span data-ttu-id="501a8-226">Salvare il file e premere CTRL+F5 per compilare ed eseguire l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="501a8-226">Save the file and press CTRL+F5 to build and run the application.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="501a8-227">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="501a8-227">See Also</span></span>  
 <span data-ttu-id="501a8-228"><xref:System.Dynamic?displayProperty=fullName></span><span class="sxs-lookup"><span data-stu-id="501a8-228"><xref:System.Dynamic?displayProperty=fullName></span></span>   
 <span data-ttu-id="501a8-229"><xref:System.Dynamic.DynamicObject?displayProperty=fullName></span><span class="sxs-lookup"><span data-stu-id="501a8-229"><xref:System.Dynamic.DynamicObject?displayProperty=fullName></span></span>   
 <span data-ttu-id="501a8-230">[Uso del tipo dinamico](../../../csharp/programming-guide/types/using-type-dynamic.md) </span><span class="sxs-lookup"><span data-stu-id="501a8-230">[Using Type dynamic](../../../csharp/programming-guide/types/using-type-dynamic.md) </span></span>  
 <span data-ttu-id="501a8-231">[Associazione anticipata e tardiva](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md) </span><span class="sxs-lookup"><span data-stu-id="501a8-231">[Early and Late Binding](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md) </span></span>  
 <span data-ttu-id="501a8-232">[dynamic](../../../csharp/language-reference/keywords/dynamic.md) </span><span class="sxs-lookup"><span data-stu-id="501a8-232">[dynamic](../../../csharp/language-reference/keywords/dynamic.md) </span></span>  
 [<span data-ttu-id="501a8-233">Implementazione delle interfacce dinamiche (blog esterno)</span><span class="sxs-lookup"><span data-stu-id="501a8-233">Implementing Dynamic Interfaces (external blog)</span></span>](http://go.microsoft.com/fwlink/?LinkId=230895)

