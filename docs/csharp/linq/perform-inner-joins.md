---
title: Eseguire inner join
description: Come eseguire degli inner join.
keywords: .NET, .NET Core, C#
author: BillWagner
manager: wpickett
ms.author: wiwagn
ms.date: 12/1/2016
ms.topic: article
ms.prod: .net-core
ms.technology: .net-core-technologies
ms.devlang: dotnet
ms.assetid: 45bceed6-f549-4114-a9b1-b44feb497742
ms.translationtype: HT
ms.sourcegitcommit: 306c608dc7f97594ef6f72ae0f5aaba596c936e1
ms.openlocfilehash: 2b73b954dbb090484a320302a3af72509fccd9d3
ms.contentlocale: it-it
ms.lasthandoff: 07/28/2017

---
# <a name="perform-inner-joins"></a><span data-ttu-id="07f34-104">Eseguire inner join</span><span class="sxs-lookup"><span data-stu-id="07f34-104">Perform inner joins</span></span>

<span data-ttu-id="07f34-105">In termini di database relazionale, un *inner join* produce un set di risultati in cui ogni elemento della prima raccolta viene visualizzato una volta per ogni elemento corrispondente nella seconda raccolta.</span><span class="sxs-lookup"><span data-stu-id="07f34-105">In relational database terms, an *inner join* produces a result set in which each element of the first collection appears one time for every matching element in the second collection.</span></span> <span data-ttu-id="07f34-106">Se un elemento nella prima raccolta non ha corrispondenti, non viene visualizzato nel set di risultati.</span><span class="sxs-lookup"><span data-stu-id="07f34-106">If an element in the first collection has no matching elements, it does not appear in the result set.</span></span> <span data-ttu-id="07f34-107">Il metodo <xref:System.Linq.Enumerable.Join%2A>, chiamato dalla clausola `join` in C#, implementa un inner join.</span><span class="sxs-lookup"><span data-stu-id="07f34-107">The <xref:System.Linq.Enumerable.Join%2A> method, which is called by the `join` clause in C#, implements an inner join.</span></span>  
  
 <span data-ttu-id="07f34-108">In questo argomento viene illustrato come eseguire quattro varianti di un inner join:</span><span class="sxs-lookup"><span data-stu-id="07f34-108">This topic shows you how to perform four variations of an inner join:</span></span>  
  
-   <span data-ttu-id="07f34-109">Un inner join semplice che correla gli elementi di due origini dati in base a una chiave semplice.</span><span class="sxs-lookup"><span data-stu-id="07f34-109">A simple inner join that correlates elements from two data sources based on a simple key.</span></span>  
  
-   <span data-ttu-id="07f34-110">Un inner join che correla gli elementi di due origini dati in base a una chiave *composta*.</span><span class="sxs-lookup"><span data-stu-id="07f34-110">An inner join that correlates elements from two data sources based on a *composite* key.</span></span> <span data-ttu-id="07f34-111">Una chiave composta, che è una chiave costituita da più di un valore, consente di correlare gli elementi in base a più di una proprietà.</span><span class="sxs-lookup"><span data-stu-id="07f34-111">A composite key, which is a key that consists of more than one value, enables you to correlate elements based on more than one property.</span></span>  
  
-   <span data-ttu-id="07f34-112">Un *join multiplo* in cui le operazioni di join successive vengono aggiunte l'una all'altra.</span><span class="sxs-lookup"><span data-stu-id="07f34-112">A *multiple join* in which successive join operations are appended to each other.</span></span>  
  
-   <span data-ttu-id="07f34-113">Un inner join che viene implementato usando un group join.</span><span class="sxs-lookup"><span data-stu-id="07f34-113">An inner join that is implemented by using a group join.</span></span>  
  
## <a name="example"></a><span data-ttu-id="07f34-114">Esempio</span><span class="sxs-lookup"><span data-stu-id="07f34-114">Example</span></span>  
  
## <a name="simple-key-join-example"></a><span data-ttu-id="07f34-115">Esempio di join con chiave semplice</span><span class="sxs-lookup"><span data-stu-id="07f34-115">Simple key join example</span></span>  
 <span data-ttu-id="07f34-116">Nell'esempio seguente vengono create due raccolte che contengono oggetti di due tipi definiti dall'utente, `Person` e `Pet`.</span><span class="sxs-lookup"><span data-stu-id="07f34-116">The following example creates two collections that contain objects of two user-defined types, `Person` and `Pet`.</span></span> <span data-ttu-id="07f34-117">La query usa la clausola `join` in C# per la corrispondenza degli oggetti `Person` con gli oggetti `Pet` per il cui il valore di `Owner` è `Person`.</span><span class="sxs-lookup"><span data-stu-id="07f34-117">The query uses the `join` clause in C# to match `Person` objects with `Pet` objects whose `Owner` is that `Person`.</span></span> <span data-ttu-id="07f34-118">La clausola `select` in C# definisce l'aspetto degli oggetti risultanti.</span><span class="sxs-lookup"><span data-stu-id="07f34-118">The `select` clause in C# defines how the resulting objects will look.</span></span> <span data-ttu-id="07f34-119">In questo esempio gli oggetti risultanti sono tipi anonimi costituiti dal nome del proprietario (owner) e dal nome dell'animale domestico (pet).</span><span class="sxs-lookup"><span data-stu-id="07f34-119">In this example the resulting objects are anonymous types that consist of the owner's first name and the pet's name.</span></span>  
  
 <span data-ttu-id="07f34-120">[!code-cs[CsLINQProgJoining#1](../../../samples/snippets/csharp/concepts/linq/how-to-perform-inner-joins_1.cs)]</span><span class="sxs-lookup"><span data-stu-id="07f34-120">[!code-cs[CsLINQProgJoining#1](../../../samples/snippets/csharp/concepts/linq/how-to-perform-inner-joins_1.cs)]</span></span>  
  
 <span data-ttu-id="07f34-121">Notare che l'oggetto `Person` il cui valore `LastName` è "Huff" non viene visualizzato nel set di risultati perché non esiste un oggetto `Pet` con `Pet.Owner` uguale a `Person`.</span><span class="sxs-lookup"><span data-stu-id="07f34-121">Note that the `Person` object whose `LastName` is "Huff" does not appear in the result set because there is no `Pet` object that has `Pet.Owner` equal to that `Person`.</span></span>  
  
## <a name="example"></a><span data-ttu-id="07f34-122">Esempio</span><span class="sxs-lookup"><span data-stu-id="07f34-122">Example</span></span>  
  
## <a name="composite-key-join-example"></a><span data-ttu-id="07f34-123">Esempio di join con chiave composta</span><span class="sxs-lookup"><span data-stu-id="07f34-123">Composite key join example</span></span>  
 <span data-ttu-id="07f34-124">Anziché correlare gli elementi in base a una sola proprietà, è possibile usare una chiave composta per confrontare gli elementi in base a più proprietà.</span><span class="sxs-lookup"><span data-stu-id="07f34-124">Instead of correlating elements based on just one property, you can use a composite key to compare elements based on multiple properties.</span></span> <span data-ttu-id="07f34-125">Per eseguire questa operazione, specificare la funzione del selettore di chiave per ogni raccolta in modo da restituire un tipo anonimo che include le proprietà da confrontare.</span><span class="sxs-lookup"><span data-stu-id="07f34-125">To do this, specify the key selector function for each collection to return an anonymous type that consists of the properties you want to compare.</span></span> <span data-ttu-id="07f34-126">Se si applicano etichette alle proprietà, l'etichetta deve essere la stessa in ogni tipo anonimo della chiave.</span><span class="sxs-lookup"><span data-stu-id="07f34-126">If you label the properties, they must have the same label in each key's anonymous type.</span></span> <span data-ttu-id="07f34-127">Le proprietà devono inoltre apparire nello stesso ordine.</span><span class="sxs-lookup"><span data-stu-id="07f34-127">The properties must also appear in the same order.</span></span>  
  
 <span data-ttu-id="07f34-128">L'esempio seguente usa un elenco di oggetti `Employee` e un elenco di oggetti `Student` per determinare quali dipendenti sono anche studenti.</span><span class="sxs-lookup"><span data-stu-id="07f34-128">The following example uses a list of `Employee` objects and a list of `Student` objects to determine which employees are also students.</span></span> <span data-ttu-id="07f34-129">Entrambi questi tipi presentano una proprietà `FirstName` e una proprietà `LastName` di tipo <xref:System.String>.</span><span class="sxs-lookup"><span data-stu-id="07f34-129">Both of these types have a `FirstName` and a `LastName` property of type <xref:System.String>.</span></span> <span data-ttu-id="07f34-130">Le funzioni che creano le chiavi di join dagli elementi di ogni elenco restituiscono un tipo anonimo costituito dalle proprietà `FirstName` e `LastName` di ogni elemento.</span><span class="sxs-lookup"><span data-stu-id="07f34-130">The functions that create the join keys from each list's elements return an anonymous type that consists of the `FirstName` and `LastName` properties of each element.</span></span> <span data-ttu-id="07f34-131">L'operazione di join confronta le chiavi composte per verificarne l'uguaglianza e restituisce coppie di oggetti da ogni elenco in cui sia il nome che il cognome corrispondono.</span><span class="sxs-lookup"><span data-stu-id="07f34-131">The join operation compares these composite keys for equality and returns pairs of objects from each list where both the first name and the last name match.</span></span>  
  
 <span data-ttu-id="07f34-132">[!code-cs[CsLINQProgJoining#2](../../../samples/snippets/csharp/concepts/linq/how-to-perform-inner-joins_2.cs)]</span><span class="sxs-lookup"><span data-stu-id="07f34-132">[!code-cs[CsLINQProgJoining#2](../../../samples/snippets/csharp/concepts/linq/how-to-perform-inner-joins_2.cs)]</span></span>  
  
## <a name="example"></a><span data-ttu-id="07f34-133">Esempio</span><span class="sxs-lookup"><span data-stu-id="07f34-133">Example</span></span>  
  
## <a name="multiple-join-example"></a><span data-ttu-id="07f34-134">Esempio di join multiplo</span><span class="sxs-lookup"><span data-stu-id="07f34-134">Multiple join example</span></span>  
 <span data-ttu-id="07f34-135">È possibile collegare tra loro qualsiasi numero di operazioni di join per eseguire un join multiplo.</span><span class="sxs-lookup"><span data-stu-id="07f34-135">Any number of join operations can be appended to each other to perform a multiple join.</span></span> <span data-ttu-id="07f34-136">Ogni clausola `join` in C# consente di correlare un'origine dati specificata con i risultati del join precedente.</span><span class="sxs-lookup"><span data-stu-id="07f34-136">Each `join` clause in C# correlates a specified data source with the results of the previous join.</span></span>  
  
 <span data-ttu-id="07f34-137">Il seguente esempio crea tre raccolte: un elenco di oggetti `Person`, un elenco di oggetti `Cat` e un elenco di oggetti `Dog`.</span><span class="sxs-lookup"><span data-stu-id="07f34-137">The following example creates three collections: a list of `Person` objects, a list of `Cat` objects, and a list of `Dog` objects.</span></span>  
  
 <span data-ttu-id="07f34-138">La prima clausola `join` in C# associa le persone e i gatti in base a un oggetto `Person` corrispondente a `Cat.Owner`.</span><span class="sxs-lookup"><span data-stu-id="07f34-138">The first `join` clause in C# matches people and cats based on a `Person` object matching `Cat.Owner`.</span></span> <span data-ttu-id="07f34-139">Restituisce una sequenza di tipi anonimi che contengono l'oggetto `Person` e `Cat.Name`.</span><span class="sxs-lookup"><span data-stu-id="07f34-139">It returns a sequence of anonymous types that contain the `Person` object and `Cat.Name`.</span></span>  
  
 <span data-ttu-id="07f34-140">La seconda clausola `join` in C# consente di correlare i tipi anonimi restituiti dal primo join con gli oggetti `Dog` dell'elenco di cani, in base a una chiave costituita dalla proprietà `Owner` del tipo `Person` e dalla prima lettera del nome dell'animale.</span><span class="sxs-lookup"><span data-stu-id="07f34-140">The second `join` clause in C# correlates the anonymous types returned by the first join with `Dog` objects in the supplied list of dogs, based on a composite key that consists of the `Owner` property of type `Person`, and the first letter of the animal's name.</span></span> <span data-ttu-id="07f34-141">Restituisce una sequenza di tipi anonimi che contengono le proprietà `Cat.Name` e `Dog.Name` di ogni coppia corrispondente.</span><span class="sxs-lookup"><span data-stu-id="07f34-141">It returns a sequence of anonymous types that contain the `Cat.Name` and `Dog.Name` properties from each matching pair.</span></span> <span data-ttu-id="07f34-142">Poiché si tratta di un inner join, vengono restituiti solo gli oggetti della prima origine dati per cui esiste una corrispondenza nella seconda origine dati.</span><span class="sxs-lookup"><span data-stu-id="07f34-142">Because this is an inner join, only those objects from the first data source that have a match in the second data source are returned.</span></span>  
  
 <span data-ttu-id="07f34-143">[!code-cs[CsLINQProgJoining#3](../../../samples/snippets/csharp/concepts/linq/how-to-perform-inner-joins_3.cs)]</span><span class="sxs-lookup"><span data-stu-id="07f34-143">[!code-cs[CsLINQProgJoining#3](../../../samples/snippets/csharp/concepts/linq/how-to-perform-inner-joins_3.cs)]</span></span>  
  
## <a name="example"></a><span data-ttu-id="07f34-144">Esempio</span><span class="sxs-lookup"><span data-stu-id="07f34-144">Example</span></span>  
  
## <a name="inner-join-by-using-grouped-join-example"></a><span data-ttu-id="07f34-145">Inner join usando l'esempio con join raggruppati</span><span class="sxs-lookup"><span data-stu-id="07f34-145">Inner join by using grouped join example</span></span>  
 <span data-ttu-id="07f34-146">Nell'esempio seguente viene illustrato come implementare un inner join usando un group join.</span><span class="sxs-lookup"><span data-stu-id="07f34-146">The following example shows you how to implement an inner join by using a group join.</span></span>  
  
 <span data-ttu-id="07f34-147">In `query1` l'elenco di oggetti `Person` viene collegato con un group join all'elenco di oggetti `Pet` in base all'oggetto `Person` corrispondente alla proprietà `Pet.Owner`.</span><span class="sxs-lookup"><span data-stu-id="07f34-147">In `query1`, the list of `Person` objects is group-joined to the list of `Pet` objects based on the `Person` matching the `Pet.Owner` property.</span></span> <span data-ttu-id="07f34-148">Il group join crea una raccolta di gruppi intermedi, dove ogni gruppo è costituito da un oggetto `Person` e una sequenza di oggetti `Pet` corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="07f34-148">The group join creates a collection of intermediate groups, where each group consists of a `Person` object and a sequence of matching `Pet` objects.</span></span>  
  
 <span data-ttu-id="07f34-149">Aggiungendo una seconda clausola `from` alla query, questa sequenza di sequenze viene combinata (o appiattita) in un'unica sequenza più lunga.</span><span class="sxs-lookup"><span data-stu-id="07f34-149">By adding a second `from` clause to the query, this sequence of sequences is combined (or flattened) into one longer sequence.</span></span> <span data-ttu-id="07f34-150">Il tipo degli elementi della sequenza finale viene specificato dalla clausola `select`.</span><span class="sxs-lookup"><span data-stu-id="07f34-150">The type of the elements of the final sequence is specified by the `select` clause.</span></span> <span data-ttu-id="07f34-151">In questo esempio il tipo è un tipo anonimo costituito dalle proprietà `Person.FirstName` e `Pet.Name` per ogni coppia corrispondente.</span><span class="sxs-lookup"><span data-stu-id="07f34-151">In this example, that type is an anonymous type that consists of the `Person.FirstName` and `Pet.Name` properties for each matching pair.</span></span>  
  
 <span data-ttu-id="07f34-152">Il risultato di `query1` è equivalente al set di risultati che si ottiene usando la clausola `join` senza la clausola `into` per eseguire un inner join.</span><span class="sxs-lookup"><span data-stu-id="07f34-152">The result of `query1` is equivalent to the result set that would have been obtained by using the `join` clause without the `into` clause to perform an inner join.</span></span> <span data-ttu-id="07f34-153">La variabile `query2` dimostra questa query equivalente.</span><span class="sxs-lookup"><span data-stu-id="07f34-153">The `query2` variable demonstrates this equivalent query.</span></span>  
  
 <span data-ttu-id="07f34-154">[!code-cs[CsLINQProgJoining#4](../../../samples/snippets/csharp/concepts/linq/how-to-perform-inner-joins_4.cs)]</span><span class="sxs-lookup"><span data-stu-id="07f34-154">[!code-cs[CsLINQProgJoining#4](../../../samples/snippets/csharp/concepts/linq/how-to-perform-inner-joins_4.cs)]</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="07f34-155">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="07f34-155">See also</span></span>  
 <span data-ttu-id="07f34-156"><xref:System.Linq.Enumerable.Join%2A></span><span class="sxs-lookup"><span data-stu-id="07f34-156"><xref:System.Linq.Enumerable.Join%2A></span></span>   
 <span data-ttu-id="07f34-157"><xref:System.Linq.Enumerable.GroupJoin%2A></span><span class="sxs-lookup"><span data-stu-id="07f34-157"><xref:System.Linq.Enumerable.GroupJoin%2A></span></span>   
 <span data-ttu-id="07f34-158">[Eseguire join raggruppati](perform-grouped-joins.md) </span><span class="sxs-lookup"><span data-stu-id="07f34-158">[Perform grouped joins](perform-grouped-joins.md) </span></span>  
 <span data-ttu-id="07f34-159">[Eseguire left outer join](perform-left-outer-joins.md) </span><span class="sxs-lookup"><span data-stu-id="07f34-159">[Perform left outer joins](perform-left-outer-joins.md) </span></span>  
 [<span data-ttu-id="07f34-160">Tipi anonimi</span><span class="sxs-lookup"><span data-stu-id="07f34-160">Anonymous types</span></span>](../programming-guide/classes-and-structs/anonymous-types.md)   
 

