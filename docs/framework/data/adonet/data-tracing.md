---
title: Traccia dati in ADO.NET
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: a6a752a5-d2a9-4335-a382-b58690ccb79f
caps.latest.revision: "9"
author: JennieHubbard
ms.author: jhubbard
manager: jhubbard
ms.workload: dotnet
ms.openlocfilehash: fcd149b34282ef6ae21593e4549478bab91e0189
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/22/2017
---
# <a name="data-tracing-in-adonet"></a><span data-ttu-id="4d0fd-102">Traccia dati in ADO.NET</span><span class="sxs-lookup"><span data-stu-id="4d0fd-102">Data Tracing in ADO.NET</span></span>
<span data-ttu-id="4d0fd-103">In ADO.NET 2.0 è disponibile una funzionalità di analisi dei dati incorporata supportata dai provider di dati .NET per [!INCLUDE[ssNoVersion](../../../../includes/ssnoversion-md.md)], Oracle, OLE DB e ODBC, nonché dall'oggetto <xref:System.Data.DataSet>ADO.NET e dai protocolli di rete di [!INCLUDE[ssNoVersion](../../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4d0fd-103">ADO.NET features built-in data tracing functionality that is supported by the .NET data providers for [!INCLUDE[ssNoVersion](../../../../includes/ssnoversion-md.md)], Oracle, OLE DB and ODBC, as well as the ADO.NET <xref:System.Data.DataSet>, and the [!INCLUDE[ssNoVersion](../../../../includes/ssnoversion-md.md)] network protocols.</span></span>  
  
 <span data-ttu-id="4d0fd-104">L'analisi delle chiamate API di accesso ai dati consente di diagnosticare i seguenti problemi:</span><span class="sxs-lookup"><span data-stu-id="4d0fd-104">Tracing data access API calls can help diagnose the following problems:</span></span>  
  
-   <span data-ttu-id="4d0fd-105">Mancata corrispondenza di schema tra il programma client e il database.</span><span class="sxs-lookup"><span data-stu-id="4d0fd-105">Schema mismatch between client program and the database.</span></span>  
  
-   <span data-ttu-id="4d0fd-106">Database non disponibile o problemi nella libreria di rete.</span><span class="sxs-lookup"><span data-stu-id="4d0fd-106">Database unavailability or network library problems.</span></span>  
  
-   <span data-ttu-id="4d0fd-107">Sintassi SQL non corretta definita a livello di codice o generata da un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="4d0fd-107">Incorrect SQL whether hard coded or generated by an application.</span></span>  
  
-   <span data-ttu-id="4d0fd-108">Logica di programmazione non corretta.</span><span class="sxs-lookup"><span data-stu-id="4d0fd-108">Incorrect programming logic.</span></span>  
  
-   <span data-ttu-id="4d0fd-109">Problemi risultanti dall'interazione tra più componenti ADO.NET o tra ADO.NET e i componenti dell'utente.</span><span class="sxs-lookup"><span data-stu-id="4d0fd-109">Issues resulting from the interaction between multiple ADO.NET components or between ADO.NET and your own components.</span></span>  
  
 <span data-ttu-id="4d0fd-110">Per supportare tecnologie di traccia diverse, questa funzionalità è estensibile, pertanto uno sviluppatore può tracciare un problema a qualsiasi livello dello stack dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="4d0fd-110">To support different trace technologies, tracing is extensible, so a developer can trace a problem at any level of the application stack.</span></span> <span data-ttu-id="4d0fd-111">Sebbene la funzionalità di analisi non sia esclusiva di ADO.NET, i provider Microsoft usano l'analisi generalizzata e le API della strumentazione.</span><span class="sxs-lookup"><span data-stu-id="4d0fd-111">Although tracing is not an ADO.NET-only feature, Microsoft providers take advantage of generalized tracing and instrumentation APIs.</span></span>  
  
 <span data-ttu-id="4d0fd-112">Per ulteriori informazioni sulla configurazione dell'analisi gestita in ADO.NET, vedere [accesso ai dati di traccia](http://msdn.microsoft.com/library/hh880086.aspx).</span><span class="sxs-lookup"><span data-stu-id="4d0fd-112">For more information about setting and configuring managed tracing in ADO.NET, see [Tracing Data Access](http://msdn.microsoft.com/library/hh880086.aspx).</span></span>  
  
## <a name="accessing-diagnostic-information-in-the-extended-events-log"></a><span data-ttu-id="4d0fd-113">Accesso alle informazioni diagnostiche nel registro di eventi esteso</span><span class="sxs-lookup"><span data-stu-id="4d0fd-113">Accessing Diagnostic Information in the Extended Events Log</span></span>  
 <span data-ttu-id="4d0fd-114">Nel [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Provider di dati per [!INCLUDE[ssNoVersion](../../../../includes/ssnoversion-md.md)], traccia di accesso ai dati ([traccia di accesso ai dati](http://msdn.microsoft.com/library/hh880086.aspx)) è stata aggiornata per semplificare per correlare gli eventi client con le informazioni di diagnostica, ad esempio gli errori di connessione da connettività buffer circolare e applicazione delle prestazioni informazioni del server nel log degli eventi estesi.</span><span class="sxs-lookup"><span data-stu-id="4d0fd-114">In the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for [!INCLUDE[ssNoVersion](../../../../includes/ssnoversion-md.md)], data access tracing ([Data Access Tracing](http://msdn.microsoft.com/library/hh880086.aspx)) has been updated to make it easier to easier to correlate client events with diagnostic information, such as connection failures, from the server's connectivity ring buffer and application performance information in the extended events log.</span></span> <span data-ttu-id="4d0fd-115">Per informazioni sulla lettura del log di eventi estesi, vedere [visualizzare i dati di sessione eventi](http://msdn.microsoft.com/library/hh710068\(SQL.110\).aspx).</span><span class="sxs-lookup"><span data-stu-id="4d0fd-115">For information about reading the extended events log, see [View Event Session Data](http://msdn.microsoft.com/library/hh710068\(SQL.110\).aspx).</span></span>  
  
 <span data-ttu-id="4d0fd-116">Per le operazioni di connessione, ADO.NET invierà un ID della connessione client.</span><span class="sxs-lookup"><span data-stu-id="4d0fd-116">For connection operations, ADO.NET will send a client connection ID.</span></span> <span data-ttu-id="4d0fd-117">Se la connessione non riesce, è possibile accedere al buffer circolare ([la risoluzione dei problemi di connettività in SQL Server 2008 con il Buffer circolare di connettività](http://go.microsoft.com/fwlink/?LinkId=207752)) e individuare il `ClientConnectionID` campo e ottenere informazioni di diagnostica di Errore di connessione.</span><span class="sxs-lookup"><span data-stu-id="4d0fd-117">If the connection fails, you can access the connectivity ring buffer ([Connectivity troubleshooting in SQL Server 2008 with the Connectivity Ring Buffer](http://go.microsoft.com/fwlink/?LinkId=207752)) and find the `ClientConnectionID` field and get diagnostic information about the connection failure.</span></span> <span data-ttu-id="4d0fd-118">Gli ID della connessione client vengono registrati nel buffer circolare solo se si verifica un errore.</span><span class="sxs-lookup"><span data-stu-id="4d0fd-118">Client connection IDs are logged in the ring buffer only if an error occurs.</span></span> <span data-ttu-id="4d0fd-119">Se la connessione non riesce prima di inviare il pacchetto di preaccesso, non verrà generato un ID di connessione client. L'ID di connessione client è un GUID a 16 byte.</span><span class="sxs-lookup"><span data-stu-id="4d0fd-119">(If a connection fails before sending the prelogin packet, a client connection ID will not be generated.) The client connection ID is a 16-byte GUID.</span></span> <span data-ttu-id="4d0fd-120">È anche possibile trovare l'ID di connessione client nell'output di destinazione di eventi estesi, se l'azione `client_connection_id` viene aggiunta agli eventi in una sessione di eventi estesi.</span><span class="sxs-lookup"><span data-stu-id="4d0fd-120">You can also find the client connection ID in the extended events target output, if the `client_connection_id` action is added to events in an extended events session.</span></span> <span data-ttu-id="4d0fd-121">È possibile abilitare l'analisi di accesso ai dati ed eseguire di nuovo il comando di connessione e osservare il campo `ClientConnectionID` nell'analisi di accesso ai dati, se si necessita di ulteriore assistenza per la diagnostica dei driver del client.</span><span class="sxs-lookup"><span data-stu-id="4d0fd-121">You can enable data access tracing and rerun the connection command and observe the `ClientConnectionID` field in the data access trace, if you need further client driver diagnostic assistance.</span></span>  
  
 <span data-ttu-id="4d0fd-122">È possibile ottenere l'ID di connessione cliente a livello di codice usando la proprietà `SqlConnection.ClientConnectionID`.</span><span class="sxs-lookup"><span data-stu-id="4d0fd-122">You can get the client connection ID programmatically by using the `SqlConnection.ClientConnectionID` property.</span></span>  
  
 <span data-ttu-id="4d0fd-123">`ClientConnectionID` è disponibile per un oggetto di <xref:System.Data.SqlClient.SqlConnection> che stabilisce correttamente una connessione.</span><span class="sxs-lookup"><span data-stu-id="4d0fd-123">The `ClientConnectionID` is available for a <xref:System.Data.SqlClient.SqlConnection> object that successfully establishes  a connection.</span></span> <span data-ttu-id="4d0fd-124">Se un tentativo di connessione non riesce, `ClientConnectionID` può essere disponibile tramite `SqlException.ToString`.</span><span class="sxs-lookup"><span data-stu-id="4d0fd-124">If a connection attempt fails, `ClientConnectionID` may be available via `SqlException.ToString`.</span></span>  
  
 <span data-ttu-id="4d0fd-125">ADO.NET invia inoltre un ID di attività specifico del thread.</span><span class="sxs-lookup"><span data-stu-id="4d0fd-125">ADO.NET also sends a thread-specific activity ID.</span></span> <span data-ttu-id="4d0fd-126">L'ID attività viene acquisito nelle sessioni di eventi estesi se le sessioni vengono avviate all'opzione TRACK_CAUSAILITY abilitata.</span><span class="sxs-lookup"><span data-stu-id="4d0fd-126">The activity ID is captured in the extended events sessions if the sessions are started with the TRACK_CAUSAILITY option enabled.</span></span> <span data-ttu-id="4d0fd-127">Per i problemi di prestazioni con una connessione attiva, è possibile ottenere un ID attività dell'analisi di accesso ai dati del client (campo di`ActivityID` ) e quindi individuare gli ID attività nell'output di eventi estesi.</span><span class="sxs-lookup"><span data-stu-id="4d0fd-127">For performance issues with an active connection, you can get the activity ID from the client's data access trace (`ActivityID` field) and then locate the activity ID in the extended events output.</span></span> <span data-ttu-id="4d0fd-128">L'ID attività negli eventi estesi è un GUID a 16 byte (diverso dal GUID per l'ID di connessione client seguito da un numero in sequenza di quattro byte).</span><span class="sxs-lookup"><span data-stu-id="4d0fd-128">The activity ID in extended events is a 16-byte GUID (not the same as the GUID for the client connection ID) appended with a four-byte sequence number.</span></span> <span data-ttu-id="4d0fd-129">Il numero di sequenze rappresenta l'ordine di una richiesta all'interno di un thread e indica un ordinamento relativo del batch e delle istruzioni RPC per il thread.</span><span class="sxs-lookup"><span data-stu-id="4d0fd-129">The sequence number represents the order of a request within a thread and indicates the relative ordering of batch and RPC statements for the thread.</span></span> <span data-ttu-id="4d0fd-130">`ActivityID` viene attualmente inviato facoltativamente per le istruzioni batch SQL e le richieste RPC quando è abilitata l'analisi di accesso ai dati e il diciottesimo bit della parola di configurazione dell'analisi di accesso ai dati è ON.</span><span class="sxs-lookup"><span data-stu-id="4d0fd-130">The `ActivityID` is currently optionally sent for SQL batch statements and RPC requests when data access tracing is enabled on and the 18th bit in the data access tracing configuration word is turned ON.</span></span>  
  
 <span data-ttu-id="4d0fd-131">Di seguito viene riportato un esempio che usa [!INCLUDE[tsql](../../../../includes/tsql-md.md)] per avviare una sessione di eventi estesi che verrà archiviata in un buffer circolare e che registrerà l'ID attività inviato da un client nelle operazioni RPC e batch.</span><span class="sxs-lookup"><span data-stu-id="4d0fd-131">The following is a sample that uses [!INCLUDE[tsql](../../../../includes/tsql-md.md)] to start an extended events session that will be stored in a ring buffer and will record the activity ID sent from a client on RPC and batch operations.</span></span>  
  
```  
create event session MySession on server   
add event connectivity_ring_buffer_recorded,   
add event sql_statement_starting (action (client_connection_id)),   
add event sql_statement_completed (action (client_connection_id)),   
add event rpc_starting (action (client_connection_id)),   
add event rpc_completed (action (client_connection_id))  
add target ring_buffer with (track_causality=on)  
```  
  
## <a name="see-also"></a><span data-ttu-id="4d0fd-132">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="4d0fd-132">See Also</span></span>  
 [<span data-ttu-id="4d0fd-133">Traccia di rete in .NET Framework</span><span class="sxs-lookup"><span data-stu-id="4d0fd-133">Network Tracing in the .NET Framework</span></span>](../../../../docs/framework/network-programming/network-tracing.md)  
 [<span data-ttu-id="4d0fd-134">Traccia e strumentazione di applicazioni</span><span class="sxs-lookup"><span data-stu-id="4d0fd-134">Tracing and Instrumenting Applications</span></span>](../../../../docs/framework/debug-trace-profile/tracing-and-instrumenting-applications.md)  
 [<span data-ttu-id="4d0fd-135">Provider gestiti ADO.NET e Centro per sviluppatori di set di dati</span><span class="sxs-lookup"><span data-stu-id="4d0fd-135">ADO.NET Managed Providers and DataSet Developer Center</span></span>](http://go.microsoft.com/fwlink/?LinkId=217917)
