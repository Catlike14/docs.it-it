---
title: Stringhe di connessione e file di configurazione
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
ms.assetid: 37df2641-661e-407a-a3fb-7bf9540f01e8
caps.latest.revision: "4"
author: douglaslMS
ms.author: douglasl
manager: craigg
ms.workload: dotnet
ms.openlocfilehash: 358bc0428a53817e85d5a5e278d8da4e1a8b6927
ms.sourcegitcommit: ed26cfef4e18f6d93ab822d8c29f902cff3519d1
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/17/2018
---
# <a name="connection-strings-and-configuration-files"></a><span data-ttu-id="64e56-102">Stringhe di connessione e file di configurazione</span><span class="sxs-lookup"><span data-stu-id="64e56-102">Connection Strings and Configuration Files</span></span>
<span data-ttu-id="64e56-103">Se le stringhe di connessione vengono incorporate nel codice dell'applicazione, è possibile che si verifichino vulnerabilità della sicurezza e problemi di manutenzione.</span><span class="sxs-lookup"><span data-stu-id="64e56-103">Embedding connection strings in your application's code can lead to security vulnerabilities and maintenance problems.</span></span> <span data-ttu-id="64e56-104">È possibile visualizzare le stringhe di connessione non crittografata compilate nel codice sorgente di un'applicazione utilizzando il [Ildasm.exe (Disassembler IL)](../../../../docs/framework/tools/ildasm-exe-il-disassembler.md) strumento.</span><span class="sxs-lookup"><span data-stu-id="64e56-104">Unencrypted connection strings compiled into an application's source code can be viewed using the [Ildasm.exe (IL Disassembler)](../../../../docs/framework/tools/ildasm-exe-il-disassembler.md) tool.</span></span> <span data-ttu-id="64e56-105">Inoltre, se la stringa di connessione viene modificata, è necessario ricompilare l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="64e56-105">Moreover, if the connection string ever changes, your application must be recompiled.</span></span> <span data-ttu-id="64e56-106">Per questi motivi, si consiglia di archiviare le stringhe di connessione in un file di configurazione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="64e56-106">For these reasons, we recommend storing connection strings in an application configuration file.</span></span>  
  
## <a name="working-with-application-configuration-files"></a><span data-ttu-id="64e56-107">Utilizzo dei file di configurazione delle applicazioni</span><span class="sxs-lookup"><span data-stu-id="64e56-107">Working with Application Configuration Files</span></span>  
 <span data-ttu-id="64e56-108">I file di configurazione delle applicazioni contengono impostazioni specifiche di una determinata applicazione.</span><span class="sxs-lookup"><span data-stu-id="64e56-108">Application configuration files contain settings that are specific to a particular application.</span></span> <span data-ttu-id="64e56-109">Ad esempio, un'applicazione ASP.NET può avere uno o più **Web. config** file e un'applicazione Windows può avere un parametro facoltativo **app** file.</span><span class="sxs-lookup"><span data-stu-id="64e56-109">For example, an ASP.NET application can have one or more **web.config** files, and a Windows application can have an optional **app.config** file.</span></span> <span data-ttu-id="64e56-110">I file di configurazione condividono elementi comuni, anche se il nome e il percorso variano a seconda dell'host dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="64e56-110">Configuration files share common elements, although the name and location of a configuration file vary depending on the application's host.</span></span>  
  
### <a name="the-connectionstrings-section"></a><span data-ttu-id="64e56-111">Sezione connectionStrings</span><span class="sxs-lookup"><span data-stu-id="64e56-111">The connectionStrings Section</span></span>  
 <span data-ttu-id="64e56-112">Le stringhe di connessione possono essere archiviate come coppie chiave/valore nel **connectionStrings** sezione la **configurazione** elemento di un file di configurazione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="64e56-112">Connection strings can be stored as key/value pairs in the **connectionStrings** section of the **configuration** element of an application configuration file.</span></span> <span data-ttu-id="64e56-113">Gli elementi figlio includono **aggiungere**, **deselezionare**, e **rimuovere**.</span><span class="sxs-lookup"><span data-stu-id="64e56-113">Child elements include **add**, **clear**, and **remove**.</span></span>  
  
 <span data-ttu-id="64e56-114">Nel frammento di file di configurazione seguente sono illustrati lo schema e la sintassi per l'archiviazione di una stringa di connessione.</span><span class="sxs-lookup"><span data-stu-id="64e56-114">The following configuration file fragment demonstrates the schema and syntax for storing a connection string.</span></span> <span data-ttu-id="64e56-115">Il **nome** attributo è un nome specificato per identificare in modo univoco una stringa di connessione in modo che possa essere recuperato in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="64e56-115">The **name** attribute is a name that you provide to uniquely identify a connection string so that it can be retrieved at run time.</span></span> <span data-ttu-id="64e56-116">Il **providerName** è il nome invariante del provider di dati .NET Framework, viene registrato nel file Machine. config.</span><span class="sxs-lookup"><span data-stu-id="64e56-116">The **providerName** is the invariant name of the .NET Framework data provider, which is registered in the machine.config file.</span></span>  
  
```xml  
<?xml version='1.0' encoding='utf-8'?>  
  <configuration>  
    <connectionStrings>  
      <clear />  
      <add name="Name"   
       providerName="System.Data.ProviderName"   
       connectionString="Valid Connection String;" />  
    </connectionStrings>  
  </configuration>  
```  
  
> [!NOTE]
>  <span data-ttu-id="64e56-117">È possibile salvare parte di una stringa di connessione in un file di configurazione e usare la classe <xref:System.Data.Common.DbConnectionStringBuilder> per completarlo in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="64e56-117">You can save part of a connection string in a configuration file and use the <xref:System.Data.Common.DbConnectionStringBuilder> class to complete it at run time.</span></span> <span data-ttu-id="64e56-118">Questa funzione è utile nelle situazioni in cui non si conoscono in anticipo gli elementi della stringa di connessione o quando non si desidera salvare informazioni sensibili in un file di configurazione.</span><span class="sxs-lookup"><span data-stu-id="64e56-118">This is useful in scenarios where you do not know elements of the connection string ahead of time, or when you do not want to save sensitive information in a configuration file.</span></span> <span data-ttu-id="64e56-119">Per ulteriori informazioni, vedere [generatori di stringhe di connessione](../../../../docs/framework/data/adonet/connection-string-builders.md).</span><span class="sxs-lookup"><span data-stu-id="64e56-119">For more information, see [Connection String Builders](../../../../docs/framework/data/adonet/connection-string-builders.md).</span></span>  
  
### <a name="using-external-configuration-files"></a><span data-ttu-id="64e56-120">Uso di file di configurazione esterni</span><span class="sxs-lookup"><span data-stu-id="64e56-120">Using External Configuration Files</span></span>  
 <span data-ttu-id="64e56-121">I file di configurazione esterni sono file distinti che contengono un frammento di un file di configurazione costituito da un'unica sezione.</span><span class="sxs-lookup"><span data-stu-id="64e56-121">External configuration files are separate files that contain a fragment of a configuration file consisting of a single section.</span></span> <span data-ttu-id="64e56-122">Al file di configurazione esterno viene quindi fatto riferimento dal file di configurazione principale.</span><span class="sxs-lookup"><span data-stu-id="64e56-122">The external configuration file is then referenced by the main configuration file.</span></span> <span data-ttu-id="64e56-123">L'archiviazione di **connectionStrings** sezione in un file fisicamente distinto risulta utile nelle situazioni in cui le stringhe di connessione possono essere modificate dopo l'applicazione viene distribuita.</span><span class="sxs-lookup"><span data-stu-id="64e56-123">Storing the **connectionStrings** section in a physically separate file is useful in situations where connection strings may be edited after the application is deployed.</span></span> <span data-ttu-id="64e56-124">Ad esempio, il comportamento ASP.NET standard prevede il riavvio di un dominio di applicazione quando i file di configurazione vengono modificati, con la conseguenza che le informazioni sullo stato vanno perse.</span><span class="sxs-lookup"><span data-stu-id="64e56-124">For example, the standard ASP.NET behavior is to restart an application domain when configuration files are modified, which results in state information being lost.</span></span> <span data-ttu-id="64e56-125">Tuttavia, la modifica di un file di configurazione esterno non provoca un riavvio dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="64e56-125">However, modifying an external configuration file does not cause an application restart.</span></span> <span data-ttu-id="64e56-126">Oltre che in ASP.NET, i file di configurazione esterni possono essere usati anche nelle applicazioni Windows.</span><span class="sxs-lookup"><span data-stu-id="64e56-126">External configuration files are not limited to ASP.NET; they can also be used by Windows applications.</span></span> <span data-ttu-id="64e56-127">È possibile inoltre usare la sicurezza e le autorizzazioni di accesso ai file per limitare l'accesso ai file di configurazione esterni.</span><span class="sxs-lookup"><span data-stu-id="64e56-127">In addition, file access security and permissions can be used to restrict access to external configuration files.</span></span> <span data-ttu-id="64e56-128">L'uso di file di configurazione esterni in fase di esecuzione è trasparente e non richiede codice speciale.</span><span class="sxs-lookup"><span data-stu-id="64e56-128">Working with external configuration files at run time is transparent, and requires no special coding.</span></span>  
  
 <span data-ttu-id="64e56-129">Per archiviare le stringhe di connessione nel file di configurazione esterno, creare un file distinto che contiene solo il **connectionStrings** sezione.</span><span class="sxs-lookup"><span data-stu-id="64e56-129">To store connection strings in an external configuration file, create a separate file that contains only the **connectionStrings** section.</span></span> <span data-ttu-id="64e56-130">Non includere altri elementi, sezioni o attributi.</span><span class="sxs-lookup"><span data-stu-id="64e56-130">Do not include any additional elements, sections, or attributes.</span></span> <span data-ttu-id="64e56-131">Questo esempio illustra la sintassi di un file di configurazione esterno.</span><span class="sxs-lookup"><span data-stu-id="64e56-131">This example shows the syntax for an external configuration file.</span></span>  
  
```xml  
<connectionStrings>  
  <add name="Name"   
   providerName="System.Data.ProviderName"   
   connectionString="Valid Connection String;" />  
</connectionStrings>  
```  
  
 <span data-ttu-id="64e56-132">Nel file di configurazione principale dell'applicazione, utilizzare il **configSource** attributo per specificare il nome completo e il percorso del file esterno.</span><span class="sxs-lookup"><span data-stu-id="64e56-132">In the main application configuration file, you use the **configSource** attribute to specify the fully qualified name and location of the external file.</span></span> <span data-ttu-id="64e56-133">In questo esempio si fa riferimento a un file di configurazione esterno denominato `connections.config`.</span><span class="sxs-lookup"><span data-stu-id="64e56-133">This example refers to an external configuration file named `connections.config`.</span></span>  
  
```xml  
<?xml version='1.0' encoding='utf-8'?>  
<configuration>  
    <connectionStrings configSource="connections.config"/>  
</configuration>  
```  
  
## <a name="retrieving-connection-strings-at-run-time"></a><span data-ttu-id="64e56-134">Recupero delle stringhe di connessione in fase di esecuzione</span><span class="sxs-lookup"><span data-stu-id="64e56-134">Retrieving Connection Strings at Run Time</span></span>  
 <span data-ttu-id="64e56-135">In .NET Framework 2.0 sono state introdotte nuove classi nello spazio dei nomi <xref:System.Configuration> per semplificare il recupero delle stringhe di connessione dai file di configurazione in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="64e56-135">The .NET Framework 2.0 introduced new classes in the <xref:System.Configuration> namespace to simplify retrieving connection strings from configuration files at run time.</span></span> <span data-ttu-id="64e56-136">È possibile recuperare una stringa di connessione a livello di codice in base al nome o al nome del provider.</span><span class="sxs-lookup"><span data-stu-id="64e56-136">You can programmatically retrieve a connection string by name or by provider name.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="64e56-137">Il **Machine. config** file contiene inoltre un **connectionStrings** sezione che contiene stringhe di connessione utilizzate da Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="64e56-137">The **machine.config** file also contains a **connectionStrings** section, which contains connection strings used by Visual Studio.</span></span> <span data-ttu-id="64e56-138">Durante il recupero di stringhe di connessione dal nome del provider di **app** in un'applicazione Windows, le stringhe di connessione nel file **Machine. config** ottenere prima di caricare e successivamente le voci da **app**. Aggiunta di **deselezionare** immediatamente dopo il **connectionStrings** elemento rimuove tutti i riferimenti ereditati dalla struttura di dati in memoria, in modo che solo le stringhe di connessione definite locale **app** vengono considerati file.</span><span class="sxs-lookup"><span data-stu-id="64e56-138">When retrieving connection strings by provider name from the **app.config** file in a Windows application, the connection strings in **machine.config** get loaded first, and then the entries from **app.config**. Adding **clear** immediately after the **connectionStrings** element removes all inherited references from the data structure in memory, so that only the connection strings defined in the local **app.config** file are considered.</span></span>  
  
### <a name="working-with-the-configuration-classes"></a><span data-ttu-id="64e56-139">Utilizzo delle classi di configurazione</span><span class="sxs-lookup"><span data-stu-id="64e56-139">Working with the Configuration Classes</span></span>  
 <span data-ttu-id="64e56-140">A partire da .NET Framework 2.0, quando si usano i file di configurazione nel computer locale, viene usato <xref:System.Configuration.ConfigurationManager> al posto dell'oggetto <xref:System.Configuration.ConfigurationSettings> deprecato.</span><span class="sxs-lookup"><span data-stu-id="64e56-140">Starting with the .NET Framework 2.0, <xref:System.Configuration.ConfigurationManager> is used when working with configuration files on the local computer, replacing the deprecated <xref:System.Configuration.ConfigurationSettings>.</span></span> <span data-ttu-id="64e56-141">Per i file di configurazione di ASP.NET, viene usato <xref:System.Web.Configuration.WebConfigurationManager>,</span><span class="sxs-lookup"><span data-stu-id="64e56-141"><xref:System.Web.Configuration.WebConfigurationManager> is used to work with ASP.NET configuration files.</span></span> <span data-ttu-id="64e56-142">È progettato per funzionare con i file di configurazione in un server Web e consente l'accesso programmatico alle sezioni di file di configurazione, ad esempio **System. Web**.</span><span class="sxs-lookup"><span data-stu-id="64e56-142">It is designed to work with configuration files on a Web server, and allows programmatic access to configuration file sections such as **system.web**.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="64e56-143">L'accesso ai file di configurazione in fase di esecuzione richiede la concessione di autorizzazioni al chiamante. Le autorizzazioni necessarie dipendono dal tipo di applicazione, dal file di configurazione e dal percorso.</span><span class="sxs-lookup"><span data-stu-id="64e56-143">Accessing configuration files at run time requires granting permissions to the caller; the required permissions depend on the type of application, configuration file, and location.</span></span> <span data-ttu-id="64e56-144">Per ulteriori informazioni, vedere [utilizzando le classi di configurazione](http://msdn.microsoft.com/library/98d2b386-baf6-4a17-974b-76e3b4c87acc) e <xref:System.Web.Configuration.WebConfigurationManager> per le applicazioni ASP.NET, e <xref:System.Configuration.ConfigurationManager> per le applicazioni di Windows.</span><span class="sxs-lookup"><span data-stu-id="64e56-144">For more information, see [Using the Configuration Classes](http://msdn.microsoft.com/library/98d2b386-baf6-4a17-974b-76e3b4c87acc) and <xref:System.Web.Configuration.WebConfigurationManager> for ASP.NET applications, and <xref:System.Configuration.ConfigurationManager> for Windows applications.</span></span>  
  
 <span data-ttu-id="64e56-145">È possibile usare <xref:System.Configuration.ConnectionStringSettingsCollection> per recuperare le stringhe di connessione dai file di configurazione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="64e56-145">You can use the <xref:System.Configuration.ConnectionStringSettingsCollection> to retrieve connection strings from application configuration files.</span></span> <span data-ttu-id="64e56-146">Contiene una raccolta di <xref:System.Configuration.ConnectionStringSettings> oggetti, ognuno dei quali rappresenta una singola voce di **connectionStrings** sezione.</span><span class="sxs-lookup"><span data-stu-id="64e56-146">It contains a collection of <xref:System.Configuration.ConnectionStringSettings> objects, each of which represents a single entry in the **connectionStrings** section.</span></span> <span data-ttu-id="64e56-147">Le proprietà sono mappate ad attributi di stringa di connessione, consentendo di recuperare una stringa di connessione in base al nome o al nome del provider.</span><span class="sxs-lookup"><span data-stu-id="64e56-147">Its properties map to connection string attributes, allowing you to retrieve a connection string by specifying the name or the provider name.</span></span>  
  
|<span data-ttu-id="64e56-148">Proprietà</span><span class="sxs-lookup"><span data-stu-id="64e56-148">Property</span></span>|<span data-ttu-id="64e56-149">Descrizione</span><span class="sxs-lookup"><span data-stu-id="64e56-149">Description</span></span>|  
|--------------|-----------------|  
|<xref:System.Configuration.ConnectionStringSettings.Name%2A>|<span data-ttu-id="64e56-150">Nome della stringa di connessione.</span><span class="sxs-lookup"><span data-stu-id="64e56-150">The name of the connection string.</span></span> <span data-ttu-id="64e56-151">Esegue il mapping al **nome** attributo.</span><span class="sxs-lookup"><span data-stu-id="64e56-151">Maps to the **name** attribute.</span></span>|  
|<xref:System.Configuration.ConnectionStringSettings.ProviderName%2A>|<span data-ttu-id="64e56-152">Nome completo del provider.</span><span class="sxs-lookup"><span data-stu-id="64e56-152">The fully qualified provider name.</span></span> <span data-ttu-id="64e56-153">Esegue il mapping al **providerName** attributo.</span><span class="sxs-lookup"><span data-stu-id="64e56-153">Maps to the **providerName** attribute.</span></span>|  
|<xref:System.Configuration.ConnectionStringSettings.ConnectionString%2A>|<span data-ttu-id="64e56-154">Stringa di connessione.</span><span class="sxs-lookup"><span data-stu-id="64e56-154">The connection string.</span></span> <span data-ttu-id="64e56-155">Esegue il mapping al **connectionString** attributo.</span><span class="sxs-lookup"><span data-stu-id="64e56-155">Maps to the **connectionString** attribute.</span></span>|  
  
### <a name="example-listing-all-connection-strings"></a><span data-ttu-id="64e56-156">Esempio: elenco di tutte le stringhe di connessione</span><span class="sxs-lookup"><span data-stu-id="64e56-156">Example: Listing All Connection Strings</span></span>  
 <span data-ttu-id="64e56-157">In questo esempio viene scorsa la raccolta `ConnectionStringSettings` e vengono visualizzate le proprietà <xref:System.Configuration.ConnectionStringSettings.Name%2A>, <xref:System.Configuration.ConnectionStringSettings.ProviderName%2A> e <xref:System.Configuration.ConnectionStringSettings.ConnectionString%2A> nella finestra della console.</span><span class="sxs-lookup"><span data-stu-id="64e56-157">This example iterates through the `ConnectionStringSettings` collection and displays the <xref:System.Configuration.ConnectionStringSettings.Name%2A>, <xref:System.Configuration.ConnectionStringSettings.ProviderName%2A>, and <xref:System.Configuration.ConnectionStringSettings.ConnectionString%2A> properties in the console window.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="64e56-158">System.Configuration.dll non è incluso in tutti i tipi di progetto e potrebbe essere necessario impostare un riferimento a questo file per usare le classi di configurazione.</span><span class="sxs-lookup"><span data-stu-id="64e56-158">System.Configuration.dll is not included in all project types, and you may need to set a reference to it in order to use the configuration classes.</span></span> <span data-ttu-id="64e56-159">Il nome e il percorso di un determinato file di configurazione dell'applicazione variano in base al tipo di applicazione e al processo di hosting.</span><span class="sxs-lookup"><span data-stu-id="64e56-159">The name and location of a particular application configuration file varies by the type of application and the hosting process.</span></span>  
  
 [!code-csharp[DataWorks ConnectionStringSettings.RetrieveFromConfig#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfig/CS/source.cs#1)]
 [!code-vb[DataWorks ConnectionStringSettings.RetrieveFromConfig#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfig/VB/source.vb#1)]  
  
### <a name="example-retrieving-a-connection-string-by-name"></a><span data-ttu-id="64e56-160">Esempio: recupero di una stringa di connessione in base al nome</span><span class="sxs-lookup"><span data-stu-id="64e56-160">Example: Retrieving a Connection String by Name</span></span>  
 <span data-ttu-id="64e56-161">In questo esempio viene illustrato come recuperare una stringa di connessione da un file di configurazione specificandone il nome.</span><span class="sxs-lookup"><span data-stu-id="64e56-161">This example demonstrates how to retrieve a connection string from a configuration file by specifying its name.</span></span> <span data-ttu-id="64e56-162">Nel codice viene creato un oggetto <xref:System.Configuration.ConnectionStringSettings> e il parametro di input specificato viene associato al nome <xref:System.Configuration.ConfigurationManager.ConnectionStrings%2A>.</span><span class="sxs-lookup"><span data-stu-id="64e56-162">The code creates a <xref:System.Configuration.ConnectionStringSettings> object, matching the supplied input parameter to the <xref:System.Configuration.ConfigurationManager.ConnectionStrings%2A> name.</span></span> <span data-ttu-id="64e56-163">Se non viene trovato alcun nome corrispondente, la funzione restituisce `null` (`Nothing` in Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="64e56-163">If no matching name is found, the function returns `null` (`Nothing` in Visual Basic).</span></span>  
  
 [!code-csharp[DataWorks ConnectionStringSettings.RetrieveFromConfigByName#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfigByName/CS/source.cs#1)]
 [!code-vb[DataWorks ConnectionStringSettings.RetrieveFromConfigByName#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfigByName/VB/source.vb#1)]  
  
### <a name="example-retrieving-a-connection-string-by-provider-name"></a><span data-ttu-id="64e56-164">Esempio: recupero di una stringa di connessione in base al nome del provider</span><span class="sxs-lookup"><span data-stu-id="64e56-164">Example: Retrieving a Connection String by Provider Name</span></span>  
 <span data-ttu-id="64e56-165">In questo esempio viene illustrato come recuperare una stringa di connessione specificando il nome invariabile del provider nel formato *ProviderName*.</span><span class="sxs-lookup"><span data-stu-id="64e56-165">This example demonstrates how to retrieve a connection string by specifying the provider-invariant name in the format *System.Data.ProviderName*.</span></span> <span data-ttu-id="64e56-166">Il codice consente di scorrere <xref:System.Configuration.ConnectionStringSettingsCollection> e restituisce la stringa di connessione per il primo <xref:System.Configuration.ConnectionStringSettings.ProviderName%2A> trovato.</span><span class="sxs-lookup"><span data-stu-id="64e56-166">The code iterates through the <xref:System.Configuration.ConnectionStringSettingsCollection> and returns the connection string for the first <xref:System.Configuration.ConnectionStringSettings.ProviderName%2A> found.</span></span> <span data-ttu-id="64e56-167">Se il nome del provider non viene trovato, la funzione restituisce `null` (`Nothing` in Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="64e56-167">If the provider name is not found, the function returns `null` (`Nothing` in Visual Basic).</span></span>  
  
 [!code-csharp[DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider/CS/source.cs#1)]
 [!code-vb[DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider/VB/source.vb#1)]  
  
## <a name="encrypting-configuration-file-sections-using-protected-configuration"></a><span data-ttu-id="64e56-168">Crittografia di sezioni dei file di configurazione tramite configurazione protetta</span><span class="sxs-lookup"><span data-stu-id="64e56-168">Encrypting Configuration File Sections Using Protected Configuration</span></span>  
 <span data-ttu-id="64e56-169">ASP.NET 2.0 ha introdotto una nuova funzionalità, denominata *la configurazione protetta*, che consente di crittografare le informazioni riservate in un file di configurazione.</span><span class="sxs-lookup"><span data-stu-id="64e56-169">ASP.NET 2.0 introduced a new feature, called *protected configuration*, that enables you to encrypt sensitive information in a configuration file.</span></span> <span data-ttu-id="64e56-170">Sebbene sia stata progettata principalmente per ASP.NET, questa funzionalità può essere usata anche per crittografare sezioni dei file di configurazione nelle applicazioni Windows.</span><span class="sxs-lookup"><span data-stu-id="64e56-170">Although primarily designed for ASP.NET, protected configuration can also be used to encrypt configuration file sections in Windows applications.</span></span> <span data-ttu-id="64e56-171">Per una descrizione dettagliata delle funzionalità di configurazione protetta, vedere [crittografia configurazione informazioni tramite configurazione protetta](http://msdn.microsoft.com/library/51cdfe5b-9d82-458c-94ff-c551c4f38ed1).</span><span class="sxs-lookup"><span data-stu-id="64e56-171">For a detailed description of the protected configuration capabilities, see [Encrypting Configuration Information Using Protected Configuration](http://msdn.microsoft.com/library/51cdfe5b-9d82-458c-94ff-c551c4f38ed1).</span></span>  
  
 <span data-ttu-id="64e56-172">Frammento di file di configurazione seguente viene illustrato il **connectionStrings** sezione dopo che è stato crittografato.</span><span class="sxs-lookup"><span data-stu-id="64e56-172">The following configuration file fragment shows the **connectionStrings** section after it has been encrypted.</span></span> <span data-ttu-id="64e56-173">Il **configProtectionProvider** specifica il provider di configurazione protetta usato per crittografare e decrittografare le stringhe di connessione.</span><span class="sxs-lookup"><span data-stu-id="64e56-173">The **configProtectionProvider** specifies the protected configuration provider used to encrypt and decrypt the connection strings.</span></span> <span data-ttu-id="64e56-174">Il **EncryptedData** sezione contiene il testo crittografato.</span><span class="sxs-lookup"><span data-stu-id="64e56-174">The **EncryptedData** section contains the cipher text.</span></span>  
  
```xml  
<connectionStrings configProtectionProvider="DataProtectionConfigurationProvider">  
  <EncryptedData>  
    <CipherData>  
      <CipherValue>AQAAANCMnd8BFdERjHoAwE/Cl+sBAAAAH2... </CipherValue>  
    </CipherData>  
  </EncryptedData>  
</connectionStrings>  
```  
  
 <span data-ttu-id="64e56-175">Quando la stringa di connessione crittografata viene recuperata in fase di esecuzione, .NET Framework Usa il provider specificato per decrittografare il **CipherValue** e renderlo disponibile per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="64e56-175">When the encrypted connection string is retrieved at run time, the .NET Framework uses the specified provider to decrypt the **CipherValue** and make it available to your application.</span></span> <span data-ttu-id="64e56-176">Non è necessario scrivere codice aggiuntivo per gestire il processo di decrittografia.</span><span class="sxs-lookup"><span data-stu-id="64e56-176">You do not need to write any additional code to manage the decryption process.</span></span>  
  
### <a name="protected-configuration-providers"></a><span data-ttu-id="64e56-177">Provider di configurazione protetta</span><span class="sxs-lookup"><span data-stu-id="64e56-177">Protected Configuration Providers</span></span>  
 <span data-ttu-id="64e56-178">Provider di configurazione protetta sono registrati nel **configProtectedData** sezione la **Machine. config** file nel computer locale, come illustrato nel frammento seguente, che mostra le due provider di configurazione protetta fornito con .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="64e56-178">Protected configuration providers are registered in the **configProtectedData** section of the **machine.config** file on the local computer, as shown in the following fragment, which shows the two protected configuration providers supplied with the .NET Framework.</span></span> <span data-ttu-id="64e56-179">I valori mostrati sono stati troncati per facilitarne la lettura.</span><span class="sxs-lookup"><span data-stu-id="64e56-179">The values shown here have been truncated for readability.</span></span>  
  
```xml  
<configProtectedData defaultProvider="RsaProtectedConfigurationProvider">  
  <providers>  
    <add name="RsaProtectedConfigurationProvider"   
      type="System.Configuration.RsaProtectedConfigurationProvider, ... />  
    <add name="DataProtectionConfigurationProvider"   
      type="System.Configuration.DpapiProtectedConfigurationProvider, ... />  
  </providers>  
</configProtectedData>  
```  
  
 È possibile configurare il provider di aggiuntive di configurazione protetta aggiungendoli al file il **Machine. config** file. È inoltre possibile creare un proprio provider di configurazione protetta ereditando dalla classe base astratta <xref:System.Configuration.ProtectedConfigurationProvider>. <span data-ttu-id="64e56-182">La tabella seguente descrive i due file di configurazione inclusi in .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="64e56-182">The following table describes the two configuration files included with the .NET Framework.</span></span>  
  
|<span data-ttu-id="64e56-183">Provider</span><span class="sxs-lookup"><span data-stu-id="64e56-183">Provider</span></span>|<span data-ttu-id="64e56-184">Descrizione</span><span class="sxs-lookup"><span data-stu-id="64e56-184">Description</span></span>|  
|--------------|-----------------|  
|<!--zz<xref:System.Configuration.RSAProtectedConfigurationProvider>-->`System.Configuration.RSAProtectedConfigurationProvider`|<span data-ttu-id="64e56-185">Usa l'algoritmo di crittografia RSA per crittografare e decrittografare i dati.</span><span class="sxs-lookup"><span data-stu-id="64e56-185">Uses the RSA encryption algorithm to encrypt and decrypt data.</span></span> <span data-ttu-id="64e56-186">L'algoritmo RSA può essere usato per la crittografia a chiave pubblica e per le firme digitali.</span><span class="sxs-lookup"><span data-stu-id="64e56-186">The RSA algorithm can be used for both public key encryption and digital signatures.</span></span> <span data-ttu-id="64e56-187">È anche noto come crittografia a "chiave pubblica" o asimmetrica perché impiega due chiavi diverse.</span><span class="sxs-lookup"><span data-stu-id="64e56-187">It is also known as "public key" or asymmetrical encryption because it employs two different keys.</span></span> <span data-ttu-id="64e56-188">È possibile utilizzare il [strumento di registrazione ASP.NET IIS (Aspnet_regiis.exe)](http://msdn.microsoft.com/library/6491c41e-e2b0-481f-9863-db3614d5f96b) per crittografare le sezioni in un file Web. config e gestire le chiavi di crittografia.</span><span class="sxs-lookup"><span data-stu-id="64e56-188">You can use the [ASP.NET IIS Registration Tool (Aspnet_regiis.exe)](http://msdn.microsoft.com/library/6491c41e-e2b0-481f-9863-db3614d5f96b) to encrypt sections in a Web.config file and manage the encryption keys.</span></span> <span data-ttu-id="64e56-189">In ASP.NET il file di configurazione viene decrittografato al momento dell'elaborazione.</span><span class="sxs-lookup"><span data-stu-id="64e56-189">ASP.NET decrypts the configuration file when it processes the file.</span></span> <span data-ttu-id="64e56-190">L'identità dell'applicazione ASP.NET deve disporre di accesso in lettura alla chiave di crittografia usata per crittografare e decrittografare le sezioni crittografate.</span><span class="sxs-lookup"><span data-stu-id="64e56-190">The identity of the ASP.NET application must have read access to the encryption key that is used to encrypt and decrypt the encrypted sections.</span></span>|  
|<!--zz<xref:System.Configuration.DPAPIProtectedConfigurationProvider>-->`System.Configuration.DPAPIProtectedConfigurationProvider`|<span data-ttu-id="64e56-191">Usa DPAPI (Data Protection API) di Windows per crittografare le sezioni di configurazione.</span><span class="sxs-lookup"><span data-stu-id="64e56-191">Uses the Windows Data Protection API (DPAPI) to encrypt configuration sections.</span></span> <span data-ttu-id="64e56-192">Usa i servizi di crittografia incorporati di Windows e può essere configurato per la protezione specifica del computer o specifica dell'account utente.</span><span class="sxs-lookup"><span data-stu-id="64e56-192">It uses the Windows built-in cryptographic services and can be configured for either machine-specific or user-account-specific protection.</span></span> <span data-ttu-id="64e56-193">La protezione specifica del computer risulta utile quando più applicazioni sullo stesso server devono condividere informazioni.</span><span class="sxs-lookup"><span data-stu-id="64e56-193">Machine-specific protection is useful for multiple applications on the same server that need to share information.</span></span> <span data-ttu-id="64e56-194">La protezione specifica dell'account utente può essere usata con i servizi eseguiti con un'identità utente specifica, ad esempio un ambiente di hosting condiviso.</span><span class="sxs-lookup"><span data-stu-id="64e56-194">User-account-specific protection can be used with services that run with a specific user identity, such as a shared hosting environment.</span></span> <span data-ttu-id="64e56-195">Ogni applicazione viene eseguita con un'identità distinta, limitando l'accesso a risorse quali file e database.</span><span class="sxs-lookup"><span data-stu-id="64e56-195">Each application runs under a separate identity which restricts access to resources such as files and databases.</span></span>|  
  
 <span data-ttu-id="64e56-196">Entrambi i provider offrono una crittografia avanzata per i dati.</span><span class="sxs-lookup"><span data-stu-id="64e56-196">Both providers offer strong encryption of data.</span></span> <span data-ttu-id="64e56-197">Se tuttavia si prevede di usare lo stesso file di configurazione crittografato in più server, ad esempio una Web farm, solo `RsaProtectedConfigurationProvider` consente di esportare le chiavi di crittografia usate per crittografare i dati e importarle in un altro server.</span><span class="sxs-lookup"><span data-stu-id="64e56-197">However, if you are planning to use the same encrypted configuration file on multiple servers, such as a Web farm, only the `RsaProtectedConfigurationProvider` enables you to export the encryption keys used to encrypt the data and import them on another server.</span></span> <span data-ttu-id="64e56-198">Per ulteriori informazioni, vedere [importazione ed esportazione protetto configurazione contenitori di chiavi RSA](http://msdn.microsoft.com/library/f3022b39-f17f-48c1-b067-025eab0ce8bc).</span><span class="sxs-lookup"><span data-stu-id="64e56-198">For more information, see [Importing and Exporting Protected Configuration RSA Key Containers](http://msdn.microsoft.com/library/f3022b39-f17f-48c1-b067-025eab0ce8bc).</span></span>  
  
### <a name="using-the-configuration-classes"></a><span data-ttu-id="64e56-199">Utilizzo delle classi di configurazione</span><span class="sxs-lookup"><span data-stu-id="64e56-199">Using the Configuration Classes</span></span>  
 <span data-ttu-id="64e56-200">Lo spazio dei nomi <xref:System.Configuration> fornisce classi per specificare le impostazioni di configurazione a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="64e56-200">The <xref:System.Configuration> namespace provides classes to work with configuration settings programmatically.</span></span> <span data-ttu-id="64e56-201">La classe <xref:System.Configuration.ConfigurationManager> fornisce accesso a file di configurazione del computer, dell'applicazione e dell'utente.</span><span class="sxs-lookup"><span data-stu-id="64e56-201">The <xref:System.Configuration.ConfigurationManager> class provides access to machine, application, and user configuration files.</span></span> <span data-ttu-id="64e56-202">Se si sta creando un'applicazione ASP.NET, è possibile utilizzare il <xref:System.Web.Configuration.WebConfigurationManager> (classe), che fornisce la stessa funzionalità mentre permette di accedere alle impostazioni che sono univoche per le applicazioni ASP.NET, ad esempio quelli trovati  **\< System. Web >**.</span><span class="sxs-lookup"><span data-stu-id="64e56-202">If you are creating an ASP.NET application, you can use the <xref:System.Web.Configuration.WebConfigurationManager> class, which provides the same functionality while also allowing you to access settings that are unique to ASP.NET applications, such as those found in **\<system.web>**.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="64e56-203">Lo spazio dei nomi <xref:System.Security.Cryptography> contiene classi che forniscono opzioni aggiuntive per la crittografia e la decrittografia dei dati.</span><span class="sxs-lookup"><span data-stu-id="64e56-203">The <xref:System.Security.Cryptography> namespace contains classes that provide additional options for encrypting and decrypting data.</span></span> <span data-ttu-id="64e56-204">Usare queste classi se si richiedono servizi di crittografia che non sono disponibili tramite configurazione protetta.</span><span class="sxs-lookup"><span data-stu-id="64e56-204">Use these classes if you require cryptographic services that are not available using protected configuration.</span></span> <span data-ttu-id="64e56-205">In alcuni casi si tratta di wrapper presenti nelle CryptoAPI di Microsoft non gestite, in altri semplicemente di implementazioni gestite.</span><span class="sxs-lookup"><span data-stu-id="64e56-205">Some of these classes are wrappers for the unmanaged Microsoft CryptoAPI, while others are purely managed implementations.</span></span> <span data-ttu-id="64e56-206">Per altre informazioni, vedere [Servizi di crittografia](http://msdn.microsoft.com/en-us/68a1e844-c63c-44af-9247-f6716eb23781).</span><span class="sxs-lookup"><span data-stu-id="64e56-206">For more information, see [Cryptographic Services](http://msdn.microsoft.com/en-us/68a1e844-c63c-44af-9247-f6716eb23781).</span></span>  
  
### <a name="appconfig-example"></a><span data-ttu-id="64e56-207">Esempio di App.config</span><span class="sxs-lookup"><span data-stu-id="64e56-207">App.config Example</span></span>  
 <span data-ttu-id="64e56-208">In questo esempio viene illustrato come attivare o disattivare la crittografia di **connectionStrings** sezione un **app** file per un'applicazione Windows.</span><span class="sxs-lookup"><span data-stu-id="64e56-208">This example demonstrates how to toggle encrypting the **connectionStrings** section in an **app.config** file for a Windows application.</span></span> <span data-ttu-id="64e56-209">La procedura assume il nome dell'applicazione come argomento, ad esempio "MyApplication.exe".</span><span class="sxs-lookup"><span data-stu-id="64e56-209">In this example, the procedure takes the name of the application as an argument, for example, "MyApplication.exe".</span></span> <span data-ttu-id="64e56-210">Il **app** file verrà quindi crittografato e copiato nella cartella che contiene il file eseguibile con il nome "MyApplication.exe".</span><span class="sxs-lookup"><span data-stu-id="64e56-210">The **app.config** file will then be encrypted and copied to the folder that contains the executable under the name of "MyApplication.exe.config".</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="64e56-211">La stringa di connessione può essere decrittografata solo nel computer in cui è stata crittografata.</span><span class="sxs-lookup"><span data-stu-id="64e56-211">The connection string can only be decrypted on the computer on which it was encrypted.</span></span>  
  
 <span data-ttu-id="64e56-212">Il codice Usa il <xref:System.Configuration.ConfigurationManager.OpenExeConfiguration%2A> per aprire la **app. config** file per la modifica e <xref:System.Configuration.ConfigurationManager.GetSection%2A> metodo restituisce il **connectionStrings** sezione.</span><span class="sxs-lookup"><span data-stu-id="64e56-212">The code uses the <xref:System.Configuration.ConfigurationManager.OpenExeConfiguration%2A> method to open the **app.config** file for editing, and the <xref:System.Configuration.ConfigurationManager.GetSection%2A> method returns the **connectionStrings** section.</span></span> <span data-ttu-id="64e56-213">Viene quindi controllata la proprietà <xref:System.Configuration.SectionInformation.IsProtected%2A>, con una chiamata a <xref:System.Configuration.SectionInformation.ProtectSection%2A> per crittografare la sezione, se non è crittografata.</span><span class="sxs-lookup"><span data-stu-id="64e56-213">The code then checks the <xref:System.Configuration.SectionInformation.IsProtected%2A> property, calling the <xref:System.Configuration.SectionInformation.ProtectSection%2A> to encrypt the section if it is not encrypted.</span></span> <span data-ttu-id="64e56-214">Il metodo <xref:System.Configuration.SectionInformation.UnprotectSection%2A> viene richiamato per decrittografare la sezione.</span><span class="sxs-lookup"><span data-stu-id="64e56-214">The <xref:System.Configuration.SectionInformation.UnprotectSection%2A> method is invoked to decrypt the section.</span></span> <span data-ttu-id="64e56-215">Il metodo <xref:System.Configuration.Configuration.Save%2A> completa l'operazione e salva le modifiche.</span><span class="sxs-lookup"><span data-stu-id="64e56-215">The <xref:System.Configuration.Configuration.Save%2A> method completes the operation and saves the changes.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="64e56-216">È necessario impostare un riferimento a `System.Configuration.dll` nel progetto affinché il codice venga eseguito.</span><span class="sxs-lookup"><span data-stu-id="64e56-216">You must set a reference to `System.Configuration.dll` in your project for the code to run.</span></span>  
  
 [!code-csharp[DataWorks ConnectionStrings.Encrypt#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStrings.Encrypt/CS/source.cs#1)]
 [!code-vb[DataWorks ConnectionStrings.Encrypt#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStrings.Encrypt/VB/source.vb#1)]  
  
### <a name="webconfig-example"></a><span data-ttu-id="64e56-217">Esempio di Web.config</span><span class="sxs-lookup"><span data-stu-id="64e56-217">Web.config Example</span></span>  
 <span data-ttu-id="64e56-218">In questo esempio viene usato il metodo <xref:System.Web.Configuration.WebConfigurationManager.OpenWebConfiguration%2A> di `WebConfigurationManager`.</span><span class="sxs-lookup"><span data-stu-id="64e56-218">This example uses the <xref:System.Web.Configuration.WebConfigurationManager.OpenWebConfiguration%2A> method of the `WebConfigurationManager`.</span></span> <span data-ttu-id="64e56-219">Si noti che in questo caso è possibile specificare il percorso relativo di **Web. config** file usando una tilde.</span><span class="sxs-lookup"><span data-stu-id="64e56-219">Note that in this case you can supply the relative path to the **Web.config** file by using a tilde.</span></span> <span data-ttu-id="64e56-220">Il codice richiede un riferimento alla classe `System.Web.Configuration`.</span><span class="sxs-lookup"><span data-stu-id="64e56-220">The code requires a reference to the `System.Web.Configuration` class.</span></span>  
  
 [!code-csharp[DataWorks ConnectionStringsWeb.Encrypt#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStringsWeb.Encrypt/CS/source.cs#1)]
 [!code-vb[DataWorks ConnectionStringsWeb.Encrypt#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStringsWeb.Encrypt/VB/source.vb#1)]  
  
 <span data-ttu-id="64e56-221">Per altre informazioni di protezione delle applicazioni ASP.NET, vedere [NIB: sicurezza ASP.NET](http://msdn.microsoft.com/en-us/04b37532-18d9-40b4-8e5f-ee09a70b311d) e [consigliate per la sicurezza ASP.NET 2.0 a colpo d'occhio](http://go.microsoft.com/fwlink/?LinkId=59997) in ASP.NET Developer Center.</span><span class="sxs-lookup"><span data-stu-id="64e56-221">For more information securing ASP.NET applications, see [NIB: ASP.NET Security](http://msdn.microsoft.com/en-us/04b37532-18d9-40b4-8e5f-ee09a70b311d) and [ASP.NET 2.0 Security Practices at a Glance](http://go.microsoft.com/fwlink/?LinkId=59997) on the ASP.NET Developer Center.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="64e56-222">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="64e56-222">See Also</span></span>  
 [<span data-ttu-id="64e56-223">Generatori di stringhe di connessione</span><span class="sxs-lookup"><span data-stu-id="64e56-223">Connection String Builders</span></span>](../../../../docs/framework/data/adonet/connection-string-builders.md)  
 [<span data-ttu-id="64e56-224">Protezione delle informazioni di connessione</span><span class="sxs-lookup"><span data-stu-id="64e56-224">Protecting Connection Information</span></span>](../../../../docs/framework/data/adonet/protecting-connection-information.md)  
 [<span data-ttu-id="64e56-225">Utilizzo delle classi di configurazione</span><span class="sxs-lookup"><span data-stu-id="64e56-225">Using the Configuration Classes</span></span>](http://msdn.microsoft.com/library/98d2b386-baf6-4a17-974b-76e3b4c87acc)  
 [<span data-ttu-id="64e56-226">Configurazione di applicazioni</span><span class="sxs-lookup"><span data-stu-id="64e56-226">Configuring Apps</span></span>](../../../../docs/framework/configure-apps/index.md)  
 [<span data-ttu-id="64e56-227">Amministrazione sito Web ASP.NET</span><span class="sxs-lookup"><span data-stu-id="64e56-227">ASP.NET Web Site Administration</span></span>](http://msdn.microsoft.com/library/1298034b-5f7d-464d-abd1-ad9e6b3eeb7e)  
 [<span data-ttu-id="64e56-228">Provider gestiti ADO.NET e Centro per sviluppatori di set di dati</span><span class="sxs-lookup"><span data-stu-id="64e56-228">ADO.NET Managed Providers and DataSet Developer Center</span></span>](http://go.microsoft.com/fwlink/?LinkId=217917)
