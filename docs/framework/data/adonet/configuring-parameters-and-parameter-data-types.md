---
title: Configurazione dei parametri e tipi di dati dei parametri
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 537d8a2c-d40b-4000-83eb-bc1fcc93f707
ms.openlocfilehash: 320a45af1c2f3b460c23d8320c456120643902f7
ms.sourcegitcommit: 11f11ca6cefe555972b3a5c99729d1a7523d8f50
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/03/2018
---
# <a name="configuring-parameters-and-parameter-data-types"></a><span data-ttu-id="4dbf8-102">Configurazione dei parametri e tipi di dati dei parametri</span><span class="sxs-lookup"><span data-stu-id="4dbf8-102">Configuring Parameters and Parameter Data Types</span></span>
<span data-ttu-id="4dbf8-103">Gli oggetti comando usano i parametri per passare valori a istruzioni o stored procedure SQL, fornendo la verifica e la convalida dei tipi.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-103">Command objects use parameters to pass values to SQL statements or stored procedures, providing type checking and validation.</span></span> <span data-ttu-id="4dbf8-104">A differenza del testo dei comandi, l'input dei parametri viene trattato come valore letterale, non come codice eseguibile.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-104">Unlike command text, parameter input is treated as a literal value, not as executable code.</span></span> <span data-ttu-id="4dbf8-105">In questo modo è possibile difendersi da attacchi SQL injection, in cui l'autore di un attacco inserisce un comando che compromette la sicurezza del server in un'istruzione SQL.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-105">This helps guard against "SQL injection" attacks, in which an attacker inserts a command that compromises security on the server into an SQL statement.</span></span>  
  
 <span data-ttu-id="4dbf8-106">I comandi con parametri possono anche migliorare le prestazioni di esecuzione delle query in quanto aiutano il server database a ottenere una corrispondenza accurata tra il comando in arrivo e un piano di query memorizzato nella cache appropriato.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-106">Parameterized commands can also improve query execution performance, because they help the database server accurately match the incoming command with a proper cached query plan.</span></span> <span data-ttu-id="4dbf8-107">Per altre informazioni, vedere [Memorizzazione nella cache e riutilizzo del piano di esecuzione](http://go.microsoft.com/fwlink/?LinkId=120424) e [Parametri e riutilizzo del piano di esecuzione](http://go.microsoft.com/fwlink/?LinkId=120423) nella documentazione online di SQL Server.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-107">For more information, see [Execution Plan Caching and Reuse](http://go.microsoft.com/fwlink/?LinkId=120424) and [Parameters and Execution Plan Reuse](http://go.microsoft.com/fwlink/?LinkId=120423) in SQL Server Books Online.</span></span> <span data-ttu-id="4dbf8-108">Oltre ai vantaggi in termini di sicurezza e prestazioni, i comandi con parametri offrono un metodo pratico per organizzare i valori passati a un'origine dati.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-108">In addition to the security and performance benefits, parameterized commands provide a convenient method for organizing values passed to a data source.</span></span>  
  
 <span data-ttu-id="4dbf8-109">Per creare un oggetto <xref:System.Data.Common.DbParameter> , è possibile usare il relativo costruttore o aggiungerlo all'oggetto <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> chiamando il metodo `Add` della raccolta <xref:System.Data.Common.DbParameterCollection> .</span><span class="sxs-lookup"><span data-stu-id="4dbf8-109">A <xref:System.Data.Common.DbParameter> object can be created by using its constructor, or by adding it to the <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> by calling the `Add` method of the <xref:System.Data.Common.DbParameterCollection> collection.</span></span> <span data-ttu-id="4dbf8-110">Il metodo `Add` accetta come input argomenti del costruttore o un oggetto parametro esistente, a seconda del provider di dati.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-110">The `Add` method will take as input either constructor arguments or an existing parameter object, depending on the data provider.</span></span>  
  
## <a name="supplying-the-parameterdirection-property"></a><span data-ttu-id="4dbf8-111">Specifica della proprietà ParameterDirection</span><span class="sxs-lookup"><span data-stu-id="4dbf8-111">Supplying the ParameterDirection Property</span></span>  
 <span data-ttu-id="4dbf8-112">Quando si aggiungono parametri, è necessario fornire una proprietà <xref:System.Data.ParameterDirection> per i parametri diversi da quelli di input.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-112">When adding parameters, you must supply a <xref:System.Data.ParameterDirection> property for parameters other than input parameters.</span></span> <span data-ttu-id="4dbf8-113">La tabella seguente illustra i valori `ParameterDirection` che è possibile usare con l'enumerazione <xref:System.Data.ParameterDirection> .</span><span class="sxs-lookup"><span data-stu-id="4dbf8-113">The following table shows the `ParameterDirection` values that you can use with the <xref:System.Data.ParameterDirection> enumeration.</span></span>  
  
|<span data-ttu-id="4dbf8-114">Nome del membro</span><span class="sxs-lookup"><span data-stu-id="4dbf8-114">Member name</span></span>|<span data-ttu-id="4dbf8-115">Descrizione</span><span class="sxs-lookup"><span data-stu-id="4dbf8-115">Description</span></span>|  
|-----------------|-----------------|  
|<xref:System.Data.ParameterDirection.Input>|<span data-ttu-id="4dbf8-116">Il parametro è un parametro di input.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-116">The parameter is an input parameter.</span></span> <span data-ttu-id="4dbf8-117">Questa è l'impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-117">This is the default.</span></span>|  
|<xref:System.Data.ParameterDirection.InputOutput>|<span data-ttu-id="4dbf8-118">Il parametro può essere sia di input che di output.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-118">The parameter can perform both input and output.</span></span>|  
|<xref:System.Data.ParameterDirection.Output>|<span data-ttu-id="4dbf8-119">Il parametro è un parametro di output.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-119">The parameter is an output parameter.</span></span>|  
|<xref:System.Data.ParameterDirection.ReturnValue>|<span data-ttu-id="4dbf8-120">Il parametro rappresenta un valore restituito da un'operazione quale una stored procedure, una funzione predefinita o una funzione definita dall'utente.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-120">The parameter represents a return value from an operation such as a stored procedure, built-in function, or user-defined function.</span></span>|  
  
## <a name="working-with-parameter-placeholders"></a><span data-ttu-id="4dbf8-121">Utilizzo dei segnaposto di parametri</span><span class="sxs-lookup"><span data-stu-id="4dbf8-121">Working with Parameter Placeholders</span></span>  
 <span data-ttu-id="4dbf8-122">La sintassi per i segnaposto dei parametri varia in base all'origine dati.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-122">The syntax for parameter placeholders depends on the data source.</span></span> <span data-ttu-id="4dbf8-123">I provider di dati [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] gestiscono in modo diverso la denominazione e la specifica di parametri e segnaposto di parametri.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-123">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data providers handle naming and specifying parameters and parameter placeholders differently.</span></span> <span data-ttu-id="4dbf8-124">Questa sintassi è personalizzata in base a un'origine dati specifica, come descritto nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-124">This syntax is customized to a specific data source, as described in the following table.</span></span>  
  
|<span data-ttu-id="4dbf8-125">Provider di dati</span><span class="sxs-lookup"><span data-stu-id="4dbf8-125">Data provider</span></span>|<span data-ttu-id="4dbf8-126">Sintassi di denominazione di parametri</span><span class="sxs-lookup"><span data-stu-id="4dbf8-126">Parameter naming syntax</span></span>|  
|-------------------|-----------------------------|  
|<xref:System.Data.SqlClient>|<span data-ttu-id="4dbf8-127">Usa parametri denominati nel formato `@`*nomeparametro*.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-127">Uses named parameters in the format `@`*parametername*.</span></span>|  
|<xref:System.Data.OleDb>|<span data-ttu-id="4dbf8-128">Usa marcatori dei parametri di posizione indicati da un punto interrogativo (`?`).</span><span class="sxs-lookup"><span data-stu-id="4dbf8-128">Uses positional parameter markers indicated by a question mark (`?`).</span></span>|  
|<xref:System.Data.Odbc>|<span data-ttu-id="4dbf8-129">Usa marcatori dei parametri di posizione indicati da un punto interrogativo (`?`).</span><span class="sxs-lookup"><span data-stu-id="4dbf8-129">Uses positional parameter markers indicated by a question mark (`?`).</span></span>|  
|<xref:System.Data.OracleClient>|<span data-ttu-id="4dbf8-130">Usa parametri denominati nel formato `:`*parmname* (o *parmname*).</span><span class="sxs-lookup"><span data-stu-id="4dbf8-130">Uses named parameters in the format `:`*parmname* (or *parmname*).</span></span>|  
  
## <a name="specifying-parameter-data-types"></a><span data-ttu-id="4dbf8-131">Specifica di un tipo di dati per i parametri</span><span class="sxs-lookup"><span data-stu-id="4dbf8-131">Specifying Parameter Data Types</span></span>  
 <span data-ttu-id="4dbf8-132">Il tipo di dati di un parametro è specifico del provider di dati [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="4dbf8-132">The data type of a parameter is specific to the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider.</span></span> <span data-ttu-id="4dbf8-133">Se si specifica il tipo, il valore dell'oggetto `Parameter` viene convertito nel tipo del provider di dati [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] prima che il valore venga passato all'origine dati.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-133">Specifying the type converts the value of the `Parameter` to the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider type before passing the value to the data source.</span></span> <span data-ttu-id="4dbf8-134">È inoltre possibile specificare il tipo di un oggetto `Parameter` in modo generico impostando la proprietà `DbType` dell'oggetto `Parameter` su un determinato oggetto <xref:System.Data.DbType>.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-134">You may also specify the type of a `Parameter` in a generic manner by setting the `DbType` property of the `Parameter` object to a particular <xref:System.Data.DbType>.</span></span>  
  
 <span data-ttu-id="4dbf8-135">Il tipo del provider di dati [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] di un oggetto `Parameter` viene inferito dal tipo [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] di `Value` dell'oggetto `Parameter` oppure da `DbType` dell'oggetto `Parameter` .</span><span class="sxs-lookup"><span data-stu-id="4dbf8-135">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider type of a `Parameter` object is inferred from the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] type of the `Value` of the `Parameter` object, or from the `DbType` of the `Parameter` object.</span></span> <span data-ttu-id="4dbf8-136">La tabella seguente illustra il tipo `Parameter` dedotto in base all'oggetto passato come valore di `Parameter` o all'oggetto `DbType`specificato.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-136">The following table shows the inferred `Parameter` type based on the object passed as the `Parameter` value or the specified `DbType`.</span></span>  
  
|<span data-ttu-id="4dbf8-137">Tipo .NET Framework</span><span class="sxs-lookup"><span data-stu-id="4dbf8-137">.NET Framework type</span></span>|<span data-ttu-id="4dbf8-138">DbType</span><span class="sxs-lookup"><span data-stu-id="4dbf8-138">DbType</span></span>|<span data-ttu-id="4dbf8-139">SqlDbType</span><span class="sxs-lookup"><span data-stu-id="4dbf8-139">SqlDbType</span></span>|<span data-ttu-id="4dbf8-140">OleDbType</span><span class="sxs-lookup"><span data-stu-id="4dbf8-140">OleDbType</span></span>|<span data-ttu-id="4dbf8-141">OdbcType</span><span class="sxs-lookup"><span data-stu-id="4dbf8-141">OdbcType</span></span>|<span data-ttu-id="4dbf8-142">OracleType</span><span class="sxs-lookup"><span data-stu-id="4dbf8-142">OracleType</span></span>|  
|-------------------------|------------|---------------|---------------|--------------|----------------|  
|<xref:System.Boolean>|<span data-ttu-id="4dbf8-143">Boolean</span><span class="sxs-lookup"><span data-stu-id="4dbf8-143">Boolean</span></span>|<span data-ttu-id="4dbf8-144">Bit</span><span class="sxs-lookup"><span data-stu-id="4dbf8-144">Bit</span></span>|<span data-ttu-id="4dbf8-145">Booleano</span><span class="sxs-lookup"><span data-stu-id="4dbf8-145">Boolean</span></span>|<span data-ttu-id="4dbf8-146">Bit</span><span class="sxs-lookup"><span data-stu-id="4dbf8-146">Bit</span></span>|<span data-ttu-id="4dbf8-147">Byte</span><span class="sxs-lookup"><span data-stu-id="4dbf8-147">Byte</span></span>|  
|<xref:System.Byte>|<span data-ttu-id="4dbf8-148">Byte</span><span class="sxs-lookup"><span data-stu-id="4dbf8-148">Byte</span></span>|<span data-ttu-id="4dbf8-149">TinyInt</span><span class="sxs-lookup"><span data-stu-id="4dbf8-149">TinyInt</span></span>|<span data-ttu-id="4dbf8-150">UnsignedTinyInt</span><span class="sxs-lookup"><span data-stu-id="4dbf8-150">UnsignedTinyInt</span></span>|<span data-ttu-id="4dbf8-151">TinyInt</span><span class="sxs-lookup"><span data-stu-id="4dbf8-151">TinyInt</span></span>|<span data-ttu-id="4dbf8-152">Byte</span><span class="sxs-lookup"><span data-stu-id="4dbf8-152">Byte</span></span>|  
|<span data-ttu-id="4dbf8-153">byte[]</span><span class="sxs-lookup"><span data-stu-id="4dbf8-153">byte[]</span></span>|<span data-ttu-id="4dbf8-154">Binario</span><span class="sxs-lookup"><span data-stu-id="4dbf8-154">Binary</span></span>|<span data-ttu-id="4dbf8-155">VarBinary`.` la conversione implicita non riesce se la matrice di byte è più grande rispetto alla dimensione massima di VarBinary, che è di 8000 byte. Per le matrici di byte maggiori di 8000 byte, impostare in modo esplicito il <xref:System.Data.SqlDbType>.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-155">VarBinary`.` This implicit conversion will fail if the byte array is larger than the maximum size of a VarBinary, which is 8000 bytes.For byte arrays larger than 8000 bytes, explicitly set the <xref:System.Data.SqlDbType>.</span></span>|<span data-ttu-id="4dbf8-156">VarBinary</span><span class="sxs-lookup"><span data-stu-id="4dbf8-156">VarBinary</span></span>|<span data-ttu-id="4dbf8-157">Binario</span><span class="sxs-lookup"><span data-stu-id="4dbf8-157">Binary</span></span>|<span data-ttu-id="4dbf8-158">Raw</span><span class="sxs-lookup"><span data-stu-id="4dbf8-158">Raw</span></span>|  
|<xref:System.Char>|``|<span data-ttu-id="4dbf8-159">L'inferenza di un oggetto <xref:System.Data.SqlDbType> da char non è supportata.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-159">Inferring a <xref:System.Data.SqlDbType> from char is not supported.</span></span>|<span data-ttu-id="4dbf8-160">Char</span><span class="sxs-lookup"><span data-stu-id="4dbf8-160">Char</span></span>|<span data-ttu-id="4dbf8-161">Char</span><span class="sxs-lookup"><span data-stu-id="4dbf8-161">Char</span></span>|<span data-ttu-id="4dbf8-162">Byte</span><span class="sxs-lookup"><span data-stu-id="4dbf8-162">Byte</span></span>|  
|<xref:System.DateTime>|<span data-ttu-id="4dbf8-163">DateTime</span><span class="sxs-lookup"><span data-stu-id="4dbf8-163">DateTime</span></span>|<span data-ttu-id="4dbf8-164">DateTime</span><span class="sxs-lookup"><span data-stu-id="4dbf8-164">DateTime</span></span>|<span data-ttu-id="4dbf8-165">DBTimeStamp</span><span class="sxs-lookup"><span data-stu-id="4dbf8-165">DBTimeStamp</span></span>|<span data-ttu-id="4dbf8-166">DateTime</span><span class="sxs-lookup"><span data-stu-id="4dbf8-166">DateTime</span></span>|<span data-ttu-id="4dbf8-167">DateTime</span><span class="sxs-lookup"><span data-stu-id="4dbf8-167">DateTime</span></span>|  
|<xref:System.DateTimeOffset>|<span data-ttu-id="4dbf8-168">DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="4dbf8-168">DateTimeOffset</span></span>|<span data-ttu-id="4dbf8-169">DateTimeOffset in SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-169">DateTimeOffset in SQL Server 2008.</span></span> <span data-ttu-id="4dbf8-170">L'inferenza di un oggetto <xref:System.Data.SqlDbType> da DateTimeOffset non è supportata nelle versioni di SQL Server precedenti a SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-170">Inferring a <xref:System.Data.SqlDbType> from DateTimeOffset is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|||<span data-ttu-id="4dbf8-171">DateTime</span><span class="sxs-lookup"><span data-stu-id="4dbf8-171">DateTime</span></span>|  
|<xref:System.Decimal>|<span data-ttu-id="4dbf8-172">Decimal</span><span class="sxs-lookup"><span data-stu-id="4dbf8-172">Decimal</span></span>|<span data-ttu-id="4dbf8-173">Decimal</span><span class="sxs-lookup"><span data-stu-id="4dbf8-173">Decimal</span></span>|<span data-ttu-id="4dbf8-174">Decimal</span><span class="sxs-lookup"><span data-stu-id="4dbf8-174">Decimal</span></span>|<span data-ttu-id="4dbf8-175">Numerico</span><span class="sxs-lookup"><span data-stu-id="4dbf8-175">Numeric</span></span>|<span data-ttu-id="4dbf8-176">Numero</span><span class="sxs-lookup"><span data-stu-id="4dbf8-176">Number</span></span>|  
|<xref:System.Double>|<span data-ttu-id="4dbf8-177">Double</span><span class="sxs-lookup"><span data-stu-id="4dbf8-177">Double</span></span>|<span data-ttu-id="4dbf8-178">Float</span><span class="sxs-lookup"><span data-stu-id="4dbf8-178">Float</span></span>|<span data-ttu-id="4dbf8-179">Double</span><span class="sxs-lookup"><span data-stu-id="4dbf8-179">Double</span></span>|<span data-ttu-id="4dbf8-180">Double</span><span class="sxs-lookup"><span data-stu-id="4dbf8-180">Double</span></span>|<span data-ttu-id="4dbf8-181">Double</span><span class="sxs-lookup"><span data-stu-id="4dbf8-181">Double</span></span>|  
|<xref:System.Single>|<span data-ttu-id="4dbf8-182">Single</span><span class="sxs-lookup"><span data-stu-id="4dbf8-182">Single</span></span>|<span data-ttu-id="4dbf8-183">Real</span><span class="sxs-lookup"><span data-stu-id="4dbf8-183">Real</span></span>|<span data-ttu-id="4dbf8-184">Single</span><span class="sxs-lookup"><span data-stu-id="4dbf8-184">Single</span></span>|<span data-ttu-id="4dbf8-185">Real</span><span class="sxs-lookup"><span data-stu-id="4dbf8-185">Real</span></span>|<span data-ttu-id="4dbf8-186">Float</span><span class="sxs-lookup"><span data-stu-id="4dbf8-186">Float</span></span>|  
|<xref:System.Guid>|<span data-ttu-id="4dbf8-187">Guid</span><span class="sxs-lookup"><span data-stu-id="4dbf8-187">Guid</span></span>|<span data-ttu-id="4dbf8-188">UniqueIdentifier</span><span class="sxs-lookup"><span data-stu-id="4dbf8-188">UniqueIdentifier</span></span>|<span data-ttu-id="4dbf8-189">Guid</span><span class="sxs-lookup"><span data-stu-id="4dbf8-189">Guid</span></span>|<span data-ttu-id="4dbf8-190">UniqueIdentifier</span><span class="sxs-lookup"><span data-stu-id="4dbf8-190">UniqueIdentifier</span></span>|<span data-ttu-id="4dbf8-191">Raw</span><span class="sxs-lookup"><span data-stu-id="4dbf8-191">Raw</span></span>|  
|<xref:System.Int16 >|<span data-ttu-id="4dbf8-192">Int16</span><span class="sxs-lookup"><span data-stu-id="4dbf8-192">Int16</span></span>|<span data-ttu-id="4dbf8-193">SmallInt</span><span class="sxs-lookup"><span data-stu-id="4dbf8-193">SmallInt</span></span>|<span data-ttu-id="4dbf8-194">SmallInt</span><span class="sxs-lookup"><span data-stu-id="4dbf8-194">SmallInt</span></span>|<span data-ttu-id="4dbf8-195">SmallInt</span><span class="sxs-lookup"><span data-stu-id="4dbf8-195">SmallInt</span></span>|<span data-ttu-id="4dbf8-196">Int16</span><span class="sxs-lookup"><span data-stu-id="4dbf8-196">Int16</span></span>|  
|<xref:System.Int32>|<span data-ttu-id="4dbf8-197">Int32</span><span class="sxs-lookup"><span data-stu-id="4dbf8-197">Int32</span></span>|<span data-ttu-id="4dbf8-198">Int</span><span class="sxs-lookup"><span data-stu-id="4dbf8-198">Int</span></span>|<span data-ttu-id="4dbf8-199">Int</span><span class="sxs-lookup"><span data-stu-id="4dbf8-199">Int</span></span>|<span data-ttu-id="4dbf8-200">Int</span><span class="sxs-lookup"><span data-stu-id="4dbf8-200">Int</span></span>|<span data-ttu-id="4dbf8-201">Int32</span><span class="sxs-lookup"><span data-stu-id="4dbf8-201">Int32</span></span>|  
|<xref:System.Int64>|<span data-ttu-id="4dbf8-202">Int64</span><span class="sxs-lookup"><span data-stu-id="4dbf8-202">Int64</span></span>|<span data-ttu-id="4dbf8-203">BigInt</span><span class="sxs-lookup"><span data-stu-id="4dbf8-203">BigInt</span></span>|<span data-ttu-id="4dbf8-204">BigInt</span><span class="sxs-lookup"><span data-stu-id="4dbf8-204">BigInt</span></span>|<span data-ttu-id="4dbf8-205">BigInt</span><span class="sxs-lookup"><span data-stu-id="4dbf8-205">BigInt</span></span>|<span data-ttu-id="4dbf8-206">Numero</span><span class="sxs-lookup"><span data-stu-id="4dbf8-206">Number</span></span>|  
|<xref:System.Object>|<span data-ttu-id="4dbf8-207">Oggetto</span><span class="sxs-lookup"><span data-stu-id="4dbf8-207">Object</span></span>|<span data-ttu-id="4dbf8-208">Variante</span><span class="sxs-lookup"><span data-stu-id="4dbf8-208">Variant</span></span>|<span data-ttu-id="4dbf8-209">Variante</span><span class="sxs-lookup"><span data-stu-id="4dbf8-209">Variant</span></span>|<span data-ttu-id="4dbf8-210">L'inferenza di un oggetto OdbcType da Object non è supportata.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-210">Inferring an OdbcType from Object is not supported.</span></span>|<span data-ttu-id="4dbf8-211">Blob</span><span class="sxs-lookup"><span data-stu-id="4dbf8-211">Blob</span></span>|  
|<xref:System.String>|<span data-ttu-id="4dbf8-212">String</span><span class="sxs-lookup"><span data-stu-id="4dbf8-212">String</span></span>|<span data-ttu-id="4dbf8-213">NVarChar.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-213">NVarChar.</span></span> <span data-ttu-id="4dbf8-214">La conversione implicita non riesce se la stringa ha una dimensione superiore a quella massima di NVarChar, che è di 4000 caratteri.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-214">This implicit conversion will fail if the string is larger than the maximum size of an NVarChar, which is 4000 characters.</span></span> <span data-ttu-id="4dbf8-215">Per le stringhe maggiori di 4000 caratteri, impostare in modo esplicito <xref:System.Data.SqlDbType>.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-215">For strings larger than 4000 characters, explicitly set the <xref:System.Data.SqlDbType>.</span></span>|<span data-ttu-id="4dbf8-216">VarWChar</span><span class="sxs-lookup"><span data-stu-id="4dbf8-216">VarWChar</span></span>|<span data-ttu-id="4dbf8-217">NVarChar</span><span class="sxs-lookup"><span data-stu-id="4dbf8-217">NVarChar</span></span>|<span data-ttu-id="4dbf8-218">NVarChar</span><span class="sxs-lookup"><span data-stu-id="4dbf8-218">NVarChar</span></span>|  
|<xref:System.TimeSpan>|<span data-ttu-id="4dbf8-219">Time</span><span class="sxs-lookup"><span data-stu-id="4dbf8-219">Time</span></span>|<span data-ttu-id="4dbf8-220">Time in SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-220">Time in SQL Server 2008.</span></span> <span data-ttu-id="4dbf8-221">L'inferenza di un oggetto <xref:System.Data.SqlDbType> da TimeSpan non è supportata nelle versioni di SQL Server precedenti a SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-221">Inferring a <xref:System.Data.SqlDbType> from TimeSpan is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="4dbf8-222">DBTime</span><span class="sxs-lookup"><span data-stu-id="4dbf8-222">DBTime</span></span>|<span data-ttu-id="4dbf8-223">Time</span><span class="sxs-lookup"><span data-stu-id="4dbf8-223">Time</span></span>|<span data-ttu-id="4dbf8-224">DateTime</span><span class="sxs-lookup"><span data-stu-id="4dbf8-224">DateTime</span></span>|  
|<xref:System.UInt16>|<span data-ttu-id="4dbf8-225">UInt16</span><span class="sxs-lookup"><span data-stu-id="4dbf8-225">UInt16</span></span>|<span data-ttu-id="4dbf8-226">L'inferenza di un oggetto <xref:System.Data.SqlDbType> da UInt16 non è supportata.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-226">Inferring a <xref:System.Data.SqlDbType> from UInt16 is not supported.</span></span>|<span data-ttu-id="4dbf8-227">UnsignedSmallInt</span><span class="sxs-lookup"><span data-stu-id="4dbf8-227">UnsignedSmallInt</span></span>|<span data-ttu-id="4dbf8-228">Int</span><span class="sxs-lookup"><span data-stu-id="4dbf8-228">Int</span></span>|<span data-ttu-id="4dbf8-229">UInt16</span><span class="sxs-lookup"><span data-stu-id="4dbf8-229">UInt16</span></span>|  
|<xref:System.UInt32>|<span data-ttu-id="4dbf8-230">UInt32</span><span class="sxs-lookup"><span data-stu-id="4dbf8-230">UInt32</span></span>|<span data-ttu-id="4dbf8-231">L'inferenza di un oggetto <xref:System.Data.SqlDbType> da UInt32 non è supportata.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-231">Inferring a <xref:System.Data.SqlDbType> from UInt32 is not supported.</span></span>|<span data-ttu-id="4dbf8-232">UnsignedInt</span><span class="sxs-lookup"><span data-stu-id="4dbf8-232">UnsignedInt</span></span>|<span data-ttu-id="4dbf8-233">BigInt</span><span class="sxs-lookup"><span data-stu-id="4dbf8-233">BigInt</span></span>|<span data-ttu-id="4dbf8-234">UInt32</span><span class="sxs-lookup"><span data-stu-id="4dbf8-234">UInt32</span></span>|  
|<xref:System.UInt64>|<span data-ttu-id="4dbf8-235">UInt64</span><span class="sxs-lookup"><span data-stu-id="4dbf8-235">UInt64</span></span>|<span data-ttu-id="4dbf8-236">L'inferenza di un oggetto <xref:System.Data.SqlDbType> da UInt64 non è supportata.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-236">Inferring a <xref:System.Data.SqlDbType> from UInt64 is not supported.</span></span>|<span data-ttu-id="4dbf8-237">UnsignedBigInt</span><span class="sxs-lookup"><span data-stu-id="4dbf8-237">UnsignedBigInt</span></span>|<span data-ttu-id="4dbf8-238">Numerico</span><span class="sxs-lookup"><span data-stu-id="4dbf8-238">Numeric</span></span>|<span data-ttu-id="4dbf8-239">Numero</span><span class="sxs-lookup"><span data-stu-id="4dbf8-239">Number</span></span>|  
||<span data-ttu-id="4dbf8-240">AnsiString</span><span class="sxs-lookup"><span data-stu-id="4dbf8-240">AnsiString</span></span>|<span data-ttu-id="4dbf8-241">VarChar</span><span class="sxs-lookup"><span data-stu-id="4dbf8-241">VarChar</span></span>|<span data-ttu-id="4dbf8-242">VarChar</span><span class="sxs-lookup"><span data-stu-id="4dbf8-242">VarChar</span></span>|<span data-ttu-id="4dbf8-243">VarChar</span><span class="sxs-lookup"><span data-stu-id="4dbf8-243">VarChar</span></span>|<span data-ttu-id="4dbf8-244">VarChar</span><span class="sxs-lookup"><span data-stu-id="4dbf8-244">VarChar</span></span>|  
||<span data-ttu-id="4dbf8-245">AnsiStringFixedLength</span><span class="sxs-lookup"><span data-stu-id="4dbf8-245">AnsiStringFixedLength</span></span>|<span data-ttu-id="4dbf8-246">Char</span><span class="sxs-lookup"><span data-stu-id="4dbf8-246">Char</span></span>|<span data-ttu-id="4dbf8-247">Char</span><span class="sxs-lookup"><span data-stu-id="4dbf8-247">Char</span></span>|<span data-ttu-id="4dbf8-248">Char</span><span class="sxs-lookup"><span data-stu-id="4dbf8-248">Char</span></span>|<span data-ttu-id="4dbf8-249">Char</span><span class="sxs-lookup"><span data-stu-id="4dbf8-249">Char</span></span>|  
|``|<span data-ttu-id="4dbf8-250">Valuta</span><span class="sxs-lookup"><span data-stu-id="4dbf8-250">Currency</span></span>|<span data-ttu-id="4dbf8-251">Money</span><span class="sxs-lookup"><span data-stu-id="4dbf8-251">Money</span></span>|<span data-ttu-id="4dbf8-252">Valuta</span><span class="sxs-lookup"><span data-stu-id="4dbf8-252">Currency</span></span>|<span data-ttu-id="4dbf8-253">L'inferenza di un oggetto `OdbcType` da `Currency` non è supportata.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-253">Inferring an `OdbcType` from `Currency` is not supported.</span></span>|<span data-ttu-id="4dbf8-254">Numero</span><span class="sxs-lookup"><span data-stu-id="4dbf8-254">Number</span></span>|  
|``|<span data-ttu-id="4dbf8-255">Data</span><span class="sxs-lookup"><span data-stu-id="4dbf8-255">Date</span></span>|<span data-ttu-id="4dbf8-256">Date in SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-256">Date in SQL Server 2008.</span></span> <span data-ttu-id="4dbf8-257">L'inferenza di un oggetto <xref:System.Data.SqlDbType> da Date non è supportata nelle versioni di SQL Server precedenti a SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-257">Inferring a <xref:System.Data.SqlDbType> from Date is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="4dbf8-258">DBDate</span><span class="sxs-lookup"><span data-stu-id="4dbf8-258">DBDate</span></span>|<span data-ttu-id="4dbf8-259">Date</span><span class="sxs-lookup"><span data-stu-id="4dbf8-259">Date</span></span>|<span data-ttu-id="4dbf8-260">DateTime</span><span class="sxs-lookup"><span data-stu-id="4dbf8-260">DateTime</span></span>|  
|``|<span data-ttu-id="4dbf8-261">SByte</span><span class="sxs-lookup"><span data-stu-id="4dbf8-261">SByte</span></span>|<span data-ttu-id="4dbf8-262">L'inferenza di un oggetto <xref:System.Data.SqlDbType> da SByte non è supportata.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-262">Inferring a <xref:System.Data.SqlDbType> from SByte is not supported.</span></span>|<span data-ttu-id="4dbf8-263">TinyInt</span><span class="sxs-lookup"><span data-stu-id="4dbf8-263">TinyInt</span></span>|<span data-ttu-id="4dbf8-264">L'inferenza di un oggetto `OdbcType` da SByte non è supportata.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-264">Inferring an `OdbcType` from SByte is not supported.</span></span>|<span data-ttu-id="4dbf8-265">SByte</span><span class="sxs-lookup"><span data-stu-id="4dbf8-265">SByte</span></span>|  
||<span data-ttu-id="4dbf8-266">StringFixedLength</span><span class="sxs-lookup"><span data-stu-id="4dbf8-266">StringFixedLength</span></span>|<span data-ttu-id="4dbf8-267">NChar</span><span class="sxs-lookup"><span data-stu-id="4dbf8-267">NChar</span></span>|<span data-ttu-id="4dbf8-268">WChar</span><span class="sxs-lookup"><span data-stu-id="4dbf8-268">WChar</span></span>|<span data-ttu-id="4dbf8-269">NChar</span><span class="sxs-lookup"><span data-stu-id="4dbf8-269">NChar</span></span>|<span data-ttu-id="4dbf8-270">NChar</span><span class="sxs-lookup"><span data-stu-id="4dbf8-270">NChar</span></span>|  
||<span data-ttu-id="4dbf8-271">Time</span><span class="sxs-lookup"><span data-stu-id="4dbf8-271">Time</span></span>|<span data-ttu-id="4dbf8-272">Time in SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-272">Time in SQL Server 2008.</span></span> <span data-ttu-id="4dbf8-273">L'inferenza di un oggetto <xref:System.Data.SqlDbType> da Time non è supportata nelle versioni di SQL Server precedenti a SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-273">Inferring a <xref:System.Data.SqlDbType> from Time is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="4dbf8-274">DBTime</span><span class="sxs-lookup"><span data-stu-id="4dbf8-274">DBTime</span></span>|<span data-ttu-id="4dbf8-275">Time</span><span class="sxs-lookup"><span data-stu-id="4dbf8-275">Time</span></span>|<span data-ttu-id="4dbf8-276">DateTime</span><span class="sxs-lookup"><span data-stu-id="4dbf8-276">DateTime</span></span>|  
||<span data-ttu-id="4dbf8-277">VarNumeric</span><span class="sxs-lookup"><span data-stu-id="4dbf8-277">VarNumeric</span></span>|<span data-ttu-id="4dbf8-278">L'inferenza di un oggetto <xref:System.Data.SqlDbType> da VarNumeric non è supportata.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-278">Inferring a <xref:System.Data.SqlDbType> from VarNumeric is not supported.</span></span>|<span data-ttu-id="4dbf8-279">VarNumeric</span><span class="sxs-lookup"><span data-stu-id="4dbf8-279">VarNumeric</span></span>|<span data-ttu-id="4dbf8-280">L'inferenza di un oggetto `OdbcType` da VarNumeric non è supportata.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-280">Inferring an `OdbcType` from VarNumeric is not supported.</span></span>|<span data-ttu-id="4dbf8-281">Numero</span><span class="sxs-lookup"><span data-stu-id="4dbf8-281">Number</span></span>|  
|<span data-ttu-id="4dbf8-282">Tipo di oggetto definito dall'utente (oggetto con <xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute></span><span class="sxs-lookup"><span data-stu-id="4dbf8-282">user-defined type (an object with <xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute></span></span>|<span data-ttu-id="4dbf8-283">Object o String, a seconda del provider (SqlClient restituisce sempre Object, ODBC restituisce sempre String e il provider di dati gestito OleDb può vedere entrambi</span><span class="sxs-lookup"><span data-stu-id="4dbf8-283">Object or String, depending the provider (SqlClient always returns an Object, Odbc always returns a String, and the OleDb managed data provider can see either</span></span>|<span data-ttu-id="4dbf8-284">SqlDbType.Udt se <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> è in caso contrario, altrimenti Variant</span><span class="sxs-lookup"><span data-stu-id="4dbf8-284">SqlDbType.Udt if <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> is present, otherwise Variant</span></span>|<span data-ttu-id="4dbf8-285">OleDbType.VarWChar (se il valore è null) in caso contrario OleDbType.Variant.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-285">OleDbType.VarWChar (if value is null) otherwise OleDbType.Variant.</span></span>|<span data-ttu-id="4dbf8-286">OdbcType.NVarChar</span><span class="sxs-lookup"><span data-stu-id="4dbf8-286">OdbcType.NVarChar</span></span>|<span data-ttu-id="4dbf8-287">Non supportato</span><span class="sxs-lookup"><span data-stu-id="4dbf8-287">not supported</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="4dbf8-288">Le conversioni da Decimal in altri tipi sono conversioni di restrizione che arrotondano il valore Decimal al valore integer più vicino che tende allo zero.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-288">Conversions from decimal to other types are narrowing conversions that round the decimal value to the nearest integer value toward zero.</span></span> <span data-ttu-id="4dbf8-289">Se non è possibile rappresentare il risultato della conversione nel tipo di destinazione, verrà generata un'eccezione <xref:System.OverflowException> .</span><span class="sxs-lookup"><span data-stu-id="4dbf8-289">If the result of the conversion is not representable in the destination type, an <xref:System.OverflowException> is thrown.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="4dbf8-290">Quando si invia un valore di parametro null al server, è necessario specificare <xref:System.DBNull>, non `null` (`Nothing` in Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="4dbf8-290">When you send a null parameter value to the server, you must specify <xref:System.DBNull>, not `null` (`Nothing` in Visual Basic).</span></span> <span data-ttu-id="4dbf8-291">Il valore null nel sistema è un oggetto vuoto senza un valore.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-291">The null value in the system is an empty object that has no value.</span></span> <span data-ttu-id="4dbf8-292"><xref:System.DBNull> viene usato per rappresentare i valori null.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-292"><xref:System.DBNull> is used to represent null values.</span></span> <span data-ttu-id="4dbf8-293">Per altre informazioni sui valori null di database, vedere [Handling Null Values](../../../../docs/framework/data/adonet/sql/handling-null-values.md).</span><span class="sxs-lookup"><span data-stu-id="4dbf8-293">For more information about database nulls, see [Handling Null Values](../../../../docs/framework/data/adonet/sql/handling-null-values.md).</span></span>  
  
## <a name="deriving-parameter-information"></a><span data-ttu-id="4dbf8-294">Informazioni sui parametri</span><span class="sxs-lookup"><span data-stu-id="4dbf8-294">Deriving Parameter Information</span></span>  
 <span data-ttu-id="4dbf8-295">I parametri possono anche essere derivati da una stored procedure usando la classe `DbCommandBuilder` .</span><span class="sxs-lookup"><span data-stu-id="4dbf8-295">Parameters can also be derived from a stored procedure using the `DbCommandBuilder` class.</span></span> <span data-ttu-id="4dbf8-296">Le classi `SqlCommandBuilder` e `OleDbCommandBuilder` forniscono un metodo statico, `DeriveParameters`, che popola automaticamente la raccolta di parametri di un oggetto comando con le informazioni provenienti da una stored procedure.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-296">Both the `SqlCommandBuilder` and `OleDbCommandBuilder` classes provide a static method, `DeriveParameters`, which automatically populates the parameters collection of a command object that uses parameter information from a stored procedure.</span></span> <span data-ttu-id="4dbf8-297">Si noti che `DeriveParameters` sovrascrive qualsiasi informazione esistente sui parametri per il comando.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-297">Note that `DeriveParameters` overwrites any existing parameter information for the command.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="4dbf8-298">La derivazione di informazioni sui parametri implica una riduzione delle prestazioni, in quando richiede un round trip aggiuntivo con l'origine dati per recuperare le informazioni.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-298">Deriving parameter information incurs a performance penalty because it requires an additional round trip to the data source to retrieve the information.</span></span> <span data-ttu-id="4dbf8-299">Se le informazioni sui parametri sono note in fase di progettazione, è possibile migliorare le prestazioni dell'applicazione impostando i parametri in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-299">If parameter information is known at design time, you can improve the performance of your application by setting the parameters explicitly.</span></span>  
  
 <span data-ttu-id="4dbf8-300">Per ulteriori informazioni, vedere [la generazione di comandi tramite commandbuilders](../../../../docs/framework/data/adonet/generating-commands-with-commandbuilders.md).</span><span class="sxs-lookup"><span data-stu-id="4dbf8-300">For more information, see [Generating Commands with CommandBuilders](../../../../docs/framework/data/adonet/generating-commands-with-commandbuilders.md).</span></span>  
  
## <a name="using-parameters-with-a-sqlcommand-and-a-stored-procedure"></a><span data-ttu-id="4dbf8-301">Uso di parametri con SqlCommand e una stored procedure</span><span class="sxs-lookup"><span data-stu-id="4dbf8-301">Using Parameters with a SqlCommand and a Stored Procedure</span></span>  
 <span data-ttu-id="4dbf8-302">Le stored procedure offrono numerosi vantaggi nelle applicazioni guidate dai dati.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-302">Stored procedures offer many advantages in data-driven applications.</span></span> <span data-ttu-id="4dbf8-303">Usando le stored procedure, le operazioni nel database possono essere incapsulate in un unico comando, ottimizzate per migliorare le prestazioni e rese più sicure con funzioni di sicurezza aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-303">By using stored procedures, database operations can be encapsulated in a single command, optimized for best performance, and enhanced with additional security.</span></span> <span data-ttu-id="4dbf8-304">Anche se una stored procedure può essere chiamata passando il nome della stored procedure seguito dagli argomenti dei parametri come istruzione SQL, l'uso di <xref:System.Data.Common.DbCommand.Parameters%2A> insieme del [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] <xref:System.Data.Common.DbCommand> oggetto consente di definire in modo più esplicito stored parametri di stored procedure e per accedere ai parametri di output e valori restituiti.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-304">Although a stored procedure can be called by passing the stored procedure name followed by parameter arguments as an SQL statement, by using the <xref:System.Data.Common.DbCommand.Parameters%2A> collection of the [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] <xref:System.Data.Common.DbCommand> object enables you to more explicitly define stored procedure parameters, and to access output parameters and return values.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="4dbf8-305">Le istruzioni con parametri vengono eseguite sul server tramite `sp_executesql,` , che consente il riutilizzo del piano di query.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-305">Parameterized statements are executed on the server by using `sp_executesql,` which allows for query plan reuse.</span></span> <span data-ttu-id="4dbf8-306">I cursori o le variabili locali del batch `sp_executesql` non sono visibili per il batch che chiama `sp_executesql`.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-306">Local cursors or variables in the `sp_executesql` batch are not visible to the batch that calls `sp_executesql`.</span></span> <span data-ttu-id="4dbf8-307">Le modifiche apportate al contesto del database durano solo fino al termine dell'esecuzione dell'istruzione `sp_executesql` .</span><span class="sxs-lookup"><span data-stu-id="4dbf8-307">Changes in database context last only to the end of the `sp_executesql` statement.</span></span> <span data-ttu-id="4dbf8-308">Per altre informazioni, vedere la documentazione online di SQL Server.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-308">For more information, see SQL Server Books Online.</span></span>  
  
 <span data-ttu-id="4dbf8-309">Quando si usano parametri con <xref:System.Data.SqlClient.SqlCommand> per eseguire una stored procedure di SQL Server, i nomi dei parametri aggiunti alla raccolta <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> devono corrispondere ai nomi dei marcatori dei parametri nella stored procedure.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-309">When using parameters with a <xref:System.Data.SqlClient.SqlCommand> to execute a SQL Server stored procedure, the names of the parameters added to the <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> collection must match the names of the parameter markers in the stored procedure.</span></span> <span data-ttu-id="4dbf8-310">Con il provider di dati [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] per SQL Server non è possibile usare il punto interrogativo (?) come segnaposto per passare i parametri a un'istruzione SQL o a una stored procedure.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-310">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for SQL Server does not support the question mark (?) placeholder for passing parameters to an SQL statement or a stored procedure.</span></span> <span data-ttu-id="4dbf8-311">I parametri nella stored procedure vengono trattati come parametri denominati e vengono ricercati marcatori di parametri corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-311">It treats parameters in the stored procedure as named parameters and searches for matching parameter markers.</span></span> <span data-ttu-id="4dbf8-312">Ad esempio, la stored procedure `CustOrderHist` è definita con un parametro denominato `@CustomerID`.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-312">For example, the `CustOrderHist` stored procedure is defined by using a parameter named `@CustomerID`.</span></span> <span data-ttu-id="4dbf8-313">Quando il codice esegue la stored procedure deve usare anche un parametro denominato `@CustomerID`.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-313">When your code executes the stored procedure, it must also use a parameter named `@CustomerID`.</span></span>  
  
```  
CREATE PROCEDURE dbo.CustOrderHist @CustomerID varchar(5)  
```  
  
### <a name="example"></a><span data-ttu-id="4dbf8-314">Esempio</span><span class="sxs-lookup"><span data-stu-id="4dbf8-314">Example</span></span>  
 <span data-ttu-id="4dbf8-315">In questo esempio viene illustrato come chiamare una stored procedure di SQL Server nel database di esempio `Northwind` .</span><span class="sxs-lookup"><span data-stu-id="4dbf8-315">This example demonstrates how to call a SQL Server stored procedure in the `Northwind` sample database.</span></span> <span data-ttu-id="4dbf8-316">Il nome della stored procedure è `dbo.SalesByCategory` e accetta un parametro di input denominato `@CategoryName` con un tipo di dati `nvarchar(15)`.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-316">The name of the stored procedure is `dbo.SalesByCategory` and it has an input parameter named `@CategoryName` with a data type of `nvarchar(15)`.</span></span> <span data-ttu-id="4dbf8-317">Nel codice viene creato un nuovo oggetto <xref:System.Data.SqlClient.SqlConnection> all'interno di un blocco using, in modo che la connessione venga eliminata al termine della procedura.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-317">The code creates a new <xref:System.Data.SqlClient.SqlConnection> inside a using block so that the connection is disposed when the procedure ends.</span></span> <span data-ttu-id="4dbf8-318">Vengono creati gli oggetti <xref:System.Data.SqlClient.SqlCommand> e <xref:System.Data.SqlClient.SqlParameter> e vengono impostate le relative proprietà.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-318">The <xref:System.Data.SqlClient.SqlCommand> and <xref:System.Data.SqlClient.SqlParameter> objects are created, and their properties set.</span></span> <span data-ttu-id="4dbf8-319">Un oggetto <xref:System.Data.SqlClient.SqlDataReader> esegue `SqlCommand` e restituisce il set di risultati dalla stored procedure, visualizzando l'output nella finestra della console.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-319">A <xref:System.Data.SqlClient.SqlDataReader> executes the `SqlCommand` and returns the result set from the stored procedure, displaying the output in the console window.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="4dbf8-320">Anziché creare oggetti `SqlCommand` e `SqlParameter` e impostare quindi le proprietà in istruzioni distinte, è possibile scegliere di usare uno dei costruttori di overload per impostare più proprietà in una singola istruzione.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-320">Instead of creating `SqlCommand` and `SqlParameter` objects and then setting properties in separate statements, you can instead elect to use one of the overloaded constructors to set multiple properties in a single statement.</span></span>  
  
 [!code-csharp[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/CS/source.cs#1)]
 [!code-vb[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/VB/source.vb#1)]  
  
## <a name="using-parameters-with-an-oledbcommand-or-odbccommand"></a><span data-ttu-id="4dbf8-321">Uso di parametri con OleDbCommand o OdbcCommand</span><span class="sxs-lookup"><span data-stu-id="4dbf8-321">Using Parameters with an OleDbCommand or OdbcCommand</span></span>  
 <span data-ttu-id="4dbf8-322">Quando si usano parametri con <xref:System.Data.OleDb.OleDbCommand> o <xref:System.Data.Odbc.OdbcCommand>, l'ordine dei parametri aggiunti alla raccolta `Parameters` deve corrispondere all'ordine dei parametri definiti nella stored procedure.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-322">When using parameters with an <xref:System.Data.OleDb.OleDbCommand> or <xref:System.Data.Odbc.OdbcCommand>, the order of the parameters added to the `Parameters` collection must match the order of the parameters defined in your stored procedure.</span></span> <span data-ttu-id="4dbf8-323">Con il provider di dati [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] per OLE DB e il provider di dati [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] per ODBC i parametri di una stored procedure vengono gestiti come segnaposto e i valori dei parametri vengono applicati nell'ordine.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-323">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for OLE DB and [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC treat parameters in a stored procedure as placeholders and apply parameter values in order.</span></span> <span data-ttu-id="4dbf8-324">Inoltre, i parametri dei valori restituiti devono essere i primi parametri aggiunti alla raccolta `Parameters` .</span><span class="sxs-lookup"><span data-stu-id="4dbf8-324">In addition, return value parameters must be the first parameters added to the `Parameters` collection.</span></span>  
  
 <span data-ttu-id="4dbf8-325">Con il provider di dati [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] per OLE DB e il provider di dati [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] per ODBC non è possibile usare parametri denominati nel passaggio di parametri a un'istruzione SQL o a una stored procedure.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-325">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for OLE DB and [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC do not support named parameters for passing parameters to an SQL statement or a stored procedure.</span></span> <span data-ttu-id="4dbf8-326">In questo caso è necessario usare il punto interrogativo (?) come segnaposto, come nell'esempio seguente.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-326">In this case, you must use the question mark (?) placeholder, as in the following example.</span></span>  
  
```  
SELECT * FROM Customers WHERE CustomerID = ?  
```  
  
 <span data-ttu-id="4dbf8-327">Di conseguenza, l'ordine in cui vengono aggiunti gli oggetti `Parameter` alla raccolta `Parameters` deve corrispondere esattamente alla posizione del segnaposto punto interrogativo (?)</span><span class="sxs-lookup"><span data-stu-id="4dbf8-327">As a result, the order in which `Parameter` objects are added to the `Parameters` collection must directly correspond to the position of the ?</span></span> <span data-ttu-id="4dbf8-328">usato per il parametro.</span><span class="sxs-lookup"><span data-stu-id="4dbf8-328">placeholder for the parameter.</span></span>  
  
### <a name="oledb-example"></a><span data-ttu-id="4dbf8-329">Esempio di OleDb</span><span class="sxs-lookup"><span data-stu-id="4dbf8-329">OleDb Example</span></span>  
  
```vb  
Dim command As OleDbCommand = New OleDbCommand( _  
  "SampleProc", connection)  
command.CommandType = CommandType.StoredProcedure  
  
Dim parameter As OleDbParameter = command.Parameters.Add( _  
  "RETURN_VALUE", OleDbType.Integer)  
parameter.Direction = ParameterDirection.ReturnValue  
  
parameter = command.Parameters.Add( _  
  "@InputParm", OleDbType.VarChar, 12)  
parameter.Value = "Sample Value"  
  
parameter = command.Parameters.Add( _  
  "@OutputParm", OleDbType.VarChar, 28)  
parameter.Direction = ParameterDirection.Output  
```  
  
```csharp  
OleDbCommand command = new OleDbCommand("SampleProc", connection);  
command.CommandType = CommandType.StoredProcedure;  
  
OleDbParameter parameter = command.Parameters.Add(  
  "RETURN_VALUE", OleDbType.Integer);  
parameter.Direction = ParameterDirection.ReturnValue;  
  
parameter = command.Parameters.Add(  
  "@InputParm", OleDbType.VarChar, 12);  
parameter.Value = "Sample Value";  
  
parameter = command.Parameters.Add(  
  "@OutputParm", OleDbType.VarChar, 28);  
parameter.Direction = ParameterDirection.Output;  
```  
  
## <a name="odbc-example"></a><span data-ttu-id="4dbf8-330">Esempio di Odbc</span><span class="sxs-lookup"><span data-stu-id="4dbf8-330">Odbc Example</span></span>  
  
```vb  
Dim command As OdbcCommand = New OdbcCommand( _  
  "{ ? = CALL SampleProc(?, ?) }", connection)  
command.CommandType = CommandType.StoredProcedure  
  
Dim parameter As OdbcParameter = command.Parameters.Add("RETURN_VALUE", OdbcType.Int)  
parameter.Direction = ParameterDirection.ReturnValue  
  
parameter = command.Parameters.Add( _  
  "@InputParm", OdbcType.VarChar, 12)  
parameter.Value = "Sample Value"  
  
parameter = command.Parameters.Add( _  
  "@OutputParm", OdbcType.VarChar, 28)  
parameter.Direction = ParameterDirection.Output  
```  
  
```csharp  
OdbcCommand command = new OdbcCommand( _  
  "{ ? = CALL SampleProc(?, ?) }", connection);  
command.CommandType = CommandType.StoredProcedure;  
  
OdbcParameter parameter = command.Parameters.Add( _  
  "RETURN_VALUE", OdbcType.Int);  
parameter.Direction = ParameterDirection.ReturnValue;  
  
parameter = command.Parameters.Add( _  
  "@InputParm", OdbcType.VarChar, 12);  
parameter.Value = "Sample Value";  
  
parameter = command.Parameters.Add( _  
  "@OutputParm", OdbcType.VarChar, 28);  
parameter.Direction = ParameterDirection.Output;  
```  
  
## <a name="see-also"></a><span data-ttu-id="4dbf8-331">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="4dbf8-331">See Also</span></span>  
 [<span data-ttu-id="4dbf8-332">Comandi e parametri</span><span class="sxs-lookup"><span data-stu-id="4dbf8-332">Commands and Parameters</span></span>](../../../../docs/framework/data/adonet/commands-and-parameters.md)  
 [<span data-ttu-id="4dbf8-333">Parametri DataAdapter</span><span class="sxs-lookup"><span data-stu-id="4dbf8-333">DataAdapter Parameters</span></span>](../../../../docs/framework/data/adonet/dataadapter-parameters.md)  
 [<span data-ttu-id="4dbf8-334">Mapping dei tipi di dati in ADO.NET</span><span class="sxs-lookup"><span data-stu-id="4dbf8-334">Data Type Mappings in ADO.NET</span></span>](../../../../docs/framework/data/adonet/data-type-mappings-in-ado-net.md)  
 [<span data-ttu-id="4dbf8-335">Provider gestiti ADO.NET e Centro per sviluppatori di set di dati</span><span class="sxs-lookup"><span data-stu-id="4dbf8-335">ADO.NET Managed Providers and DataSet Developer Center</span></span>](http://go.microsoft.com/fwlink/?LinkId=217917)
