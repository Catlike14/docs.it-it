---
title: Bridging e gestione degli errori
ms.date: 03/30/2017
ms.assetid: 4ae87d1a-b615-4014-a494-a53f63ff0137
ms.openlocfilehash: 6afaddc75855b7e95ad708b2179cabb9aee35001
ms.sourcegitcommit: efff8f331fd9467f093f8ab8d23a203d6ecb5b60
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/01/2018
ms.locfileid: "43389068"
---
# <a name="bridging-and-error-handling"></a><span data-ttu-id="a62c2-102">Bridging e gestione degli errori</span><span class="sxs-lookup"><span data-stu-id="a62c2-102">Bridging and Error Handling</span></span>
<span data-ttu-id="a62c2-103">Questo esempio viene illustrato come il servizio di routing di Windows Communication Foundation (WCF) viene usato per il collegamento delle comunicazioni tra un client e un servizio che impiegano associazioni diverse.</span><span class="sxs-lookup"><span data-stu-id="a62c2-103">This sample demonstrates how the Windows Communication Foundation (WCF) routing service is used for bridging communication between a client and a service that use different bindings.</span></span> <span data-ttu-id="a62c2-104">L'esempio mostra inoltre come utilizzare un servizio di backup per scenari di failover.</span><span class="sxs-lookup"><span data-stu-id="a62c2-104">This sample also shows how to use a back-up service for failover scenarios.</span></span> <span data-ttu-id="a62c2-105">Il servizio di routing è un componente WCF che rende più semplice includere un router basato sul contenuto nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="a62c2-105">The routing service is a WCF component that makes it easy to include a content-based router in your application.</span></span> <span data-ttu-id="a62c2-106">In questo esempio si adatta l'esempio di calcolatrice standard di WCF per comunicare con il servizio di routing.</span><span class="sxs-lookup"><span data-stu-id="a62c2-106">This sample adapts the standard WCF Calculator Sample to communicate using the routing service.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="a62c2-107">È possibile che gli esempi siano già installati nel computer.</span><span class="sxs-lookup"><span data-stu-id="a62c2-107">The samples may already be installed on your computer.</span></span> <span data-ttu-id="a62c2-108">Verificare la directory seguente (impostazione predefinita) prima di continuare.</span><span class="sxs-lookup"><span data-stu-id="a62c2-108">Check for the following (default) directory before continuing.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  <span data-ttu-id="a62c2-109">Se questa directory non esiste, andare al [Windows Communication Foundation (WCF) e gli esempi di Windows Workflow Foundation (WF) per .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) per scaricare tutti i Windows Communication Foundation (WCF) e [!INCLUDE[wf1](../../../../includes/wf1-md.md)] esempi.</span><span class="sxs-lookup"><span data-stu-id="a62c2-109">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="a62c2-110">Questo esempio si trova nella directory seguente.</span><span class="sxs-lookup"><span data-stu-id="a62c2-110">This sample is located in the following directory.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WCF\Basic\RoutingServices\ErrorHandlingAndBridging`  
  
## <a name="sample-details"></a><span data-ttu-id="a62c2-111">Dettagli dell'esempio</span><span class="sxs-lookup"><span data-stu-id="a62c2-111">Sample Details</span></span>  
 <span data-ttu-id="a62c2-112">In questo esempio, il client calcolatrice è configurato per inviare messaggi a un endpoint esposto dal router.</span><span class="sxs-lookup"><span data-stu-id="a62c2-112">In this sample, the Calculator client is configured to send messages to an endpoint exposed by the router.</span></span> <span data-ttu-id="a62c2-113">Il servizio di routing è configurato per accettare tutti i messaggi ad esso inviati e per inoltrarli a un endpoint che corrisponde al servizio di calcolatrice.</span><span class="sxs-lookup"><span data-stu-id="a62c2-113">The routing service is configured to accept all messages sent to it and to forward them to an endpoint that corresponds to the Calculator service.</span></span> <span data-ttu-id="a62c2-114">Nei punti seguenti viene descritta la configurazione del servizio di calcolatrice primario, del servizio di calcolatrice di backup e del client calcolatrice. Vengono inoltre fornite informazioni sulla modalità di comunicazione tra client e servizio mediante il servizio di routing:</span><span class="sxs-lookup"><span data-stu-id="a62c2-114">The following points describe the configuration of the primary Calculator service, the back-up Calculator service, and the Calculator client and how the communication between the client and the service happens using the routing service:</span></span>  
  
-   <span data-ttu-id="a62c2-115">Il client calcolatrice è configurato per utilizzare BasicHttpBinding, mentre il servizio di calcolatrice è configurato per utilizzare NetTcpBinding.</span><span class="sxs-lookup"><span data-stu-id="a62c2-115">The Calculator client is configured to use BasicHttpBinding while the Calculator service is configured to use NetTcpBinding.</span></span> <span data-ttu-id="a62c2-116">Il servizio di routing converte automaticamente i messaggi in modo appropriato prima di inviarli al servizio di calcolatrice e converte anche le risposte in modo che il client calcolatrice sia in grado di accedervi.</span><span class="sxs-lookup"><span data-stu-id="a62c2-116">The routing service automatically converts the messages as necessary before sending them to the Calculator service and it also converts the responses so that the Calculator client can access them.</span></span>  
  
-   <span data-ttu-id="a62c2-117">Il servizio di routing è in grado di riconoscere la presenza di due servizi di calcolatrice: il servizio di calcolatrice primario e il servizio di calcolatrice di backup.</span><span class="sxs-lookup"><span data-stu-id="a62c2-117">The routing service knows about two Calculator services: the primary Calculator service and the back-up Calculator service.</span></span> <span data-ttu-id="a62c2-118">Il servizio di routing tenta in primo luogo di comunicare con l'endpoint del servizio di calcolatrice primario.</span><span class="sxs-lookup"><span data-stu-id="a62c2-118">The routing service first attempts to communicate with the primary Calculator service endpoint.</span></span> <span data-ttu-id="a62c2-119">Se il tentativo non riesce a causa dell'inattività dell'endpoint, il servizio di routing tenta di comunicare con l'endpoint del servizio di calcolatrice di backup.</span><span class="sxs-lookup"><span data-stu-id="a62c2-119">If this attempt fails due to the endpoint being down, the routing service then tries to communicate with the back-up Calculator service endpoint.</span></span>  
  
 <span data-ttu-id="a62c2-120">I messaggi inviati dal client vengono pertanto ricevuti dal router e reindirizzati al servizio di calcolatrice effettivo.</span><span class="sxs-lookup"><span data-stu-id="a62c2-120">Thus messages sent from the client are received by the router and are rerouted to the actual Calculator service.</span></span> <span data-ttu-id="a62c2-121">Se l'endpoint del servizio di calcolatrice è inattivo, il servizio di routing instrada il messaggio all'endpoint del servizio di calcolatrice di backup.</span><span class="sxs-lookup"><span data-stu-id="a62c2-121">If the Calculator service endpoint is down, the routing service routes the message to the back-up Calculator service endpoint.</span></span> <span data-ttu-id="a62c2-122">I messaggi provenienti dal servizio di calcolatrice di backup vengono inviati nuovamente al router del servizio, che a sua volta li inoltra al client calcolatrice.</span><span class="sxs-lookup"><span data-stu-id="a62c2-122">Messages from the back-up Calculator service are sent back to the service router, which in turn passes them back to the Calculator client.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a62c2-123">In un elenco di backup possono essere definiti più endpoint.</span><span class="sxs-lookup"><span data-stu-id="a62c2-123">A back-up list can have more than one endpoint defined.</span></span> <span data-ttu-id="a62c2-124">In questo caso, se l'endpoint del servizio di backup è inattivo, il servizio di routing tenta di connettersi all'endpoint di backup successivo nell'elenco fino a quando il tentativo di connessione non riesce.</span><span class="sxs-lookup"><span data-stu-id="a62c2-124">In this case if the back-up service endpoint is down, the routing service attempts to connect to the next back-up endpoint in the list until a successful connection occurs.</span></span>  
  
#### <a name="to-use-this-sample"></a><span data-ttu-id="a62c2-125">Per usare questo esempio</span><span class="sxs-lookup"><span data-stu-id="a62c2-125">To use this sample</span></span>  
  
1.  <span data-ttu-id="a62c2-126">Utilizzando [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)], aprire RouterBridgingAndErrorHandling.sln.</span><span class="sxs-lookup"><span data-stu-id="a62c2-126">Using [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)], open RouterBridgingAndErrorHandling.sln.</span></span>  
  
2.  <span data-ttu-id="a62c2-127">Premere F5 o CTRL+MAIUSC+B in Visual Studio</span><span class="sxs-lookup"><span data-stu-id="a62c2-127">Press F5 or CTRL+SHIFT+B in Visual Studio</span></span>  
  
    1.  <span data-ttu-id="a62c2-128">Se si desidera avviare automaticamente i progetti necessari quando si preme F5, fare doppio clic la soluzione, selezionare **proprietà**e il **progetto di avvio** nodo sotto **proprietà comuni**, selezionare **progetti di avvio multipli**e impostare tutti i progetti **Start**.</span><span class="sxs-lookup"><span data-stu-id="a62c2-128">If you would like to auto-launch the necessary projects when you press F5, right-click the solution, select **Properties**, and in the **Startup Project** node under **Common Properties**, select **Multiple Startup Projects**, and set all projects to **Start**.</span></span>  
  
    2.  <span data-ttu-id="a62c2-129">Se si compila il progetto con CTRL+MAIUSC+B, avviare le applicazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="a62c2-129">If you build the project with CTRL+SHIFT+B, start the following applications:</span></span>  
  
        1.  <span data-ttu-id="a62c2-130">Client calcolatrice (./CalculatorClient/bin/client.exe)</span><span class="sxs-lookup"><span data-stu-id="a62c2-130">Calculator client (./CalculatorClient/bin/client.exe)</span></span>  
  
        2.  <span data-ttu-id="a62c2-131">Servizio di calcolatrice (./CalculatorService/bin/service.exe)</span><span class="sxs-lookup"><span data-stu-id="a62c2-131">Calculator service (./CalculatorService/bin/service.exe)</span></span>  
  
        3.  <span data-ttu-id="a62c2-132">Servizio di routing (./RoutingService/bin/RoutingService.exe)</span><span class="sxs-lookup"><span data-stu-id="a62c2-132">Routing Service (./RoutingService/bin/RoutingService.exe)</span></span>  
  
3.  <span data-ttu-id="a62c2-133">Nel client calcolatrice, premere INVIO per avviare il client.</span><span class="sxs-lookup"><span data-stu-id="a62c2-133">In the Calculator Client, press ENTER to start the client.</span></span>  
  
     <span data-ttu-id="a62c2-134">È necessario visualizzare il seguente output:</span><span class="sxs-lookup"><span data-stu-id="a62c2-134">You should see the following output:</span></span>  
  
    ```Output  
    Add(100,15.99) = 115.99  
    Subtract(145,76.54) = 68.46  
    Multiply(9,81.25) = 731.25  
    Divide(22,7) = 3.14285714285714  
    ```  
  
## <a name="configurable-via-code-or-appconfig"></a><span data-ttu-id="a62c2-135">Configurabile tramite codice o App.config</span><span class="sxs-lookup"><span data-stu-id="a62c2-135">Configurable Via Code or App.config</span></span>  
 <span data-ttu-id="a62c2-136">L'esempio proposto è configurato per l'uso di un file App.config per la definizione del comportamento del router.</span><span class="sxs-lookup"><span data-stu-id="a62c2-136">The sample ships configured to use an App.config file to define the router’s behavior.</span></span> <span data-ttu-id="a62c2-137">È inoltre possibile modificare il nome del file App.config affinché non venga riconosciuto e rimuovere i commenti dalla chiamata al metodo in `ConfigureRouterViaCode()`.</span><span class="sxs-lookup"><span data-stu-id="a62c2-137">You can also change the name of the App.config file to something else so that it is not recognized and uncomment the method call to `ConfigureRouterViaCode()`.</span></span> <span data-ttu-id="a62c2-138">Entrambi i metodi restituiscono lo stesso comportamento da parte del router.</span><span class="sxs-lookup"><span data-stu-id="a62c2-138">Either method results in the same behavior from the router.</span></span>  
  
### <a name="scenario"></a><span data-ttu-id="a62c2-139">Scenario</span><span class="sxs-lookup"><span data-stu-id="a62c2-139">Scenario</span></span>  
 <span data-ttu-id="a62c2-140">L'esempio dimostra il funzionamento del router del servizio come bridge del protocollo e gestore errori.</span><span class="sxs-lookup"><span data-stu-id="a62c2-140">This sample demonstrates the service router acting as a protocol bridge and error handler.</span></span> <span data-ttu-id="a62c2-141">In questo scenario, non si verifica alcun routing basato sul contenuto; il servizio di routing viene utilizzato come nodo proxy trasparente configurato per inoltrare direttamente messaggi a un set preconfigurato di endpoint di destinazione.</span><span class="sxs-lookup"><span data-stu-id="a62c2-141">In this scenario, no content-based routing occurs; the routing service acts as a transparent proxy node configured to pass messages directly to a preconfigured set of destination endpoints.</span></span> <span data-ttu-id="a62c2-142">Il servizio di routing esegue inoltre i passaggi aggiuntivi di gestione trasparente degli errori che si verificano in caso di invio agli endpoint con i quali è prevista la comunicazione in base alla configurazione.</span><span class="sxs-lookup"><span data-stu-id="a62c2-142">The routing service also performs the additional steps of transparently handling errors that occur when it tries to send to the endpoints that it is configured to communicate with.</span></span> <span data-ttu-id="a62c2-143">Utilizzato come bridge del protocollo, il servizio di routing consente all'utente di definire un protocollo per le comunicazioni esterne e un altro per le comunicazioni interne.</span><span class="sxs-lookup"><span data-stu-id="a62c2-143">By acting as a protocol bridge, the routing service enables the user to define one protocol for external communication and another for internal communication.</span></span>  
  
### <a name="real-world-scenario"></a><span data-ttu-id="a62c2-144">Scenario reale</span><span class="sxs-lookup"><span data-stu-id="a62c2-144">Real World Scenario</span></span>  
 <span data-ttu-id="a62c2-145">Contoso desidera fornire un endpoint del servizio interoperativo a livello mondiale, ottimizzando al contempo le prestazioni interne.</span><span class="sxs-lookup"><span data-stu-id="a62c2-145">Contoso wants to provide an interoperable service endpoint to the world, while optimizing performance internally.</span></span> <span data-ttu-id="a62c2-146">Propone pertanto i propri servizi a livello internazionale tramite un endpoint utilizzando BasicHttpBinding e ricorrendo internamente al servizio di routing che funge da bridge alla connessione all'endpoint utilizzando NetTcpBinding, impiegato dai propri servizi.</span><span class="sxs-lookup"><span data-stu-id="a62c2-146">Thus it exposes its services to the world through an endpoint using the BasicHttpBinding, while internally using the routing service to bridge that connection to the endpoint using NetTcpBinding, which its services use.</span></span> <span data-ttu-id="a62c2-147">Inoltre, poiché Contoso desidera che il servizio offerto tenga conto di possibili periodi di interruzione temporanei in uno dei servizi di produzione, virtualizza più endpoint associati al servizio del router utilizzando le funzionalità di gestione degli errori per il failover automatico nel caso in cui si renda necessario effettuare il backup degli endpoint.</span><span class="sxs-lookup"><span data-stu-id="a62c2-147">Furthermore, Contoso wants its service offering to be tolerant of temporary outages in any one of their production services and thus virtualizes multiple endpoints behind the router service using the ’s error handling capabilities to automatically failover to back-up endpoints when necessary.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a62c2-148">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="a62c2-148">See Also</span></span>  
 [<span data-ttu-id="a62c2-149">Hosting di AppFabric e salvataggio permanente</span><span class="sxs-lookup"><span data-stu-id="a62c2-149">AppFabric Hosting and Persistence Samples</span></span>](https://go.microsoft.com/fwlink/?LinkId=193961)
