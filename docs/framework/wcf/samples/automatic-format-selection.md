---
title: Selezione automatica del formato
ms.date: 03/30/2017
ms.assetid: dab51e56-8517-4a6a-bb54-b55b15ab37bb
ms.openlocfilehash: 8c26253bee069bf9bbc009ea219e6c12cab034ef
ms.sourcegitcommit: 15109844229ade1c6449f48f3834db1b26907824
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/07/2018
---
# <a name="automatic-format-selection"></a><span data-ttu-id="34e2b-102">Selezione automatica del formato</span><span class="sxs-lookup"><span data-stu-id="34e2b-102">Automatic Format Selection</span></span>
<span data-ttu-id="34e2b-103">In questo esempio viene illustrato come abilitare la selezione automatica del formato (XML o JSON) con il modello, nonché come impostare in modo esplicito il formato nel codice dell'operazione di programmazione REST di Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="34e2b-103">This sample demonstrates how to enable automatic format selection (XML or JSON) with the Windows Communication Foundation (WCF) REST programming model, as well as how to explicitly set the format in the operation code.</span></span>  
  
## <a name="sample-details"></a><span data-ttu-id="34e2b-104">Dettagli dell'esempio</span><span class="sxs-lookup"><span data-stu-id="34e2b-104">Sample Details</span></span>  
 <span data-ttu-id="34e2b-105">L'esempio è costituito da un servizio e dal codice client che effettua le richieste al servizio.</span><span class="sxs-lookup"><span data-stu-id="34e2b-105">The sample consists of a service along with client code that makes requests to the service.</span></span> <span data-ttu-id="34e2b-106">Il servizio supporta una singola operazione `GET` (`EchoWithGet`) HTTP e una singola operazione `POST` (`EchoWithPost`) HTTP.</span><span class="sxs-lookup"><span data-stu-id="34e2b-106">The service supports a single HTTP `GET` operation (`EchoWithGet`) and a single HTTP `POST` operation (`EchoWithPost`).</span></span> <span data-ttu-id="34e2b-107">Entrambe operazioni prevedono una stringa, quindi restituiscono la stringa nella risposta.</span><span class="sxs-lookup"><span data-stu-id="34e2b-107">Both operations expect a string and then return the string in the response.</span></span> <span data-ttu-id="34e2b-108">Con l'operazione `GET`, la stringa viene fornita in un parametro della stringa di query dell'URI.</span><span class="sxs-lookup"><span data-stu-id="34e2b-108">With the `GET` operation, the string is provided in a URI query-string parameter.</span></span> <span data-ttu-id="34e2b-109">Con l'operazione `POST`, la stringa viene fornita nel corpo della richiesta serializzata in XML.</span><span class="sxs-lookup"><span data-stu-id="34e2b-109">With the `POST` operation, the string is provided in the body of the request, serialized in XML.</span></span> <span data-ttu-id="34e2b-110">Il servizio è in grado di restituire risposte in XML o JSON usando le nuove funzionalità di selezione automatica del formato e di selezione imperativa del formato di [!INCLUDE[netfx40_long](../../../../includes/netfx40-long-md.md)].</span><span class="sxs-lookup"><span data-stu-id="34e2b-110">The service is able to return responses in either XML or JSON, utilizing the new automatic format selection and imperative format selection features in [!INCLUDE[netfx40_long](../../../../includes/netfx40-long-md.md)].</span></span>  
  
 <span data-ttu-id="34e2b-111">Nell'esempio la selezione automatica del formato viene abilitata tramite il file App.config.</span><span class="sxs-lookup"><span data-stu-id="34e2b-111">In the sample, automatic format selection is enabled using the App.config file.</span></span> <span data-ttu-id="34e2b-112">Sull'endpoint HTTP Web predefinito all'attributo `automaticFormatSelectionEnabled` è stato assegnato il valore `true`.</span><span class="sxs-lookup"><span data-stu-id="34e2b-112">On the default Web HTTP endpoint, the `automaticFormatSelectionEnabled` attribute has been given a value of `true`.</span></span> <span data-ttu-id="34e2b-113">Con la selezione automatica del formato abilitata, l'infrastruttura WCF seleziona il più appropriato risposta formato (XML o JSON) dato le intestazioni HTTP Accept o Content-Type della richiesta.</span><span class="sxs-lookup"><span data-stu-id="34e2b-113">With automatic format selection enabled, the WCF infrastructure selects the most appropriate response format (XML or JSON) given the HTTP Accept or Content-Type headers of the request.</span></span> <span data-ttu-id="34e2b-114">Per usare questa nuova funzionalità, non è necessario che lo sviluppatore fornisca una configurazione o un codice aggiuntivo oltre all'impostazione dell'attributo `automaticFormatSelectionEnabled` su `true`.</span><span class="sxs-lookup"><span data-stu-id="34e2b-114">The developer is not required to provide any additional code or configuration other than setting the `automaticFormatSelectionEnabled` attribute to `true` to use this new feature.</span></span> <span data-ttu-id="34e2b-115">Nel codice client in Program.cs le richieste vengono inviate in entrambe le `GET` e `POST` operazioni del servizio con l'intestazione HTTP Accept specificata come "application/xml" o "application/json" e il servizio restituisce una risposta che formato corrispondente.</span><span class="sxs-lookup"><span data-stu-id="34e2b-115">In the client code in Program.cs, requests are sent to both the `GET` and `POST` operations of the service with the HTTP Accept header specified as either "application/xml" or "application/json" and the service returns a response in that respective format.</span></span>  
  
 <span data-ttu-id="34e2b-116">Anche nell'operazione `GET` viene usata la selezione imperativa del formato.</span><span class="sxs-lookup"><span data-stu-id="34e2b-116">Also in the `GET` operation, imperative format selection is used.</span></span> <span data-ttu-id="34e2b-117">L'operazione `GET` verifica se è presente un parametro della stringa di query `format` facoltativo e in caso affermativo imposta il formato della risposta sulla proprietà <xref:System.ServiceModel.Web.WebOperationContext.OutgoingResponse%2A>.</span><span class="sxs-lookup"><span data-stu-id="34e2b-117">The `GET` operation checks for an optional `format` query-string parameter and if present, sets the response format on the <xref:System.ServiceModel.Web.WebOperationContext.OutgoingResponse%2A> property.</span></span> <span data-ttu-id="34e2b-118">L'impostazione in modo imperativo il formato della risposta in questo modo sostituisce la selezione automatica del formato effettuata dall'infrastruttura WCF.</span><span class="sxs-lookup"><span data-stu-id="34e2b-118">Imperatively setting the response format in this way overrides the automatic format selection done by the WCF infrastructure.</span></span>  
  
 <span data-ttu-id="34e2b-119">L'esempio è costituito da un servizio indipendente e da un client in esecuzione in un'applicazione console.</span><span class="sxs-lookup"><span data-stu-id="34e2b-119">The sample consists of a self-hosted service and a client that runs within a console application.</span></span> <span data-ttu-id="34e2b-120">Quando l'applicazione console è in esecuzione, il client invia richieste al servizio e scrive nella finestra della console le informazioni pertinenti incluse nelle risposte.</span><span class="sxs-lookup"><span data-stu-id="34e2b-120">As the console application runs, the client makes requests to the service and writes the pertinent information from the responses to the console window.</span></span>  
  
#### <a name="to-use-this-sample"></a><span data-ttu-id="34e2b-121">Per usare questo esempio</span><span class="sxs-lookup"><span data-stu-id="34e2b-121">To use this sample</span></span>  
  
1.  <span data-ttu-id="34e2b-122">Aprire la soluzione per l'esempio relativo alla selezione automatica del formato.</span><span class="sxs-lookup"><span data-stu-id="34e2b-122">Open the solution for the Automatic Format Selection Sample.</span></span> <span data-ttu-id="34e2b-123">Per garantire l'esecuzione corretta dell'esempio, è necessario che l'avvio di [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] venga eseguito come amministratore.</span><span class="sxs-lookup"><span data-stu-id="34e2b-123">When launching [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)], you must run as an administrator for the sample to execute successfully.</span></span> <span data-ttu-id="34e2b-124">Farlo facendo clic con il [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] sull'icona e selezionare **Esegui come amministratore** dal menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="34e2b-124">Do this by right-clicking the [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] icon and select **Run as Administrator** from the context menu.</span></span>  
  
2.  <span data-ttu-id="34e2b-125">Premere CTRL+MAIUSC+B per compilare la soluzione, quindi premere CTRL+F5 per eseguire il progetto AutomaticFormatSelection dell'applicazione console.</span><span class="sxs-lookup"><span data-stu-id="34e2b-125">Press CTRL+SHIFT+B to build the solution and then press Ctrl+F5 to run the console application AutomaticFormatSelection project.</span></span> <span data-ttu-id="34e2b-126">Verrà visualizzata la finestra della console in cui saranno disponibili gli URI del servizio in esecuzione e della pagina della Guida HTML per il servizio in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="34e2b-126">The console window appears and provides the URI of the running service and the URI of the HTML help page for the running service.</span></span>  
  
3.  <span data-ttu-id="34e2b-127">Durante l'esecuzione dell'esempio, il client invia richieste al servizio e scrive le risposte nella finestra della console.</span><span class="sxs-lookup"><span data-stu-id="34e2b-127">As the sample runs, the client sends requests to the service and writes the responses to the console window.</span></span> <span data-ttu-id="34e2b-128">Si notino i formati diversi delle risposte in XML e JSON.</span><span class="sxs-lookup"><span data-stu-id="34e2b-128">Notice the different formats of the responses in XML and JSON.</span></span>  
  
4.  <span data-ttu-id="34e2b-129">Premere un tasto qualsiasi per terminare l'esempio.</span><span class="sxs-lookup"><span data-stu-id="34e2b-129">Press any key to terminate the sample.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="34e2b-130">È possibile che gli esempi siano già installati nel computer.</span><span class="sxs-lookup"><span data-stu-id="34e2b-130">The samples may already be installed on your machine.</span></span> <span data-ttu-id="34e2b-131">Verificare la directory seguente (impostazione predefinita) prima di continuare.</span><span class="sxs-lookup"><span data-stu-id="34e2b-131">Check for the following (default) directory before continuing.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  <span data-ttu-id="34e2b-132">Se questa directory non esiste, andare al [Windows Communication Foundation (WCF) e gli esempi di Windows Workflow Foundation (WF) per .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) per scaricare tutti i Windows Communication Foundation (WCF) e [!INCLUDE[wf1](../../../../includes/wf1-md.md)] esempi.</span><span class="sxs-lookup"><span data-stu-id="34e2b-132">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="34e2b-133">Questo esempio si trova nella directory seguente.</span><span class="sxs-lookup"><span data-stu-id="34e2b-133">This sample is located in the following directory.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WCF\Basic\Web\AutomaticFormatSelection`  
  
## <a name="see-also"></a><span data-ttu-id="34e2b-134">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="34e2b-134">See Also</span></span>
