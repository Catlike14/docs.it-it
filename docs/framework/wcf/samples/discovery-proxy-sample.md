---
title: Esempio relativo al proxy di individuazione
ms.date: 03/30/2017
ms.assetid: 1dfa02df-15b1-4e97-9c8e-f5f2772711b0
ms.openlocfilehash: e9cbfcb717f502a849d4d508d13df6c00b95db58
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/04/2018
ms.locfileid: "33503184"
---
# <a name="discovery-proxy-sample"></a><span data-ttu-id="6bf65-102">Esempio relativo al proxy di individuazione</span><span class="sxs-lookup"><span data-stu-id="6bf65-102">Discovery Proxy Sample</span></span>
<span data-ttu-id="6bf65-103">Questo esempio mostra come creare un'implementazione di un proxy di individuazione per archiviare informazioni sui servizi esistenti e come i client possono eseguire una query su tale proxy per ricevere informazioni.</span><span class="sxs-lookup"><span data-stu-id="6bf65-103">This sample shows how to create an implementation of a Discovery proxy to store information about existing services and how clients can query that proxy for information.</span></span> <span data-ttu-id="6bf65-104">L'esempio è costituito da tre progetti:</span><span class="sxs-lookup"><span data-stu-id="6bf65-104">This sample consists of three projects:</span></span>  
  
-   <span data-ttu-id="6bf65-105">**Servizio**: un semplice servizio di calcolatrice di Windows Communication Foundation (WCF) che effettua la registrazione con il proxy di individuazione.</span><span class="sxs-lookup"><span data-stu-id="6bf65-105">**Service**: A simple Windows Communication Foundation (WCF) calculator service that registers itself with the discovery proxy.</span></span>  
  
-   <span data-ttu-id="6bf65-106">**Proxy di individuazione**: l'implementazione di un servizio proxy di individuazione.</span><span class="sxs-lookup"><span data-stu-id="6bf65-106">**Discovery Proxy**: The implementation of a discovery proxy service.</span></span>  
  
-   <span data-ttu-id="6bf65-107">**Client**: applicazione client WCF che chiama il proxy di individuazione per la ricerca per i servizi.</span><span class="sxs-lookup"><span data-stu-id="6bf65-107">**Client**: A WCF client application that calls the discovery proxy to search for services.</span></span>  
  
## <a name="demonstrates"></a><span data-ttu-id="6bf65-108">Dimostrazione</span><span class="sxs-lookup"><span data-stu-id="6bf65-108">Demonstrates</span></span>  
 <span data-ttu-id="6bf65-109">Implementazione di un proxy di individuazione</span><span class="sxs-lookup"><span data-stu-id="6bf65-109">Discovery proxy implementation</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="6bf65-110">È possibile che gli esempi siano già installati nel computer.</span><span class="sxs-lookup"><span data-stu-id="6bf65-110">The samples may already be installed on your machine.</span></span> <span data-ttu-id="6bf65-111">Verificare la directory seguente (impostazione predefinita) prima di continuare.</span><span class="sxs-lookup"><span data-stu-id="6bf65-111">Check for the following (default) directory before continuing.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  <span data-ttu-id="6bf65-112">Se questa directory non esiste, andare al [Windows Communication Foundation (WCF) e gli esempi di Windows Workflow Foundation (WF) per .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) per scaricare tutti i Windows Communication Foundation (WCF) e [!INCLUDE[wf1](../../../../includes/wf1-md.md)] esempi.</span><span class="sxs-lookup"><span data-stu-id="6bf65-112">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="6bf65-113">Questo esempio si trova nella directory seguente.</span><span class="sxs-lookup"><span data-stu-id="6bf65-113">This sample is located in the following directory.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WCF\Basic\Discovery\DiscoveryProxy`  
  
## <a name="discoveryproxy"></a><span data-ttu-id="6bf65-114">DiscoveryProxy</span><span class="sxs-lookup"><span data-stu-id="6bf65-114">DiscoveryProxy</span></span>  
 <span data-ttu-id="6bf65-115">Nel metodo `Main` del file Program.cs, l'esempio mostra come viene ospitato un servizio di tipo <xref:System.ServiceModel.Discovery.DiscoveryProxy>.</span><span class="sxs-lookup"><span data-stu-id="6bf65-115">In the `Main` method of the Program.cs file, the sample shows how a service of type <xref:System.ServiceModel.Discovery.DiscoveryProxy> is hosted.</span></span> <span data-ttu-id="6bf65-116">Vengono esposti due endpoint, uno di tipo <xref:System.ServiceModel.Discovery.DiscoveryEndpoint> e un altro di tipo <xref:System.ServiceModel.Discovery.AnnouncementEndpoint>.</span><span class="sxs-lookup"><span data-stu-id="6bf65-116">It exposes two endpoints, one of type <xref:System.ServiceModel.Discovery.DiscoveryEndpoint> and another of type <xref:System.ServiceModel.Discovery.AnnouncementEndpoint>.</span></span> <span data-ttu-id="6bf65-117">Entrambi gli endpoint utilizzano TCP come trasporto.</span><span class="sxs-lookup"><span data-stu-id="6bf65-117">Both of the endpoints use TCP as a transport.</span></span> <span data-ttu-id="6bf65-118"><xref:System.ServiceModel.Discovery.DiscoveryEndpoint> è in ascolto su un URI specificato dal parametro `probeEndpointAddress`, ovvero sia dove i client possono inviare messaggi del probe per eseguire una query sul proxy per i dati.</span><span class="sxs-lookup"><span data-stu-id="6bf65-118">The <xref:System.ServiceModel.Discovery.DiscoveryEndpoint> is listening at the URI specified by the `probeEndpointAddress` parameter, this is where clients can send probe messages to query the proxy for its data.</span></span> <span data-ttu-id="6bf65-119"><xref:System.ServiceModel.Discovery.AnnouncementEndpoint> è in ascolto su un URI specificato dal parametro `announcementEndpointAddress`.</span><span class="sxs-lookup"><span data-stu-id="6bf65-119">The <xref:System.ServiceModel.Discovery.AnnouncementEndpoint> is listening at the URI specified by the `announcementEndpointAddress` parameter.</span></span> <span data-ttu-id="6bf65-120">Si tratta di dove il proxy è in ascolto degli annunci.</span><span class="sxs-lookup"><span data-stu-id="6bf65-120">This is where the proxy listens to for announcements.</span></span> <span data-ttu-id="6bf65-121">Quando viene ricevuto un annuncio online, il proxy aggiunge il servizio alla cache e quando viene ricevuto un annuncio offline il servizio viene rimosso dalla cache.</span><span class="sxs-lookup"><span data-stu-id="6bf65-121">When an online announcement is received, the proxy adds the service to its cache and when an offline announcement is received it removes the service from its cache.</span></span>  
  
 <span data-ttu-id="6bf65-122">DiscoveryProxy.cs contiene l'implementazione di <xref:System.ServiceModel.Discovery.DiscoveryProxy>.</span><span class="sxs-lookup"><span data-stu-id="6bf65-122">The DiscoveryProxy.cs contains the implementation of the <xref:System.ServiceModel.Discovery.DiscoveryProxy>.</span></span> <span data-ttu-id="6bf65-123">Il proxy deve ereditare dalla classe <xref:System.Object> e richiede un'implementazione di <xref:System.Runtime.Remoting.Messaging.AsyncResult>.</span><span class="sxs-lookup"><span data-stu-id="6bf65-123">The Proxy must inherit from the <xref:System.Object> class and requires an implementation of <xref:System.Runtime.Remoting.Messaging.AsyncResult>.</span></span> <span data-ttu-id="6bf65-124">Durante la creazione di istanze, il proxy crea un nuovo <xref:System.Collections.Generic.Dictionary%602>, utilizzato per archiviare elementi noti.</span><span class="sxs-lookup"><span data-stu-id="6bf65-124">At instantiation, the Proxy creates a new <xref:System.Collections.Generic.Dictionary%602>, which it uses to store elements it knows about.</span></span>  
  
 <span data-ttu-id="6bf65-125">Il file è diviso in due aree, metodi della cache del proxy e implementazione del proxy di individuazione.</span><span class="sxs-lookup"><span data-stu-id="6bf65-125">The file is divided into two regions, Proxy Cache Methods and Discovery Proxy Implementation.</span></span> <span data-ttu-id="6bf65-126">L'area dei metodi della cache del proxy contiene metodi utilizzati per aggiornare <xref:System.Collections.Generic.Dictionary%602>, eseguire query su <xref:System.Collections.Generic.Dictionary%602> e stampare dati per gli utenti.</span><span class="sxs-lookup"><span data-stu-id="6bf65-126">The Proxy Cache Methods region contains methods used to update the <xref:System.Collections.Generic.Dictionary%602>, perform queries against the <xref:System.Collections.Generic.Dictionary%602>, and print the data for users.</span></span> <span data-ttu-id="6bf65-127">L'area di implementazione del proxy di individuazione contiene i metodi ignorati richiesti per la funzionalità di annuncio e probe.</span><span class="sxs-lookup"><span data-stu-id="6bf65-127">The Discovery Proxy Implementation region contains the overridden methods required for the Announcement and Probe functionality.</span></span> <span data-ttu-id="6bf65-128">Tali metodi definiscono le azioni intraprese da un proxy dopo avere ricevuto un annuncio online, un annuncio offline o un messaggio del probe.</span><span class="sxs-lookup"><span data-stu-id="6bf65-128">They define the actions taken by a proxy after receiving an Online Announcement, an Offline Announcement, or a Probe message.</span></span>  
  
## <a name="service"></a><span data-ttu-id="6bf65-129">Service</span><span class="sxs-lookup"><span data-stu-id="6bf65-129">Service</span></span>  
 <span data-ttu-id="6bf65-130">Nel file Program.cs nel progetto Service, lo stesso URI viene utilizzato per l'endpoint dell'annuncio come proxy di individuazione.</span><span class="sxs-lookup"><span data-stu-id="6bf65-130">In the Program.cs file in the Service project, the same URI is used for its announcement endpoint as the discovery proxy.</span></span> <span data-ttu-id="6bf65-131">Ciò si verifica perché il servizio utilizza l'endpoint per l'invio degli annunci, mentre il proxy lo utilizza per riceverli.</span><span class="sxs-lookup"><span data-stu-id="6bf65-131">This is because service uses the endpoint for sending the announcements, while the proxy uses it for receiving them.</span></span> <span data-ttu-id="6bf65-132">Il servizio utilizza <xref:System.ServiceModel.Discovery.EndpointDiscoveryBehavior> e aggiunge un endpoint relativo agli annunci.</span><span class="sxs-lookup"><span data-stu-id="6bf65-132">The service uses the <xref:System.ServiceModel.Discovery.EndpointDiscoveryBehavior> and adds an announcement endpoint to it.</span></span>  
  
## <a name="client"></a><span data-ttu-id="6bf65-133">Client</span><span class="sxs-lookup"><span data-stu-id="6bf65-133">Client</span></span>  
 <span data-ttu-id="6bf65-134">Il progetto Client utilizza lo stesso URI per l'endpoint del probe del proxy.</span><span class="sxs-lookup"><span data-stu-id="6bf65-134">The Client project uses the same URI for its probe endpoint as the Proxy.</span></span> <span data-ttu-id="6bf65-135">Ciò si verifica perché i probe in questo scenario vengono trasmessi in unicast in modo specifico all'endpoint disponibile nel proxy.</span><span class="sxs-lookup"><span data-stu-id="6bf65-135">This is because the probes in this scenario are also being unicast specifically to the endpoint available on the proxy.</span></span> <span data-ttu-id="6bf65-136">Il client si connette a questo indirizzo conosciuto, quindi esegue query per il servizio.</span><span class="sxs-lookup"><span data-stu-id="6bf65-136">The Client connects to this well-known address and then queries it for the service.</span></span> <span data-ttu-id="6bf65-137">Una volta individuato il servizio, effettua la connessione.</span><span class="sxs-lookup"><span data-stu-id="6bf65-137">Once it has found the service it connects to it.</span></span>  
  
#### <a name="to-use-this-sample"></a><span data-ttu-id="6bf65-138">Per usare questo esempio</span><span class="sxs-lookup"><span data-stu-id="6bf65-138">To use this sample</span></span>  
  
1.  <span data-ttu-id="6bf65-139">Caricare la soluzione del progetto in [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] e compilare il progetto.</span><span class="sxs-lookup"><span data-stu-id="6bf65-139">Load the project solution in [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] and build the project.</span></span>  
  
2.  <span data-ttu-id="6bf65-140">Eseguire prima l'applicazione del proxy di individuazione, generato in [directory soluzione di base]\DiscoveryProxy\bin\debug.</span><span class="sxs-lookup"><span data-stu-id="6bf65-140">First run the Discovery Proxy application, generated in [solution base directory]\DiscoveryProxy\bin\debug.</span></span> <span data-ttu-id="6bf65-141">Il proxy di individuazione deve essere eseguito per primo perché gli endpoint relativi agli annunci TCP devono essere attivi affinché il servizio possa inviare i propri annunci.</span><span class="sxs-lookup"><span data-stu-id="6bf65-141">The Discovery Proxy must run first because TCP announcement endpoints must be up for the service to send its announcements.</span></span>  
  
3.  <span data-ttu-id="6bf65-142">In secondo luogo, eseguire prima l'applicazione del servizio, generata in [directory soluzione di base]\Service\bin\debug.</span><span class="sxs-lookup"><span data-stu-id="6bf65-142">Second, run the service application generated in [solution base directory]\Service\bin\debug.</span></span> <span data-ttu-id="6bf65-143">All'avvio, il servizio invia un annuncio all'endpoint degli annunci del proxy di individuazione e tale annuncio viene registrato nella cache del proxy.</span><span class="sxs-lookup"><span data-stu-id="6bf65-143">At start-up, the service sends an announcement to the announcement endpoint of the discovery proxy and is registered in the proxy’s cache.</span></span>  
  
4.  <span data-ttu-id="6bf65-144">In seguito, eseguire prima l'applicazione client, generata in [directory soluzione di base]\Client\bin\debug.</span><span class="sxs-lookup"><span data-stu-id="6bf65-144">Next, run the client application, generated in [solution base directory]\Client\bin\debug.</span></span> <span data-ttu-id="6bf65-145">Il client esegue una query sul proxy, ottiene l'indirizzo del servizio, quindi si connette al servizio.</span><span class="sxs-lookup"><span data-stu-id="6bf65-145">The client queries the proxy, gets the service address and then connects to the service.</span></span>  
  
5.  <span data-ttu-id="6bf65-146">Infine, terminare il client, il servizio e quindi il proxy.</span><span class="sxs-lookup"><span data-stu-id="6bf65-146">Lastly, terminate the client, service and then the proxy.</span></span> <span data-ttu-id="6bf65-147">Il proxy deve essere in esecuzione per ricevere l'annuncio offline del servizio.</span><span class="sxs-lookup"><span data-stu-id="6bf65-147">The proxy must be running for it to receive the service's offline announcement.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6bf65-148">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="6bf65-148">See Also</span></span>
