---
title: Panoramica dell'architettura dei metadati
ms.date: 03/30/2017
helpviewer_keywords:
- metadata [WCF], overview
ms.assetid: 1d37645e-086d-4d68-a358-f3c5b6e8205e
ms.openlocfilehash: ccad6f8c2a289dae3ae4fdbbcc7c690b0fbc9085
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/04/2018
ms.locfileid: "33496893"
---
# <a name="metadata-architecture-overview"></a>Panoramica dell'architettura dei metadati
Windows Communication Foundation (WCF) fornisce un'infrastruttura avanzata per l'esportazione, la pubblicazione, il recupero e l'importazione di metadati del servizio. Servizi WCF utilizzano i metadati per descrivere come interagire con gli endpoint del servizio affinché strumenti, ad esempio Svcutil.exe, possono generare automaticamente il codice client per accedere al servizio.  
  
 La maggior parte dei tipi che costituiscono l'infrastruttura di metadati WCF si trovano nel <xref:System.ServiceModel.Description> dello spazio dei nomi.  
  
 WCF Usa il <xref:System.ServiceModel.Description.ServiceEndpoint> classe per descrivere gli endpoint in un servizio. È possibile usare WCF per generare metadati per gli endpoint del servizio o importare i metadati del servizio per generare <xref:System.ServiceModel.Description.ServiceEndpoint> istanze.  
  
 WCF rappresenta i metadati per un servizio come istanza del <xref:System.ServiceModel.Description.MetadataSet> tipo, la cui struttura è fortemente legata al formato di serializzazione dei metadati definito in WS-MetadataExchange. Il tipo <xref:System.ServiceModel.Description.MetadataSet> raggruppa i metadati effettivi del servizio, ad esempio i documenti Web Services Description Language (WSDL), i documenti di XML Schema o le espressioni WS-Policy, come raccolta di istanze di <xref:System.ServiceModel.Description.MetadataSection>. Ogni istanza di <xref:System.ServiceModel.Description.MetadataSection?displayProperty=nameWithType> contiene un sottolinguaggio dei metadati specifici e un identificatore. Una <xref:System.ServiceModel.Description.MetadataSection?displayProperty=nameWithType> può contenere gli elementi seguenti nella proprietà <xref:System.ServiceModel.Description.MetadataSection.Metadata%2A?displayProperty=nameWithType>:  
  
-   Metadati non elaborati.  
  
-   Istanza di <xref:System.ServiceModel.Description.MetadataReference>.  
  
-   Istanza di <xref:System.ServiceModel.Description.MetadataLocation>.  
  
 Le istanze di <xref:System.ServiceModel.Description.MetadataReference?displayProperty=nameWithType> puntano a un altro endpoint di scambio di metadati (MEX) e le istanze di <xref:System.ServiceModel.Description.MetadataLocation?displayProperty=nameWithType> puntano a un documento di metadati utilizzando un URL HTTP. WCF supporta l'utilizzo di documenti WSDL per descrivere gli endpoint del servizio, contratti di servizio, associazioni, modelli di scambio dei messaggi, messaggi e messaggi di errore implementati da un servizio. I tipi di dati utilizzati dal servizio sono descritti nei documenti WSDL utilizzando XML Schema. Per ulteriori informazioni, vedere [Schema importazione ed esportazione](../../../../docs/framework/wcf/feature-details/schema-import-and-export.md). È possibile utilizzare WCF per esportare e importare estensioni WSDL per il comportamento del servizio, i comportamenti del contratto e gli elementi di associazione che estendono la funzionalità di un servizio. Per altre informazioni, vedere [esportazione di metadati personalizzati per un'estensione WCF](../../../../docs/framework/wcf/extending/exporting-custom-metadata-for-a-wcf-extension.md).  
  
## <a name="exporting-service-metadata"></a>Esportazione di metadati del servizio  
 In WCF *esportazione dei metadati* è il processo di descrivere gli endpoint di servizio e quindi proiettarli in una rappresentazione parallela standardizzata che i client possono usare per comprendere come utilizzare il servizio. Per esportare metadati da istanze di <xref:System.ServiceModel.Description.ServiceEndpoint>, utilizzare un'implementazione della classe astratta <xref:System.ServiceModel.Description.MetadataExporter>. Un'implementazione <xref:System.ServiceModel.Description.MetadataExporter?displayProperty=nameWithType> genera metadati che sono incapsulati in un'istanza di <xref:System.ServiceModel.Description.MetadataSet>.  
  
 La classe <xref:System.ServiceModel.Description.MetadataExporter?displayProperty=nameWithType> fornisce un framework per la generazione di espressioni di criteri che descrivono le funzionalità e i requisiti di un'associazione di endpoint e le operazioni, i messaggi e gli errori pertinenti. Queste espressioni di criteri vengono acquisite in un'istanza di <xref:System.ServiceModel.Description.PolicyConversionContext>. Un'implementazione di <xref:System.ServiceModel.Description.MetadataExporter?displayProperty=nameWithType> può quindi collegare tali espressioni di criteri ai metadati che genera.  
  
 <xref:System.ServiceModel.Description.MetadataExporter?displayProperty=nameWithType> chiama ogni <xref:System.ServiceModel.Channels.BindingElement?displayProperty=nameWithType> che implementa l'interfaccia <xref:System.ServiceModel.Description.IPolicyExportExtension> nell'associazione di un <xref:System.ServiceModel.Description.ServiceEndpoint> durante la generazione di un oggetto <xref:System.ServiceModel.Description.PolicyConversionContext> che deve essere utilizzato dall'implementazione di <xref:System.ServiceModel.Description.MetadataExporter?displayProperty=nameWithType>. È possibile esportare nuove asserzioni di criteri implementando l'interfaccia <xref:System.ServiceModel.Description.IPolicyExportExtension> nelle implementazioni personalizzate del tipo <xref:System.ServiceModel.Channels.BindingElement>.  
  
 Il <xref:System.ServiceModel.Description.WsdlExporter> il tipo è l'implementazione del <xref:System.ServiceModel.Description.MetadataExporter?displayProperty=nameWithType> astratta incluso con WCF. Il tipo <xref:System.ServiceModel.Description.WsdlExporter> genera metadati WSDL con allegate le espressioni di criteri.  
  
 Per esportare metadati WSDL personalizzati o estensioni WSDL per i comportamenti degli endpoint, i comportamenti del contratto o elementi di associazione in un endpoint del servizio, è possibile implementare l'interfaccia <xref:System.ServiceModel.Description.IWsdlExportExtension>. <xref:System.ServiceModel.Description.WsdlExporter> cerca in un'istanza <xref:System.ServiceModel.Description.ServiceEndpoint> elementi di associazione, comportamenti dell'operazione, comportamenti del contratto e comportamenti degli endpoint che implementano l'interfaccia <xref:System.ServiceModel.Description.IWsdlExportExtension> in fase di generazione del documento WSDL.  
  
## <a name="publishing-service-metadata"></a>Pubblicazione di metadati del servizio  
 I servizi WCF pubblicano metadati esponendo uno o più endpoint dei metadati. La pubblicazione dei metadati del servizio li rende disponibili utilizzando i protocolli standard, ad esempio le richieste MEX e HTTP/GET. Gli endpoint dei metadati sono accomunati ad altri endpoint del servizio dal fatto di avere un indirizzo, un'associazione e un contratto. È possibile aggiungere endpoint dei metadati a un host del servizio nella configurazione o nel codice.  
  
 Per pubblicare endpoint dei metadati per un servizio WCF, è innanzitutto necessario aggiungere un'istanza di <xref:System.ServiceModel.Description.ServiceMetadataBehavior> comportamento al servizio del servizio. L'aggiunta di un'istanza <xref:System.ServiceModel.Description.ServiceMetadataBehavior?displayProperty=nameWithType> al servizio aggiunge a quest'ultimo la capacità di pubblicare metadati esponendo uno o più endpoint dei metadati. Dopo aver aggiunto il comportamento del servizio <xref:System.ServiceModel.Description.ServiceMetadataBehavior?displayProperty=nameWithType>, è possibile esporre gli endpoint dei metadati che supportano il protocollo MEX o quelli che rispondono alle richieste HTTP/GET.  
  
 Per aggiungere endpoint dei metadati che utilizzano il protocollo MEX, aggiungere gli endpoint del servizio all'host del servizio che utilizzano il contratto di servizio denominata IMetadataExchange.WCF definisce il <xref:System.ServiceModel.Description.IMetadataExchange> interfaccia con questo nome di contratto di servizio. Endpoint WS-MetadataExchange o MEX, possono utilizzare una delle quattro associazioni predefinite esposte tramite i metodi factory statici nel <xref:System.ServiceModel.Description.MetadataExchangeBindings> classe in modo che corrisponda associazioni predefinite utilizzate dagli strumenti WCF, ad esempio Svcutil.exe. È inoltre possibile configurare gli endpoint dei metadati MEX utilizzando un'associazione personalizzata.  
  
 <xref:System.ServiceModel.Description.ServiceMetadataBehavior> utilizza un oggetto <xref:System.ServiceModel.Description.WsdlExporter?displayProperty=nameWithType> per esportare i metadati per tutti gli endpoint nel servizio. Per ulteriori informazioni sull'esportazione di metadati da un servizio, vedere [esportazione e importazione di metadati](../../../../docs/framework/wcf/feature-details/exporting-and-importing-metadata.md).  
  
 <xref:System.ServiceModel.Description.ServiceMetadataBehavior> aggiunge all'host del servizio un'istanza di <xref:System.ServiceModel.Description.ServiceMetadataExtension> come estensione. <xref:System.ServiceModel.Description.ServiceMetadataExtension?displayProperty=nameWithType> fornisce l'implementazione per i metadati che pubblicano protocolli. È inoltre possibile utilizzare <xref:System.ServiceModel.Description.ServiceMetadataExtension?displayProperty=nameWithType> per ottenere i metadati del servizio in fase di esecuzione accedendo alla proprietà <xref:System.ServiceModel.Description.ServiceMetadataExtension.Metadata%2A>.  
  
> [!CAUTION]
>  Se si aggiunge un endpoint MEX al file di configurazione dell'applicazione e quindi si tenta di aggiungere l'oggetto <xref:System.ServiceModel.Description.ServiceMetadataBehavior> all'host del servizio nel codice, verrà generata l'eccezione seguente:  
>   
>  System.InvalidOperationException: Impossibile trovare il nome contratto 'IMetadataExchange' nell'elenco dei contratti implementati dal servizio Service1. Aggiungere un elemento ServiceMetadataBehavior al file di configurazione oppure direttamente a ServiceHost per abilitare il supporto per questo contratto.  
>   
>  Per risolvere il problema, aggiungere l'oggetto <xref:System.ServiceModel.Description.ServiceMetadataBehavior> al file di configurazione oppure aggiungere sia l'endpoint che l'oggetto <xref:System.ServiceModel.Description.ServiceMetadataBehavior> al codice.  
>   
>  Per un esempio di aggiunta <xref:System.ServiceModel.Description.ServiceMetadataBehavior> in un file di configurazione dell'applicazione, vedere il [Introduzione](../../../../docs/framework/wcf/samples/getting-started-sample.md). Per un esempio di aggiunta <xref:System.ServiceModel.Description.ServiceMetadataBehavior> nel codice, vedere il [indipendente](../../../../docs/framework/wcf/samples/self-host.md) esempio.  
  
> [!CAUTION]
>  Quando si pubblicano metadati per un servizio che espone due contratti di servizio diversi in cui ciascuno contiene un'operazione dello stesso nome viene generata un'eccezione. Se ad esempio è presente un servizio che espone un contratto di servizio denominato ICarService con un'operazione Get(Car c) e lo stesso servizio espone un contratto di servizio denominato IBookService con un'operazione Get(Book b), viene generata un'eccezione o viene visualizzato un messaggio di errore durante la creazione dei metadati del servizio. Per risolvere il problema, effettuare una delle operazioni seguenti:  
>   
>  -   Rinominare una delle operazioni.  
> -   Impostare <xref:System.ServiceModel.OperationContractAttribute.Name%2A> su un nome diverso.  
> -   Impostare uno degli spazi dei nomi delle operazioni su uno spazio dei nomi diverso, utilizzando la proprietà <xref:System.ServiceModel.ServiceContractAttribute.Namespace%2A>.  
  
## <a name="retrieving-service-metadata"></a>Recupero di metadati del servizio  
 WCF è possibile recuperare i metadati del servizio utilizzando protocolli standard, ad esempio WS-MetadataExchange e HTTP. Entrambi questi protocolli sono supportati dal tipo <xref:System.ServiceModel.Description.MetadataExchangeClient>. Per recuperare i metadati del servizio, utilizzare il tipo <xref:System.ServiceModel.Description.MetadataExchangeClient?displayProperty=nameWithType> fornendo un indirizzo e un'associazione facoltativa. L'associazione utilizzata da un'istanza <xref:System.ServiceModel.Description.MetadataExchangeClient?displayProperty=nameWithType> può essere una delle associazioni predefinite dalla classe statica <xref:System.ServiceModel.Description.MetadataExchangeBindings>, un'associazione fornita dall'utente o un'associazione caricata dalla configurazione dell'endpoint per il contratto `IMetadataExchange`. <xref:System.ServiceModel.Description.MetadataExchangeClient?displayProperty=nameWithType> può inoltre risolvere i riferimenti dell'URL HTTP ai metadati utilizzando il tipo <xref:System.Net.HttpWebRequest>.  
  
 Per impostazione predefinita, un'istanza di <xref:System.ServiceModel.Description.MetadataExchangeClient?displayProperty=nameWithType> è collegata a una sola istanza di <xref:System.ServiceModel.Channels.ChannelFactoryBase>. È possibile modificare o sostituire l'istanza di <xref:System.ServiceModel.Channels.ChannelFactoryBase> utilizzata da <xref:System.ServiceModel.Description.MetadataExchangeClient?displayProperty=nameWithType> eseguendo l'override del metodo virtuale <xref:System.ServiceModel.Description.MetadataExchangeClient.GetChannelFactory%2A>. Analogamente, è possibile modificare o sostituire l'istanza di <xref:System.Net.HttpWebRequest?displayProperty=nameWithType> utilizzata da <xref:System.ServiceModel.Description.MetadataExchangeClient?displayProperty=nameWithType> per le richieste HTTP/GET eseguendo l'override del metodo virtuale <xref:System.ServiceModel.Description.MetadataExchangeClient.GetWebRequest%2A?displayProperty=nameWithType>.  
  
 È possibile recuperare i metadati del servizio utilizzando richieste WS-MetadataExchange o HTTP/GET utilizzando lo strumento Svcutil.exe e passando il **/target:metadata** switch e un indirizzo. Svcutil.exe scarica i metadati all'indirizzo specificato e salva i file su disco. Svcutil.exe utilizza un'istanza di <xref:System.ServiceModel.Description.MetadataExchangeClient?displayProperty=nameWithType> internamente e carica una configurazione dell'endpoint MEX (dal file di configurazione dell'applicazione) il cui nome corrisponde allo schema dell'indirizzo passato a Svcutil.exe, se presente. In caso contrario, Svcutil.exe utilizza per impostazione predefinita una delle associazioni definite dal tipo di factory statico <xref:System.ServiceModel.Description.MetadataExchangeBindings>.  
  
## <a name="importing-service-metadata"></a>Importazione di metadati del servizio  
 In WCF, importazione dei metadati è il processo di generazione di una rappresentazione astratta di un servizio o alle relative parti componente dai relativi metadati. Ad esempio, è possibile importare WCF <xref:System.ServiceModel.Description.ServiceEndpoint> casi <xref:System.ServiceModel.Channels.Binding> istanze o <xref:System.ServiceModel.Description.ContractDescription> documentare le istanze di un documento WSDL per un servizio. Per importare i metadati del servizio in WCF, utilizzare un'implementazione della <xref:System.ServiceModel.Description.MetadataImporter> classe astratta. Tipi che derivano dal <xref:System.ServiceModel.Description.MetadataImporter?displayProperty=nameWithType> classe implementano il supporto per l'importazione dei formati dei metadati che utilizzano WS-Policy importare logica di WCF.  
  
 Un'implementazione di <xref:System.ServiceModel.Description.MetadataImporter?displayProperty=nameWithType> raccoglie le espressioni di criteri collegate ai metadati del servizio in un oggetto <xref:System.ServiceModel.Description.PolicyConversionContext>. <xref:System.ServiceModel.Description.MetadataImporter?displayProperty=nameWithType> elabora quindi i criteri come parte dell'importazione dei metadati chiamando le implementazioni dell'interfaccia <xref:System.ServiceModel.Description.IPolicyImportExtension> nella proprietà <xref:System.ServiceModel.Description.MetadataImporter.PolicyImportExtensions%2A>.  
  
 È possibile aggiungere il supporto per importare nuove asserzioni di criteri in un <xref:System.ServiceModel.Description.MetadataImporter?displayProperty=nameWithType> aggiungendo la propria implementazione dell'interfaccia <xref:System.ServiceModel.Description.IPolicyImportExtension> alla raccolta <xref:System.ServiceModel.Description.MetadataImporter.PolicyImportExtensions%2A> in un'istanza <xref:System.ServiceModel.Description.MetadataImporter?displayProperty=nameWithType>. In alternativa, è possibile registrare l'estensione di importazione dei criteri nel file di configurazione dell'applicazione client.  
  
 Il <xref:System.ServiceModel.Description.WsdlImporter?displayProperty=nameWithType> il tipo è l'implementazione del <xref:System.ServiceModel.Description.MetadataImporter?displayProperty=nameWithType> astratta incluso con WCF. Il tipo <xref:System.ServiceModel.Description.WsdlImporter?displayProperty=nameWithType> importa metadati WSDL insieme ai relativi criteri allegati. Questi elementi vengono quindi raggruppati in un oggetto <xref:System.ServiceModel.Description.MetadataSet>.  
  
 Per aggiungere il supporto per l'importazione di estensioni WSDL, implementare l'interfaccia <xref:System.ServiceModel.Description.IWsdlImportExtension>, quindi aggiungere tale implementazione alla proprietà <xref:System.ServiceModel.Description.WsdlImporter.WsdlImportExtensions%2A> nell'istanza di <xref:System.ServiceModel.Description.WsdlImporter?displayProperty=nameWithType>. È inoltre possibile utilizzare il tipo <xref:System.ServiceModel.Description.WsdlImporter?displayProperty=nameWithType> per caricare implementazioni dell'interfaccia <xref:System.ServiceModel.Description.IWsdlImportExtension?displayProperty=nameWithType> registrate nel file di configurazione dell'applicazione client.  
  
## <a name="dynamic-bindings"></a>Associazioni dinamiche  
 È possibile aggiornare dinamicamente l'associazione utilizzata per creare un canale per un endpoint del servizio nel caso in cui l'associazione per l'endpoint cambi o si desideri creare un canale per un endpoint che utilizza lo stesso contratto ma ha un'associazione diversa. È possibile utilizzare la <xref:System.ServiceModel.Description.MetadataResolver> classe statica per recuperare e importare metadati in fase di esecuzione per endpoint del servizio che implementano un contratto specifico. È quindi possibile utilizzare gli oggetti <xref:System.ServiceModel.Description.ServiceEndpoint?displayProperty=nameWithType> importati per creare un client o una channel factory per l'endpoint desiderato.  
  
## <a name="see-also"></a>Vedere anche  
 <xref:System.ServiceModel.Description>  
 [Formati dei metadati](../../../../docs/framework/wcf/feature-details/metadata-formats.md)  
 [Esportazione e importazione di metadati](../../../../docs/framework/wcf/feature-details/exporting-and-importing-metadata.md)  
 [Pubblicazione di metadati](../../../../docs/framework/wcf/feature-details/publishing-metadata.md)  
 [Recupero di metadati](../../../../docs/framework/wcf/feature-details/retrieving-metadata.md)  
 [Uso di metadati](../../../../docs/framework/wcf/feature-details/using-metadata.md)  
 [Considerazioni sulla sicurezza con i metadati](../../../../docs/framework/wcf/feature-details/security-considerations-with-metadata.md)  
 [Estensione del sistema di metadati](../../../../docs/framework/wcf/extending/extending-the-metadata-system.md)
