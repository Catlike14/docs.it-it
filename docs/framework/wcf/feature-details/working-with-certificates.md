---
title: Utilizzo dei certificati
ms.custom: ''
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: ''
ms.suite: ''
ms.technology:
- dotnet-clr
ms.tgt_pltfrm: ''
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords:
- certificates [WCF]
ms.assetid: 6ffb8682-8f07-4a45-afbb-8d2487e9dbc3
caps.latest.revision: 26
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload:
- dotnet
ms.openlocfilehash: e731fd31f2a247466891abbf75d67a61dba7f286
ms.sourcegitcommit: 03ee570f6f528a7d23a4221dcb26a9498edbdf8c
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/28/2018
---
# <a name="working-with-certificates"></a><span data-ttu-id="3d561-102">Utilizzo dei certificati</span><span class="sxs-lookup"><span data-stu-id="3d561-102">Working with Certificates</span></span>
<span data-ttu-id="3d561-103">Per programmare le funzionalità di sicurezza di [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] in genere si utilizzano i certificati digitali X.509. In particolare, questi certificati vengono utilizzati per autenticare client e server nonché per crittografare e firmare digitalmente i messaggi.</span><span class="sxs-lookup"><span data-stu-id="3d561-103">To program [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] security, X.509 digital certificates are commonly used to authenticate clients and servers, encrypt, and digitally sign messages.</span></span> <span data-ttu-id="3d561-104">Questo argomento fornisce una breve descrizione delle funzionalità relative ai certificati digitali X.509 e illustra come utilizzarle in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]. Questo argomento contiene inoltre i collegamenti agli argomenti che trattano questi concetti in modo più dettagliato o che descrivono come eseguire attività comuni tramite l'utilizzo di [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] e dei certificati.</span><span class="sxs-lookup"><span data-stu-id="3d561-104">This topic briefly explains X.509 digital certificate features and how to use them in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], and includes links to topics that explain these concepts further or that show how to accomplish common tasks using [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] and certificates.</span></span>  
  
 <span data-ttu-id="3d561-105">In breve, un certificato digitale è una parte di un *infrastruttura a chiave pubblica* (PKI), che è un sistema di certificati digitali, autorità di certificazione e altre autorità di registrazione che verificano e autenticano la validità di ogni parte coinvolta in una transazione elettronica tramite l'utilizzo di crittografia a chiave pubblica.</span><span class="sxs-lookup"><span data-stu-id="3d561-105">In brief, a digital certificate is a part of a *public key infrastructure* (PKI), which is a system of digital certificates, certificate authorities, and other registration authorities that verify and authenticate the validity of each party involved in an electronic transaction through the use of public key cryptography.</span></span> <span data-ttu-id="3d561-106">Un'autorità di certificazione rilascia certificati e ogni certificato ha un set di campi che contengono dati, ad esempio *soggetto* (l'entità a cui viene rilasciato il certificato), le date di validità (quando il certificato è valido), (l'autorità emittente entità che ha emesso il certificato) e una chiave pubblica.</span><span class="sxs-lookup"><span data-stu-id="3d561-106">A certification authority issues certificates and each certificate has a set of fields that contain data, such as *subject* (the entity to which the certificate is issued), validity dates (when the certificate is valid), issuer (the entity that issued the certificate), and a public key.</span></span> <span data-ttu-id="3d561-107">In [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], ognuna di queste proprietà viene elaborata come un'attestazione <xref:System.IdentityModel.Claims.Claim>. Esistono due tipi di attestazioni: di identità e di diritto.</span><span class="sxs-lookup"><span data-stu-id="3d561-107">In [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], each of these properties is processed as a <xref:System.IdentityModel.Claims.Claim>, and each claim is further divided into two types: identity and right.</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="3d561-108"> Vedere i certificati X.509 [certificati a chiave pubblica X.509](http://go.microsoft.com/fwlink/?LinkId=209952) [!INCLUDE[crabout](../../../../includes/crabout-md.md)] attestazioni e l'autorizzazione in WCF vedere [gestione attestazioni e autorizzazioni con il modello di identità](../../../../docs/framework/wcf/feature-details/managing-claims-and-authorization-with-the-identity-model.md).</span><span class="sxs-lookup"><span data-stu-id="3d561-108"> X.509 certificates see [X.509 Public Key Certificates](http://go.microsoft.com/fwlink/?LinkId=209952)[!INCLUDE[crabout](../../../../includes/crabout-md.md)] Claims and Authorization in WCF see [Managing Claims and Authorization with the Identity Model](../../../../docs/framework/wcf/feature-details/managing-claims-and-authorization-with-the-identity-model.md).</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="3d561-109"> implementazione di un'infrastruttura PKI, vedere [Windows Server 2008 R2 - Servizi certificati](http://go.microsoft.com/fwlink/?LinkId=209949).</span><span class="sxs-lookup"><span data-stu-id="3d561-109"> implementing a PKI, see [Windows Server 2008 R2 - Certificate Services](http://go.microsoft.com/fwlink/?LinkId=209949).</span></span>  
  
 <span data-ttu-id="3d561-110">Una delle funzionalità principali di un certificato è consentire l'autenticazione dell'identità del proprietario del certificato presso altre entità.</span><span class="sxs-lookup"><span data-stu-id="3d561-110">A primary function of the certificate is to authenticate the identity of the owner of the certificate to others.</span></span> <span data-ttu-id="3d561-111">Contiene un certificato di *chiave pubblica* del proprietario, mentre il proprietario conserva la chiave privata.</span><span class="sxs-lookup"><span data-stu-id="3d561-111">A certificate contains the *public key* of the owner, while the owner retains the private key.</span></span> <span data-ttu-id="3d561-112">La chiave pubblica può essere utilizzata per crittografare i messaggi inviati al proprietario del certificato.</span><span class="sxs-lookup"><span data-stu-id="3d561-112">The public key can be used to encrypt messages sent to the owner of the certificate.</span></span> <span data-ttu-id="3d561-113">In quanto unico detentore della chiave privata, solo il proprietario è in grado di decrittografare questi messaggi.</span><span class="sxs-lookup"><span data-stu-id="3d561-113">Only the owner has access to the private key, so only the owner can decrypt those messages.</span></span>  
  
 <span data-ttu-id="3d561-114">I certificati devono essere rilasciati da un autorità di certificazione, che spesso è un'emittente di certificati di terze parti.</span><span class="sxs-lookup"><span data-stu-id="3d561-114">Certificates must be issued by a certification authority, which is often a third-party  issuer of certificates.</span></span> <span data-ttu-id="3d561-115">Nei domini Windows è disponibile un'autorità di certificazione utilizzabile per rilasciare certificati ai computer appartenenti al dominio.</span><span class="sxs-lookup"><span data-stu-id="3d561-115">On a Windows domain, a certification authority is included that can be used to issue certificates to computers on the domain.</span></span>  
  
## <a name="viewing-certificates"></a><span data-ttu-id="3d561-116">Visualizzazione dei certificati</span><span class="sxs-lookup"><span data-stu-id="3d561-116">Viewing Certificates</span></span>  
 <span data-ttu-id="3d561-117">Quando si utilizzano i certificati, spesso è necessario visualizzarli e analizzarne le proprietà.</span><span class="sxs-lookup"><span data-stu-id="3d561-117">To work with certificates, it is often necessary to view them and examine their properties.</span></span> <span data-ttu-id="3d561-118">A tale scopo è possibile ricorrere allo snap-in Microsoft Management Console (MMC), uno strumento di facile utilizzo.</span><span class="sxs-lookup"><span data-stu-id="3d561-118">This is easily done with the Microsoft Management Console (MMC) snap-in tool.</span></span> <span data-ttu-id="3d561-119">Per ulteriori informazioni, vedere [procedura: visualizzare certificati con lo Snap-in MMC](../../../../docs/framework/wcf/feature-details/how-to-view-certificates-with-the-mmc-snap-in.md).</span><span class="sxs-lookup"><span data-stu-id="3d561-119">For more information, see [How to: View Certificates with the MMC Snap-in](../../../../docs/framework/wcf/feature-details/how-to-view-certificates-with-the-mmc-snap-in.md).</span></span>  
  
## <a name="certificate-stores"></a><span data-ttu-id="3d561-120">Archivi certificati</span><span class="sxs-lookup"><span data-stu-id="3d561-120">Certificate Stores</span></span>  
 <span data-ttu-id="3d561-121">I certificati vengono memorizzati in appositi archivi.</span><span class="sxs-lookup"><span data-stu-id="3d561-121">Certificates are found in stores.</span></span> <span data-ttu-id="3d561-122">Sono disponibili due posizioni principali di archiviazione, ognuna delle quali è composta da più sottoarchivi.</span><span class="sxs-lookup"><span data-stu-id="3d561-122">Two major store locations exist that are further divided into sub-stores.</span></span> <span data-ttu-id="3d561-123">Gli amministratori di un computer possono visualizzare entrambi gli archivi principali mediante lo snap-in MMC.</span><span class="sxs-lookup"><span data-stu-id="3d561-123">If you are the administrator on a computer, you can view both major stores by using the MMC snap-in tool.</span></span> <span data-ttu-id="3d561-124">Gli altri utenti, invece, sono in grado di visualizzare soltanto l'archivio utente corrente.</span><span class="sxs-lookup"><span data-stu-id="3d561-124">Non-administrators can view only the current user store.</span></span>  
  
-   <span data-ttu-id="3d561-125">**Archivio del computer locale**.</span><span class="sxs-lookup"><span data-stu-id="3d561-125">**The local machine store**.</span></span> <span data-ttu-id="3d561-126">contiene i certificati utilizzati dai processi del computer, ad esempio [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3d561-126">This contains the certificates accessed by machine processes, such as [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)].</span></span> <span data-ttu-id="3d561-127">Utilizzare questa posizione per archiviare i certificati utilizzati per l'autenticazione del server presso i client.</span><span class="sxs-lookup"><span data-stu-id="3d561-127">Use this location to store certificates that authenticate the server to clients.</span></span>  
  
-   <span data-ttu-id="3d561-128">**L'archivio utente corrente**.</span><span class="sxs-lookup"><span data-stu-id="3d561-128">**The current user store**.</span></span> <span data-ttu-id="3d561-129">questa posizione in genere viene utilizzata dalle applicazioni interattive per memorizzare i certificati relativi all'utente corrente del computer.</span><span class="sxs-lookup"><span data-stu-id="3d561-129">Interactive applications typically place certificates here for the computer's current user.</span></span> <span data-ttu-id="3d561-130">Se si crea un'applicazione client, utilizzare questa posizione per archiviare i certificati utilizzati per l'autenticazione degli utenti presso un servizio.</span><span class="sxs-lookup"><span data-stu-id="3d561-130">If you are creating a client application, this is where you typically place certificates that authenticate a user to a service.</span></span>  
  
 <span data-ttu-id="3d561-131">Ognuno di questi due archivi è composto da più sottoarchivi.</span><span class="sxs-lookup"><span data-stu-id="3d561-131">These two stores are further divided into sub-stores.</span></span> <span data-ttu-id="3d561-132">Segue l'elenco di alcuni dei sottoarchivi più importanti quando si programma in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="3d561-132">The most important of these when programming with [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] include:</span></span>  
  
-   <span data-ttu-id="3d561-133">**Autorità di certificazione radice attendibili**.</span><span class="sxs-lookup"><span data-stu-id="3d561-133">**Trusted Root Certification Authorities**.</span></span> <span data-ttu-id="3d561-134">i certificati contenuti in questo archivio possono essere utilizzati per creare una catena di certificati che consente di risalire a un certificato di autorità di certificazione di questo archivio.</span><span class="sxs-lookup"><span data-stu-id="3d561-134">You can use the certificates in this store to create a chain of certificates, which can be traced back to a certification authority certificate in this store.</span></span>  
  
    > [!IMPORTANT]
    >  <span data-ttu-id="3d561-135">Il computer locale considera implicitamente attendibile qualsiasi certificato posizionato in questo archivio, anche se il certificato non è stato rilasciato da un autorità di certificazione di terze parti attendibile.</span><span class="sxs-lookup"><span data-stu-id="3d561-135">The local computer implicitly trusts any certificate placed in this store, even if the certificate does not come from a trusted third-party certification authority.</span></span> <span data-ttu-id="3d561-136">È pertanto necessario garantire che questo archivio contenga soltanto certificati rilasciati da emittenti completamente attendibili, nonché comprendere quali problemi possono verificarsi qualora questa indicazione non venga rispettata.</span><span class="sxs-lookup"><span data-stu-id="3d561-136">For this reason, do not place any certificate into this store unless you fully trust the issuer and understand the consequences.</span></span>  
  
-   <span data-ttu-id="3d561-137">**Personale**.</span><span class="sxs-lookup"><span data-stu-id="3d561-137">**Personal**.</span></span> <span data-ttu-id="3d561-138">questo archivio viene utilizzato per i certificati associati a un utente di un computer.</span><span class="sxs-lookup"><span data-stu-id="3d561-138">This store is used for certificates associated with a user of a computer.</span></span> <span data-ttu-id="3d561-139">In genere questo archivio viene utilizzato per i certificati rilasciati mediante uno dei certificati di autorità di certificazione contenuti nell'archivio Autorità di certificazione radice disponibile nell'elenco locale.</span><span class="sxs-lookup"><span data-stu-id="3d561-139">Typically this store is used for certificates issued by one of the certification authority certificates found in the Trusted Root Certification Authorities store.</span></span> <span data-ttu-id="3d561-140">In alternativa, questo archivio può contenere certificati autocertificati ritenuti attendibili da un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="3d561-140">Alternatively, a certificate found here may be self-issued and trusted by an application.</span></span>  
  
 [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="3d561-141"> gli archivi certificati, vedere [archivi certificati](http://go.microsoft.com/fwlink/?LinkId=88912).</span><span class="sxs-lookup"><span data-stu-id="3d561-141"> certificate stores, see [Certificate Stores](http://go.microsoft.com/fwlink/?LinkId=88912).</span></span>  
  
### <a name="selecting-a-store"></a><span data-ttu-id="3d561-142">Scelta di un archivio</span><span class="sxs-lookup"><span data-stu-id="3d561-142">Selecting a Store</span></span>  
 <span data-ttu-id="3d561-143">La scelta della posizione in cui archiviare un certificato dipende dalla modalità di esecuzione del servizio o del client.</span><span class="sxs-lookup"><span data-stu-id="3d561-143">Selecting where to store a certificate depends how and when the service or client runs.</span></span> <span data-ttu-id="3d561-144">In particolare, la scelta si basa sulle regole di carattere generale seguenti:</span><span class="sxs-lookup"><span data-stu-id="3d561-144">The following general rules apply:</span></span>  
  
-   <span data-ttu-id="3d561-145">Se il servizio WCF è ospitato in un servizio Windows utilizzare il **computer locale** archiviare.</span><span class="sxs-lookup"><span data-stu-id="3d561-145">If the WCF service is hosted in a Windows service use the **local machine** store.</span></span> <span data-ttu-id="3d561-146">Si noti che per memorizzare certificati in questo archivio è necessario disporre dei privilegi di amministratore.</span><span class="sxs-lookup"><span data-stu-id="3d561-146">Note that administrator privileges are required to install certificates into the local machine store.</span></span>  
  
-   <span data-ttu-id="3d561-147">Se il servizio o il client è un'applicazione che viene eseguito con un account utente, utilizzare il **utente corrente** archiviare.</span><span class="sxs-lookup"><span data-stu-id="3d561-147">If the service or client is an application that runs under a user account, then use the **current user** store.</span></span>  
  
### <a name="accessing-stores"></a><span data-ttu-id="3d561-148">Accesso agli archivi</span><span class="sxs-lookup"><span data-stu-id="3d561-148">Accessing Stores</span></span>  
 <span data-ttu-id="3d561-149">Analogamente alle cartelle di un computer, anche gli archivi vengono protetti tramite gli elenchi di controllo di accesso (ACL, Access Control List).</span><span class="sxs-lookup"><span data-stu-id="3d561-149">Stores are protected by access control lists (ACLs), just like folders on a computer.</span></span> <span data-ttu-id="3d561-150">Quando si crea un servizio ospitato in Internet Information Services (IIS), il processo [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] è in esecuzione nell'account [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3d561-150">When creating a service hosted by Internet Information Services (IIS), the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] process runs under the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] account.</span></span> <span data-ttu-id="3d561-151">Tale account deve essere autorizzato ad accedere all'archivio contenente i certificati utilizzati da un servizio.</span><span class="sxs-lookup"><span data-stu-id="3d561-151">That account must have access to the store that contains the certificates a service uses.</span></span> <span data-ttu-id="3d561-152">Ogni archivio principale viene protetto mediante un ACL predefinito, che tuttavia può essere modificato.</span><span class="sxs-lookup"><span data-stu-id="3d561-152">Each of the major stores is protected with a default access list, but the lists can be modified.</span></span> <span data-ttu-id="3d561-153">Se si crea un ruolo a parte per accedere a un archivio, a tale ruolo è necessario concedere l'autorizzazione di accesso.</span><span class="sxs-lookup"><span data-stu-id="3d561-153">If you create a separate role to access a store, you must grant that role access permission.</span></span> <span data-ttu-id="3d561-154">Per informazioni su come modificare l'elenco di accesso utilizzando lo strumento WinHttpCertConfig.exe, vedere [procedura: creare certificati temporanei da usare durante lo sviluppo](../../../../docs/framework/wcf/feature-details/how-to-create-temporary-certificates-for-use-during-development.md).</span><span class="sxs-lookup"><span data-stu-id="3d561-154">To learn how to modify the access list using the WinHttpCertConfig.exe tool, see [How to: Create Temporary Certificates for Use During Development](../../../../docs/framework/wcf/feature-details/how-to-create-temporary-certificates-for-use-during-development.md).</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="3d561-155"> utilizzo di certificati client con IIS, vedere [come chiamare un servizio Web usando un certificato client per l'autenticazione in un'applicazione Web ASP.NET](http://go.microsoft.com/fwlink/?LinkId=88914).</span><span class="sxs-lookup"><span data-stu-id="3d561-155"> using client certificates with IIS, see [How to call a Web service by using a client certificate for authentication in an ASP.NET Web application](http://go.microsoft.com/fwlink/?LinkId=88914).</span></span>  
  
## <a name="chain-trust-and-certificate-authorities"></a><span data-ttu-id="3d561-156">Catena di trust e autorità di certificazione</span><span class="sxs-lookup"><span data-stu-id="3d561-156">Chain Trust and Certificate Authorities</span></span>  
 <span data-ttu-id="3d561-157">I certificati vengono creati in una gerarchia dove ogni singolo certificato è collegato alla CA che ha emesso il certificato.</span><span class="sxs-lookup"><span data-stu-id="3d561-157">Certificates are created in a hierarchy where each individual certificate is linked to the CA that issued the certificate.</span></span> <span data-ttu-id="3d561-158">Questo collegamento è per il certificato della CA.</span><span class="sxs-lookup"><span data-stu-id="3d561-158">This link is to the CA’s certificate.</span></span> <span data-ttu-id="3d561-159">Il certificato della CA collega quindi la CA che ha emesso il certificato della CA originale.</span><span class="sxs-lookup"><span data-stu-id="3d561-159">The CA’s certificate then links to the CA that issued the orginal CA’s certificate.</span></span> <span data-ttu-id="3d561-160">Questo processo si ripete fino a raggiungere il certificato della CA radice.</span><span class="sxs-lookup"><span data-stu-id="3d561-160">This process is repeated up until the Root CA’s certificate is reached.</span></span> <span data-ttu-id="3d561-161">Il certificato della CA radice è considerato naturalmente attendibile.</span><span class="sxs-lookup"><span data-stu-id="3d561-161">The Root CA’s certificate is inherently trusted.</span></span>  
  
 <span data-ttu-id="3d561-162">I certificati digitali vengono utilizzati per autenticare un'entità basandosi questa gerarchia, detta anche un *catena di certificati*.</span><span class="sxs-lookup"><span data-stu-id="3d561-162">Digital certificates are used to authenticate an entity by relying this hierarchy, also called a *chain of trust*.</span></span> <span data-ttu-id="3d561-163">È possibile visualizzare una catena di qualsiasi certificato utilizzando lo snap-in MMC facendo doppio clic su qualsiasi certificato e scegliendo il **percorso certificato** scheda [!INCLUDE[crabout](../../../../includes/crabout-md.md)] importazione catene di certificati per autorità di certificazione, vedere [Procedura: specificare la catena di certificati Autorità di certificazione utilizzata per verificare le firme](../../../../docs/framework/wcf/feature-details/specify-the-certificate-authority-chain-verify-signatures-wcf.md).</span><span class="sxs-lookup"><span data-stu-id="3d561-163">You can view any certificate's chain using the MMC snap-in by double-clicking any certificate, then clicking the **Certificate Path** tab. [!INCLUDE[crabout](../../../../includes/crabout-md.md)] importing certificate chains for a Certification authority, see [How to: Specify the Certificate Authority Certificate Chain Used to Verify Signatures](../../../../docs/framework/wcf/feature-details/specify-the-certificate-authority-chain-verify-signatures-wcf.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="3d561-164">Qualsiasi emittente può essere definito come un'autorità radice attendibile. A tale scopo, aggiungere il certificato di tale emittente nell'archivio Autorità di certificazione radice attendibili.</span><span class="sxs-lookup"><span data-stu-id="3d561-164">Any issuer can be designated a trusted root authority by placing the issuer's certificate in the trusted root authority certificate store.</span></span>  
  
### <a name="disabling-chain-trust"></a><span data-ttu-id="3d561-165">Disabilitazione della catena di trust</span><span class="sxs-lookup"><span data-stu-id="3d561-165">Disabling Chain Trust</span></span>  
 <span data-ttu-id="3d561-166">Quando si crea un nuovo servizio è possibile che si utilizzi un certificato che non è stato rilasciato tramite un certificato radice attendibile oppure che il certificato emittente non sia contenuto nell'archivio Autorità di certificazione radice attendibili.</span><span class="sxs-lookup"><span data-stu-id="3d561-166">When creating a new service, you may be using a certificate that is not issued by a trusted root certificate, or the issuing certificate itself may not be in the Trusted Root Certification Authorities store.</span></span> <span data-ttu-id="3d561-167">In questo caso, e solo per scopi di sviluppo, è possibile disabilitare temporaneamente il meccanismo che verifica la catena di trust di un certificato.</span><span class="sxs-lookup"><span data-stu-id="3d561-167">For development purposes only, you can temporarily disable the mechanism that checks the chain of trust for a certificate.</span></span> <span data-ttu-id="3d561-168">A tale scopo, impostare la proprietà `CertificateValidationMode` su `PeerTrust` oppure su `PeerOrChainTrust`.</span><span class="sxs-lookup"><span data-stu-id="3d561-168">To do this, set the `CertificateValidationMode` property to either `PeerTrust` or `PeerOrChainTrust`.</span></span> <span data-ttu-id="3d561-169">Queste modalità specificano rispettivamente che il certificato può essere autocertificato (trust peer) o appartenere a una catena di trust.</span><span class="sxs-lookup"><span data-stu-id="3d561-169">Either mode specifies that the certificate can either be self-issued (peer trust) or part of a chain of trust.</span></span> <span data-ttu-id="3d561-170">Questa proprietà può essere impostata in una qualsiasi delle classi seguenti:</span><span class="sxs-lookup"><span data-stu-id="3d561-170">You can set the property on any of the following classes.</span></span>  
  
|<span data-ttu-id="3d561-171">Classe</span><span class="sxs-lookup"><span data-stu-id="3d561-171">Class</span></span>|<span data-ttu-id="3d561-172">Proprietà</span><span class="sxs-lookup"><span data-stu-id="3d561-172">Property</span></span>|  
|-----------|--------------|  
|<xref:System.ServiceModel.Security.X509ClientCertificateAuthentication>|<xref:System.ServiceModel.Security.X509ClientCertificateAuthentication.CertificateValidationMode%2A?displayProperty=nameWithType>|  
|<xref:System.ServiceModel.Security.X509PeerCertificateAuthentication>|<xref:System.ServiceModel.Security.X509PeerCertificateAuthentication.CertificateValidationMode%2A?displayProperty=nameWithType>|  
|<xref:System.ServiceModel.Security.X509ServiceCertificateAuthentication>|<xref:System.ServiceModel.Security.X509ServiceCertificateAuthentication.CertificateValidationMode%2A?displayProperty=nameWithType>|  
|<xref:System.ServiceModel.Security.IssuedTokenServiceCredential>|<xref:System.ServiceModel.Security.IssuedTokenServiceCredential.CertificateValidationMode%2A?displayProperty=nameWithType>|  
  
 <span data-ttu-id="3d561-173">La proprietà può anche essere impostata in configurazione.</span><span class="sxs-lookup"><span data-stu-id="3d561-173">You can also set the property using configuration.</span></span> <span data-ttu-id="3d561-174">Gli elementi seguenti vengono utilizzati per specificare la modalità di convalida:</span><span class="sxs-lookup"><span data-stu-id="3d561-174">The following elements are used to specify the validation mode:</span></span>  
  
-   [<span data-ttu-id="3d561-175">\<authentication></span><span class="sxs-lookup"><span data-stu-id="3d561-175">\<authentication></span></span>](../../../../docs/framework/configure-apps/file-schema/wcf/authentication-of-servicecertificate-element.md)  
  
-   [<span data-ttu-id="3d561-176">\<peerAuthentication></span><span class="sxs-lookup"><span data-stu-id="3d561-176">\<peerAuthentication></span></span>](../../../../docs/framework/configure-apps/file-schema/wcf/peerauthentication-element.md)  
  
-   [<span data-ttu-id="3d561-177">\<messageSenderAuthentication></span><span class="sxs-lookup"><span data-stu-id="3d561-177">\<messageSenderAuthentication></span></span>](../../../../docs/framework/configure-apps/file-schema/wcf/messagesenderauthentication-element.md)  
  
## <a name="custom-authentication"></a><span data-ttu-id="3d561-178">Autenticazione personalizzata</span><span class="sxs-lookup"><span data-stu-id="3d561-178">Custom Authentication</span></span>  
 <span data-ttu-id="3d561-179">La proprietà `CertificateValidationMode` consente inoltre di personalizzare la modalità di autenticazione dei certificati.</span><span class="sxs-lookup"><span data-stu-id="3d561-179">The `CertificateValidationMode` property also enables you to customize how certificates are authenticated.</span></span> <span data-ttu-id="3d561-180">Per impostazione predefinita, il livello è impostato su `ChainTrust`.</span><span class="sxs-lookup"><span data-stu-id="3d561-180">By default, the level is set to `ChainTrust`.</span></span> <span data-ttu-id="3d561-181">Per usare il valore <xref:System.ServiceModel.Security.X509CertificateValidationMode.Custom> è necessario impostare anche l'attributo `CustomCertificateValidatorType` sull'assembly e sul tipo usati per convalidare il certificato.</span><span class="sxs-lookup"><span data-stu-id="3d561-181">To use the <xref:System.ServiceModel.Security.X509CertificateValidationMode.Custom> value, you must also set the `CustomCertificateValidatorType` attribute to an assembly and type used to validate the certificate.</span></span> <span data-ttu-id="3d561-182">Per creare un validator personalizzato è necessario ereditare una classe dalla classe astratta <xref:System.IdentityModel.Selectors.X509CertificateValidator>.</span><span class="sxs-lookup"><span data-stu-id="3d561-182">To create a custom validator, you must inherit from the abstract <xref:System.IdentityModel.Selectors.X509CertificateValidator> class.</span></span>  
  
 <span data-ttu-id="3d561-183">Quando si crea un autenticatore personalizzato è fondamentale eseguire l'override del metodo <xref:System.IdentityModel.Selectors.X509CertificateValidator.Validate%2A>.</span><span class="sxs-lookup"><span data-stu-id="3d561-183">When creating a custom authenticator, the most important method to override is the <xref:System.IdentityModel.Selectors.X509CertificateValidator.Validate%2A> method.</span></span> <span data-ttu-id="3d561-184">Per un esempio di autenticazione personalizzata, vedere il [Validator del certificato x. 509](../../../../docs/framework/wcf/samples/x-509-certificate-validator.md) esempio.</span><span class="sxs-lookup"><span data-stu-id="3d561-184">For an example of custom authentication, see the [X.509 Certificate Validator](../../../../docs/framework/wcf/samples/x-509-certificate-validator.md) sample.</span></span> <span data-ttu-id="3d561-185">Per altre informazioni, vedere [credenziale personalizzata e convalida delle credenziali](../../../../docs/framework/wcf/extending/custom-credential-and-credential-validation.md).</span><span class="sxs-lookup"><span data-stu-id="3d561-185">For more information, see [Custom Credential and Credential Validation](../../../../docs/framework/wcf/extending/custom-credential-and-credential-validation.md).</span></span>  
  
## <a name="using-makecertexe-to-build-a-certificate-chain"></a><span data-ttu-id="3d561-186">Utilizzo dello strumento Makecert.exe per compilare una catena di certificati</span><span class="sxs-lookup"><span data-stu-id="3d561-186">Using Makecert.exe to Build a Certificate Chain</span></span>  
 <span data-ttu-id="3d561-187">Lo strumento di creazione dei certificati Makecert.exe crea certificati X.509 e coppie di chiavi privata/pubblica.</span><span class="sxs-lookup"><span data-stu-id="3d561-187">The Certificate Creation Tool (Makecert.exe) creates X.509 certificates and private key/public key pairs.</span></span> <span data-ttu-id="3d561-188">La chiave privata può essere salvata su disco e quindi utilizzata per rilasciare e firmare nuovi certificati, simulando in questo modo una gerarchia di certificati concatenati.</span><span class="sxs-lookup"><span data-stu-id="3d561-188">You can save the private key to disk and then use it to issue and sign new certificates, thus simulating a hierarchy of chained certificates.</span></span> <span data-ttu-id="3d561-189">Questo strumento deve essere utilizzato esclusivamente come risorsa ausiliare durante la fase di sviluppo dei servizi. È pertanto necessario evitare di utilizzarlo per creare i certificati da utilizzare nella distribuzione definitiva.</span><span class="sxs-lookup"><span data-stu-id="3d561-189">The tool is intended for use only as an aid when developing services and should never be used to create certificates for actual deployment.</span></span> <span data-ttu-id="3d561-190">Quando si sviluppa un servizio [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], attenersi ai passaggi seguenti per compilare una catena di trust tramite lo strumento Makecert.exe.</span><span class="sxs-lookup"><span data-stu-id="3d561-190">When developing an [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service, use the following steps to build a chain of trust with Makecert.exe.</span></span>  
  
#### <a name="to-build-a-chain-of-trust-with-makecertexe"></a><span data-ttu-id="3d561-191">Per compilare una catena di trust tramite lo strumento Makecert.exe</span><span class="sxs-lookup"><span data-stu-id="3d561-191">To build a chain of trust with Makecert.exe</span></span>  
  
1.  <span data-ttu-id="3d561-192">Utilizzare lo strumento MakeCert.exe per creare un certificato temporaneo dell'autorità radice (autofirmato).</span><span class="sxs-lookup"><span data-stu-id="3d561-192">Create a temporary root authority (self-signed) certificate using the MakeCert.exe tool.</span></span> <span data-ttu-id="3d561-193">Salvare la chiave privata su disco.</span><span class="sxs-lookup"><span data-stu-id="3d561-193">Save the private key to the disk.</span></span>  
  
2.  <span data-ttu-id="3d561-194">Utilizzare il nuovo certificato per rilasciare un altro certificato contenente la chiave pubblica.</span><span class="sxs-lookup"><span data-stu-id="3d561-194">Use the new certificate to issue another certificate that contains the public key.</span></span>  
  
3.  <span data-ttu-id="3d561-195">Importare il certificato dell'autorità radice nell'archivio Autorità di certificazione radice attendibili.</span><span class="sxs-lookup"><span data-stu-id="3d561-195">Import the root authority certificate into the Trusted Root Certification Authorities store.</span></span>  
  
4.  <span data-ttu-id="3d561-196">Per istruzioni dettagliate, vedere [procedura: creare certificati temporanei da usare durante lo sviluppo](../../../../docs/framework/wcf/feature-details/how-to-create-temporary-certificates-for-use-during-development.md).</span><span class="sxs-lookup"><span data-stu-id="3d561-196">For step-by-step instructions, see [How to: Create Temporary Certificates for Use During Development](../../../../docs/framework/wcf/feature-details/how-to-create-temporary-certificates-for-use-during-development.md).</span></span>  
  
## <a name="which-certificate-to-use"></a><span data-ttu-id="3d561-197">Scelta del certificato da utilizzare</span><span class="sxs-lookup"><span data-stu-id="3d561-197">Which Certificate to Use?</span></span>  
 <span data-ttu-id="3d561-198">Quando si utilizzano i certificati spesso sorgono dubbi su quale certificato scegliere e sul motivo per cui sceglierlo.</span><span class="sxs-lookup"><span data-stu-id="3d561-198">Common questions about certificates are which certificate to use, and why.</span></span> <span data-ttu-id="3d561-199">La soluzione a questi dubbi varia a seconda che la programmazione riguardi un client o un servizio.</span><span class="sxs-lookup"><span data-stu-id="3d561-199">The answer depends on whether you are programming a client or service.</span></span> <span data-ttu-id="3d561-200">Le informazioni seguenti rappresentano una linea guida generale e non forniscono una risposta esauriente a questi dubbi.</span><span class="sxs-lookup"><span data-stu-id="3d561-200">The following information provides a general guideline and is not an exhaustive answer to these questions.</span></span>  
  
### <a name="service-certificates"></a><span data-ttu-id="3d561-201">Certificati di servizio</span><span class="sxs-lookup"><span data-stu-id="3d561-201">Service Certificates</span></span>  
 <span data-ttu-id="3d561-202">Lo scopo principale dei certificati di servizio è autenticare il server presso i client.</span><span class="sxs-lookup"><span data-stu-id="3d561-202">Service certificates have the primary task of authenticating the server to clients.</span></span> <span data-ttu-id="3d561-203">Uno dei primi controlli svolti quando un client esegue l'autenticazione di un server consiste nel confrontare il valore di **soggetto** campo per l'identificatore URI (Uniform Resource) usato per contattare il servizio: deve corrispondere il DNS di entrambi.</span><span class="sxs-lookup"><span data-stu-id="3d561-203">One of the initial checks when a client authenticates a server is to compare the value of the **Subject** field to the Uniform Resource Identifier (URI) used to contact the service: the DNS of both must match.</span></span> <span data-ttu-id="3d561-204">Se, ad esempio, l'URI del servizio è "http://www.contoso.com/endpoint/" la **soggetto** campo deve contenere anche il valore "www.contoso.com".</span><span class="sxs-lookup"><span data-stu-id="3d561-204">For example, if the URI of the service is "http://www.contoso.com/endpoint/" then the **Subject** field must also contain the value "www.contoso.com".</span></span>  
  
 <span data-ttu-id="3d561-205">Si noti che il campo può contenere più valori, ognuno avente un prefisso iniziale che ne indica il valore.</span><span class="sxs-lookup"><span data-stu-id="3d561-205">Note that the field can contain several values, each prefixed with an initialization to indicate the value.</span></span> <span data-ttu-id="3d561-206">Nella maggior parte dei casi viene utilizzato il prefisso iniziale "CN" per indicare un nome comune. Ad esempio, "CN = www.contoso.com".</span><span class="sxs-lookup"><span data-stu-id="3d561-206">Most commonly, the initialization is "CN" for common name, for example, "CN = www.contoso.com".</span></span> <span data-ttu-id="3d561-207">È anche possibile che il **soggetto** campo sia vuoto, nel qual caso il **nome alternativo soggetto** campo può contenere il **nome DNS** valore.</span><span class="sxs-lookup"><span data-stu-id="3d561-207">It is also possible for the **Subject** field to be blank, in which case the **Subject Alternative Name** field can contain the **DNS Name** value.</span></span>  
  
 <span data-ttu-id="3d561-208">Si noti inoltre il valore della **scopi designati** campo del certificato deve includere un valore appropriato, ad esempio "Server Authentication" o "Autenticazione Client".</span><span class="sxs-lookup"><span data-stu-id="3d561-208">Also note the value of the **Intended Purposes** field of the certificate should include an appropriate value, such as "Server Authentication" or "Client Authentication".</span></span>  
  
### <a name="client-certificates"></a><span data-ttu-id="3d561-209">Certificati client</span><span class="sxs-lookup"><span data-stu-id="3d561-209">Client Certificates</span></span>  
 <span data-ttu-id="3d561-210">Anziché essere rilasciati da un'autorità di certificazione di terze parti,</span><span class="sxs-lookup"><span data-stu-id="3d561-210">Client certificates are not typically issued by a third-party certification authority.</span></span> <span data-ttu-id="3d561-211">in genere i certificati client vengono memorizzati da un'autorità radice nell'archivio Personale dell'utente corrente. Il campo Scopi designati in questo caso viene impostato su "Autenticazione client".</span><span class="sxs-lookup"><span data-stu-id="3d561-211">Instead, the Personal store of the current user location typically contains certificates placed there by a root authority, with an intended purpose of "Client Authentication".</span></span> <span data-ttu-id="3d561-212">Un client può utilizzare un certificato client quando è necessario eseguire l'autenticazione reciproca.</span><span class="sxs-lookup"><span data-stu-id="3d561-212">The client can use such a certificate when mutual authentication is required.</span></span>  
  
## <a name="online-revocation-and-offline-revocation"></a><span data-ttu-id="3d561-213">Revoca online e revoca offline</span><span class="sxs-lookup"><span data-stu-id="3d561-213">Online Revocation and Offline Revocation</span></span>  
  
### <a name="certificate-validity"></a><span data-ttu-id="3d561-214">Validità del certificato</span><span class="sxs-lookup"><span data-stu-id="3d561-214">Certificate Validity</span></span>  
 <span data-ttu-id="3d561-215">Ogni certificato è valido solo per un determinato periodo di tempo, detto di *periodo di validità*.</span><span class="sxs-lookup"><span data-stu-id="3d561-215">Every certificate is valid only for a given period of time, called the *validity period*.</span></span> <span data-ttu-id="3d561-216">Il periodo di validità è definito per il **valido da** e **valido a** i campi di un certificato x. 509.</span><span class="sxs-lookup"><span data-stu-id="3d561-216">The validity period is defined by the **Valid from** and **Valid to** fields of an X.509 certificate.</span></span> <span data-ttu-id="3d561-217">Durante l'autenticazione questi due campi vengono verificati per stabilire se il certificato è nel periodo di validità.</span><span class="sxs-lookup"><span data-stu-id="3d561-217">During authentication, the certificate is checked to determine whether the certificate is still within the validity period.</span></span>  
  
### <a name="certificate-revocation-list"></a><span data-ttu-id="3d561-218">Elenco di revoche di certificati (CRL, Certificate Revocation List)</span><span class="sxs-lookup"><span data-stu-id="3d561-218">Certificate Revocation List</span></span>  
 <span data-ttu-id="3d561-219">Durante il periodo di validità, l'autorità di certificazione può revocare un certificato in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="3d561-219">At any time during the validity period, the certification authority can revoke a certificate.</span></span> <span data-ttu-id="3d561-220">Ciò può verificarsi per vari motivi, ad esempio se la chiave privata del certificato viene compromessa.</span><span class="sxs-lookup"><span data-stu-id="3d561-220">This can occur for many reasons, such as a compromise of the private key of the certificate.</span></span>  
  
 <span data-ttu-id="3d561-221">In questo caso, tutti i certificati appartenenti alle catene di trust aventi origine dal certificato revocato sono anch'essi considerati non validi e durante le procedure di autenticazione vengono considerati non attendibili.</span><span class="sxs-lookup"><span data-stu-id="3d561-221">When this occurs, any chains that descend from the revoked certificate are also invalid, and are not trusted during authentication procedures.</span></span> <span data-ttu-id="3d561-222">Per scoprire quali certificati vengono revocati, ogni emittente pubblica un e data-timestamp *elenco certificati revocati* (CRL).</span><span class="sxs-lookup"><span data-stu-id="3d561-222">To find out which certificates are revoked, each issuer publishes a time- and date-stamped *certificate revocation list* (CRL).</span></span> <span data-ttu-id="3d561-223">Questo elenco può essere controllato tramite la revoca online oppure la revoca offline impostando la proprietà `RevocationMode` o la proprietà `DefaultRevocationMode` delle classi seguenti su uno dei valori dell'enumerazione <xref:System.Security.Cryptography.X509Certificates.X509RevocationMode>: <xref:System.ServiceModel.Security.X509ClientCertificateAuthentication>, <xref:System.ServiceModel.Security.X509PeerCertificateAuthentication>, <xref:System.ServiceModel.Security.X509ServiceCertificateAuthentication> e <xref:System.ServiceModel.Security.IssuedTokenServiceCredential>.</span><span class="sxs-lookup"><span data-stu-id="3d561-223">The list can be checked using either online revocation or offline revocation by setting the `RevocationMode` or `DefaultRevocationMode` property of the following classes to one of the <xref:System.Security.Cryptography.X509Certificates.X509RevocationMode> enumeration values: <xref:System.ServiceModel.Security.X509ClientCertificateAuthentication>, <xref:System.ServiceModel.Security.X509PeerCertificateAuthentication>, <xref:System.ServiceModel.Security.X509ServiceCertificateAuthentication>, and the <xref:System.ServiceModel.Security.IssuedTokenServiceCredential> classes.</span></span> <span data-ttu-id="3d561-224">Il valore predefinito di tutte le proprietà è `Online`.</span><span class="sxs-lookup"><span data-stu-id="3d561-224">The default value for all properties is `Online`.</span></span>  
  
 <span data-ttu-id="3d561-225">È inoltre possibile impostare la modalità di configurazione utilizzando il `revocationMode` attributo di entrambi i [ \<autenticazione >](../../../../docs/framework/configure-apps/file-schema/wcf/authentication-of-clientcertificate-element.md) (del [ \<serviceBehaviors >](../../../../docs/framework/configure-apps/file-schema/wcf/servicebehaviors.md)) e il [ \<autenticazione >](../../../../docs/framework/configure-apps/file-schema/wcf/authentication-of-clientcertificate-element.md) (del [ \<endpointBehaviors >](../../../../docs/framework/configure-apps/file-schema/wcf/endpointbehaviors.md)).</span><span class="sxs-lookup"><span data-stu-id="3d561-225">You can also set the mode in configuration using the `revocationMode` attribute of both the [\<authentication>](../../../../docs/framework/configure-apps/file-schema/wcf/authentication-of-clientcertificate-element.md) (of the [\<serviceBehaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/servicebehaviors.md)) and the [\<authentication>](../../../../docs/framework/configure-apps/file-schema/wcf/authentication-of-clientcertificate-element.md) (of the [\<endpointBehaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/endpointbehaviors.md)).</span></span>  
  
## <a name="the-setcertificate-method"></a><span data-ttu-id="3d561-226">Metodo SetCertificate</span><span class="sxs-lookup"><span data-stu-id="3d561-226">The SetCertificate Method</span></span>  
 <span data-ttu-id="3d561-227">In [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] spesso occorre specificare un certificato o un set di certificati che un servizio o un client deve utilizzare per autenticare, crittografare o firmare digitalmente un messaggio.</span><span class="sxs-lookup"><span data-stu-id="3d561-227">In [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], you must often specify a certificate or set of certificates a service or client is to use to authenticate, encrypt, or digitally sign a message.</span></span> <span data-ttu-id="3d561-228">Questa operazione può essere eseguita a livello di programmazione mediante il metodo `SetCertificate` di varie classi che rappresentano i certificati X.509.</span><span class="sxs-lookup"><span data-stu-id="3d561-228">You can do this programmatically by using the `SetCertificate` method of various classes that represent X.509 certificates.</span></span> <span data-ttu-id="3d561-229">Le classi seguenti utilizzano il metodo `SetCertificate` per specificare un certificato.</span><span class="sxs-lookup"><span data-stu-id="3d561-229">The following classes use the `SetCertificate` method to specify a certificate.</span></span>  
  
|<span data-ttu-id="3d561-230">Classe</span><span class="sxs-lookup"><span data-stu-id="3d561-230">Class</span></span>|<span data-ttu-id="3d561-231">Metodo</span><span class="sxs-lookup"><span data-stu-id="3d561-231">Method</span></span>|  
|-----------|------------|  
|<xref:System.ServiceModel.Security.PeerCredential>|<xref:System.ServiceModel.Security.PeerCredential.SetCertificate%2A>|  
|<xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential>|<xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential.SetCertificate%2A>|  
|<xref:System.ServiceModel.Security.X509CertificateRecipientServiceCredential>|<xref:System.ServiceModel.Security.X509CertificateRecipientServiceCredential.SetCertificate%2A>|  
|<xref:System.ServiceModel.Security.X509CertificateInitiatorServiceCredential>|  
|<xref:System.ServiceModel.Security.X509CertificateInitiatorServiceCredential.SetCertificate%2A>|  
  
 <span data-ttu-id="3d561-232">Il metodo `SetCertificate` si basa sulla definizione di una posizione di archivio, di un archivio, di un tipo "di ricerca" (ovvero il parametro `x509FindType` )" che specifica un campo del certificato e un valore da ricercare nel campo.</span><span class="sxs-lookup"><span data-stu-id="3d561-232">The `SetCertificate` method works by designating a store location and store, a "find" type (`x509FindType` parameter) that specifies a field of the certificate, and a value to find in the field.</span></span> <span data-ttu-id="3d561-233">Ad esempio, il codice seguente crea un <xref:System.ServiceModel.ServiceHost> istanza e imposta il certificato di servizio utilizzato per autenticare il servizio client con il `SetCertificate` metodo.</span><span class="sxs-lookup"><span data-stu-id="3d561-233">For example, the following code creates a <xref:System.ServiceModel.ServiceHost> instance and sets the service certificate used to authenticate the service to clients with the `SetCertificate` method.</span></span>  
  
 [!code-csharp[c_WorkingWithCertificates#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_workingwithcertificates/cs/source.cs#1)]
 [!code-vb[c_WorkingWithCertificates#1](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_workingwithcertificates/vb/source.vb#1)]  
  
### <a name="multiple-certificates-with-the-same-value"></a><span data-ttu-id="3d561-234">Certificati aventi lo stesso valore</span><span class="sxs-lookup"><span data-stu-id="3d561-234">Multiple Certificates with the Same Value</span></span>  
 <span data-ttu-id="3d561-235">Un archivio può contenere più certificati aventi lo stesso nome del soggetto.</span><span class="sxs-lookup"><span data-stu-id="3d561-235">A store may contain multiple certificates with the same subject name.</span></span> <span data-ttu-id="3d561-236">Ciò significa che se si specifica che il `x509FindType` viene <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindBySubjectName> o <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindBySubjectDistinguishedName>e una o più certificati con lo stesso valore, viene generata un'eccezione perché non esiste alcun modo per distinguere quale certificato è obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="3d561-236">This means that if you specify that the `x509FindType` is <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindBySubjectName> or <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindBySubjectDistinguishedName>, and more than one certificate has the same value, an exception is thrown because there is no way to distinguish which certificate is required.</span></span> <span data-ttu-id="3d561-237">Per risolvere questo problema, impostare la proprietà `x509FindType` su <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindByThumbprint>.</span><span class="sxs-lookup"><span data-stu-id="3d561-237">You can mitigate this by setting the `x509FindType` to <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindByThumbprint>.</span></span> <span data-ttu-id="3d561-238">Il campo dell'identificazione personale ("Thumbprint") contiene infatti un valore univoco che può essere utilizzato per individuare un certificato specifico all'interno di un archivio.</span><span class="sxs-lookup"><span data-stu-id="3d561-238">The thumbprint field contains a unique value that can be used to find a specific certificate in a store.</span></span> <span data-ttu-id="3d561-239">Tuttavia, ciò comporta uno svantaggio: se il certificato viene revocato o rinnovato, il metodo `SetCertificate` ha esito negativo poiché in questi casi l'identificazione personale viene rispettivamente eliminata o alterata.</span><span class="sxs-lookup"><span data-stu-id="3d561-239">However, this has its own disadvantage: if the certificate is revoked or renewed, the `SetCertificate` method fails because the thumbprint is also gone.</span></span> <span data-ttu-id="3d561-240">Oppure, se il certificato non è più valido, l'autenticazione ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="3d561-240">Or, if the certificate is no longer valid, authentication fails.</span></span> <span data-ttu-id="3d561-241">Per risolvere questo problema è possibile impostare il parametro `x590FindType` su <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindByIssuerName> e specificare quindi nome dell'emittente.</span><span class="sxs-lookup"><span data-stu-id="3d561-241">The way to mitigate this is to set the `x590FindType` parameter to <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindByIssuerName> and specify the issuer's name.</span></span> <span data-ttu-id="3d561-242">Se non è richiesto alcun emittente specifico, è anche possibile impostare uno degli altri valori dell'enumerazione <xref:System.Security.Cryptography.X509Certificates.X509FindType>, ad esempio <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindByTimeValid>.</span><span class="sxs-lookup"><span data-stu-id="3d561-242">If no particular issuer is required, you can also set one of the other <xref:System.Security.Cryptography.X509Certificates.X509FindType> enumeration values, such as <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindByTimeValid>.</span></span>  
  
## <a name="certificates-in-configuration"></a><span data-ttu-id="3d561-243">Impostazione dei certificati in configurazione</span><span class="sxs-lookup"><span data-stu-id="3d561-243">Certificates in Configuration</span></span>  
 <span data-ttu-id="3d561-244">I certificati possono anche essere impostati in configurazione.</span><span class="sxs-lookup"><span data-stu-id="3d561-244">You can also set certificates by using configuration.</span></span> <span data-ttu-id="3d561-245">Se si sta creando un servizio, vengono specificate credenziali, inclusi i certificati, sotto il [ \<serviceBehaviors >](../../../../docs/framework/configure-apps/file-schema/wcf/servicebehaviors.md).</span><span class="sxs-lookup"><span data-stu-id="3d561-245">If you are creating a service, credentials, including certificates, are specified under the [\<serviceBehaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/servicebehaviors.md).</span></span> <span data-ttu-id="3d561-246">Quando si programma un client, i certificati sono specificati all'interno di [ \<endpointBehaviors >](../../../../docs/framework/configure-apps/file-schema/wcf/endpointbehaviors.md).</span><span class="sxs-lookup"><span data-stu-id="3d561-246">When you are programming a client, certificates are specified under the [\<endpointBehaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/endpointbehaviors.md).</span></span>  
  
## <a name="mapping-a-certificate-to-a-user-account"></a><span data-ttu-id="3d561-247">Mapping di un certificato a un account utente</span><span class="sxs-lookup"><span data-stu-id="3d561-247">Mapping a Certificate to a User Account</span></span>  
 <span data-ttu-id="3d561-248">Una funzionalità di IIS e di Active Directory è la possibilità di eseguire il mapping di un certificato a un account utente di Windows.</span><span class="sxs-lookup"><span data-stu-id="3d561-248">A feature of IIS and Active Directory is the ability to map a certificate to a Windows user account.</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="3d561-249"> la funzionalità, vedere [eseguire il mapping dei certificati per account utente di](http://go.microsoft.com/fwlink/?LinkId=88917).</span><span class="sxs-lookup"><span data-stu-id="3d561-249"> the feature, see [Map certificates to user accounts](http://go.microsoft.com/fwlink/?LinkId=88917).</span></span>  
  
 [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="3d561-250"> utilizza il mapping di Active Directory, vedere [Mapping certificati Client con il Mapping del servizio Directory](http://go.microsoft.com/fwlink/?LinkId=88918).</span><span class="sxs-lookup"><span data-stu-id="3d561-250"> using Active Directory mapping, see [Mapping Client Certificates with Directory Service Mapping](http://go.microsoft.com/fwlink/?LinkId=88918).</span></span>  
  
 <span data-ttu-id="3d561-251">Se questa funzionalità è abilitata è possibile impostare la proprietà <xref:System.ServiceModel.Security.X509ClientCertificateAuthentication.MapClientCertificateToWindowsAccount%2A> della classe <xref:System.ServiceModel.Security.X509ClientCertificateAuthentication> su `true`.</span><span class="sxs-lookup"><span data-stu-id="3d561-251">With this capability enabled, you can set the <xref:System.ServiceModel.Security.X509ClientCertificateAuthentication.MapClientCertificateToWindowsAccount%2A> property of the <xref:System.ServiceModel.Security.X509ClientCertificateAuthentication> class to `true`.</span></span> <span data-ttu-id="3d561-252">Nella configurazione, è possibile impostare il `mapClientCertificateToWindowsAccount` attributo del [ \<autenticazione >](../../../../docs/framework/configure-apps/file-schema/wcf/authentication-of-servicecertificate-element.md) elemento `true`, come illustrato nel codice seguente.</span><span class="sxs-lookup"><span data-stu-id="3d561-252">In configuration, you can set the `mapClientCertificateToWindowsAccount` attribute of the [\<authentication>](../../../../docs/framework/configure-apps/file-schema/wcf/authentication-of-servicecertificate-element.md) element to `true`, as shown in the following code.</span></span>  
  
```xml  
<serviceBehaviors>  
 <behavior name="MappingBehavior">  
  <serviceCredentials>  
   <clientCertificate>  
    <authentication certificateValidationMode="None" mapClientCertificateToWindowsAccount="true" />  
   </clientCertificate>  
  </serviceCredentials>  
 </behavior>  
</serviceBehaviors>  
```  
  
 <span data-ttu-id="3d561-253">L'esecuzione del mapping di un certificato X.509 al token che rappresenta un account utente di Windows è considerata un'elevazione dei privilegi perché, una volta eseguito tale mapping, il token di Windows può essere utilizzato per accedere alle risorse protette.</span><span class="sxs-lookup"><span data-stu-id="3d561-253">Mapping an X.509 certificate to the token that represents a Windows user account is considered an elevation of privilege because, once mapped, the Windows token can be used to gain access to protected resources.</span></span> <span data-ttu-id="3d561-254">Pertanto, il criterio del dominio richiede che il certificato X.509 sia conforme al proprio criterio prima di eseguire il mapping.</span><span class="sxs-lookup"><span data-stu-id="3d561-254">Therefore, domain policy requires the X.509 certificate to comply with its policy prior to mapping.</span></span> <span data-ttu-id="3d561-255">Il *SChannel* pacchetto di protezione applica questo requisito.</span><span class="sxs-lookup"><span data-stu-id="3d561-255">The *SChannel* security package enforces this requirement.</span></span>  
  
 <span data-ttu-id="3d561-256">Quando si utilizza [!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)] o versioni successive, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] garantisce che il certificato sia conforme al criterio di dominio prima che venga mappato a un account di Windows.</span><span class="sxs-lookup"><span data-stu-id="3d561-256">When using [!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)] or later, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] ensures the certificate conforms to domain policy before it is mapped to a Windows account.</span></span>  
  
 <span data-ttu-id="3d561-257">Nella prima versione di [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] il mapping viene eseguito senza prendere in considerazione il criterio del dominio.</span><span class="sxs-lookup"><span data-stu-id="3d561-257">In the first release of [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], mapping is done without consulting the domain policy.</span></span> <span data-ttu-id="3d561-258">È pertanto possibile che le applicazioni che funzionano correttamente con la prima versione presentano problemi se il mapping viene abilitato e il certificato X.509 non soddisfa il criterio del dominio.</span><span class="sxs-lookup"><span data-stu-id="3d561-258">Therefore it is possible that older applications that used to work when running under the first release, fails if the mapping is enabled and the X.509 certificate does not satisfy the domain policy.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3d561-259">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="3d561-259">See Also</span></span>  
 <xref:System.ServiceModel.Channels>  
 <xref:System.ServiceModel.Security>  
 <xref:System.ServiceModel>  
 <xref:System.Security.Cryptography.X509Certificates.X509FindType>  
 [<span data-ttu-id="3d561-260">Protezione di servizi e client</span><span class="sxs-lookup"><span data-stu-id="3d561-260">Securing Services and Clients</span></span>](../../../../docs/framework/wcf/feature-details/securing-services-and-clients.md)
