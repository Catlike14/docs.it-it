---
title: 'CustomPeerResolverService: registrazioni client'
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 40236953-a916-4236-84a6-928859e1331a
caps.latest.revision: "7"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 9c979922bf8c7b786fd0a671c22289fb148a883c
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/22/2017
---
# <a name="inside-the-custompeerresolverservice-client-registrations"></a><span data-ttu-id="452a6-102">CustomPeerResolverService: registrazioni client</span><span class="sxs-lookup"><span data-stu-id="452a6-102">Inside the CustomPeerResolverService: Client Registrations</span></span>
<span data-ttu-id="452a6-103">Ogni nodo della rete pubblica le informazioni sull'endpoint relative nel servizio resolver tramite la funzione `Register`.</span><span class="sxs-lookup"><span data-stu-id="452a6-103">Each node in the mesh publishes its endpoint information to the resolver service through the `Register` function.</span></span> <span data-ttu-id="452a6-104">Il servizio resolver archivia queste informazioni come record di registrazione.</span><span class="sxs-lookup"><span data-stu-id="452a6-104">The resolver service stores this information as a registration record.</span></span> <span data-ttu-id="452a6-105">Questo record contiene un identificatore univoco (RegistrationID) e informazioni sull'endpoint (PeerNodeAddress) per il nodo.</span><span class="sxs-lookup"><span data-stu-id="452a6-105">This record contains a unique identifier (RegistrationID) and endpoint information (PeerNodeAddress) for the node.</span></span>  
  
## <a name="stale-records-and-expiration-time"></a><span data-ttu-id="452a6-106">Record non aggiornati e data di scadenza</span><span class="sxs-lookup"><span data-stu-id="452a6-106">Stale Records and Expiration Time</span></span>  
 <span data-ttu-id="452a6-107">Idealmente, quando un nodo abbandona la rete, chiama la funzione `Unregister` affinché il servizio resolver rimuova la voce di registrazione.</span><span class="sxs-lookup"><span data-stu-id="452a6-107">Ideally, when a node leaves the mesh, it will call the `Unregister` function, which causes the resolver service to remove the registration entry.</span></span> <span data-ttu-id="452a6-108">Talvolta, i nodi vengono arrestati o diventano inaccessibili prima della chiamata alla funzione `Unregister`, lasciando un record di registrazione non aggiornato.</span><span class="sxs-lookup"><span data-stu-id="452a6-108">Sometimes, nodes shut down or become inaccessible before calling `Unregister`, leaving behind a stale registration record.</span></span>  
  
 <span data-ttu-id="452a6-109">I record non aggiornati nel servizio resolver possono causare problemi di connessione.</span><span class="sxs-lookup"><span data-stu-id="452a6-109">Stale records in your resolver service can cause failed connections.</span></span> <span data-ttu-id="452a6-110">Se un nodo che tenta di connettersi a una rete riceve informazioni di connessione non aggiornate dal servizio resolver, potrebbe richiedere più tempo per connettersi alla rete in modo corretto.</span><span class="sxs-lookup"><span data-stu-id="452a6-110">If a node trying to connect to a mesh receives stale connection information from the resolver service, it can take longer to successfully join the mesh.</span></span> <span data-ttu-id="452a6-111">I record non aggiornati occupano memoria.</span><span class="sxs-lookup"><span data-stu-id="452a6-111">Stale records also take up memory.</span></span> <span data-ttu-id="452a6-112">Senza un processo di pulizia efficiente, la cache utilizzata per archiviare le registrazioni potrebbe alla fine causare un overflow o un arresto anomalo del servizio resolver.</span><span class="sxs-lookup"><span data-stu-id="452a6-112">Without an efficient clean up process, the cache used to store registrations could eventually overflow and crash the resolver service.</span></span>  
  
 <span data-ttu-id="452a6-113"><xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> contrassegna ogni record con una data di scadenza (Datetime) e archivia tali informazioni come parte del record.</span><span class="sxs-lookup"><span data-stu-id="452a6-113">The <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> marks each record with an expiration time (DateTime), and stores that information as part of the record.</span></span> <span data-ttu-id="452a6-114">Il servizio utilizza la data di scadenza per identificare i record non aggiornati.</span><span class="sxs-lookup"><span data-stu-id="452a6-114">The service uses the expiration time to identify stale records.</span></span> <span data-ttu-id="452a6-115">Le implementazioni personalizzate dovrebbero offrire un comportamento simile.</span><span class="sxs-lookup"><span data-stu-id="452a6-115">Custom implementations should do something similar.</span></span>  
  
## <a name="refreshinterval-and-cleanupinterval"></a><span data-ttu-id="452a6-116">RefreshInterval e CleanupInterval</span><span class="sxs-lookup"><span data-stu-id="452a6-116">RefreshInterval and CleanupInterval</span></span>  
 <span data-ttu-id="452a6-117">La proprietà `RefreshInterval` di <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> definisce il periodo di validità dei record di registrazione nella tabella di ricerca della registrazione del servizio.</span><span class="sxs-lookup"><span data-stu-id="452a6-117">The `RefreshInterval` property of the <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> defines how long registration records remain valid in the service's registration lookup table.</span></span> <span data-ttu-id="452a6-118">Superata la quantità di tempo fornita a questa proprietà per un determinato record, tale record non risulta più aggiornato e viene contrassegnato per l'eliminazione.</span><span class="sxs-lookup"><span data-stu-id="452a6-118">When the amount of time supplied to this property has passed for a given record, that record becomes stale and is marked for deletion.</span></span>  
  
 <span data-ttu-id="452a6-119">La proprietà `CleanupInterval` di <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> specifica al servizio la frequenza con la quale cercare ed eliminare i record di registrazione non aggiornati.</span><span class="sxs-lookup"><span data-stu-id="452a6-119">The `CleanupInterval` property of the <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> tells the service how often to search for and delete stale registration records.</span></span> <span data-ttu-id="452a6-120">È necessario impostare la proprietà `CleanupInterval` su un valore superiore o uguale al valore `RefreshInterval` impostato nel servizio.</span><span class="sxs-lookup"><span data-stu-id="452a6-120">The `CleanupInterval` should be set to a time greater than or equal to the `RefreshInterval` set on the service.</span></span>  
  
 <span data-ttu-id="452a6-121">Per implementare il proprio servizio resolver, è necessario scrivere una funzione di manutenzione per rimuovere i record di registrazione non aggiornati.</span><span class="sxs-lookup"><span data-stu-id="452a6-121">To implement your own resolver service, you need to write a maintenance function to remove stale registration records.</span></span> <span data-ttu-id="452a6-122">Sono disponibili diversi modi per eseguire questa operazione:</span><span class="sxs-lookup"><span data-stu-id="452a6-122">There are several ways to do this:</span></span>  
  
-   <span data-ttu-id="452a6-123">**Manutenzione periodica**: impostare un timer per passare disattivi periodicamente ed esaminare l'archivio dati per eliminare i record obsoleti.</span><span class="sxs-lookup"><span data-stu-id="452a6-123">**Periodic maintenance**: Set a timer to go off periodically, and go through your data store to delete old records.</span></span> <span data-ttu-id="452a6-124">Questo approccio è utilizzato da <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService>.</span><span class="sxs-lookup"><span data-stu-id="452a6-124">The <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> uses this approach.</span></span>  
  
-   <span data-ttu-id="452a6-125">**Eliminazione passiva**: anziché cercare attivamente i record non aggiornati a intervalli regolari, è possibile identificare ed eliminare i record non aggiornati quando il servizio è già in esecuzione un'altra funzione.</span><span class="sxs-lookup"><span data-stu-id="452a6-125">**Passive deletion**: Instead of actively searching for stale records at regular intervals, you can identify and delete stale records when your service is already performing another function.</span></span> <span data-ttu-id="452a6-126">Questo approccio potrebbe potenzialmente rallentare i tempi di risposta alle richieste dei client resolver, ma elimina la necessità di un timer e potrebbe rivelarsi più efficiente qualora si preveda che un numero ridotto di nodi abbandoni la rete senza chiamare `Unregister`.</span><span class="sxs-lookup"><span data-stu-id="452a6-126">This may potentially slow down response time to requests from the resolver clients, but it eliminates the need for a timer, and may be more efficient if few nodes are expected to leave without calling `Unregister`.</span></span>  
  
## <a name="registrationlifetime-and-refresh"></a><span data-ttu-id="452a6-127">RegistrationLifetime e Refresh</span><span class="sxs-lookup"><span data-stu-id="452a6-127">RegistrationLifetime and Refresh</span></span>  
 <span data-ttu-id="452a6-128">Quando un nodo effettua la registrazione con un servizio resolver, riceve un oggetto <xref:System.ServiceModel.PeerResolvers.RegisterResponseInfo> dal servizio.</span><span class="sxs-lookup"><span data-stu-id="452a6-128">When a node registers with a resolver service, it receives a <xref:System.ServiceModel.PeerResolvers.RegisterResponseInfo> object from the service.</span></span> <span data-ttu-id="452a6-129">La proprietà `RegistrationLifetime` di questo oggetto indica al nodo il tempo a sua disposizione prima che scada la registrazione e venga rimosso dal servizio resolver.</span><span class="sxs-lookup"><span data-stu-id="452a6-129">This object has a `RegistrationLifetime` property which indicates to the node how much time it has before the registration expires and is removed by the resolver service.</span></span> <span data-ttu-id="452a6-130">Se, ad esempio, `RegistrationLifetime` è pari a 2 minuti, il nodo deve chiamare `Refresh` in meno di 2 minuti per assicurarsi che il record rimanga aggiornato e non venga eliminato.</span><span class="sxs-lookup"><span data-stu-id="452a6-130">If, for example, the `RegistrationLifetime` is 2 minutes, the node needs to call `Refresh` in under 2 minutes to ensure the record stays fresh and is not deleted.</span></span> <span data-ttu-id="452a6-131">Quando il servizio resolver riceve una richiesta `Refresh`, cerca il record e reimposta la data di scadenza.</span><span class="sxs-lookup"><span data-stu-id="452a6-131">When the resolver service receives a `Refresh` request, it looks up the record and resets the expiration time.</span></span> <span data-ttu-id="452a6-132">Refresh restituisce un oggetto <xref:System.ServiceModel.PeerResolvers.RefreshResponseInfo> con una proprietà `RegistrationLifetime`.</span><span class="sxs-lookup"><span data-stu-id="452a6-132">Refresh returns a <xref:System.ServiceModel.PeerResolvers.RefreshResponseInfo> object with a `RegistrationLifetime` property.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="452a6-133">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="452a6-133">See Also</span></span>  
 [<span data-ttu-id="452a6-134">Resolver del peer</span><span class="sxs-lookup"><span data-stu-id="452a6-134">Peer Resolvers</span></span>](../../../../docs/framework/wcf/feature-details/peer-resolvers.md)
