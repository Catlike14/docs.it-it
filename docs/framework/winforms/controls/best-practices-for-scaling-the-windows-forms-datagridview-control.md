---
title: Procedure consigliate per ridimensionare il controllo DataGridView Windows Form
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-winforms
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- DataGridView control [Windows Forms], row sharing
- data grids [Windows Forms], best practices
- DataGridView control [Windows Forms], shared rows
- DataGridView control [Windows Forms], best practices
- best practices [Windows Forms], dataGridView control
- DataGridView control [Windows Forms], scaling
ms.assetid: 8321a8a6-6340-4fd1-b475-fa090b905aaf
caps.latest.revision: "31"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: ecd629bd38e08c8d6909ee4ad771f17b1554fc80
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/22/2017
---
# <a name="best-practices-for-scaling-the-windows-forms-datagridview-control"></a><span data-ttu-id="6538b-102">Procedure consigliate per ridimensionare il controllo DataGridView Windows Form</span><span class="sxs-lookup"><span data-stu-id="6538b-102">Best Practices for Scaling the Windows Forms DataGridView Control</span></span>
<span data-ttu-id="6538b-103">Il <xref:System.Windows.Forms.DataGridView> controllo è progettato per fornire la massima scalabilità.</span><span class="sxs-lookup"><span data-stu-id="6538b-103">The <xref:System.Windows.Forms.DataGridView> control is designed to provide maximum scalability.</span></span> <span data-ttu-id="6538b-104">Se è necessario visualizzare grandi quantità di dati, è necessario seguire le linee guida descritte in questo argomento per evitare l'utilizzo di grandi quantità di memoria o diminuire la velocità di risposta dell'interfaccia utente (UI).</span><span class="sxs-lookup"><span data-stu-id="6538b-104">If you need to display large amounts of data, you should follow the guidelines described in this topic to avoid consuming large amounts of memory or degrading the responsiveness of the user interface (UI).</span></span> <span data-ttu-id="6538b-105">In questo argomento vengono illustrati i problemi seguenti:</span><span class="sxs-lookup"><span data-stu-id="6538b-105">This topic discusses the following issues:</span></span>  
  
-   <span data-ttu-id="6538b-106">Utilizzo efficiente di stili di cella</span><span class="sxs-lookup"><span data-stu-id="6538b-106">Using cell styles efficiently</span></span>  
  
-   <span data-ttu-id="6538b-107">Utilizzo efficiente di menu di scelta rapida</span><span class="sxs-lookup"><span data-stu-id="6538b-107">Using shortcut menus efficiently</span></span>  
  
-   <span data-ttu-id="6538b-108">Utilizzo in modo efficiente il ridimensionamento automatico</span><span class="sxs-lookup"><span data-stu-id="6538b-108">Using automatic resizing efficiently</span></span>  
  
-   <span data-ttu-id="6538b-109">Utilizzando le raccolte di celle, righe e colonne selezionate in modo efficiente</span><span class="sxs-lookup"><span data-stu-id="6538b-109">Using the selected cells, rows, and columns collections efficiently</span></span>  
  
-   <span data-ttu-id="6538b-110">Utilizzo di righe condivise</span><span class="sxs-lookup"><span data-stu-id="6538b-110">Using shared rows</span></span>  
  
-   <span data-ttu-id="6538b-111">Impedisce la rimozione della condivisione di righe</span><span class="sxs-lookup"><span data-stu-id="6538b-111">Preventing rows from becoming unshared</span></span>  
  
 <span data-ttu-id="6538b-112">Se si dispone delle prestazioni di particolari esigenze, è possibile implementare la modalità virtuale e fornire operazioni di gestione dati.</span><span class="sxs-lookup"><span data-stu-id="6538b-112">If you have special performance needs, you can implement virtual mode and provide your own data management operations.</span></span> <span data-ttu-id="6538b-113">Per ulteriori informazioni, vedere [modalità di visualizzazione di dati nel controllo DataGridView Windows Form](../../../../docs/framework/winforms/controls/data-display-modes-in-the-windows-forms-datagridview-control.md).</span><span class="sxs-lookup"><span data-stu-id="6538b-113">For more information, see [Data Display Modes in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/data-display-modes-in-the-windows-forms-datagridview-control.md).</span></span>  
  
## <a name="using-cell-styles-efficiently"></a><span data-ttu-id="6538b-114">Utilizzo efficiente di stili di cella</span><span class="sxs-lookup"><span data-stu-id="6538b-114">Using Cell Styles Efficiently</span></span>  
 <span data-ttu-id="6538b-115">Ogni cella, riga e colonna può avere le proprie informazioni di stile.</span><span class="sxs-lookup"><span data-stu-id="6538b-115">Each cell, row, and column can have its own style information.</span></span> <span data-ttu-id="6538b-116">Informazioni di stile vengono archiviate in <xref:System.Windows.Forms.DataGridViewCellStyle> oggetti.</span><span class="sxs-lookup"><span data-stu-id="6538b-116">Style information is stored in <xref:System.Windows.Forms.DataGridViewCellStyle> objects.</span></span> <span data-ttu-id="6538b-117">La creazione degli oggetti di stile di cella per molti singoli <xref:System.Windows.Forms.DataGridView> elementi possono risultare inefficienti, specialmente quando si lavora con grandi quantità di dati.</span><span class="sxs-lookup"><span data-stu-id="6538b-117">Creating cell style objects for many individual <xref:System.Windows.Forms.DataGridView> elements can be inefficient, especially when working with large amounts of data.</span></span> <span data-ttu-id="6538b-118">Per evitare un impatto sulle prestazioni, utilizzare le linee guida seguenti:</span><span class="sxs-lookup"><span data-stu-id="6538b-118">To avoid a performance impact, use the following guidelines:</span></span>  
  
-   <span data-ttu-id="6538b-119">Evitare di impostare le proprietà di stile di cella per singoli <xref:System.Windows.Forms.DataGridViewCell> o <xref:System.Windows.Forms.DataGridViewRow> oggetti.</span><span class="sxs-lookup"><span data-stu-id="6538b-119">Avoid setting cell style properties for individual <xref:System.Windows.Forms.DataGridViewCell> or <xref:System.Windows.Forms.DataGridViewRow> objects.</span></span> <span data-ttu-id="6538b-120">Ciò include l'oggetto riga specificato per il <xref:System.Windows.Forms.DataGridView.RowTemplate%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="6538b-120">This includes the row object specified by the <xref:System.Windows.Forms.DataGridView.RowTemplate%2A> property.</span></span> <span data-ttu-id="6538b-121">Ogni nuova riga viene clonato dal modello di riga riceverà la propria copia dell'oggetto stile di cella del modello.</span><span class="sxs-lookup"><span data-stu-id="6538b-121">Each new row that is cloned from the row template will receive its own copy of the template's cell style object.</span></span> <span data-ttu-id="6538b-122">Per ottenere la massima scalabilità, impostare le proprietà di stile di cella nel <xref:System.Windows.Forms.DataGridView> livello.</span><span class="sxs-lookup"><span data-stu-id="6538b-122">For maximum scalability, set cell style properties at the <xref:System.Windows.Forms.DataGridView> level.</span></span> <span data-ttu-id="6538b-123">Ad esempio, impostare il <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType> proprietà anziché <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType> proprietà.</span><span class="sxs-lookup"><span data-stu-id="6538b-123">For example, set the <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType> property rather than the <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType> property.</span></span>  
  
-   <span data-ttu-id="6538b-124">Se alcune celle è necessaria una formattazione diversa da quella predefinita, utilizzare lo stesso <xref:System.Windows.Forms.DataGridViewCellStyle> istanza tra gruppi di celle, righe o colonne.</span><span class="sxs-lookup"><span data-stu-id="6538b-124">If some cells require formatting other than default formatting, use the same <xref:System.Windows.Forms.DataGridViewCellStyle> instance across groups of cells, rows, or columns.</span></span> <span data-ttu-id="6538b-125">Evitare di impostare direttamente le proprietà di tipo <xref:System.Windows.Forms.DataGridViewCellStyle> su singole celle, righe e colonne.</span><span class="sxs-lookup"><span data-stu-id="6538b-125">Avoid directly setting properties of type <xref:System.Windows.Forms.DataGridViewCellStyle> on individual cells, rows, and columns.</span></span> <span data-ttu-id="6538b-126">Per un esempio di stile di cella condivisione, vedere [procedura: impostare stili di cella predefiniti per il controllo DataGridView Windows Form](../../../../docs/framework/winforms/controls/how-to-set-default-cell-styles-for-the-windows-forms-datagridview-control.md).</span><span class="sxs-lookup"><span data-stu-id="6538b-126">For an example of cell style sharing, see [How to: Set Default Cell Styles for the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/how-to-set-default-cell-styles-for-the-windows-forms-datagridview-control.md).</span></span> <span data-ttu-id="6538b-127">È anche possibile evitare una riduzione delle prestazioni durante l'impostazione di stili di cella singolarmente mediante la gestione di <xref:System.Windows.Forms.DataGridView.CellFormatting> gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="6538b-127">You can also avoid a performance penalty when setting cell styles individually by handling the <xref:System.Windows.Forms.DataGridView.CellFormatting> event handler.</span></span> <span data-ttu-id="6538b-128">Per un esempio, vedere [procedura: personalizzare la formattazione dei dati nel controllo DataGridView Windows Form](../../../../docs/framework/winforms/controls/how-to-customize-data-formatting-in-the-windows-forms-datagridview-control.md).</span><span class="sxs-lookup"><span data-stu-id="6538b-128">For an example, see [How to: Customize Data Formatting in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/how-to-customize-data-formatting-in-the-windows-forms-datagridview-control.md).</span></span>  
  
-   <span data-ttu-id="6538b-129">Quando si determina uno stile di cella, utilizzare il <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A?displayProperty=nameWithType> proprietà anziché <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType> proprietà.</span><span class="sxs-lookup"><span data-stu-id="6538b-129">When determining a cell's style, use the <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A?displayProperty=nameWithType> property rather than the <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="6538b-130">L'accesso al <xref:System.Windows.Forms.DataGridViewCell.Style%2A> proprietà consente di creare una nuova istanza di <xref:System.Windows.Forms.DataGridViewCellStyle> classe se la proprietà non è già stata utilizzata.</span><span class="sxs-lookup"><span data-stu-id="6538b-130">Accessing the <xref:System.Windows.Forms.DataGridViewCell.Style%2A> property creates a new instance of the <xref:System.Windows.Forms.DataGridViewCellStyle> class if the property has not already been used.</span></span> <span data-ttu-id="6538b-131">Inoltre, l'oggetto potrebbe non contenere le informazioni di stile complete per la cella se alcuni stili vengono ereditate dalla riga, colonna o dal controllo.</span><span class="sxs-lookup"><span data-stu-id="6538b-131">Additionally, this object might not contain the complete style information for the cell if some styles are inherited from the row, column, or control.</span></span> <span data-ttu-id="6538b-132">Per ulteriori informazioni sull'ereditarietà, vedere [stili della cella nel controllo DataGridView Windows Form](../../../../docs/framework/winforms/controls/cell-styles-in-the-windows-forms-datagridview-control.md).</span><span class="sxs-lookup"><span data-stu-id="6538b-132">For more information about cell style inheritance, see [Cell Styles in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/cell-styles-in-the-windows-forms-datagridview-control.md).</span></span>  
  
## <a name="using-shortcut-menus-efficiently"></a><span data-ttu-id="6538b-133">Utilizzo efficiente di menu di scelta rapida</span><span class="sxs-lookup"><span data-stu-id="6538b-133">Using Shortcut Menus Efficiently</span></span>  
 <span data-ttu-id="6538b-134">Ogni cella, riga e colonna può avere il proprio menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="6538b-134">Each cell, row, and column can have its own shortcut menu.</span></span> <span data-ttu-id="6538b-135">Menu di scelta rapida di <xref:System.Windows.Forms.DataGridView> controllo sono rappresentati da <xref:System.Windows.Forms.ContextMenuStrip> controlli.</span><span class="sxs-lookup"><span data-stu-id="6538b-135">Shortcut menus in the <xref:System.Windows.Forms.DataGridView> control are represented by <xref:System.Windows.Forms.ContextMenuStrip> controls.</span></span> <span data-ttu-id="6538b-136">Come con gli oggetti di stile di cella, la creazione di menu di scelta rapida per molti singoli <xref:System.Windows.Forms.DataGridView> elementi influirà negativamente sulle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="6538b-136">Just as with cell style objects, creating shortcut menus for many individual <xref:System.Windows.Forms.DataGridView> elements will negatively impact performance.</span></span> <span data-ttu-id="6538b-137">Per evitare questo problema, utilizzare le linee guida seguenti:</span><span class="sxs-lookup"><span data-stu-id="6538b-137">To avoid this penalty, use the following guidelines:</span></span>  
  
-   <span data-ttu-id="6538b-138">Evitare di creare menu di scelta rapida per le singole celle e righe.</span><span class="sxs-lookup"><span data-stu-id="6538b-138">Avoid creating shortcut menus for individual cells and rows.</span></span> <span data-ttu-id="6538b-139">Ciò include il modello di riga, viene duplicato e il relativo menu di scelta rapida quando nuove righe vengono aggiunte al controllo.</span><span class="sxs-lookup"><span data-stu-id="6538b-139">This includes the row template, which is cloned along with its shortcut menu when new rows are added to the control.</span></span> <span data-ttu-id="6538b-140">Per ottenere la massima scalabilità, utilizzare solo del controllo <xref:System.Windows.Forms.Control.ContextMenuStrip%2A> proprietà per specificare un menu di scelta rapida solo per l'intero controllo.</span><span class="sxs-lookup"><span data-stu-id="6538b-140">For maximum scalability, use only the control's <xref:System.Windows.Forms.Control.ContextMenuStrip%2A> property to specify a single shortcut menu for the entire control.</span></span>  
  
-   <span data-ttu-id="6538b-141">Se sono necessari più menu di scelta rapida per più righe o celle, gestire il <xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded> o <xref:System.Windows.Forms.DataGridView.RowContextMenuStripNeeded> eventi.</span><span class="sxs-lookup"><span data-stu-id="6538b-141">If you require multiple shortcut menus for multiple rows or cells, handle the <xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded> or <xref:System.Windows.Forms.DataGridView.RowContextMenuStripNeeded> events.</span></span> <span data-ttu-id="6538b-142">Questi eventi consentono di gestire il menu di scelta rapida manualmente, che consente di ottimizzare le prestazioni.</span><span class="sxs-lookup"><span data-stu-id="6538b-142">These events let you manage the shortcut menu objects yourself, allowing you to tune performance.</span></span>  
  
## <a name="using-automatic-resizing-efficiently"></a><span data-ttu-id="6538b-143">Utilizzo in modo efficiente il ridimensionamento automatico</span><span class="sxs-lookup"><span data-stu-id="6538b-143">Using Automatic Resizing Efficiently</span></span>  
 <span data-ttu-id="6538b-144">Le righe, colonne e le intestazioni possono essere ridimensionate automaticamente come modifiche del contenuto cella in modo che l'intero contenuto delle celle viene visualizzato senza troncamenti.</span><span class="sxs-lookup"><span data-stu-id="6538b-144">Rows, columns, and headers can be automatically resized as cell content changes so that the entire contents of cells are displayed without clipping.</span></span> <span data-ttu-id="6538b-145">Modifica delle modalità di ridimensionamento anche possibile ridimensionare righe, colonne e intestazioni.</span><span class="sxs-lookup"><span data-stu-id="6538b-145">Changing sizing modes can also resize rows, columns, and headers.</span></span> <span data-ttu-id="6538b-146">Per determinare le dimensioni corrette, il <xref:System.Windows.Forms.DataGridView> controllo deve esaminare il valore di ogni cella che è necessario consentirne l'utilizzo.</span><span class="sxs-lookup"><span data-stu-id="6538b-146">To determine the correct size, the <xref:System.Windows.Forms.DataGridView> control must examine the value of each cell that it must accommodate.</span></span> <span data-ttu-id="6538b-147">Quando si lavora con grandi set di dati, questa analisi può influire negativamente sulle prestazioni del controllo quando si verifica il ridimensionamento automatico.</span><span class="sxs-lookup"><span data-stu-id="6538b-147">When working with large data sets, this analysis can negatively impact the performance of the control when automatic resizing occurs.</span></span> <span data-ttu-id="6538b-148">Per evitare effetti negativi sulle prestazioni, utilizzare le linee guida seguenti:</span><span class="sxs-lookup"><span data-stu-id="6538b-148">To avoid performance penalties, use the following guidelines:</span></span>  
  
-   <span data-ttu-id="6538b-149">Evitare di utilizzare il ridimensionamento automatico in un <xref:System.Windows.Forms.DataGridView> controllo con un ampio set di righe.</span><span class="sxs-lookup"><span data-stu-id="6538b-149">Avoid using automatic sizing on a <xref:System.Windows.Forms.DataGridView> control with a large set of rows.</span></span> <span data-ttu-id="6538b-150">Se si utilizza il ridimensionamento automatico, ridimensionare solo le righe visualizzate.</span><span class="sxs-lookup"><span data-stu-id="6538b-150">If you do use automatic sizing, only resize based on the displayed rows.</span></span> <span data-ttu-id="6538b-151">Utilizzare solo le righe visualizzate in modalità virtuale.</span><span class="sxs-lookup"><span data-stu-id="6538b-151">Use only the displayed rows in virtual mode as well.</span></span>  
  
    -   <span data-ttu-id="6538b-152">Per le righe e colonne, utilizzare il `DisplayedCells` o `DisplayedCellsExceptHeaders` campo il <xref:System.Windows.Forms.DataGridViewAutoSizeRowsMode>, <xref:System.Windows.Forms.DataGridViewAutoSizeColumnsMode>, e <xref:System.Windows.Forms.DataGridViewAutoSizeColumnMode> enumerazioni.</span><span class="sxs-lookup"><span data-stu-id="6538b-152">For rows and columns, use the `DisplayedCells` or `DisplayedCellsExceptHeaders` field of the <xref:System.Windows.Forms.DataGridViewAutoSizeRowsMode>, <xref:System.Windows.Forms.DataGridViewAutoSizeColumnsMode>, and <xref:System.Windows.Forms.DataGridViewAutoSizeColumnMode> enumerations.</span></span>  
  
    -   <span data-ttu-id="6538b-153">Per le intestazioni di riga, utilizzare il <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToDisplayedHeaders> o <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToFirstHeader> campo il <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode> enumerazione.</span><span class="sxs-lookup"><span data-stu-id="6538b-153">For row headers, use the <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToDisplayedHeaders> or <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToFirstHeader> field of the <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode> enumeration.</span></span>  
  
-   <span data-ttu-id="6538b-154">Per ottenere la massima scalabilità, disattivare il ridimensionamento automatico e utilizzare il ridimensionamento a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="6538b-154">For maximum scalability, turn off automatic sizing and use programmatic resizing.</span></span>  
  
 <span data-ttu-id="6538b-155">Per ulteriori informazioni, vedere [opzioni di ridimensionamento nel controllo DataGridView Windows Form](../../../../docs/framework/winforms/controls/sizing-options-in-the-windows-forms-datagridview-control.md).</span><span class="sxs-lookup"><span data-stu-id="6538b-155">For more information, see [Sizing Options in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/sizing-options-in-the-windows-forms-datagridview-control.md).</span></span>  
  
## <a name="using-the-selected-cells-rows-and-columns-collections-efficiently"></a><span data-ttu-id="6538b-156">Utilizzo efficiente di celle, righe e le raccolte di colonne</span><span class="sxs-lookup"><span data-stu-id="6538b-156">Using the Selected Cells, Rows, and Columns Collections Efficiently</span></span>  
 <span data-ttu-id="6538b-157">Il <xref:System.Windows.Forms.DataGridView.SelectedCells%2A> insieme non viene eseguito in modo efficiente con selezioni di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="6538b-157">The <xref:System.Windows.Forms.DataGridView.SelectedCells%2A> collection does not perform efficiently with large selections.</span></span> <span data-ttu-id="6538b-158">Il <xref:System.Windows.Forms.DataGridView.SelectedRows%2A> e <xref:System.Windows.Forms.DataGridView.SelectedColumns%2A> raccolte anche possono risultare inefficiente, anche se a un livello inferiore perché sono presenti molte righe minore del numero di celle in una tipica <xref:System.Windows.Forms.DataGridView> controllo e molte meno colonne che righe.</span><span class="sxs-lookup"><span data-stu-id="6538b-158">The <xref:System.Windows.Forms.DataGridView.SelectedRows%2A> and <xref:System.Windows.Forms.DataGridView.SelectedColumns%2A> collections can also be inefficient, although to a lesser degree because there are many fewer rows than cells in a typical <xref:System.Windows.Forms.DataGridView> control, and many fewer columns than rows.</span></span> <span data-ttu-id="6538b-159">Per evitare effetti negativi sulle prestazioni quando si utilizzano queste raccolte, utilizzare le linee guida seguenti:</span><span class="sxs-lookup"><span data-stu-id="6538b-159">To avoid performance penalties when working with these collections, use the following guidelines:</span></span>  
  
-   <span data-ttu-id="6538b-160">Per determinare se tutte le celle di <xref:System.Windows.Forms.DataGridView> sono state selezionate prima dell'accesso al contenuto del <xref:System.Windows.Forms.DataGridView.SelectedCells%2A> insieme, controllare il valore restituito del <xref:System.Windows.Forms.DataGridView.AreAllCellsSelected%2A> (metodo).</span><span class="sxs-lookup"><span data-stu-id="6538b-160">To determine whether all the cells in the <xref:System.Windows.Forms.DataGridView> have been selected before you access the contents of the <xref:System.Windows.Forms.DataGridView.SelectedCells%2A> collection, check the return value of the <xref:System.Windows.Forms.DataGridView.AreAllCellsSelected%2A> method.</span></span> <span data-ttu-id="6538b-161">Si noti tuttavia che questo metodo può causare righe venga rimossa.</span><span class="sxs-lookup"><span data-stu-id="6538b-161">Note, however, that this method can cause rows to become unshared.</span></span> <span data-ttu-id="6538b-162">Per altre informazioni, vedere la sezione successiva.</span><span class="sxs-lookup"><span data-stu-id="6538b-162">For more information, see the next section.</span></span>  
  
-   <span data-ttu-id="6538b-163">Evitare di utilizzare il <xref:System.Collections.ICollection.Count%2A> proprietà del <xref:System.Windows.Forms.DataGridViewSelectedCellCollection?displayProperty=nameWithType> per determinare il numero di celle selezionate.</span><span class="sxs-lookup"><span data-stu-id="6538b-163">Avoid using the <xref:System.Collections.ICollection.Count%2A> property of the <xref:System.Windows.Forms.DataGridViewSelectedCellCollection?displayProperty=nameWithType> to determine the number of selected cells.</span></span> <span data-ttu-id="6538b-164">Utilizzare invece il <xref:System.Windows.Forms.DataGridView.GetCellCount%2A?displayProperty=nameWithType> (metodo) e passare il <xref:System.Windows.Forms.DataGridViewElementStates.Selected?displayProperty=nameWithType> valore.</span><span class="sxs-lookup"><span data-stu-id="6538b-164">Instead, use the <xref:System.Windows.Forms.DataGridView.GetCellCount%2A?displayProperty=nameWithType> method and pass in the <xref:System.Windows.Forms.DataGridViewElementStates.Selected?displayProperty=nameWithType> value.</span></span> <span data-ttu-id="6538b-165">Analogamente, utilizzare il <xref:System.Windows.Forms.DataGridViewRowCollection.GetRowCount%2A?displayProperty=nameWithType> e <xref:System.Windows.Forms.DataGridViewColumnCollection.GetColumnCount%2A?displayProperty=nameWithType> metodi per determinare il numero di elementi selezionati, anziché l'accesso alle raccolte di righe e colonne selezionate.</span><span class="sxs-lookup"><span data-stu-id="6538b-165">Similarly, use the <xref:System.Windows.Forms.DataGridViewRowCollection.GetRowCount%2A?displayProperty=nameWithType> and <xref:System.Windows.Forms.DataGridViewColumnCollection.GetColumnCount%2A?displayProperty=nameWithType> methods to determine the number of selected elements, rather than accessing the selected row and column collections.</span></span>  
  
-   <span data-ttu-id="6538b-166">Evitare le modalità di selezione basata sulla cella.</span><span class="sxs-lookup"><span data-stu-id="6538b-166">Avoid cell-based selection modes.</span></span> <span data-ttu-id="6538b-167">Al contrario, impostare il <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> proprietà <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType> o <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="6538b-167">Instead, set the <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> property to <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect?displayProperty=nameWithType>.</span></span>  
  
## <a name="using-shared-rows"></a><span data-ttu-id="6538b-168">Uso di righe condivisi</span><span class="sxs-lookup"><span data-stu-id="6538b-168">Using Shared Rows</span></span>  
 <span data-ttu-id="6538b-169">Utilizzo efficiente della memoria viene eseguito nel <xref:System.Windows.Forms.DataGridView> controllo condivisione delle righe.</span><span class="sxs-lookup"><span data-stu-id="6538b-169">Efficient memory use is achieved in the <xref:System.Windows.Forms.DataGridView> control through shared rows.</span></span> <span data-ttu-id="6538b-170">Le righe condividono le informazioni sul relativo aspetto e comportamento possibile la condivisione delle istanze del <xref:System.Windows.Forms.DataGridViewRow> classe.</span><span class="sxs-lookup"><span data-stu-id="6538b-170">Rows will share as much information about their appearance and behavior as possible by sharing instances of the <xref:System.Windows.Forms.DataGridViewRow> class.</span></span>  
  
 <span data-ttu-id="6538b-171">Mentre la condivisione delle istanze di riga, potrai risparmiare memoria, righe può facilmente essere rimossa.</span><span class="sxs-lookup"><span data-stu-id="6538b-171">While sharing row instances saves memory, rows can easily become unshared.</span></span> <span data-ttu-id="6538b-172">Ad esempio, ogni volta che un utente interagisce direttamente con una cella, la riga viene rimossa.</span><span class="sxs-lookup"><span data-stu-id="6538b-172">For example, whenever a user interacts directly with a cell, its row becomes unshared.</span></span> <span data-ttu-id="6538b-173">Poiché non è possibile evitare questo, le linee guida fornite in questo argomento sono utili solo quando si lavora con grandi quantità di dati e solo quando gli utenti interagiscono con una relativamente piccola parte dei dati ogni volta che viene eseguito il programma.</span><span class="sxs-lookup"><span data-stu-id="6538b-173">Because this cannot be avoided, the guidelines in this topic are useful only when working with very large amounts of data and only when users will interact with a relatively small part of the data each time your program is run.</span></span>  
  
 <span data-ttu-id="6538b-174">Una riga non può essere condivisi in un oggetto non associato <xref:System.Windows.Forms.DataGridView> controllare se una delle relative celle contengono valori.</span><span class="sxs-lookup"><span data-stu-id="6538b-174">A row cannot be shared in an unbound <xref:System.Windows.Forms.DataGridView> control if any of its cells contain values.</span></span> <span data-ttu-id="6538b-175">Quando il <xref:System.Windows.Forms.DataGridView> è associato a un'origine dati esterna o quando si implementa la modalità virtuale e fornire la propria origine dati, i valori di cella vengono archiviati all'esterno del controllo anziché in oggetti cella, consentendo la condivisione delle righe.</span><span class="sxs-lookup"><span data-stu-id="6538b-175">When the <xref:System.Windows.Forms.DataGridView> control is bound to an external data source or when you implement virtual mode and provide your own data source, the cell values are stored outside the control rather than in cell objects, allowing the rows to be shared.</span></span>  
  
 <span data-ttu-id="6538b-176">Un oggetto riga può essere condiviso solo se lo stato di tutte le relative celle, è possibile determinare lo stato della riga e degli stati delle colonne contenenti le celle.</span><span class="sxs-lookup"><span data-stu-id="6538b-176">A row object can only be shared if the state of all its cells can be determined from the state of the row and the states of the columns containing the cells.</span></span> <span data-ttu-id="6538b-177">Se si modifica lo stato di una cella in modo che non può essere dedotto dallo stato della relativa riga e colonna, la riga non può essere condivisa.</span><span class="sxs-lookup"><span data-stu-id="6538b-177">If you change the state of a cell so that it can no longer be deduced from the state of its row and column, the row cannot be shared.</span></span>  
  
 <span data-ttu-id="6538b-178">Ad esempio, una riga non può essere condivisa in una delle situazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="6538b-178">For example, a row cannot be shared in any of the following situations:</span></span>  
  
-   <span data-ttu-id="6538b-179">La riga contiene una singola cella selezionata che non è presente in una colonna selezionata.</span><span class="sxs-lookup"><span data-stu-id="6538b-179">The row contains a single selected cell that is not in a selected column.</span></span>  
  
-   <span data-ttu-id="6538b-180">La riga contiene una cella con il relativo <xref:System.Windows.Forms.DataGridViewCell.ToolTipText%2A> o <xref:System.Windows.Forms.DataGridViewCell.ContextMenuStrip%2A> set di proprietà.</span><span class="sxs-lookup"><span data-stu-id="6538b-180">The row contains a cell with its <xref:System.Windows.Forms.DataGridViewCell.ToolTipText%2A> or <xref:System.Windows.Forms.DataGridViewCell.ContextMenuStrip%2A> properties set.</span></span>  
  
-   <span data-ttu-id="6538b-181">La riga contiene un <xref:System.Windows.Forms.DataGridViewComboBoxCell> con il relativo <xref:System.Windows.Forms.DataGridViewComboBoxCell.Items%2A> set di proprietà.</span><span class="sxs-lookup"><span data-stu-id="6538b-181">The row contains a <xref:System.Windows.Forms.DataGridViewComboBoxCell> with its <xref:System.Windows.Forms.DataGridViewComboBoxCell.Items%2A> property set.</span></span>  
  
 <span data-ttu-id="6538b-182">In modalità di associazione o la modalità virtuale, è possibile fornire le descrizioni comandi e menu di scelta rapida per le singole celle gestendo il <xref:System.Windows.Forms.DataGridView.CellToolTipTextNeeded> e <xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded> eventi.</span><span class="sxs-lookup"><span data-stu-id="6538b-182">In bound mode or virtual mode, you can provide ToolTips and shortcut menus for individual cells by handling the <xref:System.Windows.Forms.DataGridView.CellToolTipTextNeeded> and <xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded> events.</span></span>  
  
 <span data-ttu-id="6538b-183">Il <xref:System.Windows.Forms.DataGridView> controllo tenterà automaticamente di utilizzare le righe condivise ogni volta che vengono aggiunte righe di <xref:System.Windows.Forms.DataGridViewRowCollection>.</span><span class="sxs-lookup"><span data-stu-id="6538b-183">The <xref:System.Windows.Forms.DataGridView> control will automatically attempt to use shared rows whenever rows are added to the <xref:System.Windows.Forms.DataGridViewRowCollection>.</span></span> <span data-ttu-id="6538b-184">Utilizzare le linee guida seguenti per assicurarsi che le righe vengono condivisi:</span><span class="sxs-lookup"><span data-stu-id="6538b-184">Use the following guidelines to ensure that rows are shared:</span></span>  
  
-   <span data-ttu-id="6538b-185">Evitare di chiamare il `Add(Object[])` overload del <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> (metodo) e `Insert(Object[])` overload del <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> metodo il <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> insieme.</span><span class="sxs-lookup"><span data-stu-id="6538b-185">Avoid calling the `Add(Object[])` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> method and the `Insert(Object[])` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> method of the <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> collection.</span></span> <span data-ttu-id="6538b-186">Questi overload creano automaticamente righe non condivise.</span><span class="sxs-lookup"><span data-stu-id="6538b-186">These overloads automatically create unshared rows.</span></span>  
  
-   <span data-ttu-id="6538b-187">Assicurarsi che la riga specificata nel <xref:System.Windows.Forms.DataGridView.RowTemplate%2A?displayProperty=nameWithType> proprietà può essere condivisi nei casi seguenti:</span><span class="sxs-lookup"><span data-stu-id="6538b-187">Be sure that the row specified in the <xref:System.Windows.Forms.DataGridView.RowTemplate%2A?displayProperty=nameWithType> property can be shared in the following cases:</span></span>  
  
    -   <span data-ttu-id="6538b-188">Quando si chiama il `Add()` o `Add(Int32)` gli overload del <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> (metodo) o `Insert(Int32,Int32)` overload del <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> metodo il <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> insieme.</span><span class="sxs-lookup"><span data-stu-id="6538b-188">When calling the `Add()` or `Add(Int32)` overloads of the <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> method or the `Insert(Int32,Int32)` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> method of the <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> collection.</span></span>  
  
    -   <span data-ttu-id="6538b-189">Quando viene incrementato il valore della <xref:System.Windows.Forms.DataGridView.RowCount%2A?displayProperty=nameWithType> proprietà.</span><span class="sxs-lookup"><span data-stu-id="6538b-189">When increasing the value of the <xref:System.Windows.Forms.DataGridView.RowCount%2A?displayProperty=nameWithType> property.</span></span>  
  
    -   <span data-ttu-id="6538b-190">Quando si imposta la <xref:System.Windows.Forms.DataGridView.DataSource%2A?displayProperty=nameWithType> proprietà.</span><span class="sxs-lookup"><span data-stu-id="6538b-190">When setting the <xref:System.Windows.Forms.DataGridView.DataSource%2A?displayProperty=nameWithType> property.</span></span>  
  
-   <span data-ttu-id="6538b-191">Assicurarsi che la riga indicata dal `indexSource` parametro può essere condivisa quando si chiama il <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopy%2A>, <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopies%2A>, <xref:System.Windows.Forms.DataGridViewRowCollection.InsertCopy%2A>, e <xref:System.Windows.Forms.DataGridViewRowCollection.InsertCopies%2A> metodi del <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> insieme.</span><span class="sxs-lookup"><span data-stu-id="6538b-191">Be sure that the row indicated by the `indexSource` parameter can be shared when calling the <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopy%2A>, <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopies%2A>, <xref:System.Windows.Forms.DataGridViewRowCollection.InsertCopy%2A>, and <xref:System.Windows.Forms.DataGridViewRowCollection.InsertCopies%2A> methods of the <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> collection.</span></span>  
  
-   <span data-ttu-id="6538b-192">Assicurarsi che la riga specificata o le righe possono essere condivisa quando si chiama il `Add(DataGridViewRow)` overload del <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> (metodo), il <xref:System.Windows.Forms.DataGridViewRowCollection.AddRange%2A> (metodo), il `Insert(Int32,DataGridViewRow)` overload del <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> (metodo) e <xref:System.Windows.Forms.DataGridViewRowCollection.InsertRange%2A> metodo il <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType>insieme.</span><span class="sxs-lookup"><span data-stu-id="6538b-192">Be sure that the specified row or rows can be shared when calling the `Add(DataGridViewRow)` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> method, the <xref:System.Windows.Forms.DataGridViewRowCollection.AddRange%2A> method, the `Insert(Int32,DataGridViewRow)` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> method, and the <xref:System.Windows.Forms.DataGridViewRowCollection.InsertRange%2A> method of the <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> collection.</span></span>  
  
 <span data-ttu-id="6538b-193">Per determinare se una riga è condivisa, utilizzare il <xref:System.Windows.Forms.DataGridViewRowCollection.SharedRow%2A?displayProperty=nameWithType> metodo per recuperare l'oggetto riga e quindi selezionare l'oggetto <xref:System.Windows.Forms.DataGridViewBand.Index%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="6538b-193">To determine whether a row is shared, use the <xref:System.Windows.Forms.DataGridViewRowCollection.SharedRow%2A?displayProperty=nameWithType> method to retrieve the row object, and then check the object's <xref:System.Windows.Forms.DataGridViewBand.Index%2A> property.</span></span> <span data-ttu-id="6538b-194">Righe condivise hanno sempre un <xref:System.Windows.Forms.DataGridViewBand.Index%2A> valore della proprietà di – 1.</span><span class="sxs-lookup"><span data-stu-id="6538b-194">Shared rows always have an <xref:System.Windows.Forms.DataGridViewBand.Index%2A> property value of –1.</span></span>  
  
## <a name="preventing-rows-from-becoming-unshared"></a><span data-ttu-id="6538b-195">Impedisce la rimozione della condivisione di righe</span><span class="sxs-lookup"><span data-stu-id="6538b-195">Preventing Rows from Becoming Unshared</span></span>  
 <span data-ttu-id="6538b-196">Righe condivise può essere rimossa in seguito a un'azione utente o di codice.</span><span class="sxs-lookup"><span data-stu-id="6538b-196">Shared rows can become unshared as a result of code or user action.</span></span> <span data-ttu-id="6538b-197">Per evitare un impatto sulle prestazioni, è necessario evitare che le righe verrà annullata.</span><span class="sxs-lookup"><span data-stu-id="6538b-197">To avoid a performance impact, you should avoid causing rows to become unshared.</span></span> <span data-ttu-id="6538b-198">Durante lo sviluppo di applicazioni, è possibile gestire il <xref:System.Windows.Forms.DataGridView.RowUnshared> evento per determinare quando le righe diventano non condivise.</span><span class="sxs-lookup"><span data-stu-id="6538b-198">During application development, you can handle the <xref:System.Windows.Forms.DataGridView.RowUnshared> event to determine when rows become unshared.</span></span> <span data-ttu-id="6538b-199">Ciò è utile quando il debug di problemi di condivisione delle righe.</span><span class="sxs-lookup"><span data-stu-id="6538b-199">This is useful when debugging row-sharing problems.</span></span>  
  
 <span data-ttu-id="6538b-200">Per impedire la rimozione della condivisione di righe, utilizzare le linee guida seguenti:</span><span class="sxs-lookup"><span data-stu-id="6538b-200">To prevent rows from becoming unshared, use the following guidelines:</span></span>  
  
-   <span data-ttu-id="6538b-201">Evitare l'indicizzazione di <xref:System.Windows.Forms.DataGridView.Rows%2A> raccolta o l'iterazione con un `foreach` ciclo.</span><span class="sxs-lookup"><span data-stu-id="6538b-201">Avoid indexing the <xref:System.Windows.Forms.DataGridView.Rows%2A> collection or iterating through it with a `foreach` loop.</span></span> <span data-ttu-id="6538b-202">In genere non è necessario accedere direttamente alle righe.</span><span class="sxs-lookup"><span data-stu-id="6538b-202">You will not typically need to access rows directly.</span></span> <span data-ttu-id="6538b-203"><xref:System.Windows.Forms.DataGridView>i metodi che operano sulle righe accettano gli argomenti di indice di riga invece istanze della riga.</span><span class="sxs-lookup"><span data-stu-id="6538b-203"><xref:System.Windows.Forms.DataGridView> methods that operate on rows take row index arguments rather than row instances.</span></span> <span data-ttu-id="6538b-204">Inoltre, gestori di eventi relativi alle righe ricevono oggetti di argomento dell'evento con le proprietà di riga che è possibile utilizzare per modificare le righe senza che ne venga annullata.</span><span class="sxs-lookup"><span data-stu-id="6538b-204">Additionally, handlers for row-related events receive event argument objects with row properties that you can use to manipulate rows without causing them to become unshared.</span></span>  
  
-   <span data-ttu-id="6538b-205">Se è necessario accedere a un oggetto riga, utilizzare il <xref:System.Windows.Forms.DataGridViewRowCollection.SharedRow%2A?displayProperty=nameWithType> (metodo) e passare di indice effettivo la riga.</span><span class="sxs-lookup"><span data-stu-id="6538b-205">If you need to access a row object, use the <xref:System.Windows.Forms.DataGridViewRowCollection.SharedRow%2A?displayProperty=nameWithType> method and pass in the row's actual index.</span></span> <span data-ttu-id="6538b-206">Si noti tuttavia che la modifica di un oggetto riga condivisa recuperato mediante questo metodo modificare tutte le righe che condividono questo oggetto.</span><span class="sxs-lookup"><span data-stu-id="6538b-206">Note, however, that modifying a shared row object retrieved through this method will modify all the rows that share this object.</span></span> <span data-ttu-id="6538b-207">La riga per nuovi record non è condivisa con altre righe, tuttavia, in modo che non sarà interessata quando si modifica qualsiasi altra riga.</span><span class="sxs-lookup"><span data-stu-id="6538b-207">The row for new records is not shared with other rows, however, so it will not be affected when you modify any other row.</span></span> <span data-ttu-id="6538b-208">Si noti inoltre che il menu di scelta rapida diversi possono disporre di diverse righe rappresentata da una riga condivisa.</span><span class="sxs-lookup"><span data-stu-id="6538b-208">Note also that different rows represented by a shared row may have different shortcut menus.</span></span> <span data-ttu-id="6538b-209">Per recuperare il menu di scelta rapida corretto dall'istanza di una riga condivisa, utilizzare il <xref:System.Windows.Forms.DataGridViewRow.GetContextMenuStrip%2A> (metodo) e passare di indice effettivo la riga.</span><span class="sxs-lookup"><span data-stu-id="6538b-209">To retrieve the correct shortcut menu from a shared row instance, use the <xref:System.Windows.Forms.DataGridViewRow.GetContextMenuStrip%2A> method and pass in the row's actual index.</span></span> <span data-ttu-id="6538b-210">Se si accede della riga condivisa <xref:System.Windows.Forms.DataGridViewRow.ContextMenuStrip%2A> proprietà, invece, verrà utilizzato l'indice di riga condivisa di -1 e non verrà recuperato il menu di scelta rapida corretto.</span><span class="sxs-lookup"><span data-stu-id="6538b-210">If you access the shared row's <xref:System.Windows.Forms.DataGridViewRow.ContextMenuStrip%2A> property instead, it will use the shared row index of -1 and will not retrieve the correct shortcut menu.</span></span>  
  
-   <span data-ttu-id="6538b-211">Evitare l'indicizzazione di <xref:System.Windows.Forms.DataGridViewRow.Cells%2A?displayProperty=nameWithType> insieme.</span><span class="sxs-lookup"><span data-stu-id="6538b-211">Avoid indexing the <xref:System.Windows.Forms.DataGridViewRow.Cells%2A?displayProperty=nameWithType> collection.</span></span> <span data-ttu-id="6538b-212">Accesso diretto a una cella provocherà la riga padre e la rimozione della condivisione, creare un'istanza di un nuovo <xref:System.Windows.Forms.DataGridViewRow>.</span><span class="sxs-lookup"><span data-stu-id="6538b-212">Accessing a cell directly will cause its parent row to become unshared, instantiating a new <xref:System.Windows.Forms.DataGridViewRow>.</span></span> <span data-ttu-id="6538b-213">Gestori di eventi correlati alla cella ricevono oggetti di argomento dell'evento con le proprietà di cella che è possibile utilizzare per modificare le celle senza causare righe venga rimossa.</span><span class="sxs-lookup"><span data-stu-id="6538b-213">Handlers for cell-related events receive event argument objects with cell properties that you can use to manipulate cells without causing rows to become unshared.</span></span> <span data-ttu-id="6538b-214">È inoltre possibile utilizzare il <xref:System.Windows.Forms.DataGridView.CurrentCellAddress%2A> proprietà per recuperare gli indici di riga e di colonna della cella corrente senza accedere direttamente alla cella.</span><span class="sxs-lookup"><span data-stu-id="6538b-214">You can also use the <xref:System.Windows.Forms.DataGridView.CurrentCellAddress%2A> property to retrieve the row and column indexes of the current cell without accessing the cell directly.</span></span>  
  
-   <span data-ttu-id="6538b-215">Evitare le modalità di selezione basata sulla cella.</span><span class="sxs-lookup"><span data-stu-id="6538b-215">Avoid cell-based selection modes.</span></span> <span data-ttu-id="6538b-216">Queste modalità provocano righe non condivise.</span><span class="sxs-lookup"><span data-stu-id="6538b-216">These modes cause rows to become unshared.</span></span> <span data-ttu-id="6538b-217">Al contrario, impostare il <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> proprietà <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType> o <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="6538b-217">Instead, set the <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> property to <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect?displayProperty=nameWithType>.</span></span>  
  
-   <span data-ttu-id="6538b-218">Non gestire la <xref:System.Windows.Forms.DataGridViewRowCollection.CollectionChanged?displayProperty=nameWithType> o <xref:System.Windows.Forms.DataGridView.RowStateChanged?displayProperty=nameWithType> eventi.</span><span class="sxs-lookup"><span data-stu-id="6538b-218">Do not handle the <xref:System.Windows.Forms.DataGridViewRowCollection.CollectionChanged?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridView.RowStateChanged?displayProperty=nameWithType> events.</span></span> <span data-ttu-id="6538b-219">Questi eventi provocano righe non condivise.</span><span class="sxs-lookup"><span data-stu-id="6538b-219">These events cause rows to become unshared.</span></span> <span data-ttu-id="6538b-220">Inoltre, non chiamare il <xref:System.Windows.Forms.DataGridViewRowCollection.OnCollectionChanged%2A?displayProperty=nameWithType> o <xref:System.Windows.Forms.DataGridView.OnRowStateChanged%2A?displayProperty=nameWithType> metodi, la generazione di questi eventi.</span><span class="sxs-lookup"><span data-stu-id="6538b-220">Also, do not call the <xref:System.Windows.Forms.DataGridViewRowCollection.OnCollectionChanged%2A?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridView.OnRowStateChanged%2A?displayProperty=nameWithType> methods, which raise these events.</span></span>  
  
-   <span data-ttu-id="6538b-221">Non accedere il <xref:System.Windows.Forms.DataGridView.SelectedCells%2A?displayProperty=nameWithType> raccolta quando il <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> valore della proprietà è <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect>, <xref:System.Windows.Forms.DataGridViewSelectionMode.ColumnHeaderSelect>, <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect>, o <xref:System.Windows.Forms.DataGridViewSelectionMode.RowHeaderSelect>.</span><span class="sxs-lookup"><span data-stu-id="6538b-221">Do not access the <xref:System.Windows.Forms.DataGridView.SelectedCells%2A?displayProperty=nameWithType> collection when the <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> property value is <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect>, <xref:System.Windows.Forms.DataGridViewSelectionMode.ColumnHeaderSelect>, <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect>, or <xref:System.Windows.Forms.DataGridViewSelectionMode.RowHeaderSelect>.</span></span> <span data-ttu-id="6538b-222">In questo modo tutte le righe selezionate verrà annullata.</span><span class="sxs-lookup"><span data-stu-id="6538b-222">This causes all selected rows to become unshared.</span></span>  
  
-   <span data-ttu-id="6538b-223">Non chiamare il <xref:System.Windows.Forms.DataGridView.AreAllCellsSelected%2A?displayProperty=nameWithType> metodo.</span><span class="sxs-lookup"><span data-stu-id="6538b-223">Do not call the <xref:System.Windows.Forms.DataGridView.AreAllCellsSelected%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="6538b-224">Questo metodo può causare righe venga rimossa.</span><span class="sxs-lookup"><span data-stu-id="6538b-224">This method can cause rows to become unshared.</span></span>  
  
-   <span data-ttu-id="6538b-225">Non chiamare il <xref:System.Windows.Forms.DataGridView.SelectAll%2A?displayProperty=nameWithType> metodo quando il <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> valore della proprietà è <xref:System.Windows.Forms.DataGridViewSelectionMode.CellSelect>.</span><span class="sxs-lookup"><span data-stu-id="6538b-225">Do not call the <xref:System.Windows.Forms.DataGridView.SelectAll%2A?displayProperty=nameWithType> method when the <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> property value is <xref:System.Windows.Forms.DataGridViewSelectionMode.CellSelect>.</span></span> <span data-ttu-id="6538b-226">In questo modo tutte le righe per la rimozione della condivisione.</span><span class="sxs-lookup"><span data-stu-id="6538b-226">This causes all rows to become unshared.</span></span>  
  
-   <span data-ttu-id="6538b-227">Non impostare il <xref:System.Windows.Forms.DataGridViewCell.ReadOnly%2A> o <xref:System.Windows.Forms.DataGridViewCell.Selected%2A> proprietà di una cella per `false` quando è impostata la proprietà corrispondente nella colonna `true`.</span><span class="sxs-lookup"><span data-stu-id="6538b-227">Do not set the <xref:System.Windows.Forms.DataGridViewCell.ReadOnly%2A> or <xref:System.Windows.Forms.DataGridViewCell.Selected%2A> property of a cell to `false` when the corresponding property in its column is set to `true`.</span></span> <span data-ttu-id="6538b-228">In questo modo tutte le righe per la rimozione della condivisione.</span><span class="sxs-lookup"><span data-stu-id="6538b-228">This causes all rows to become unshared.</span></span>  
  
-   <span data-ttu-id="6538b-229">Non accedere il <xref:System.Windows.Forms.DataGridViewRowCollection.List%2A?displayProperty=nameWithType> proprietà.</span><span class="sxs-lookup"><span data-stu-id="6538b-229">Do not access the <xref:System.Windows.Forms.DataGridViewRowCollection.List%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="6538b-230">In questo modo tutte le righe per la rimozione della condivisione.</span><span class="sxs-lookup"><span data-stu-id="6538b-230">This causes all rows to become unshared.</span></span>  
  
-   <span data-ttu-id="6538b-231">Non chiamare il `Sort(IComparer)` overload di <xref:System.Windows.Forms.DataGridView.Sort%2A> metodo.</span><span class="sxs-lookup"><span data-stu-id="6538b-231">Do not call the `Sort(IComparer)` overload of the <xref:System.Windows.Forms.DataGridView.Sort%2A> method.</span></span> <span data-ttu-id="6538b-232">Ordinamento con un operatore di confronto personalizzato fa sì che tutte le righe per la rimozione della condivisione.</span><span class="sxs-lookup"><span data-stu-id="6538b-232">Sorting with a custom comparer causes all rows to become unshared.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6538b-233">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="6538b-233">See Also</span></span>  
 <xref:System.Windows.Forms.DataGridView>  
 [<span data-ttu-id="6538b-234">Ottimizzazione delle prestazioni nel controllo DataGridView di Windows Form</span><span class="sxs-lookup"><span data-stu-id="6538b-234">Performance Tuning in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/performance-tuning-in-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="6538b-235">Modo virtuale nel controllo DataGridView di Windows Form</span><span class="sxs-lookup"><span data-stu-id="6538b-235">Virtual Mode in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/virtual-mode-in-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="6538b-236">Modalità di visualizzazione di dati nel controllo DataGridView di Windows Form</span><span class="sxs-lookup"><span data-stu-id="6538b-236">Data Display Modes in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/data-display-modes-in-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="6538b-237">Stili delle celle nel controllo DataGridView di Windows Form</span><span class="sxs-lookup"><span data-stu-id="6538b-237">Cell Styles in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/cell-styles-in-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="6538b-238">Procedura: Impostare stili di cella predefiniti per il controllo DataGridView di Windows Form</span><span class="sxs-lookup"><span data-stu-id="6538b-238">How to: Set Default Cell Styles for the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/how-to-set-default-cell-styles-for-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="6538b-239">Opzioni di ridimensionamento nel controllo DataGridView di Windows Form</span><span class="sxs-lookup"><span data-stu-id="6538b-239">Sizing Options in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/sizing-options-in-the-windows-forms-datagridview-control.md)
