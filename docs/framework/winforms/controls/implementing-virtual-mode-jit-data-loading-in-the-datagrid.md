---
title: Implementazione del modo virtuale con caricamento dati JIT nel controllo DataGridView di Windows Form
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-winforms
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords:
- examples [Windows Forms], just-in-time data loading
- data [Windows Forms], managing large data sets
- DataGridView control [Windows Forms], virtual mode
- just-in-time data loading
- DataGridView control [Windows Forms], large data sets
- virtual mode [Windows Forms], just-in-time data loading
ms.assetid: c2a052b9-423c-4ff7-91dc-d8c7c79345f6
caps.latest.revision: "13"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 2a830c11e8df73b71f16c1b9dfd1007461d910f5
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/22/2017
---
# <a name="implementing-virtual-mode-with-just-in-time-data-loading-in-the-windows-forms-datagridview-control"></a><span data-ttu-id="a0a50-102">Implementazione del modo virtuale con caricamento dati JIT nel controllo DataGridView di Windows Form</span><span class="sxs-lookup"><span data-stu-id="a0a50-102">Implementing Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control</span></span>
<span data-ttu-id="a0a50-103">Uno dei motivi per implementare la modalità virtuale nel <xref:System.Windows.Forms.DataGridView> controllo consiste nel recuperare i dati solo quando è necessario.</span><span class="sxs-lookup"><span data-stu-id="a0a50-103">One reason to implement virtual mode in the <xref:System.Windows.Forms.DataGridView> control is to retrieve data only as it is needed.</span></span> <span data-ttu-id="a0a50-104">Si tratta di *il caricamento dei dati di just-in-time*.</span><span class="sxs-lookup"><span data-stu-id="a0a50-104">This is called *just-in-time data loading*.</span></span>  
  
 <span data-ttu-id="a0a50-105">Se si lavora con una tabella di dimensioni molto grande in un database remoto, ad esempio, si potrebbe desidera evitare ritardi di avvio recuperando solo i dati necessari per la visualizzazione e il recupero di dati aggiuntivi solo quando l'utente scorre nuove righe all'interno della visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="a0a50-105">If you are working with a very large table in a remote database, for example, you might want to avoid startup delays by retrieving only the data that is necessary for display and retrieving additional data only when the user scrolls new rows into view.</span></span> <span data-ttu-id="a0a50-106">Se i computer client che esegue l'applicazione dispongono di una quantità limitata di memoria disponibile per l'archiviazione dei dati, è anche possibile eliminare i dati non utilizzati durante il recupero dei nuovi valori dal database.</span><span class="sxs-lookup"><span data-stu-id="a0a50-106">If the client computers running your application have a limited amount of memory available for storing data, you might also want to discard unused data when retrieving new values from the database.</span></span>  
  
 <span data-ttu-id="a0a50-107">Nelle sezioni seguenti viene descritto come utilizzare un <xref:System.Windows.Forms.DataGridView> controllo con una cache di just-in-time.</span><span class="sxs-lookup"><span data-stu-id="a0a50-107">The following sections describe how to use a <xref:System.Windows.Forms.DataGridView> control with a just-in-time cache.</span></span>  
  
 <span data-ttu-id="a0a50-108">Per copiare il codice in questo argomento come elenco singolo, vedere [procedura: implementare la modalità virtuale con caricamento dati JIT nel controllo DataGridView Windows Form](../../../../docs/framework/winforms/controls/virtual-mode-with-just-in-time-data-loading-in-the-datagrid.md).</span><span class="sxs-lookup"><span data-stu-id="a0a50-108">To copy the code in this topic as a single listing, see [How to: Implement Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/virtual-mode-with-just-in-time-data-loading-in-the-datagrid.md).</span></span>  
  
## <a name="the-form"></a><span data-ttu-id="a0a50-109">Il modulo</span><span class="sxs-lookup"><span data-stu-id="a0a50-109">The Form</span></span>  
 <span data-ttu-id="a0a50-110">L'esempio di codice seguente definisce un form contenente una proprietà di sola lettura <xref:System.Windows.Forms.DataGridView> controllo che interagisce con un `Cache` mediante un <xref:System.Windows.Forms.DataGridView.CellValueNeeded> gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="a0a50-110">The following code example defines a form containing a read-only <xref:System.Windows.Forms.DataGridView> control that interacts with a `Cache` object through a <xref:System.Windows.Forms.DataGridView.CellValueNeeded> event handler.</span></span> <span data-ttu-id="a0a50-111">Il `Cache` oggetto gestisce i valori archiviati localmente e utilizza un `DataRetriever` oggetto per recuperare i valori della tabella Orders del database Northwind di esempio.</span><span class="sxs-lookup"><span data-stu-id="a0a50-111">The `Cache` object manages the locally stored values and uses a `DataRetriever` object to retrieve values from the Orders table of the sample Northwind database.</span></span> <span data-ttu-id="a0a50-112">Il `DataRetriever` oggetto che implementa il `IDataPageRetriever` interfaccia necessaria per il `Cache` classe, viene anche utilizzato per inizializzare il <xref:System.Windows.Forms.DataGridView> controllo righe e colonne.</span><span class="sxs-lookup"><span data-stu-id="a0a50-112">The `DataRetriever` object, which implements the `IDataPageRetriever` interface required by the `Cache` class, is also used to initialize the <xref:System.Windows.Forms.DataGridView> control rows and columns.</span></span>  
  
 <span data-ttu-id="a0a50-113">Il `IDataPageRetriever`, `DataRetriever`, e `Cache` tipi sono descritti più avanti in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="a0a50-113">The `IDataPageRetriever`, `DataRetriever`, and `Cache` types are described later in this topic.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a0a50-114">L'archiviazione delle informazioni riservate, ad esempio la password, nella stringa di connessione può avere implicazioni sulla sicurezza dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="a0a50-114">Storing sensitive information, such as a password, within the connection string can affect the security of your application.</span></span> <span data-ttu-id="a0a50-115">L'autenticazione di Windows, detta anche sicurezza integrata, consente di controllare l'accesso a un database in modo più sicuro.</span><span class="sxs-lookup"><span data-stu-id="a0a50-115">Using Windows Authentication (also known as integrated security) is a more secure way to control access to a database.</span></span> <span data-ttu-id="a0a50-116">Per altre informazioni, vedere [Protezione delle informazioni di connessione](../../../../docs/framework/data/adonet/protecting-connection-information.md).</span><span class="sxs-lookup"><span data-stu-id="a0a50-116">For more information, see [Protecting Connection Information](../../../../docs/framework/data/adonet/protecting-connection-information.md).</span></span>  
  
 [!code-csharp[System.Windows.Forms.DataGridView.Virtual_lazyloading#100](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/CS/lazyloading.cs#100)]
 [!code-vb[System.Windows.Forms.DataGridView.Virtual_lazyloading#100](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/VB/lazyloading.vb#100)]  
  
## <a name="the-idatapageretriever-interface"></a><span data-ttu-id="a0a50-117">L'interfaccia IDataPageRetriever</span><span class="sxs-lookup"><span data-stu-id="a0a50-117">The IDataPageRetriever Interface</span></span>  
 <span data-ttu-id="a0a50-118">L'esempio di codice seguente definisce il `IDataPageRetriever` interfaccia viene implementata dalla `DataRetriever` classe.</span><span class="sxs-lookup"><span data-stu-id="a0a50-118">The following code example defines the `IDataPageRetriever` interface, which is implemented by the `DataRetriever` class.</span></span> <span data-ttu-id="a0a50-119">L'unico metodo dichiarato in questa interfaccia è il `SupplyPageOfData` metodo, che richiede un indice di riga iniziale e un conteggio del numero di righe in una singola pagina di dati.</span><span class="sxs-lookup"><span data-stu-id="a0a50-119">The only method declared in this interface is the `SupplyPageOfData` method, which requires an initial row index and a count of the number of rows in a single page of data.</span></span> <span data-ttu-id="a0a50-120">Questi valori vengono utilizzati dall'implementatore per recuperare un subset di dati da un'origine dati.</span><span class="sxs-lookup"><span data-stu-id="a0a50-120">These values are used by the implementer to retrieve a subset of data from a data source.</span></span>  
  
 <span data-ttu-id="a0a50-121">Oggetto `Cache` oggetto utilizza un'implementazione di questa interfaccia durante la costruzione per caricare due pagine iniziali di dati.</span><span class="sxs-lookup"><span data-stu-id="a0a50-121">A `Cache` object uses an implementation of this interface during construction to load two initial pages of data.</span></span> <span data-ttu-id="a0a50-122">Ogni volta che è necessario un valore non memorizzato nella cache, la cache scarta una di queste pagine e richiede una nuova pagina contenente il valore di `IDataPageRetriever`.</span><span class="sxs-lookup"><span data-stu-id="a0a50-122">Whenever an uncached value is needed, the cache discards one of these pages and requests a new page containing the value from the `IDataPageRetriever`.</span></span>  
  
 [!code-csharp[System.Windows.Forms.DataGridView.Virtual_lazyloading#201](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/CS/lazyloading.cs#201)]
 [!code-vb[System.Windows.Forms.DataGridView.Virtual_lazyloading#201](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/VB/lazyloading.vb#201)]  
  
## <a name="the-dataretriever-class"></a><span data-ttu-id="a0a50-123">La classe DataRetriever</span><span class="sxs-lookup"><span data-stu-id="a0a50-123">The DataRetriever Class</span></span>  
 <span data-ttu-id="a0a50-124">L'esempio di codice seguente definisce il `DataRetriever` classe che implementa il `IDataPageRetriever` interfaccia per il recupero delle pagine di dati da un server.</span><span class="sxs-lookup"><span data-stu-id="a0a50-124">The following code example defines the `DataRetriever` class, which implements the `IDataPageRetriever` interface to retrieve pages of data from a server.</span></span> <span data-ttu-id="a0a50-125">Il `DataRetriever` classe fornisce anche `Columns` e `RowCount` proprietà, che il <xref:System.Windows.Forms.DataGridView> controllo utilizzato per creare le colonne necessarie e aggiungere il numero appropriato di righe vuote di <xref:System.Windows.Forms.DataGridView.Rows%2A> insieme.</span><span class="sxs-lookup"><span data-stu-id="a0a50-125">The `DataRetriever` class also provides `Columns` and `RowCount` properties, which the <xref:System.Windows.Forms.DataGridView> control uses to create the necessary columns and to add the appropriate number of empty rows to the <xref:System.Windows.Forms.DataGridView.Rows%2A> collection.</span></span> <span data-ttu-id="a0a50-126">Aggiunta di righe vuote è necessaria in modo che il controllo si comporteranno come se contenesse tutti i dati nella tabella.</span><span class="sxs-lookup"><span data-stu-id="a0a50-126">Adding the empty rows is necessary so that the control will behave as though it contains all the data in the table.</span></span> <span data-ttu-id="a0a50-127">Ciò significa che la casella di scorrimento nella barra di scorrimento avrà le dimensioni appropriate e che l'utente sarà in grado di accedere a qualsiasi riga della tabella.</span><span class="sxs-lookup"><span data-stu-id="a0a50-127">This means that the scroll box in the scroll bar will have the appropriate size, and the user will be able to access any row in the table.</span></span> <span data-ttu-id="a0a50-128">Le righe vengono compilate i <xref:System.Windows.Forms.DataGridView.CellValueNeeded> gestore eventi solo quando lo scorrimento nella visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="a0a50-128">The rows are filled by the <xref:System.Windows.Forms.DataGridView.CellValueNeeded> event handler only when they are scrolled into view.</span></span>  
  
 [!code-csharp[System.Windows.Forms.DataGridView.Virtual_lazyloading#200](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/CS/lazyloading.cs#200)]
 [!code-vb[System.Windows.Forms.DataGridView.Virtual_lazyloading#200](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/VB/lazyloading.vb#200)]  
  
## <a name="the-cache-class"></a><span data-ttu-id="a0a50-129">La classe di Cache</span><span class="sxs-lookup"><span data-stu-id="a0a50-129">The Cache Class</span></span>  
 <span data-ttu-id="a0a50-130">L'esempio di codice seguente definisce il `Cache` (classe), che gestisce due pagine di dati compilate tramite un `IDataPageRetriever` implementazione.</span><span class="sxs-lookup"><span data-stu-id="a0a50-130">The following code example defines the `Cache` class, which manages two pages of data populated through an `IDataPageRetriever` implementation.</span></span> <span data-ttu-id="a0a50-131">Il `Cache` classe definisce un inner `DataPage` struttura, che contiene un <xref:System.Data.DataTable> per archiviare i valori in una cache singola pagina e che calcola gli indici di riga che rappresentano i limiti superiori e inferiori della pagina.</span><span class="sxs-lookup"><span data-stu-id="a0a50-131">The `Cache` class defines an inner `DataPage` structure, which contains a <xref:System.Data.DataTable> to store the values in a single cache page and which calculates the row indexes that represent the upper and lower boundaries of the page.</span></span>  
  
 <span data-ttu-id="a0a50-132">La `Cache` classe carica due pagine di dati in fase di costruzione.</span><span class="sxs-lookup"><span data-stu-id="a0a50-132">The `Cache` class loads two pages of data at construction time.</span></span> <span data-ttu-id="a0a50-133">Ogni volta che il <xref:System.Windows.Forms.DataGridView.CellValueNeeded> evento richiede un valore, il `Cache` oggetto determina se il valore è disponibile in una delle due pagine e, in caso affermativo, lo restituisce.</span><span class="sxs-lookup"><span data-stu-id="a0a50-133">Whenever the <xref:System.Windows.Forms.DataGridView.CellValueNeeded> event requests a value, the `Cache` object determines if the value is available in one of its two pages and, if so, returns it.</span></span> <span data-ttu-id="a0a50-134">Se il valore non è disponibile localmente, il `Cache` oggetto determina quale delle due pagine più righe attualmente visualizzate e la sostituisce con uno nuovo contenente il valore richiesto, il quale viene quindi restituito.</span><span class="sxs-lookup"><span data-stu-id="a0a50-134">If the value is not available locally, the `Cache` object determines which of its two pages is farthest from the currently displayed rows and replaces the page with a new one containing the requested value, which it then returns.</span></span>  
  
 <span data-ttu-id="a0a50-135">Supponendo che il numero di righe in una pagina di dati è pari al numero di righe che possono essere visualizzati sullo schermo in una sola volta, questo modello consente agli utenti di paging di una tabella da restituire in modo efficiente per la pagina visualizzata più di recente.</span><span class="sxs-lookup"><span data-stu-id="a0a50-135">Assuming that the number of rows in a data page is the same as the number of rows that can be displayed on screen at once, this model allows users paging through the table to efficiently return to the most recently viewed page.</span></span>  
  
 [!code-csharp[System.Windows.Forms.DataGridView.Virtual_lazyloading#300](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/CS/lazyloading.cs#300)]
 [!code-vb[System.Windows.Forms.DataGridView.Virtual_lazyloading#300](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/VB/lazyloading.vb#300)]  
  
## <a name="additional-considerations"></a><span data-ttu-id="a0a50-136">Considerazioni aggiuntive</span><span class="sxs-lookup"><span data-stu-id="a0a50-136">Additional Considerations</span></span>  
 <span data-ttu-id="a0a50-137">Esempi di codice precedenti vengono forniti come una dimostrazione in fase di caricamento di dati.</span><span class="sxs-lookup"><span data-stu-id="a0a50-137">The previous code examples are provided as a demonstration of just-in-time data loading.</span></span> <span data-ttu-id="a0a50-138">È necessario modificare il codice per le proprie esigenze ottenere la massima efficienza.</span><span class="sxs-lookup"><span data-stu-id="a0a50-138">You will need to modify the code for your own needs to achieve maximum efficiency.</span></span> <span data-ttu-id="a0a50-139">Come minimo, è necessario scegliere un valore appropriato per il numero di righe per pagina di dati nella cache.</span><span class="sxs-lookup"><span data-stu-id="a0a50-139">At minimum, you will need to choose an appropriate value for the number of rows per page of data in the cache.</span></span> <span data-ttu-id="a0a50-140">Questo valore viene passato il `Cache` costruttore.</span><span class="sxs-lookup"><span data-stu-id="a0a50-140">This value is passed into the `Cache` constructor.</span></span> <span data-ttu-id="a0a50-141">Il numero di righe per pagina deve essere non sia minore del numero di righe che possono essere visualizzati contemporaneamente nel <xref:System.Windows.Forms.DataGridView> controllo.</span><span class="sxs-lookup"><span data-stu-id="a0a50-141">The number of rows per page should be no less than the number of rows that can be displayed simultaneously in your <xref:System.Windows.Forms.DataGridView> control.</span></span>  
  
 <span data-ttu-id="a0a50-142">Per ottenere risultati ottimali, è necessario eseguire il test delle prestazioni e usabilità per determinare i requisiti di sistema e gli utenti.</span><span class="sxs-lookup"><span data-stu-id="a0a50-142">For best results, you will need to conduct performance testing and usability testing to determine the requirements of your system and your users.</span></span> <span data-ttu-id="a0a50-143">È necessario prendere in considerazione diversi fattori includono la quantità di memoria nei computer client che eseguono l'applicazione, della larghezza di banda della connessione di rete utilizzata e la latenza del server utilizzato.</span><span class="sxs-lookup"><span data-stu-id="a0a50-143">Several factors that you will need to take into consideration include the amount of memory in the client machines running your application, the available bandwidth of the network connection used, and the latency of the server used.</span></span> <span data-ttu-id="a0a50-144">La larghezza di banda e latenza deve essere determinate in momenti di picco.</span><span class="sxs-lookup"><span data-stu-id="a0a50-144">The bandwidth and latency should be determined at times of peak usage.</span></span>  
  
 <span data-ttu-id="a0a50-145">Per migliorare le prestazioni di scorrimento dell'applicazione, è possibile aumentare la quantità di dati archiviati in locale.</span><span class="sxs-lookup"><span data-stu-id="a0a50-145">To improve the scrolling performance of your application, you can increase the amount of data stored locally.</span></span> <span data-ttu-id="a0a50-146">Per migliorare il tempo di avvio, tuttavia, è necessario evitare di caricare troppi dati inizialmente.</span><span class="sxs-lookup"><span data-stu-id="a0a50-146">To improve startup time, however, you must avoid loading too much data initially.</span></span> <span data-ttu-id="a0a50-147">Si consiglia di modificare la `Cache` classe per aumentare il numero di pagine di dati può archiviare.</span><span class="sxs-lookup"><span data-stu-id="a0a50-147">You may want to modify the `Cache` class to increase the number of data pages it can store.</span></span> <span data-ttu-id="a0a50-148">L'utilizzo di più pagine di dati può migliorare le prestazioni di scorrimento, ma è necessario determinare il numero ideale di righe in una pagina di dati, a seconda della larghezza di banda e latenza del server.</span><span class="sxs-lookup"><span data-stu-id="a0a50-148">Using more data pages can improve scrolling efficiency, but you will need to determine the ideal number of rows in a data page, depending on the available bandwidth and the server latency.</span></span> <span data-ttu-id="a0a50-149">Con pagine di dimensioni ridotte, il server di accesso a più di frequente, ma richiederà meno tempo per restituire i dati richiesti.</span><span class="sxs-lookup"><span data-stu-id="a0a50-149">With smaller pages, the server will be accessed more frequently, but will take less time to return the requested data.</span></span> <span data-ttu-id="a0a50-150">Se la latenza è più un problema di larghezza di banda, si desidera utilizzare le pagine di dati più grande.</span><span class="sxs-lookup"><span data-stu-id="a0a50-150">If latency is more of an issue than bandwidth, you may want to use larger data pages.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a0a50-151">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="a0a50-151">See Also</span></span>  
 <xref:System.Windows.Forms.DataGridView>  
 <xref:System.Windows.Forms.DataGridView.VirtualMode%2A>  
 [<span data-ttu-id="a0a50-152">Ottimizzazione delle prestazioni nel controllo DataGridView di Windows Form</span><span class="sxs-lookup"><span data-stu-id="a0a50-152">Performance Tuning in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/performance-tuning-in-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="a0a50-153">Procedure consigliate per ridimensionare il controllo DataGridView di Windows Form</span><span class="sxs-lookup"><span data-stu-id="a0a50-153">Best Practices for Scaling the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/best-practices-for-scaling-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="a0a50-154">Modo virtuale nel controllo DataGridView di Windows Form</span><span class="sxs-lookup"><span data-stu-id="a0a50-154">Virtual Mode in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/virtual-mode-in-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="a0a50-155">Procedura dettagliata: Implementazione della modalità virtuale nel controllo DataGridView di Windows Form</span><span class="sxs-lookup"><span data-stu-id="a0a50-155">Walkthrough: Implementing Virtual Mode in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/implementing-virtual-mode-wf-datagridview-control.md)  
 [<span data-ttu-id="a0a50-156">Procedura: Implementare la modalità virtuale con caricamento dati JIT nel controllo DataGridView di Windows Form</span><span class="sxs-lookup"><span data-stu-id="a0a50-156">How to: Implement Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/virtual-mode-with-just-in-time-data-loading-in-the-datagrid.md)
