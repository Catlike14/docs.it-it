---
title: Metodo IMetaDataDispenserEx::SetOption
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: reference
api_name: IMetaDataDispenserEx.SetOption
api_location: mscoree.dll
api_type: COM
f1_keywords: IMetaDataDispenserEx::SetOption
helpviewer_keywords:
- IMetaDataDispenserEx::SetOption method [.NET Framework metadata]
- SetOption method [.NET Framework metadata]
ms.assetid: 9f1c7ccd-7fb2-41d8-aa00-24b823376527
topic_type: apiref
caps.latest.revision: "20"
author: mairaw
ms.author: mairaw
manager: wpickett
ms.openlocfilehash: a58ac4379522c13125f98df058cd67bceb7cdbd1
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 11/21/2017
---
# <a name="imetadatadispenserexsetoption-method"></a><span data-ttu-id="80660-102">Metodo IMetaDataDispenserEx::SetOption</span><span class="sxs-lookup"><span data-stu-id="80660-102">IMetaDataDispenserEx::SetOption Method</span></span>
<span data-ttu-id="80660-103">Imposta l'opzione specificata per un determinato valore per l'ambito dei metadati corrente.</span><span class="sxs-lookup"><span data-stu-id="80660-103">Sets the specified option to a given value for the current metadata scope.</span></span> <span data-ttu-id="80660-104">L'opzione controlla la modalità di gestione delle chiamate all'ambito dei metadati corrente.</span><span class="sxs-lookup"><span data-stu-id="80660-104">The option controls how calls to the current metadata scope are handled.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="80660-105">Sintassi</span><span class="sxs-lookup"><span data-stu-id="80660-105">Syntax</span></span>  
  
```  
HRESULT SetOption (  
    [in] REFGUID optionId,   
    [in] const VARIANT *pValue  
);  
```  
  
#### <a name="parameters"></a><span data-ttu-id="80660-106">Parametri</span><span class="sxs-lookup"><span data-stu-id="80660-106">Parameters</span></span>  
 `optionId`  
 <span data-ttu-id="80660-107">[in] Puntatore a un GUID che specifica l'opzione da impostare.</span><span class="sxs-lookup"><span data-stu-id="80660-107">[in] A pointer to a GUID that specifies the option to be set.</span></span>  
  
 `pValue`  
 <span data-ttu-id="80660-108">[in] Il valore da utilizzare per impostare l'opzione.</span><span class="sxs-lookup"><span data-stu-id="80660-108">[in] The value to use to set the option.</span></span> <span data-ttu-id="80660-109">Il tipo di questo valore deve essere una variante del tipo dell'opzione specificata.</span><span class="sxs-lookup"><span data-stu-id="80660-109">The type of this value must be a variant of the specified option's type.</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="80660-110">Note</span><span class="sxs-lookup"><span data-stu-id="80660-110">Remarks</span></span>  
 <span data-ttu-id="80660-111">La tabella seguente elenca i GUID disponibili che il `optionId` parametro può puntare e i corrispondenti valori validi per il `pValue` parametro.</span><span class="sxs-lookup"><span data-stu-id="80660-111">The following table lists the available GUIDs that the `optionId` parameter can point to and the corresponding valid values for the `pValue` parameter.</span></span>  
  
|<span data-ttu-id="80660-112">GUID</span><span class="sxs-lookup"><span data-stu-id="80660-112">GUID</span></span>|<span data-ttu-id="80660-113">Descrizione</span><span class="sxs-lookup"><span data-stu-id="80660-113">Description</span></span>|<span data-ttu-id="80660-114">`pValue`Parametro</span><span class="sxs-lookup"><span data-stu-id="80660-114">`pValue` Parameter</span></span>|  
|----------|-----------------|------------------------|  
|<span data-ttu-id="80660-115">MetaDataCheckDuplicatesFor</span><span class="sxs-lookup"><span data-stu-id="80660-115">MetaDataCheckDuplicatesFor</span></span>|<span data-ttu-id="80660-116">Controlla gli elementi selezionati per i duplicati.</span><span class="sxs-lookup"><span data-stu-id="80660-116">Controls which items are checked for duplicates.</span></span> <span data-ttu-id="80660-117">Ogni volta che si chiama un [IMetaDataEmit](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-interface.md) metodo che crea un nuovo elemento, è possibile chiedere al metodo per verificare se l'elemento esiste già nell'ambito corrente.</span><span class="sxs-lookup"><span data-stu-id="80660-117">Each time you call an [IMetaDataEmit](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-interface.md) method that creates a new item, you can ask the method to check whether the item already exists in the current scope.</span></span> <span data-ttu-id="80660-118">Ad esempio, è possibile verificare l'esistenza di `mdMethodDef` elementi; in questo caso, quando si chiama [IMetaDataEmit:: DefineMethod](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-definemethod-method.md), verificherà che il metodo non esiste già nell'ambito corrente.</span><span class="sxs-lookup"><span data-stu-id="80660-118">For example, you can check for the existence of `mdMethodDef` items; in this case, when you call [IMetaDataEmit::DefineMethod](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-definemethod-method.md), it will check that the method does not already exist in the current scope.</span></span> <span data-ttu-id="80660-119">Questo controllo viene utilizzata la chiave che identifica in modo univoco un determinato metodo: padre di tipo, nome e firma.</span><span class="sxs-lookup"><span data-stu-id="80660-119">This check uses the key that uniquely identifies a given method: parent type, name, and signature.</span></span>|<span data-ttu-id="80660-120">Deve essere una variante del tipo UI4 e deve contenere una combinazione dei valori del [CorCheckDuplicatesFor](../../../../docs/framework/unmanaged-api/metadata/corcheckduplicatesfor-enumeration.md) enumerazione.</span><span class="sxs-lookup"><span data-stu-id="80660-120">Must be a variant of type UI4, and must contain a combination of the values of the [CorCheckDuplicatesFor](../../../../docs/framework/unmanaged-api/metadata/corcheckduplicatesfor-enumeration.md) enumeration.</span></span>|  
|<span data-ttu-id="80660-121">MetaDataRefToDefCheck</span><span class="sxs-lookup"><span data-stu-id="80660-121">MetaDataRefToDefCheck</span></span>|<span data-ttu-id="80660-122">I controlli che fa riferimento a elementi vengono convertiti in definizioni.</span><span class="sxs-lookup"><span data-stu-id="80660-122">Controls which referenced items are converted to definitions.</span></span> <span data-ttu-id="80660-123">Per impostazione predefinita, il motore dei metadati consente di ottimizzare il codice mediante la conversione di un elemento di cui si fa riferimento alla relativa definizione se l'elemento di riferimento viene effettivamente definita nell'ambito corrente.</span><span class="sxs-lookup"><span data-stu-id="80660-123">By default, the metadata engine will optimize the code by converting a referenced item to its definition if the referenced item is actually defined in the current scope.</span></span>|<span data-ttu-id="80660-124">Deve essere una variante del tipo UI4 e deve contenere una combinazione dei valori del [CorRefToDefCheck](../../../../docs/framework/unmanaged-api/metadata/correftodefcheck-enumeration.md) enumerazione.</span><span class="sxs-lookup"><span data-stu-id="80660-124">Must be a variant of type UI4, and must contain a combination of the values of the [CorRefToDefCheck](../../../../docs/framework/unmanaged-api/metadata/correftodefcheck-enumeration.md) enumeration.</span></span>|  
|<span data-ttu-id="80660-125">MetaDataNotificationForTokenMovement</span><span class="sxs-lookup"><span data-stu-id="80660-125">MetaDataNotificationForTokenMovement</span></span>|<span data-ttu-id="80660-126">Determina quale token avvenuti durante un'unione di metadati generano callback.</span><span class="sxs-lookup"><span data-stu-id="80660-126">Controls which token remaps occurring during a metadata merge generate callbacks.</span></span> <span data-ttu-id="80660-127">Utilizzare il [IMetaDataEmit:: SetHandler](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-sethandler-method.md) metodo per stabilire il [IMapToken](../../../../docs/framework/unmanaged-api/metadata/imaptoken-interface.md) interfaccia.</span><span class="sxs-lookup"><span data-stu-id="80660-127">Use the [IMetaDataEmit::SetHandler](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-sethandler-method.md) method to establish your [IMapToken](../../../../docs/framework/unmanaged-api/metadata/imaptoken-interface.md) interface.</span></span>|<span data-ttu-id="80660-128">Deve essere una variante del tipo UI4 e deve contenere una combinazione dei valori del [CorNotificationForTokenMovement](../../../../docs/framework/unmanaged-api/metadata/cornotificationfortokenmovement-enumeration.md) enumerazione.</span><span class="sxs-lookup"><span data-stu-id="80660-128">Must be a variant of type UI4, and must contain a combination of the values of the [CorNotificationForTokenMovement](../../../../docs/framework/unmanaged-api/metadata/cornotificationfortokenmovement-enumeration.md) enumeration.</span></span>|  
|<span data-ttu-id="80660-129">MetaDataSetENC</span><span class="sxs-lookup"><span data-stu-id="80660-129">MetaDataSetENC</span></span>|<span data-ttu-id="80660-130">Controlla il comportamento di modifica e continuazione (ENC).</span><span class="sxs-lookup"><span data-stu-id="80660-130">Controls the behavior of edit-and-continue (ENC).</span></span> <span data-ttu-id="80660-131">Contemporaneamente, è possibile impostare solo una modalità di comportamento.</span><span class="sxs-lookup"><span data-stu-id="80660-131">Only one mode of behavior can be set at a time.</span></span>|<span data-ttu-id="80660-132">Deve essere una variante del tipo UI4 e deve contenere un valore di [CorSetENC](../../../../docs/framework/unmanaged-api/metadata/corsetenc-enumeration.md) enumerazione.</span><span class="sxs-lookup"><span data-stu-id="80660-132">Must be a variant of type UI4, and must contain a value of the [CorSetENC](../../../../docs/framework/unmanaged-api/metadata/corsetenc-enumeration.md) enumeration.</span></span> <span data-ttu-id="80660-133">Il valore non è una maschera di bit.</span><span class="sxs-lookup"><span data-stu-id="80660-133">The value is not a bitmask.</span></span>|  
|<span data-ttu-id="80660-134">MetaDataErrorIfEmitOutOfOrder</span><span class="sxs-lookup"><span data-stu-id="80660-134">MetaDataErrorIfEmitOutOfOrder</span></span>|<span data-ttu-id="80660-135">Controlla i callback di generare gli errori generati out-di-ordine.</span><span class="sxs-lookup"><span data-stu-id="80660-135">Controls which emitted-out-of-order errors generate callbacks.</span></span> <span data-ttu-id="80660-136">Emissione di metadati non in ordine non è un errore irreversibile. Tuttavia, se si generano metadati in un ordine preferito dal motore di metadati, i metadati sono più compatto e pertanto possono eseguire in modo più efficiente la ricerca.</span><span class="sxs-lookup"><span data-stu-id="80660-136">Emitting metadata out of order is not fatal; however, if you emit metadata in an order that is favored by the metadata engine, the metadata is more compact and therefore can be more efficiently searched.</span></span> <span data-ttu-id="80660-137">Utilizzare il `IMetaDataEmit::SetHandler` metodo per stabilire il [IMetaDataError](../../../../docs/framework/unmanaged-api/metadata/imetadataerror-interface.md) interfaccia.</span><span class="sxs-lookup"><span data-stu-id="80660-137">Use the `IMetaDataEmit::SetHandler` method to establish your [IMetaDataError](../../../../docs/framework/unmanaged-api/metadata/imetadataerror-interface.md) interface.</span></span>|<span data-ttu-id="80660-138">Deve essere una variante del tipo UI4 e deve contenere una combinazione dei valori del [CorErrorIfEmitOutOfOrder](../../../../docs/framework/unmanaged-api/metadata/corerrorifemitoutoforder-enumeration.md) enumerazione.</span><span class="sxs-lookup"><span data-stu-id="80660-138">Must be a variant of type UI4, and must contain a combination of the values of the [CorErrorIfEmitOutOfOrder](../../../../docs/framework/unmanaged-api/metadata/corerrorifemitoutoforder-enumeration.md) enumeration.</span></span>|  
|<span data-ttu-id="80660-139">MetaDataImportOption</span><span class="sxs-lookup"><span data-stu-id="80660-139">MetaDataImportOption</span></span>|<span data-ttu-id="80660-140">Controlla quali tipi di elementi che sono stati eliminati durante un ENC vengono recuperati dall'enumeratore.</span><span class="sxs-lookup"><span data-stu-id="80660-140">Controls which kinds of items that were deleted during an ENC are retrieved by an enumerator.</span></span>|<span data-ttu-id="80660-141">Deve essere una variante del tipo UI4 e deve contenere una combinazione dei valori del [Enumerazione CorImportOptions](../../../../docs/framework/unmanaged-api/metadata/corimportoptions-enumeration.md) enumerazione.</span><span class="sxs-lookup"><span data-stu-id="80660-141">Must be a variant of type UI4, and must contain a combination of the values of the [CorImportOptions Enumeration](../../../../docs/framework/unmanaged-api/metadata/corimportoptions-enumeration.md) enumeration.</span></span>|  
|<span data-ttu-id="80660-142">MetaDataThreadSafetyOptions</span><span class="sxs-lookup"><span data-stu-id="80660-142">MetaDataThreadSafetyOptions</span></span>|<span data-ttu-id="80660-143">Controlla se il motore dei metadati ottiene blocchi, per garantirne la sicurezza dei thread di lettura/scrittura.</span><span class="sxs-lookup"><span data-stu-id="80660-143">Controls whether the metadata engine obtains reader/writer locks, thereby ensuring thread safety.</span></span> <span data-ttu-id="80660-144">Per impostazione predefinita, il motore si presuppone che l'accesso a thread singolo dal chiamante, non vengono ottenuti blocchi.</span><span class="sxs-lookup"><span data-stu-id="80660-144">By default, the engine assumes that access is single-threaded by the caller, so no locks are obtained.</span></span> <span data-ttu-id="80660-145">I client sono responsabili della gestione della sincronizzazione di thread appropriato quando si utilizza l'API dei metadati.</span><span class="sxs-lookup"><span data-stu-id="80660-145">Clients are responsible for maintaining proper thread synchronization when using the metadata API.</span></span>|<span data-ttu-id="80660-146">Deve essere una variante del tipo UI4 e deve contenere un valore di [CorThreadSafetyOptions](../../../../docs/framework/unmanaged-api/metadata/corthreadsafetyoptions-enumeration.md) enumerazione.</span><span class="sxs-lookup"><span data-stu-id="80660-146">Must be a variant of type UI4, and must contain a value of the [CorThreadSafetyOptions](../../../../docs/framework/unmanaged-api/metadata/corthreadsafetyoptions-enumeration.md) enumeration.</span></span> <span data-ttu-id="80660-147">Il valore non è una maschera di bit.</span><span class="sxs-lookup"><span data-stu-id="80660-147">The value is not a bitmask.</span></span>|  
|<span data-ttu-id="80660-148">MetaDataGenerateTCEAdapters</span><span class="sxs-lookup"><span data-stu-id="80660-148">MetaDataGenerateTCEAdapters</span></span>|<span data-ttu-id="80660-149">Determina se l'utilità di importazione della libreria di tipo deve generare le schede evento accoppiamento (TCE) per i contenitori di punto di connessione COM.</span><span class="sxs-lookup"><span data-stu-id="80660-149">Controls whether the type library importer should generate the tightly coupled event (TCE) adapters for COM connection point containers.</span></span>|<span data-ttu-id="80660-150">Deve essere una variante del tipo BOOL.</span><span class="sxs-lookup"><span data-stu-id="80660-150">Must be a variant of type BOOL.</span></span> <span data-ttu-id="80660-151">Se `pValue` è impostato su `true`, type library importer genera gli adattatori TCE.</span><span class="sxs-lookup"><span data-stu-id="80660-151">If `pValue` is set to `true`, the type library importer generates the TCE adapters.</span></span>|  
|<span data-ttu-id="80660-152">MetaDataTypeLibImportNamespace</span><span class="sxs-lookup"><span data-stu-id="80660-152">MetaDataTypeLibImportNamespace</span></span>|<span data-ttu-id="80660-153">Specifica uno spazio dei nomi non predefinito per la libreria dei tipi da importare.</span><span class="sxs-lookup"><span data-stu-id="80660-153">Specifies a non-default namespace for the type library that is being imported.</span></span>|<span data-ttu-id="80660-154">Deve essere un valore null o una variante del tipo BSTR.</span><span class="sxs-lookup"><span data-stu-id="80660-154">Must be either a null value or a variant of type BSTR.</span></span> <span data-ttu-id="80660-155">Se `pValue` è un valore null, lo spazio dei nomi corrente è impostato su null; in caso contrario, lo spazio dei nomi corrente viene impostato sulla stringa contenuta nel tipo BSTR della variante.</span><span class="sxs-lookup"><span data-stu-id="80660-155">If `pValue` is a null value, the current namespace is set to null; otherwise, the current namespace is set to the string that is held in the variant's BSTR type.</span></span>|  
|<span data-ttu-id="80660-156">MetaDataLinkerOptions</span><span class="sxs-lookup"><span data-stu-id="80660-156">MetaDataLinkerOptions</span></span>|<span data-ttu-id="80660-157">Determina se il linker deve generare un assembly o un file di modulo .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="80660-157">Controls whether the linker should generate an assembly or a .NET Framework module file.</span></span>|<span data-ttu-id="80660-158">Deve essere una variante del tipo UI4 e deve contenere una combinazione dei valori del [CorLinkerOptions](../../../../docs/framework/unmanaged-api/metadata/corlinkeroptions-enumeration.md) enumerazione.</span><span class="sxs-lookup"><span data-stu-id="80660-158">Must be a variant of type UI4, and must contain a combination of the values of the [CorLinkerOptions](../../../../docs/framework/unmanaged-api/metadata/corlinkeroptions-enumeration.md) enumeration.</span></span>|  
|<span data-ttu-id="80660-159">MetaDataRuntimeVersion</span><span class="sxs-lookup"><span data-stu-id="80660-159">MetaDataRuntimeVersion</span></span>|<span data-ttu-id="80660-160">Specifica la versione di common language runtime con cui è stata compilata questa immagine.</span><span class="sxs-lookup"><span data-stu-id="80660-160">Specifies the version of the common language runtime against which this image was built.</span></span> <span data-ttu-id="80660-161">La versione viene archiviata come una stringa, ad esempio "v 1.0.3705".</span><span class="sxs-lookup"><span data-stu-id="80660-161">The version is stored as a string, such as "v1.0.3705".</span></span>|<span data-ttu-id="80660-162">Deve essere un valore null, un valore VT_EMPTY o una variante del tipo BSTR.</span><span class="sxs-lookup"><span data-stu-id="80660-162">Must be a null value, a VT_EMPTY value, or a variant of type BSTR.</span></span> <span data-ttu-id="80660-163">Se `pValue` è null, la versione di runtime è impostata su null.</span><span class="sxs-lookup"><span data-stu-id="80660-163">If `pValue` is null, the runtime version is set to null.</span></span> <span data-ttu-id="80660-164">Se `pValue` è VT_EMPTY, la versione è impostata su un valore predefinito, che viene disegnato dalla versione di Mscorwks.dll all'interno del quale è in esecuzione il codice dei metadati.</span><span class="sxs-lookup"><span data-stu-id="80660-164">If `pValue` is VT_EMPTY, the version is set to a default value, which is drawn from the version of Mscorwks.dll within which the metadata code is running.</span></span> <span data-ttu-id="80660-165">In caso contrario, la versione di runtime è impostata per la stringa contenuta nel tipo BSTR della variante.</span><span class="sxs-lookup"><span data-stu-id="80660-165">Otherwise, the runtime version is set to the string that is held in the variant's BSTR type.</span></span>|  
|<span data-ttu-id="80660-166">MetaDataMergerOptions</span><span class="sxs-lookup"><span data-stu-id="80660-166">MetaDataMergerOptions</span></span>|<span data-ttu-id="80660-167">Specifica le opzioni per l'unione dei metadati.</span><span class="sxs-lookup"><span data-stu-id="80660-167">Specifies options for merging metadata.</span></span>|<span data-ttu-id="80660-168">Deve essere una variante del tipo UI4 e deve contenere una combinazione dei valori del `MergeFlags` enumerazione, è descritto nel file corhdr. H.</span><span class="sxs-lookup"><span data-stu-id="80660-168">Must be a variant of type UI4, and must contain a combination of the values of the `MergeFlags` enumeration, which is described in the CorHdr.h file.</span></span>|  
|<span data-ttu-id="80660-169">MetaDataPreserveLocalRefs</span><span class="sxs-lookup"><span data-stu-id="80660-169">MetaDataPreserveLocalRefs</span></span>|<span data-ttu-id="80660-170">Disabilita l'ottimizzazione locali riferimenti nelle definizioni.</span><span class="sxs-lookup"><span data-stu-id="80660-170">Disables optimizing local references into definitions.</span></span>|<span data-ttu-id="80660-171">Deve contenere una combinazione dei valori del [CorLocalRefPreservation](../../../../docs/framework/unmanaged-api/metadata/corlocalrefpreservation-enumeration.md) enumerazione.</span><span class="sxs-lookup"><span data-stu-id="80660-171">Must contain a combination of the values of the [CorLocalRefPreservation](../../../../docs/framework/unmanaged-api/metadata/corlocalrefpreservation-enumeration.md) enumeration.</span></span>|  
  
## <a name="requirements"></a><span data-ttu-id="80660-172">Requisiti</span><span class="sxs-lookup"><span data-stu-id="80660-172">Requirements</span></span>  
 <span data-ttu-id="80660-173">**Piattaforma:** vedere [requisiti di sistema](../../../../docs/framework/get-started/system-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="80660-173">**Platform:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).</span></span>  
  
 <span data-ttu-id="80660-174">**Intestazione:** Cor. h</span><span class="sxs-lookup"><span data-stu-id="80660-174">**Header:** Cor.h</span></span>  
  
 <span data-ttu-id="80660-175">**Libreria:** usata come risorsa in MsCorEE.dll</span><span class="sxs-lookup"><span data-stu-id="80660-175">**Library:** Used as a resource in MsCorEE.dll</span></span>  
  
 <span data-ttu-id="80660-176">**Versioni di .NET framework:**[!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]</span><span class="sxs-lookup"><span data-stu-id="80660-176">**.NET Framework Versions:** [!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="80660-177">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="80660-177">See Also</span></span>  
 [<span data-ttu-id="80660-178">IMetaDataDispenserEx (interfaccia)</span><span class="sxs-lookup"><span data-stu-id="80660-178">IMetaDataDispenserEx Interface</span></span>](../../../../docs/framework/unmanaged-api/metadata/imetadatadispenserex-interface.md)  
 [<span data-ttu-id="80660-179">IMetaDataDispenser (interfaccia)</span><span class="sxs-lookup"><span data-stu-id="80660-179">IMetaDataDispenser Interface</span></span>](../../../../docs/framework/unmanaged-api/metadata/imetadatadispenser-interface.md)
