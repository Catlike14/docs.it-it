---
title: Utilizzo dell'attività CancellationScope
ms.date: 03/30/2017
ms.assetid: 39c5c338-b316-43d6-b7fe-a543281dd1ec
ms.openlocfilehash: 82d44fff869f207c09dc7685fc3470630e001a59
ms.sourcegitcommit: 2eceb05f1a5bb261291a1f6a91c5153727ac1c19
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/05/2018
ms.locfileid: "43731521"
---
# <a name="using-cancellationscope"></a><span data-ttu-id="e3a4d-102">Utilizzo dell'attività CancellationScope</span><span class="sxs-lookup"><span data-stu-id="e3a4d-102">Using CancellationScope</span></span>
<span data-ttu-id="e3a4d-103">Nell'esempio viene illustrato come usare l'attività <xref:System.Activities.Statements.CancellationScope> per annullare il lavoro in un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="e3a4d-103">This sample demonstrates how to use the <xref:System.Activities.Statements.CancellationScope> activity to cancel work in an application.</span></span>  
  
 <span data-ttu-id="e3a4d-104">Molti componenti e servizi di livello intermedio si basano sul noto costrutto di programmazione delle transazioni per gestire l'annullamento.</span><span class="sxs-lookup"><span data-stu-id="e3a4d-104">Many middle tier components and services rely on the well-known programming construct of transactions to handle cancellation for them.</span></span>  <span data-ttu-id="e3a4d-105">Esistono tuttavia molte situazioni nelle quali è necessario annullare il lavoro che non può essere eseguito in una transazione.</span><span class="sxs-lookup"><span data-stu-id="e3a4d-105">However, there are many situations in which work that cannot be done in a transaction must be canceled.</span></span>  <span data-ttu-id="e3a4d-106">Usare l'annullamento è più difficile che usare le transazioni perché il lavoro da annullare deve prima essere rilevato.</span><span class="sxs-lookup"><span data-stu-id="e3a4d-106">Using cancellation is more difficult than using transactions, because work that must be canceled must first be tracked.</span></span> [!INCLUDE[netfx_current_short](../../../../includes/netfx-current-short-md.md)]<span data-ttu-id="e3a4d-107"> semplifica questa operazione fornendo un'attività <xref:System.Activities.Statements.CancellationScope>.</span><span class="sxs-lookup"><span data-stu-id="e3a4d-107"> helps you with this by providing a <xref:System.Activities.Statements.CancellationScope> activity.</span></span>  
  
 <span data-ttu-id="e3a4d-108">È possibile attivare l'annullamento dall'interno un'attività o dall'elemento padre dell'attività.</span><span class="sxs-lookup"><span data-stu-id="e3a4d-108">Cancellation can be triggered either from within an activity or from the activity's parent.</span></span>  <span data-ttu-id="e3a4d-109">Le attività figlio sono pianificate dall'attività padre (ad esempio <xref:System.Activities.Statements.Sequence>, <xref:System.Activities.Statements.Parallel>, <xref:System.Activities.Statements.Flowchart> o da una CompositeActivity personalizzata).</span><span class="sxs-lookup"><span data-stu-id="e3a4d-109">Child activities are scheduled by their parent activity (such as a <xref:System.Activities.Statements.Sequence>, <xref:System.Activities.Statements.Parallel>, <xref:System.Activities.Statements.Flowchart>, or a custom composite activity).</span></span>  <span data-ttu-id="e3a4d-110">L'attività padre può annullare le attività figlio per qualsiasi motivo.</span><span class="sxs-lookup"><span data-stu-id="e3a4d-110">The parent activity can cancel child activities for any reason.</span></span>  <span data-ttu-id="e3a4d-111">Ad esempio, un'attività <xref:System.Activities.Statements.Parallel> con tre rami figlio annullerà i rami figlio restanti quando completa un ramo e l'espressione <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> restituisce `true`.</span><span class="sxs-lookup"><span data-stu-id="e3a4d-111">For example, a <xref:System.Activities.Statements.Parallel> activity with three child branches will cancel the remaining child branches whenever it completes a branch and the <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> expression evaluates to `true`.</span></span> <span data-ttu-id="e3a4d-112">Il flusso di lavoro può essere annullato anche esternamente dall'applicazione host chiamando <xref:System.Activities.WorkflowApplication.Cancel%2A>.</span><span class="sxs-lookup"><span data-stu-id="e3a4d-112">The workflow can also be canceled externally by the host application by calling <xref:System.Activities.WorkflowApplication.Cancel%2A>.</span></span>  
  
 <span data-ttu-id="e3a4d-113">Per usare l'attività <xref:System.Activities.Statements.CancellationScope>, inserire il lavoro che deve essere annullato nella proprietà <xref:System.Activities.Statements.CancellationScope.Body%2A> e inserire il lavoro eseguito dopo l'annullamento nella proprietà <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A>.</span><span class="sxs-lookup"><span data-stu-id="e3a4d-113">To use the <xref:System.Activities.Statements.CancellationScope> activity, put the work that needs to be canceled into the <xref:System.Activities.Statements.CancellationScope.Body%2A> property, and put the work that is performed after cancellation into the <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> property.</span></span>  
  
 <span data-ttu-id="e3a4d-114">In questo esempio viene illustrato l'annullamento di un'attività dall'interno dell'attività stessa.</span><span class="sxs-lookup"><span data-stu-id="e3a4d-114">This sample demonstrates cancelling an activity from within the activity itself.</span></span>  
  
 <span data-ttu-id="e3a4d-115">Lo scenario usato nell'esempio per illustrare l'attività <xref:System.Activities.Statements.CancellationScope> è un cliente che desidera acquistare il prima possibile un biglietto per Miami.</span><span class="sxs-lookup"><span data-stu-id="e3a4d-115">The scenario that the sample uses to demonstrate the <xref:System.Activities.Statements.CancellationScope> activity is a client wanting to buy a ticket to Miami as soon as possible.</span></span> <span data-ttu-id="e3a4d-116">Due agenzie di viaggio desiderano concludere l'affare.</span><span class="sxs-lookup"><span data-stu-id="e3a4d-116">There are two travel agencies that want the business.</span></span> <span data-ttu-id="e3a4d-117">Nell'esempio vengono usati due oggetti <xref:System.Activities.Statements.CancellationScope> all'interno di un'attività <xref:System.Activities.Statements.Parallel> per modellare questa logica di business.</span><span class="sxs-lookup"><span data-stu-id="e3a4d-117">The sample uses two <xref:System.Activities.Statements.CancellationScope> within a <xref:System.Activities.Statements.Parallel> activity to model this business logic.</span></span> <span data-ttu-id="e3a4d-118">L'oggetto <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> dell'attività <xref:System.Activities.Statements.Parallel> viene impostato su `true`. Poiché <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> viene controllato dopo il completamento di qualsiasi ramo, questo farà in modo che il ramo restante venga annullato dopo il completamento del primo ramo.</span><span class="sxs-lookup"><span data-stu-id="e3a4d-118">The <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> of the <xref:System.Activities.Statements.Parallel> activity is set to `true`; since the <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> is checked after any branch completes, this will cause the remaining branch to be canceled after the first branch completes.</span></span> <span data-ttu-id="e3a4d-119">L'acquisto del biglietto viene richiesto dall'applicazione client a entrambe le agenzie e quando la prima conferma che il biglietto è stato acquistato, l'ordine all'altra agenzia viene annullato automaticamente.</span><span class="sxs-lookup"><span data-stu-id="e3a4d-119">The client application asks both agencies to buy the ticket, and when the first one confirms that the ticket has been bought, the application cancels the order at the other agency.</span></span>  
  
## <a name="to-use-this-sample"></a><span data-ttu-id="e3a4d-120">Per usare questo esempio</span><span class="sxs-lookup"><span data-stu-id="e3a4d-120">To use this sample</span></span>  
  
1.  <span data-ttu-id="e3a4d-121">In [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)] aprire il file della soluzione CancelationScopeXAML.sln.</span><span class="sxs-lookup"><span data-stu-id="e3a4d-121">Using [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)], open the CancelationScopeXAML.sln solution file.</span></span>  
  
2.  <span data-ttu-id="e3a4d-122">Per compilare la soluzione, premere CTRL+MAIUSC+B.</span><span class="sxs-lookup"><span data-stu-id="e3a4d-122">To build the solution, press CTRL+SHIFT+B.</span></span>  
  
3.  <span data-ttu-id="e3a4d-123">Per eseguire la soluzione, premere CTRL+F5.</span><span class="sxs-lookup"><span data-stu-id="e3a4d-123">To run the solution, press CTRL+F5.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="e3a4d-124">È possibile che gli esempi siano già installati nel computer.</span><span class="sxs-lookup"><span data-stu-id="e3a4d-124">The samples may already be installed on your machine.</span></span> <span data-ttu-id="e3a4d-125">Verificare la directory seguente (impostazione predefinita) prima di continuare.</span><span class="sxs-lookup"><span data-stu-id="e3a4d-125">Check for the following (default) directory before continuing.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  <span data-ttu-id="e3a4d-126">Se questa directory non esiste, andare al [Windows Communication Foundation (WCF) e gli esempi di Windows Workflow Foundation (WF) per .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) per scaricare tutti i Windows Communication Foundation (WCF) e [!INCLUDE[wf1](../../../../includes/wf1-md.md)] esempi.</span><span class="sxs-lookup"><span data-stu-id="e3a4d-126">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="e3a4d-127">Questo esempio si trova nella directory seguente.</span><span class="sxs-lookup"><span data-stu-id="e3a4d-127">This sample is located in the following directory.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WF\Basic\Built-InActivities\CancellationScope`