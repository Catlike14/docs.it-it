---
title: Ambito di istruzioni della transazione
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 37141708-a29f-4b6a-81fe-f8a11f825061
caps.latest.revision: "8"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 854e04c53bf438c3356072d762f129b7f21b7dd5
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/22/2017
---
# <a name="transaction-convoy-scope"></a><span data-ttu-id="00292-102">Ambito di istruzioni della transazione</span><span class="sxs-lookup"><span data-stu-id="00292-102">Transaction Convoy Scope</span></span>
<span data-ttu-id="00292-103">In questo esempio viene illustrato come creare un modello di attività di messaggistica di una serie di istruzioni parallele insieme a un oggetto <xref:System.ServiceModel.Activities.TransactedReceiveScope> per modellare un protocollo in cui possono verificarsi diverse operazioni in qualsiasi ordine, tutte nella stessa transazione.</span><span class="sxs-lookup"><span data-stu-id="00292-103">This sample demonstrates how to create a Parallel Convoy messaging activity pattern in conjunction with a <xref:System.ServiceModel.Activities.TransactedReceiveScope> to model a protocol where a number of operations can happen in any order all under the same transaction.</span></span> <span data-ttu-id="00292-104">In questo esempio viene inoltre illustrato in che modo <xref:System.ServiceModel.Activities.TransactedReceiveScope> crea automaticamente una nuova transazione quando non ne viene propagata una al server, in modo che il client non utilizzi alcuna transazione.</span><span class="sxs-lookup"><span data-stu-id="00292-104">This sample also demonstrates how a <xref:System.ServiceModel.Activities.TransactedReceiveScope> automatically creates a new transaction when one is not flowed to the server, so the client does not make use of any transactions.</span></span>  
  
 <span data-ttu-id="00292-105">L'esempio è costituito da due progetti di flusso di lavoro che rappresentano client e server.</span><span class="sxs-lookup"><span data-stu-id="00292-105">The sample consists of two workflow projects that represent the client and server.</span></span> <span data-ttu-id="00292-106">Il progetto client esegue un flusso di lavoro che inizia con l'invio di un messaggio per il bootstrap del flusso di lavoro del server che inizializza una correlazione e avvia un ambito transazionale per il resto delle attività di messaggistica.</span><span class="sxs-lookup"><span data-stu-id="00292-106">The client project runs a workflow that begins by sending a message to bootstrap the server workflow, which initializes a correlation and starts a transactional scope for the remainder of the messaging activities.</span></span> <span data-ttu-id="00292-107">L'attività <xref:System.Activities.Statements.Sequence> del client contiene una coppia <xref:System.ServiceModel.Activities.Send> e <xref:System.ServiceModel.Activities.ReceiveReply>iniziale e quindi un'attività <xref:System.Activities.Statements.Parallel> con tre rami.</span><span class="sxs-lookup"><span data-stu-id="00292-107">The client <xref:System.Activities.Statements.Sequence> activity contains an initial <xref:System.ServiceModel.Activities.Send> and <xref:System.ServiceModel.Activities.ReceiveReply> pair and then a <xref:System.Activities.Statements.Parallel> activity with three branches.</span></span> <span data-ttu-id="00292-108">Ogni ramo invia un messaggio unidirezionale al server.</span><span class="sxs-lookup"><span data-stu-id="00292-108">Each branch sends a one-way message to the server.</span></span> <span data-ttu-id="00292-109">La proprietà <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> dell'attività <xref:System.Activities.Statements.Parallel> viene impostata su `false` in modo che tutti e tre i rami siano completati.</span><span class="sxs-lookup"><span data-stu-id="00292-109">The <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> property of the <xref:System.Activities.Statements.Parallel> activity is set to `false` so that all three branches complete.</span></span>  
  
 <span data-ttu-id="00292-110">Il flusso di lavoro server è simile al flusso di lavoro client con l'eccezione che le attività di messaggistica sono orientate verso il lato server della comunicazione e sono contenuti all'interno di un'attività <xref:System.ServiceModel.Activities.TransactedReceiveScope>, in modo che ogni lavoro venga eseguito nella stessa transazione.</span><span class="sxs-lookup"><span data-stu-id="00292-110">The server workflow is similar to the client workflow except the messaging activities are oriented towards the server side of the communication and they are contained within a <xref:System.ServiceModel.Activities.TransactedReceiveScope> activity so that all work done executes under the same transaction.</span></span> <span data-ttu-id="00292-111">Quando il primo messaggio viene ricevuto nel server, viene creata una transazione che diventa di ambiente per l'ambito del corpo di <xref:System.ServiceModel.Activities.TransactedReceiveScope>, in modo che qualsiasi attività all'interno di questo ambito possa accedere alla transazione.</span><span class="sxs-lookup"><span data-stu-id="00292-111">When the first message is received on the server, a transaction is created and is made ambient for the scope of the <xref:System.ServiceModel.Activities.TransactedReceiveScope> body so that any activity within this scope can access the transaction.</span></span> <span data-ttu-id="00292-112">Successivamente tutte le ricezioni vengono eseguite in parallelo.</span><span class="sxs-lookup"><span data-stu-id="00292-112">After this, all receives execute in parallel.</span></span> <span data-ttu-id="00292-113">È necessario che tutte le ricezioni vengano eseguite esattamente una volta come descritto dalla condizione di completamento nell'attività parallela.</span><span class="sxs-lookup"><span data-stu-id="00292-113">All receives must execute exactly once as described by the completion condition on the parallel activity.</span></span> <span data-ttu-id="00292-114">Alla fine del corpo <xref:System.ServiceModel.Activities.TransactedReceiveScope> è presente un punto di persistenza implicito e anche l'operazione di persistenza viene eseguita nella stessa transazione.</span><span class="sxs-lookup"><span data-stu-id="00292-114">An implicit persistence point exists at the end of the <xref:System.ServiceModel.Activities.TransactedReceiveScope> body and the persistence operation is also executed under the same transaction.</span></span>  
  
#### <a name="to-use-this-sample"></a><span data-ttu-id="00292-115">Per usare questo esempio</span><span class="sxs-lookup"><span data-stu-id="00292-115">To use this sample</span></span>  
  
1.  <span data-ttu-id="00292-116">In [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)] aprire il file della soluzione ParallelConvoySample.sln.</span><span class="sxs-lookup"><span data-stu-id="00292-116">Using [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)], open the ParallelConvoySample.sln solution file.</span></span>  
  
2.  <span data-ttu-id="00292-117">Per compilare la soluzione, premere CTRL+MAIUSC+B.</span><span class="sxs-lookup"><span data-stu-id="00292-117">To build the solution, press CTRL+SHIFT+B.</span></span>  
  
3.  <span data-ttu-id="00292-118">Assicurarsi che entrambi i progetti siano impostati per l'avvio.</span><span class="sxs-lookup"><span data-stu-id="00292-118">Ensure both projects are set to start.</span></span>  
  
    1.  <span data-ttu-id="00292-119">In **Esplora**, la soluzione e scegliere **Imposta progetti di avvio**.</span><span class="sxs-lookup"><span data-stu-id="00292-119">In **Solution Explorer**, right-click the solution and select **Set Startup Projects**.</span></span>  
  
    2.  <span data-ttu-id="00292-120">Selezionare **più progetti di avvio** e assicurarsi che l'azione per entrambi i progetti è impostata su **avviare**.</span><span class="sxs-lookup"><span data-stu-id="00292-120">Select **Multiple Startup Projects** and ensure the action for both projects is set to **Start**.</span></span>  
  
4.  <span data-ttu-id="00292-121">Per eseguire la soluzione, premere CTRL+F5.</span><span class="sxs-lookup"><span data-stu-id="00292-121">To run the solution, press CTRL+F5.</span></span>  
  
     <span data-ttu-id="00292-122">Il server stampa `Server is running` per indicare che è pronto.</span><span class="sxs-lookup"><span data-stu-id="00292-122">The server prints `Server is running`, which indicates the server is ready.</span></span>  
  
     <span data-ttu-id="00292-123">Premere un tasto qualsiasi nella finestra della console del client per avviare l'esempio.</span><span class="sxs-lookup"><span data-stu-id="00292-123">Press any key in the client console window to start the sample.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="00292-124">È possibile che gli esempi siano già installati nel computer.</span><span class="sxs-lookup"><span data-stu-id="00292-124">The samples may already be installed on your machine.</span></span> <span data-ttu-id="00292-125">Verificare la directory seguente (impostazione predefinita) prima di continuare.</span><span class="sxs-lookup"><span data-stu-id="00292-125">Check for the following (default) directory before continuing.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  <span data-ttu-id="00292-126">Se questa directory non esiste, andare alla sezione relativa agli [esempi di Windows Communication Foundation (WCF) e Windows Workflow Foundation (WF) per .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) per scaricare tutti gli esempi di [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] e [!INCLUDE[wf1](../../../../includes/wf1-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="00292-126">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="00292-127">Questo esempio si trova nella directory seguente.</span><span class="sxs-lookup"><span data-stu-id="00292-127">This sample is located in the following directory.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WF\Scenario\Transactions\TransactedConvoyScope`