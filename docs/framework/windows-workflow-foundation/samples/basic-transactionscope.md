---
title: TransactionScope di base
ms.date: 03/30/2017
ms.assetid: 1e22b76a-76de-43b4-9be7-7a86ed3d5a44
ms.openlocfilehash: fe6877c4b2d72dc3d571740395fd4dc92ca8e99c
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/04/2018
ms.locfileid: "33516802"
---
# <a name="basic-transactionscope"></a><span data-ttu-id="89588-102">TransactionScope di base</span><span class="sxs-lookup"><span data-stu-id="89588-102">Basic TransactionScope</span></span>
<span data-ttu-id="89588-103">Questo esempio è costituito da quattro scenari che vengono eseguiti illustrando come annidare istanze di <xref:System.Activities.Statements.TransactionScope>.</span><span class="sxs-lookup"><span data-stu-id="89588-103">This sample consists of four scenarios that run showing how to nest <xref:System.Activities.Statements.TransactionScope> instances.</span></span> <span data-ttu-id="89588-104">Nel primo scenario viene illustrato l'annidamento di un'attività di terze parti di cui l'autore non dispone di informazioni sulla modalità di costruzione.</span><span class="sxs-lookup"><span data-stu-id="89588-104">The first scenario shows nesting a 3rd party activity of which the author has no knowledge of the construction.</span></span> <span data-ttu-id="89588-105">Nel secondo e nel terzo scenario viene illustrato come vengono rispettati timeout, mentre nello scenario finale viene illustrata l'impostazione di <xref:System.Activities.Statements.TransactionScope.AbortInstanceOnTransactionFailure%2A>.</span><span class="sxs-lookup"><span data-stu-id="89588-105">The second and third scenarios show how time-outs are respected and the final scenario shows the <xref:System.Activities.Statements.TransactionScope.AbortInstanceOnTransactionFailure%2A> setting.</span></span>  
  
## <a name="nesting-of-transactionscopeactivity"></a><span data-ttu-id="89588-106">Annidamento di TransactionScopeActivity</span><span class="sxs-lookup"><span data-stu-id="89588-106">Nesting of TransactionScopeActivity</span></span>  
 <span data-ttu-id="89588-107">Il flusso di lavoro per il primo scenario è costituito da una sequenza di due attività <xref:System.Activities.Statements.WriteLine> e una <xref:System.Activities.Statements.TransactionScope>.</span><span class="sxs-lookup"><span data-stu-id="89588-107">The workflow for the first scenario consists of a sequence of two <xref:System.Activities.Statements.WriteLine> activities and a <xref:System.Activities.Statements.TransactionScope>.</span></span> <span data-ttu-id="89588-108">Il corpo di <xref:System.Activities.Statements.TransactionScope> è una sequenza delle altre due attività <xref:System.Activities.Statements.WriteLine>, un'attività personalizzata che stampa l'identificatore locale della transazione e un'attività di terze parti.</span><span class="sxs-lookup"><span data-stu-id="89588-108">The body of the <xref:System.Activities.Statements.TransactionScope> is a sequence of two more <xref:System.Activities.Statements.WriteLine> activities, a custom activity that prints the local identifier of the transaction and a third party activity.</span></span> <span data-ttu-id="89588-109">L'attività di terze parti `TransactionScopeTest` contiene un oggetto <xref:System.Activities.Statements.TransactionScope> anche se l'autore del flusso di lavoro non ha modo di esserne a conoscenza.</span><span class="sxs-lookup"><span data-stu-id="89588-109">The third party activity `TransactionScopeTest` contains a <xref:System.Activities.Statements.TransactionScope> although the workflow author has no way of knowing.</span></span> <span data-ttu-id="89588-110">In questo scenario viene illustrato che le attività <xref:System.Activities.Statements.TransactionScope> possono essere annidate.</span><span class="sxs-lookup"><span data-stu-id="89588-110">This scenario shows that <xref:System.Activities.Statements.TransactionScope> activities can be nested.</span></span>  
  
## <a name="time-outs"></a><span data-ttu-id="89588-111">Timeout</span><span class="sxs-lookup"><span data-stu-id="89588-111">Time-Outs</span></span>  
 <span data-ttu-id="89588-112">Il flusso di lavoro per il secondo scenario è quasi identico al primo.</span><span class="sxs-lookup"><span data-stu-id="89588-112">The workflow for the second scenario is nearly identical to the first.</span></span> <span data-ttu-id="89588-113">`TransactionScopeTest` è stato sostituito con <xref:System.Activities.Statements.TransactionScope>.</span><span class="sxs-lookup"><span data-stu-id="89588-113">The `TransactionScopeTest` has been replaced with a <xref:System.Activities.Statements.TransactionScope>.</span></span> <span data-ttu-id="89588-114">Il corpo di <xref:System.Activities.Statements.TransactionScope> ha un ritardo di cinque secondi e il timeout per la transazione è impostato su due secondi.</span><span class="sxs-lookup"><span data-stu-id="89588-114">The body of the <xref:System.Activities.Statements.TransactionScope> is a five-second delay and the time-out for the transaction is set to two seconds.</span></span> <span data-ttu-id="89588-115">Il valore del timeout per l'attività <xref:System.Activities.Statements.TransactionScope> esterna è impostato su 10 secondi.</span><span class="sxs-lookup"><span data-stu-id="89588-115">The time-out for the outer <xref:System.Activities.Statements.TransactionScope> is set to 10 seconds.</span></span> <span data-ttu-id="89588-116">Notare che viene rispettato il timeout inferiore presente nell'ambito e la transazione scade.</span><span class="sxs-lookup"><span data-stu-id="89588-116">Note that the smallest time-out in scope is respected and the transaction times out.</span></span>  
  
 <span data-ttu-id="89588-117">Il flusso di lavoro per il terzo scenario è quasi identico al secondo scenario.</span><span class="sxs-lookup"><span data-stu-id="89588-117">The workflow for the third scenario is nearly identical to scenario two.</span></span> <span data-ttu-id="89588-118">L'attività di ritardo è stata spostata dal corpo dell'attività <xref:System.Activities.Statements.TransactionScope> interna immediatamente dopo di essa nella sequenza, ovvero il corpo dell'attività <xref:System.Activities.Statements.TransactionScope> esterna.</span><span class="sxs-lookup"><span data-stu-id="89588-118">The delay activity has been moved from the body of the inner <xref:System.Activities.Statements.TransactionScope> to immediately after it in the sequence that is the body of the outer <xref:System.Activities.Statements.TransactionScope>.</span></span> <span data-ttu-id="89588-119">La transazione scade ancora perché il timeout di due secondi dell'attività <xref:System.Activities.Statements.TransactionScope> interna non è più applicabile.</span><span class="sxs-lookup"><span data-stu-id="89588-119">The transaction still times out but because the two second time-out of the inner <xref:System.Activities.Statements.TransactionScope> no longer applies.</span></span> <span data-ttu-id="89588-120">La transazione scade a 10 secondi quando viene superato il timeout dell'attività <xref:System.Activities.Statements.TransactionScope> esterna.</span><span class="sxs-lookup"><span data-stu-id="89588-120">The transaction times out at 10 seconds when the outer <xref:System.Activities.Statements.TransactionScope> time-out is exceeded.</span></span>  
  
## <a name="aborting-on-transaction-failure"></a><span data-ttu-id="89588-121">Interruzione in caso di errore della transazione</span><span class="sxs-lookup"><span data-stu-id="89588-121">Aborting on Transaction Failure</span></span>  
 <span data-ttu-id="89588-122">Questo flusso di lavoro è simile al terzo scenario, salvo il fatto che i timeout sono stati sostituiti dalla proprietà <xref:System.Activities.Statements.TransactionScope.AbortInstanceOnTransactionFailure%2A>.</span><span class="sxs-lookup"><span data-stu-id="89588-122">This workflow is similar to scenario three except the time-outs have been replaced by the <xref:System.Activities.Statements.TransactionScope.AbortInstanceOnTransactionFailure%2A> property.</span></span> <span data-ttu-id="89588-123">Notare che i flag di tutti gli elementi figlio interni, se impostati, devono corrispondere all'attività <xref:System.Activities.Statements.TransactionScope> esterna.</span><span class="sxs-lookup"><span data-stu-id="89588-123">Note that the flags of all inner children, if set, must match the outer <xref:System.Activities.Statements.TransactionScope>.</span></span> <span data-ttu-id="89588-124">In questo scenario non corrispondono e quindi viene generata un'eccezione all'apertura del flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="89588-124">In this scenario, they do not and an exception is thrown when the workflow opens.</span></span>  
  
#### <a name="to-run-the-sample"></a><span data-ttu-id="89588-125">Per eseguire l'esempio</span><span class="sxs-lookup"><span data-stu-id="89588-125">To run the sample</span></span>  
  
1.  <span data-ttu-id="89588-126">Aprire la soluzione BasicTransactionScopeSample.sln in [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)].</span><span class="sxs-lookup"><span data-stu-id="89588-126">Open the BasicTransactionScopeSample.sln solution in [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)].</span></span>  
  
2.  <span data-ttu-id="89588-127">Per compilare la soluzione, premere CTRL + MAIUSC + B o scegliere **Compila soluzione** dal **compilare** menu.</span><span class="sxs-lookup"><span data-stu-id="89588-127">To build the solution, press CTRL+SHIFT+B or select **Build Solution** from the **Build** menu.</span></span>  
  
3.  <span data-ttu-id="89588-128">Una volta completata la compilazione, premere F5 o scegliere **Avvia debug** dal **Debug** menu.</span><span class="sxs-lookup"><span data-stu-id="89588-128">Once the build has succeeded, press F5 or select **Start Debugging** from the **Debug** menu.</span></span> <span data-ttu-id="89588-129">In alternativa è possibile premere CTRL + F5 o selezionare **Avvia senza eseguire debug** dal **Debug** menu per l'esecuzione senza debug.</span><span class="sxs-lookup"><span data-stu-id="89588-129">Alternatively you can press CTRL+F5 or select **Start Without Debugging** from the **Debug** menu to run without debugging.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="89588-130">È possibile che gli esempi siano già installati nel computer.</span><span class="sxs-lookup"><span data-stu-id="89588-130">The samples may already be installed on your machine.</span></span> <span data-ttu-id="89588-131">Verificare la directory seguente (impostazione predefinita) prima di continuare.</span><span class="sxs-lookup"><span data-stu-id="89588-131">Check for the following (default) directory before continuing.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  <span data-ttu-id="89588-132">Se questa directory non esiste, andare al [Windows Communication Foundation (WCF) e gli esempi di Windows Workflow Foundation (WF) per .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) per scaricare tutti i Windows Communication Foundation (WCF) e [!INCLUDE[wf1](../../../../includes/wf1-md.md)] esempi.</span><span class="sxs-lookup"><span data-stu-id="89588-132">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="89588-133">Questo esempio si trova nella directory seguente.</span><span class="sxs-lookup"><span data-stu-id="89588-133">This sample is located in the following directory.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WF\Basic\Transactions\BasicTransactionScope`