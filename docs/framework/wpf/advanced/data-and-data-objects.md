---
title: Dati e oggetti dati
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-wpf
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords:
- data transfer [WPF], drag-and-drop
- DataFormats class [WPF]
- DataObject class [WPF]
ms.assetid: 5967d557-1867-420f-a524-ae3af78402da
caps.latest.revision: "5"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: cb2354b61a0433981675ba55978f31937212cabc
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/22/2017
---
# <a name="data-and-data-objects"></a><span data-ttu-id="28ff3-102">Dati e oggetti dati</span><span class="sxs-lookup"><span data-stu-id="28ff3-102">Data and Data Objects</span></span>
<span data-ttu-id="28ff3-103">I dati trasferiti come parte di un'operazione di trascinamento e rilascio viene archiviati in un oggetto dati.</span><span class="sxs-lookup"><span data-stu-id="28ff3-103">Data that is transferred as part of a drag-and-drop operation is stored in a data object.</span></span>  <span data-ttu-id="28ff3-104">Concettualmente, un oggetto dati è costituito da uno o più delle seguenti coppie di:</span><span class="sxs-lookup"><span data-stu-id="28ff3-104">Conceptually, a data object consists of one or more of the following pairs:</span></span>  
  
-   <span data-ttu-id="28ff3-105">Un <xref:System.Object> che contiene i dati effettivi.</span><span class="sxs-lookup"><span data-stu-id="28ff3-105">An <xref:System.Object> that contains the actual data.</span></span>  
  
-   <span data-ttu-id="28ff3-106">Un identificatore di formato di dati corrispondente.</span><span class="sxs-lookup"><span data-stu-id="28ff3-106">A corresponding data format identifier.</span></span>  
  
 <span data-ttu-id="28ff3-107">I dati stessi possono contenere qualsiasi elemento che può essere rappresentato come una base <xref:System.Object>.</span><span class="sxs-lookup"><span data-stu-id="28ff3-107">The data itself can consist of anything that can be represented as a base <xref:System.Object>.</span></span>  <span data-ttu-id="28ff3-108">Il formato di dati corrispondente è una stringa o <xref:System.Type> che fornisce un hint sul formato dei dati è in.</span><span class="sxs-lookup"><span data-stu-id="28ff3-108">The corresponding data format is a string or <xref:System.Type> that provides a hint about what format the data is in.</span></span>  <span data-ttu-id="28ff3-109">Gli oggetti dati supportano l'hosting di più coppie di formato di dati o dati; In questo modo un singolo oggetto dati fornire i dati in più formati.</span><span class="sxs-lookup"><span data-stu-id="28ff3-109">Data objects support hosting multiple data/data format pairs; this enables a single data object to provide data in multiple formats.</span></span>  
  
<a name="Data_and_Data_Objects"></a>   
## <a name="data-objects"></a><span data-ttu-id="28ff3-110">Oggetti dati</span><span class="sxs-lookup"><span data-stu-id="28ff3-110">Data Objects</span></span>  
 <span data-ttu-id="28ff3-111">Tutti gli oggetti di dati devono implementare il <xref:System.Windows.IDataObject> interfaccia che fornisce il seguente set standard di metodi che consentono e semplificano il trasferimento dei dati.</span><span class="sxs-lookup"><span data-stu-id="28ff3-111">All data objects must implement the <xref:System.Windows.IDataObject> interface, which provides the following standard set of methods that enable and facilitate data transfer.</span></span>  
  
|<span data-ttu-id="28ff3-112">Metodo</span><span class="sxs-lookup"><span data-stu-id="28ff3-112">Method</span></span>|<span data-ttu-id="28ff3-113">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="28ff3-113">Summary</span></span>|  
|------------|-------------|  
|<xref:System.Windows.IDataObject.GetData%2A>|<span data-ttu-id="28ff3-114">Recupera un oggetto dati in un formato dati specificato.</span><span class="sxs-lookup"><span data-stu-id="28ff3-114">Retrieves a data object in a specified data format.</span></span>|  
|<xref:System.Windows.IDataObject.GetDataPresent%2A>|<span data-ttu-id="28ff3-115">Controlla se i dati sono disponibili in, o possono essere convertiti nel formato specificato.</span><span class="sxs-lookup"><span data-stu-id="28ff3-115">Checks to see whether the data is available in, or can be converted to, a specified format.</span></span>|  
|<xref:System.Windows.IDataObject.GetFormats%2A>|<span data-ttu-id="28ff3-116">Restituisce un elenco di formati di dati nell'oggetto dati viene archiviati in, o possono essere convertiti in.</span><span class="sxs-lookup"><span data-stu-id="28ff3-116">Returns a list of formats that the data in this data object is stored in, or can be converted to.</span></span>|  
|<xref:System.Windows.IDataObject.SetData%2A>|<span data-ttu-id="28ff3-117">Archivia i dati specificati nell'oggetto dati.</span><span class="sxs-lookup"><span data-stu-id="28ff3-117">Stores the specified data in this data object.</span></span>|  
  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="28ff3-118">fornisce un'implementazione di base <xref:System.Windows.IDataObject> nel <xref:System.Windows.DataObject> classe.</span><span class="sxs-lookup"><span data-stu-id="28ff3-118"> provides a basic implementation of <xref:System.Windows.IDataObject> in the <xref:System.Windows.DataObject> class.</span></span> <span data-ttu-id="28ff3-119">L'azione <xref:System.Windows.DataObject> classe è sufficiente per molti scenari comuni di trasferimento dei dati.</span><span class="sxs-lookup"><span data-stu-id="28ff3-119">The stock <xref:System.Windows.DataObject> class is sufficient for many common data transfer scenarios.</span></span>  
  
 <span data-ttu-id="28ff3-120">Esistono vari formati predefiniti, quali bitmap, CSV, file, HTML, RTF, stringa, testo e audio.</span><span class="sxs-lookup"><span data-stu-id="28ff3-120">There are several pre-defined formats, such as bitmap, CSV, file, HTML, RTF, string, text, and audio.</span></span> <span data-ttu-id="28ff3-121">Per informazioni sui formati di dati predefiniti forniti con [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], vedere il <xref:System.Windows.DataFormats> argomento di riferimento di classe.</span><span class="sxs-lookup"><span data-stu-id="28ff3-121">For information about pre-defined data formats provided with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see the <xref:System.Windows.DataFormats> class reference topic.</span></span>  
  
 <span data-ttu-id="28ff3-122">Oggetti dati è in genere includono una funzionalità per convertire automaticamente i dati archiviati in un formato in un formato diverso durante l'estrazione dei dati. Questa funzionalità è detta automaticamente la conversione.</span><span class="sxs-lookup"><span data-stu-id="28ff3-122">Data objects commonly include a facility for automatically converting data stored in one format to a different format while extracting data; this facility is referred to as auto-convert.</span></span> <span data-ttu-id="28ff3-123">Quando si eseguono query per i formati di dati disponibili in un oggetto dati, i formati di dati convertibili automaticamente possono essere filtrati da formati dati nativi chiamando il <xref:System.Windows.DataObject.GetFormats%28System.Boolean%29> o <xref:System.Windows.DataObject.GetDataPresent%28System.String%2CSystem.Boolean%29> metodo e specificando la `autoConvert` parametro come `false`.</span><span class="sxs-lookup"><span data-stu-id="28ff3-123">When querying for the data formats available in a data object, auto-convertible data formats can be filtered from native data formats by calling the <xref:System.Windows.DataObject.GetFormats%28System.Boolean%29> or <xref:System.Windows.DataObject.GetDataPresent%28System.String%2CSystem.Boolean%29> method and specifying the `autoConvert` parameter as `false`.</span></span>  <span data-ttu-id="28ff3-124">Quando si aggiungono dati a un oggetto dati con il <xref:System.Windows.DataObject.SetData%28System.String%2CSystem.Object%2CSystem.Boolean%29> (metodo), la conversione automatica dei dati può essere impedita impostando il `autoConvert` parametro `false`.</span><span class="sxs-lookup"><span data-stu-id="28ff3-124">When adding data to a data object with the <xref:System.Windows.DataObject.SetData%28System.String%2CSystem.Object%2CSystem.Boolean%29> method, auto-conversion of data can be prohibited by setting the `autoConvert` parameter to `false`.</span></span>  
  
<a name="Working_with_Data_Objects"></a>   
## <a name="working-with-data-objects"></a><span data-ttu-id="28ff3-125">Utilizzo di oggetti dati</span><span class="sxs-lookup"><span data-stu-id="28ff3-125">Working with Data Objects</span></span>  
 <span data-ttu-id="28ff3-126">Questa sezione descrive le tecniche comuni per la creazione e utilizzo di oggetti dati.</span><span class="sxs-lookup"><span data-stu-id="28ff3-126">This section describes common techniques for creating and working with data objects.</span></span>  
  
### <a name="creating-new-data-objects"></a><span data-ttu-id="28ff3-127">Creazione di nuovi oggetti di dati</span><span class="sxs-lookup"><span data-stu-id="28ff3-127">Creating New Data Objects</span></span>  
 <span data-ttu-id="28ff3-128">Il <xref:System.Windows.DataObject> classe fornisce molti costruttori di overload che agevolano la compilazione di un nuovo <xref:System.Windows.DataObject> istanza con una coppia di formato singolo dati.</span><span class="sxs-lookup"><span data-stu-id="28ff3-128">The <xref:System.Windows.DataObject> class provides several overloaded constructors that facilitate populating a new <xref:System.Windows.DataObject> instance with a single data/data format pair.</span></span>  
  
 <span data-ttu-id="28ff3-129">Esempio di codice seguente crea un nuovo oggetto dati e viene utilizzato uno dei costruttori di overload <xref:System.Windows.DataObject.%23ctor%2A>(<xref:System.Windows.DataObject.%23ctor(System.String,System.Object)>) per inizializzare l'oggetto dati con una stringa e un formato dati specificato.</span><span class="sxs-lookup"><span data-stu-id="28ff3-129">The following example code creates a new data object and uses one of the overloaded constructors <xref:System.Windows.DataObject.%23ctor%2A>(<xref:System.Windows.DataObject.%23ctor(System.String,System.Object)>) to initialize the data object with a string and a specified data format.</span></span>  <span data-ttu-id="28ff3-130">In questo caso, il formato di dati è specificato da una stringa. la <xref:System.Windows.DataFormats> classe fornisce un set di stringhe di tipo predefinite.</span><span class="sxs-lookup"><span data-stu-id="28ff3-130">In this case, the data format is specified by a string; the <xref:System.Windows.DataFormats> class provides a set of pre-defined type strings.</span></span> <span data-ttu-id="28ff3-131">Per impostazione predefinita, è consentita la conversione automatica dei dati archiviati.</span><span class="sxs-lookup"><span data-stu-id="28ff3-131">Auto-conversion of the stored data is allowed by default.</span></span>  
  
 [!code-csharp[DragDrop_DragDropMiscCode#_DragDrop_CreateDataObject_TypeString](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/CSharp/Window1.xaml.cs#_dragdrop_createdataobject_typestring)]
 [!code-vb[DragDrop_DragDropMiscCode#_DragDrop_CreateDataObject_TypeString](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/visualbasic/window1.xaml.vb#_dragdrop_createdataobject_typestring)]  
  
 <span data-ttu-id="28ff3-132">Per ulteriori esempi di codice che crea un oggetto dati, vedere [creare un oggetto dati](../../../../docs/framework/wpf/advanced/how-to-create-a-data-object.md).</span><span class="sxs-lookup"><span data-stu-id="28ff3-132">For more examples of code that creates a data object, see [Create a Data Object](../../../../docs/framework/wpf/advanced/how-to-create-a-data-object.md).</span></span>  
  
### <a name="storing-data-in-multiple-formats"></a><span data-ttu-id="28ff3-133">L'archiviazione dei dati in più formati</span><span class="sxs-lookup"><span data-stu-id="28ff3-133">Storing Data in Multiple Formats</span></span>  
 <span data-ttu-id="28ff3-134">Un singolo oggetto dati è in grado di archiviare dati in più formati.</span><span class="sxs-lookup"><span data-stu-id="28ff3-134">A single data object is able to store data in multiple formats.</span></span>   <span data-ttu-id="28ff3-135">L'utilizzo di più formati di dati all'interno di un singolo oggetto dati strategico potenzialmente rende l'oggetto dati utilizzabile da un'ampia gamma di obiettivi di rilascio più se solo un unico formato dati potrebbe essere rappresentato.</span><span class="sxs-lookup"><span data-stu-id="28ff3-135">Strategic use of multiple data formats within a single data object potentially makes the data object consumable by a wider variety of drop targets than if only a single data format could be represented.</span></span>  <span data-ttu-id="28ff3-136">Si noti che, in generale, un'origine di trascinamento deve essere indipendente sui formati di dati che possono essere utilizzati da potenziali obiettivi di rilascio.</span><span class="sxs-lookup"><span data-stu-id="28ff3-136">Note that, in general, a drag source must be agnostic about the data formats that are consumable by potential drop targets.</span></span>  
  
 <span data-ttu-id="28ff3-137">Nell'esempio seguente viene illustrato come utilizzare il <xref:System.Windows.DataObject.SetData%28System.String%2CSystem.Object%29> metodo per aggiungere dati a un oggetto dati in più formati.</span><span class="sxs-lookup"><span data-stu-id="28ff3-137">The following example shows how to use the <xref:System.Windows.DataObject.SetData%28System.String%2CSystem.Object%29> method to add data to a data object in multiple formats.</span></span>  
  
 [!code-csharp[DragDrop_DragDropMiscCode#_DragDrop_StoreMultipleFormats](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/CSharp/Window1.xaml.cs#_dragdrop_storemultipleformats)]
 [!code-vb[DragDrop_DragDropMiscCode#_DragDrop_StoreMultipleFormats](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/visualbasic/window1.xaml.vb#_dragdrop_storemultipleformats)]  
  
### <a name="querying-a-data-object-for-available-formats"></a><span data-ttu-id="28ff3-138">Esecuzione di query su un oggetto dati per i formati disponibili</span><span class="sxs-lookup"><span data-stu-id="28ff3-138">Querying a Data Object for Available Formats</span></span>  
 <span data-ttu-id="28ff3-139">Poiché un singolo oggetto dati può contenere un numero arbitrario di formati di dati, oggetti dati consentono di recuperare un elenco dei formati di dati disponibili.</span><span class="sxs-lookup"><span data-stu-id="28ff3-139">Because a single data object can contain an arbitrary number of data formats, data objects include facilities for retrieving a list of available data formats.</span></span>  
  
 <span data-ttu-id="28ff3-140">Il codice di esempio seguente usa il <xref:System.Windows.DataObject.GetFormats%2A> overload per ottenere una matrice di stringhe che indica tutti i formati di dati disponibili in un oggetto dati (nativo e conversione automatica).</span><span class="sxs-lookup"><span data-stu-id="28ff3-140">The following example code uses the <xref:System.Windows.DataObject.GetFormats%2A> overload to get an array of strings denoting all data formats available in a data object (both native and by auto-convert).</span></span>  
  
 [!code-csharp[DragDrop_DragDropMiscCode#_DragDrop_GetAllDataFormats](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/CSharp/Window1.xaml.cs#_dragdrop_getalldataformats)]
 [!code-vb[DragDrop_DragDropMiscCode#_DragDrop_GetAllDataFormats](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/visualbasic/window1.xaml.vb#_dragdrop_getalldataformats)]  
  
 <span data-ttu-id="28ff3-141">Per ulteriori esempi di codice che esegue una query di un oggetto dati per i formati dati disponibili, vedere [sono elencati i formati di dati in un oggetto dati](../../../../docs/framework/wpf/advanced/how-to-list-the-data-formats-in-a-data-object.md).</span><span class="sxs-lookup"><span data-stu-id="28ff3-141">For more examples of code that queries a data object for available data formats, see [List the Data Formats in a Data Object](../../../../docs/framework/wpf/advanced/how-to-list-the-data-formats-in-a-data-object.md).</span></span>  <span data-ttu-id="28ff3-142">Per esempi di query su un oggetto dati per la presenza di un particolare formato dati, vedere [determinare se un formato di dati è presente in un oggetto dati](../../../../docs/framework/wpf/advanced/how-to-determine-if-a-data-format-is-present-in-a-data-object.md).</span><span class="sxs-lookup"><span data-stu-id="28ff3-142">For examples of querying a data object for the presence of a particular data format, see [Determine if a Data Format is Present in a Data Object](../../../../docs/framework/wpf/advanced/how-to-determine-if-a-data-format-is-present-in-a-data-object.md).</span></span>  
  
### <a name="retrieving-data-from-a-data-object"></a><span data-ttu-id="28ff3-143">Il recupero dei dati da un oggetto dati</span><span class="sxs-lookup"><span data-stu-id="28ff3-143">Retrieving Data from a Data Object</span></span>  
 <span data-ttu-id="28ff3-144">Il recupero dei dati da un oggetto dati in un determinato formato richiede semplicemente la chiamata a uno del <xref:System.Windows.DataObject.GetData%2A> metodi e specificare il formato di dati desiderato.</span><span class="sxs-lookup"><span data-stu-id="28ff3-144">Retrieving data from a data object in a particular format simply involves calling one of the <xref:System.Windows.DataObject.GetData%2A> methods and specifying the desired data format.</span></span>  <span data-ttu-id="28ff3-145">Uno del <xref:System.Windows.DataObject.GetDataPresent%2A> metodi possono essere usati per verificare la presenza di un particolare formato dati.</span><span class="sxs-lookup"><span data-stu-id="28ff3-145">One of the <xref:System.Windows.DataObject.GetDataPresent%2A> methods can be used to check for the presence of a particular data format.</span></span>  <span data-ttu-id="28ff3-146"><xref:System.Windows.DataObject.GetData%2A>Restituisce i dati in un <xref:System.Object>; a seconda del formato di dati, questo oggetto può essere convertito in un contenitore specifico del tipo.</span><span class="sxs-lookup"><span data-stu-id="28ff3-146"><xref:System.Windows.DataObject.GetData%2A> returns the data in an <xref:System.Object>; depending on the data format, this object can be cast to a type-specific container.</span></span>  
  
 <span data-ttu-id="28ff3-147">Il codice di esempio seguente usa il <xref:System.Windows.DataObject.GetDataPresent%28System.String%29> overload per controllare se un formato dati specificato è disponibile (nativa o mediante conversione automatica).</span><span class="sxs-lookup"><span data-stu-id="28ff3-147">The following example code uses the <xref:System.Windows.DataObject.GetDataPresent%28System.String%29> overload to check if a specified data format is available (native or by auto-convert).</span></span> <span data-ttu-id="28ff3-148">Se il formato specificato non è disponibile, l'esempio recupera i dati utilizzando il <xref:System.Windows.DataObject.GetData%28System.String%29> metodo.</span><span class="sxs-lookup"><span data-stu-id="28ff3-148">If the specified format is available, the example retrieves the data by using the <xref:System.Windows.DataObject.GetData%28System.String%29> method.</span></span>  
  
 [!code-csharp[DragDrop_DragDropMiscCode#_DragDrop_GetSpecificDataFormat](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/CSharp/Window1.xaml.cs#_dragdrop_getspecificdataformat)]
 [!code-vb[DragDrop_DragDropMiscCode#_DragDrop_GetSpecificDataFormat](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/visualbasic/window1.xaml.vb#_dragdrop_getspecificdataformat)]  
  
 <span data-ttu-id="28ff3-149">Per ulteriori esempi di codice che recupera dati da un oggetto dati, vedere [recupera i dati in un determinato formato di dati](../../../../docs/framework/wpf/advanced/how-to-retrieve-data-in-a-particular-data-format.md).</span><span class="sxs-lookup"><span data-stu-id="28ff3-149">For more examples of code that retrieves data from a data object, see [Retrieve Data in a Particular Data Format](../../../../docs/framework/wpf/advanced/how-to-retrieve-data-in-a-particular-data-format.md).</span></span>  
  
### <a name="removing-data-from-a-data-object"></a><span data-ttu-id="28ff3-150">Rimozione dei dati da un oggetto dati</span><span class="sxs-lookup"><span data-stu-id="28ff3-150">Removing Data From a Data Object</span></span>  
 <span data-ttu-id="28ff3-151">Impossibile rimuovere dati direttamente da un oggetto dati.</span><span class="sxs-lookup"><span data-stu-id="28ff3-151">Data cannot be directly removed from a data object.</span></span>  <span data-ttu-id="28ff3-152">Per rimuovere in modo efficace i dati da un oggetto dati, seguire questi passaggi:</span><span class="sxs-lookup"><span data-stu-id="28ff3-152">To effectively remove data from a data object, follow these steps:</span></span>  
  
1.  <span data-ttu-id="28ff3-153">Creare un nuovo oggetto dati che conterrà solo i dati di cui che si desidera mantenere.</span><span class="sxs-lookup"><span data-stu-id="28ff3-153">Create a new data object that will contain only the data you want to retain.</span></span>  
  
2.  <span data-ttu-id="28ff3-154">"Copia" i dati desiderati dall'oggetto dati precedente al nuovo oggetto dati.</span><span class="sxs-lookup"><span data-stu-id="28ff3-154">"Copy" the desired data from the old data object to the new data object.</span></span>  <span data-ttu-id="28ff3-155">Per copiare i dati, utilizzare uno del <xref:System.Windows.DataObject.GetData%2A> metodi per recuperare un <xref:System.Object> che contiene i dati non elaborati e quindi utilizzare uno del <xref:System.Windows.DataObject.SetData%2A> metodi per aggiungere i dati al nuovo oggetto dati.</span><span class="sxs-lookup"><span data-stu-id="28ff3-155">To copy the data, use one of the <xref:System.Windows.DataObject.GetData%2A> methods to retrieve an <xref:System.Object> that contains the raw data, and then use one of the <xref:System.Windows.DataObject.SetData%2A> methods to add the data to the new data object.</span></span>  
  
3.  <span data-ttu-id="28ff3-156">Sostituire l'oggetto dati precedente con quello nuovo.</span><span class="sxs-lookup"><span data-stu-id="28ff3-156">Replace the old data object with the new one.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="28ff3-157">Il <xref:System.Windows.DataObject.SetData%2A> metodi consentono solo di aggiungere dati a un oggetto dati; non sostituiscono i dati, anche se i dati e il formato dei dati sono esattamente uguali come una chiamata precedente.</span><span class="sxs-lookup"><span data-stu-id="28ff3-157">The <xref:System.Windows.DataObject.SetData%2A> methods only add data to a data object; they do not replace data, even if the data and data format are exactly the same as a previous call.</span></span> <span data-ttu-id="28ff3-158">La chiamata <xref:System.Windows.DataObject.SetData%2A> due volte per gli stessi dati e dati formato comporterà il formato di dati/presenti due volte nell'oggetto dati.</span><span class="sxs-lookup"><span data-stu-id="28ff3-158">Calling <xref:System.Windows.DataObject.SetData%2A> twice for the same data and data format will result in the data/data format being present twice in the data object.</span></span>
