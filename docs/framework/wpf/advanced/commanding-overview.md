---
title: Cenni preliminari sull'esecuzione di comandi
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-wpf
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords:
- interfaces [WPF], ICommandSource
- command library [WPF]
- commands [WPF], definition of
- CommandBindings [WPF]
- ICommandSource interfaces [WPF]
- commanding [WPF]
- CommandManager [WPF]
ms.assetid: bc208dfe-367d-426a-99de-52b7e7511e81
caps.latest.revision: "35"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 9b75319b5a07ac2ee1601f30394da641eb2b781c
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 11/21/2017
---
# <a name="commanding-overview"></a><span data-ttu-id="25d61-102">Cenni preliminari sull'esecuzione di comandi</span><span class="sxs-lookup"><span data-stu-id="25d61-102">Commanding Overview</span></span>
<a name="introduction"></a> <span data-ttu-id="25d61-103">I comandi sono un meccanismo di input in [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] che consente la gestione dell'input a un livello più semantico rispetto all'input dei dispositivi.</span><span class="sxs-lookup"><span data-stu-id="25d61-103">Commanding is an input mechanism in [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] which provides input handling at a more semantic level than device input.</span></span> <span data-ttu-id="25d61-104">Sono esempi di comandi le operazioni **Copia**, **Taglia** e **Incolla** disponibili in molte applicazioni.</span><span class="sxs-lookup"><span data-stu-id="25d61-104">Examples of commands are the **Copy**, **Cut**, and **Paste** operations found on many applications.</span></span>  
  
 <span data-ttu-id="25d61-105">Questa panoramica presenta i comandi disponibili in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], le classi che fanno parte del modello di esecuzione dei comandi e le procedure per usare e creare comandi nelle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="25d61-105">This overview defines what commands are in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], which classes are part of the commanding model, and how to use and create commands in your applications.</span></span>  
  
 <span data-ttu-id="25d61-106">Di seguito sono elencate le diverse sezioni di questo argomento:</span><span class="sxs-lookup"><span data-stu-id="25d61-106">This topic contains the following sections:</span></span>  
  
-   [<span data-ttu-id="25d61-107">Cosa sono i comandi?</span><span class="sxs-lookup"><span data-stu-id="25d61-107">What Are Commands?</span></span>](#commands_at_10000_feet)  
  
-   [<span data-ttu-id="25d61-108">Esempio di comando semplice in WPF</span><span class="sxs-lookup"><span data-stu-id="25d61-108">Simple Command Example in WPF</span></span>](#simple_command)  
  
-   [<span data-ttu-id="25d61-109">Quattro concetti principali dell'esecuzione dei comandi WPF</span><span class="sxs-lookup"><span data-stu-id="25d61-109">Four Main Concepts in WPF Commanding</span></span>](#Four_main_Concepts)  
  
-   [<span data-ttu-id="25d61-110">Libreria dei comandi</span><span class="sxs-lookup"><span data-stu-id="25d61-110">Command Library</span></span>](#Command_Library)  
  
-   [<span data-ttu-id="25d61-111">Creazione di comandi personalizzati</span><span class="sxs-lookup"><span data-stu-id="25d61-111">Creating Custom Commands</span></span>](#creating_commands)  
  
<a name="commands_at_10000_feet"></a>   
## <a name="what-are-commands"></a><span data-ttu-id="25d61-112">Cosa sono i comandi?</span><span class="sxs-lookup"><span data-stu-id="25d61-112">What Are Commands?</span></span>  
 <span data-ttu-id="25d61-113">I comandi hanno diversi scopi.</span><span class="sxs-lookup"><span data-stu-id="25d61-113">Commands have several purposes.</span></span> <span data-ttu-id="25d61-114">Il primo scopo è di separare la semantica e l'oggetto che richiama un comando dalla logica che esegue il comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-114">The first purpose is to separate the semantics and the object that invokes a command from the logic that executes the command.</span></span> <span data-ttu-id="25d61-115">In questo modo, più codici sorgente diversi possono richiamare la stessa logica di comando che può quindi essere personalizzata per obiettivi differenti.</span><span class="sxs-lookup"><span data-stu-id="25d61-115">This allows for multiple and disparate sources to invoke the same command logic, and it allows the command logic to be customized for different targets.</span></span> <span data-ttu-id="25d61-116">Le operazioni di modifica **Copia**, **Taglia** e **Incolla**, ad esempio, disponibili in molte applicazioni, possono essere richiamate usando azioni dell'utente diverse se vengono implementate tramite i comandi.</span><span class="sxs-lookup"><span data-stu-id="25d61-116">For example, the editing operations **Copy**, **Cut**, and **Paste**, which are found in many applications, can be invoked by using different user actions if they are implemented by using commands.</span></span> <span data-ttu-id="25d61-117">Un'applicazione potrebbe consentire a un utente di tagliare gli oggetti o il testo selezionati facendo clic su un pulsante, scegliendo una voce da un menu o usando una combinazione di tasti, ad esempio CTRL+X.</span><span class="sxs-lookup"><span data-stu-id="25d61-117">An application might allow a user to cut selected objects or text by either clicking a button, choosing an item in a menu, or using a key combination, such as CTRL+X.</span></span> <span data-ttu-id="25d61-118">Usando i comandi è possibile associare ogni tipo di azione utente alla stessa logica.</span><span class="sxs-lookup"><span data-stu-id="25d61-118">By using commands, you can bind each type of user action to the same logic.</span></span>  
  
 <span data-ttu-id="25d61-119">Un altro scopo dei comandi è di indicare se un'azione è disponibile.</span><span class="sxs-lookup"><span data-stu-id="25d61-119">Another purpose of commands is to indicate whether an action is available.</span></span> <span data-ttu-id="25d61-120">Per continuare con l'esempio in cui viene tagliato un oggetto o un testo, l'azione ha senso solo quando viene selezionato un elemento.</span><span class="sxs-lookup"><span data-stu-id="25d61-120">To continue the example of cutting an object or text, the action only makes sense when something is selected.</span></span> <span data-ttu-id="25d61-121">Se un utente tenta di tagliare un oggetto o un testo senza avere selezionato alcun elemento, non viene eseguita alcuna operazione.</span><span class="sxs-lookup"><span data-stu-id="25d61-121">If a user tries to cut an object or text without having anything selected, nothing would happen.</span></span> <span data-ttu-id="25d61-122">Per indicarlo all'utente, in molte applicazioni vengono disabilitati i pulsanti e le voci di menu in modo che l'utente sappia se è possibile eseguire un'azione.</span><span class="sxs-lookup"><span data-stu-id="25d61-122">To indicate this to the user, many applications disable buttons and menu items so that the user knows whether it is possible to perform an action.</span></span> <span data-ttu-id="25d61-123">Un comando è possibile indicare se un'azione è possibile implementando il <xref:System.Windows.Input.ICommand.CanExecute%2A> metodo.</span><span class="sxs-lookup"><span data-stu-id="25d61-123">A command can indicate whether an action is possible by implementing the <xref:System.Windows.Input.ICommand.CanExecute%2A> method.</span></span> <span data-ttu-id="25d61-124">Un pulsante può sottoscrivere il <xref:System.Windows.Input.ICommand.CanExecuteChanged> evento ed essere disabilitato se <xref:System.Windows.Input.ICommand.CanExecute%2A> restituisce `false` oppure essere abilitato se <xref:System.Windows.Input.ICommand.CanExecute%2A> restituisce `true`.</span><span class="sxs-lookup"><span data-stu-id="25d61-124">A button can subscribe to the <xref:System.Windows.Input.ICommand.CanExecuteChanged> event and be disabled if <xref:System.Windows.Input.ICommand.CanExecute%2A> returns `false` or be enabled if <xref:System.Windows.Input.ICommand.CanExecute%2A> returns `true`.</span></span>  
  
 <span data-ttu-id="25d61-125">La semantica di un comando può essere coerente tra le applicazioni e le classi, tuttavia la logica dell'azione è specifica dell'oggetto particolare su cui si agisce.</span><span class="sxs-lookup"><span data-stu-id="25d61-125">The semantics of a command can be consistent across applications and classes, but the logic of the action is specific to the particular object acted upon.</span></span> <span data-ttu-id="25d61-126">La combinazione di tasti CTRL+X richiama il comando **Taglia** nelle classi di testo, nelle classi di immagine e nei Web browser, tuttavia la logica effettiva per l'esecuzione dell'operazione **Taglia** viene definita dall'applicazione in cui si esegue l'operazione di taglio.</span><span class="sxs-lookup"><span data-stu-id="25d61-126">The key combination CTRL+X invokes the **Cut** command in text classes, image classes, and Web browsers, but the actual logic for performing the **Cut** operation is defined by the application that performs the cut.</span></span> <span data-ttu-id="25d61-127">Oggetto <xref:System.Windows.Input.RoutedCommand> consente ai client implementare la logica.</span><span class="sxs-lookup"><span data-stu-id="25d61-127">A <xref:System.Windows.Input.RoutedCommand> enables clients to implement the logic.</span></span> <span data-ttu-id="25d61-128">Un oggetto testo può tagliare il testo selezionato negli Appunti, mentre un oggetto immagine può tagliare l'immagine selezionata.</span><span class="sxs-lookup"><span data-stu-id="25d61-128">A text object may cut the selected text into the clipboard, while an image object may cut the selected image.</span></span> <span data-ttu-id="25d61-129">Quando un'applicazione gestisce il <xref:System.Windows.Input.CommandManager.Executed> evento, dispone di accesso alla destinazione del comando e può richiedere l'azione appropriata in base al tipo della destinazione.</span><span class="sxs-lookup"><span data-stu-id="25d61-129">When an application handles the <xref:System.Windows.Input.CommandManager.Executed> event, it has access to the target of the command and can take appropriate action depending on the target's type.</span></span>  
  
<a name="simple_command"></a>   
## <a name="simple-command-example-in-wpf"></a><span data-ttu-id="25d61-130">Esempio di comando semplice in WPF</span><span class="sxs-lookup"><span data-stu-id="25d61-130">Simple Command Example in WPF</span></span>  
 <span data-ttu-id="25d61-131">Il modo più semplice per utilizzare un comando di [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] consiste nell'utilizzare un oggetto predefinito <xref:System.Windows.Input.RoutedCommand> da una delle classi della libreria di comando; utilizzare un controllo che offre supporto nativo per la gestione del comando; e utilizzare un controllo che offre supporto nativo per richiamare un comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-131">The simplest way to use a command in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is to use a predefined <xref:System.Windows.Input.RoutedCommand> from one of the command library classes; use a control that has native support for handling the command; and use a control that has native support for invoking a command.</span></span>  <span data-ttu-id="25d61-132">Il <xref:System.Windows.Input.ApplicationCommands.Paste%2A> comando è uno dei comandi predefiniti di <xref:System.Windows.Input.ApplicationCommands> classe.</span><span class="sxs-lookup"><span data-stu-id="25d61-132">The <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command is one of the predefined commands in the <xref:System.Windows.Input.ApplicationCommands> class.</span></span>  <span data-ttu-id="25d61-133">Il <xref:System.Windows.Controls.TextBox> controllo dispone di logica incorporata per la gestione di <xref:System.Windows.Input.ApplicationCommands.Paste%2A> comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-133">The <xref:System.Windows.Controls.TextBox> control has built in logic for handling the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command.</span></span>  <span data-ttu-id="25d61-134">E <xref:System.Windows.Controls.MenuItem> classe offre supporto nativo per richiamare i comandi.</span><span class="sxs-lookup"><span data-stu-id="25d61-134">And the <xref:System.Windows.Controls.MenuItem> class has native support for invoking commands.</span></span>  
  
 <span data-ttu-id="25d61-135">Nell'esempio seguente viene illustrato come impostare un <xref:System.Windows.Controls.MenuItem> in modo che quando si fa clic, richiami il <xref:System.Windows.Input.ApplicationCommands.Paste%2A> comando un <xref:System.Windows.Controls.TextBox>, supponendo che il <xref:System.Windows.Controls.TextBox> ha lo stato attivo della tastiera.</span><span class="sxs-lookup"><span data-stu-id="25d61-135">The following example shows how to set up a <xref:System.Windows.Controls.MenuItem> so that when it is clicked it will invoke the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command on a <xref:System.Windows.Controls.TextBox>, assuming the <xref:System.Windows.Controls.TextBox> has keyboard focus.</span></span>  
  
 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewSimpleCommand](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewsimplecommand)]  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcommandtargetcodebehind)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcommandtargetcodebehind)]  
  
<a name="Four_main_Concepts"></a>   
## <a name="four-main-concepts-in-wpf-commanding"></a><span data-ttu-id="25d61-136">Quattro concetti principali dell'esecuzione dei comandi WPF</span><span class="sxs-lookup"><span data-stu-id="25d61-136">Four Main Concepts in WPF Commanding</span></span>  
 <span data-ttu-id="25d61-137">Il modello di comando indirizzato di [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] può essere suddiviso in quattro concetti principali: il comando, l'origine del comando, la destinazione del comando e l'associazione del comando:</span><span class="sxs-lookup"><span data-stu-id="25d61-137">The routed command model in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] can be broken up into four main concepts: the command, the command source, the command target, and the command binding:</span></span>  
  
-   <span data-ttu-id="25d61-138">Il *comando* è l'azione da eseguire.</span><span class="sxs-lookup"><span data-stu-id="25d61-138">The *command* is the action to be executed.</span></span>  
  
-   <span data-ttu-id="25d61-139">L'*origine del comando* è l'oggetto che richiama il comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-139">The *command source* is the object which invokes the command.</span></span>  
  
-   <span data-ttu-id="25d61-140">La *destinazione del comando* è l'oggetto su cui viene eseguito il comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-140">The *command target* is the object that the command is being executed on.</span></span>  
  
-   <span data-ttu-id="25d61-141">L'*associazione del comando* è l'oggetto che esegue il mapping della logica di comando al comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-141">The *command binding* is the object which maps the command logic to the command.</span></span>  
  
 <span data-ttu-id="25d61-142">Nell'esempio precedente, il <xref:System.Windows.Input.ApplicationCommands.Paste%2A> è il comando, il <xref:System.Windows.Controls.MenuItem> è l'origine del comando, il <xref:System.Windows.Controls.TextBox> è la destinazione del comando e l'associazione del comando viene fornito dal <xref:System.Windows.Controls.TextBox> controllo.</span><span class="sxs-lookup"><span data-stu-id="25d61-142">In the previous example, the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command is the command, the <xref:System.Windows.Controls.MenuItem> is the command source, the <xref:System.Windows.Controls.TextBox> is the command target, and the command binding is supplied by the <xref:System.Windows.Controls.TextBox> control.</span></span>  <span data-ttu-id="25d61-143">Vale la pena notare che non è sempre il caso che la <xref:System.Windows.Input.CommandBinding> viene fornito dal controllo che rappresenta la classe di destinazione del comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-143">It is worth noting that it is not always the case that the <xref:System.Windows.Input.CommandBinding> is supplied by the control that is the command target class.</span></span>  <span data-ttu-id="25d61-144">Molto spesso le <xref:System.Windows.Input.CommandBinding> dallo sviluppatore dell'applicazione, è necessario creare o <xref:System.Windows.Input.CommandBinding> possono essere associati a un predecessore della destinazione del comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-144">Quite often the <xref:System.Windows.Input.CommandBinding> must be created by the application developer, or the <xref:System.Windows.Input.CommandBinding> might be attached to an ancestor of the command target.</span></span>  
  
<a name="Commands"></a>   
### <a name="commands"></a><span data-ttu-id="25d61-145">Comandi:</span><span class="sxs-lookup"><span data-stu-id="25d61-145">Commands</span></span>  
 <span data-ttu-id="25d61-146">I comandi [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] vengono creati implementando il <xref:System.Windows.Input.ICommand> interfaccia.</span><span class="sxs-lookup"><span data-stu-id="25d61-146">Commands in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are created by implementing the <xref:System.Windows.Input.ICommand> interface.</span></span>  <span data-ttu-id="25d61-147"><xref:System.Windows.Input.ICommand>espone due metodi, <xref:System.Windows.Input.ICommand.Execute%2A>, e <xref:System.Windows.Input.ICommand.CanExecute%2A>e un evento, <xref:System.Windows.Input.ICommand.CanExecuteChanged>.</span><span class="sxs-lookup"><span data-stu-id="25d61-147"><xref:System.Windows.Input.ICommand> exposes two methods, <xref:System.Windows.Input.ICommand.Execute%2A>, and <xref:System.Windows.Input.ICommand.CanExecute%2A>, and an event, <xref:System.Windows.Input.ICommand.CanExecuteChanged>.</span></span> <span data-ttu-id="25d61-148"><xref:System.Windows.Input.ICommand.Execute%2A>esegue le azioni che sono associate con il comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-148"><xref:System.Windows.Input.ICommand.Execute%2A> performs the actions that are associated with the command.</span></span> <span data-ttu-id="25d61-149"><xref:System.Windows.Input.ICommand.CanExecute%2A>Determina se il comando può essere eseguito il comando sulla destinazione corrente.</span><span class="sxs-lookup"><span data-stu-id="25d61-149"><xref:System.Windows.Input.ICommand.CanExecute%2A> determines whether the command can execute on the current command target.</span></span> <span data-ttu-id="25d61-150"><xref:System.Windows.Input.ICommand.CanExecuteChanged>viene generato se il gestore che consente di centralizzare le operazioni di comando rileva una modifica nell'origine del comando che potrebbe invalidare un comando che è stato generato ma non ancora eseguito dall'associazione del comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-150"><xref:System.Windows.Input.ICommand.CanExecuteChanged> is raised if the command manager that centralizes the commanding operations detects a change in the command source that might invalidate a command that has been raised but not yet executed by the command binding.</span></span>  <span data-ttu-id="25d61-151">Il [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] implementazione di <xref:System.Windows.Input.ICommand> è il <xref:System.Windows.Input.RoutedCommand> ed è l'obiettivo di questa panoramica.</span><span class="sxs-lookup"><span data-stu-id="25d61-151">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] implementation of <xref:System.Windows.Input.ICommand> is the <xref:System.Windows.Input.RoutedCommand> class and is the focus of this overview.</span></span>  
  
 <span data-ttu-id="25d61-152">Le origini di input principali di [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] sono il mouse, la tastiera, l'input penna e i comandi indirizzati.</span><span class="sxs-lookup"><span data-stu-id="25d61-152">The main sources of input in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are the mouse, the keyboard, ink, and routed commands.</span></span>  <span data-ttu-id="25d61-153">Utilizzano gli input più orientati al dispositivo un <xref:System.Windows.RoutedEvent> per notificare agli oggetti in una pagina dell'applicazione che si è verificato un evento di input.</span><span class="sxs-lookup"><span data-stu-id="25d61-153">The more device-oriented inputs use a <xref:System.Windows.RoutedEvent> to notify objects in an application page that an input event has occurred.</span></span>  <span data-ttu-id="25d61-154">Oggetto <xref:System.Windows.Input.RoutedCommand> non è diverso.</span><span class="sxs-lookup"><span data-stu-id="25d61-154">A <xref:System.Windows.Input.RoutedCommand> is no different.</span></span>  <span data-ttu-id="25d61-155">Il <xref:System.Windows.Input.RoutedCommand.Execute%2A> e <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> metodi di un <xref:System.Windows.Input.RoutedCommand> non contengono la logica dell'applicazione per il comando, ma piuttosto generano gli eventi indirizzati che effettuano il tunneling e bubbling nella struttura ad albero fino a quando non viene rilevato un oggetto con un <xref:System.Windows.Input.CommandBinding>.</span><span class="sxs-lookup"><span data-stu-id="25d61-155">The <xref:System.Windows.Input.RoutedCommand.Execute%2A> and <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> methods of a <xref:System.Windows.Input.RoutedCommand> do not contain the application logic for the command, but rather they raise routed events that tunnel and bubble through the element tree until they encounter an object with a <xref:System.Windows.Input.CommandBinding>.</span></span>  <span data-ttu-id="25d61-156">Il <xref:System.Windows.Input.CommandBinding> contiene i gestori per questi eventi e i gestori di cui eseguono il comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-156">The <xref:System.Windows.Input.CommandBinding> contains the handlers for these events and it is the handlers that perform the command.</span></span>  <span data-ttu-id="25d61-157">Per altre informazioni sul routing di eventi in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], vedere [Cenni preliminari sugli eventi indirizzati](../../../../docs/framework/wpf/advanced/routed-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="25d61-157">For more information on event routing in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Routed Events Overview](../../../../docs/framework/wpf/advanced/routed-events-overview.md).</span></span>  
  
 <span data-ttu-id="25d61-158">Il <xref:System.Windows.Input.RoutedCommand.Execute%2A> metodo su un <xref:System.Windows.Input.RoutedCommand> genera il <xref:System.Windows.Input.CommandManager.PreviewExecuted> e <xref:System.Windows.Input.CommandManager.Executed> eventi sulla destinazione del comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-158">The <xref:System.Windows.Input.RoutedCommand.Execute%2A> method on a <xref:System.Windows.Input.RoutedCommand> raises the <xref:System.Windows.Input.CommandManager.PreviewExecuted> and the <xref:System.Windows.Input.CommandManager.Executed> events on the command target.</span></span>  <span data-ttu-id="25d61-159">Il <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> metodo su un <xref:System.Windows.Input.RoutedCommand> genera il <xref:System.Windows.Input.CommandManager.CanExecute> e <xref:System.Windows.Input.CommandManager.PreviewCanExecute> eventi sulla destinazione del comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-159">The <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> method on a <xref:System.Windows.Input.RoutedCommand> raises the <xref:System.Windows.Input.CommandManager.CanExecute> and <xref:System.Windows.Input.CommandManager.PreviewCanExecute> events on the command target.</span></span>  <span data-ttu-id="25d61-160">Questi tunnel eventi e a bolle attraverso l'albero degli elementi fino a quando non viene rilevato un oggetto che ha un <xref:System.Windows.Input.CommandBinding> per quel comando specifico.</span><span class="sxs-lookup"><span data-stu-id="25d61-160">These events tunnel and bubble through the element tree until they encounter an object which has a <xref:System.Windows.Input.CommandBinding> for that particular command.</span></span>  
  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="25d61-161">fornisce un set di comandi indirizzati comuni distribuito in diverse classi: <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.NavigationCommands>, <xref:System.Windows.Input.ComponentCommands>, e <xref:System.Windows.Documents.EditingCommands>.</span><span class="sxs-lookup"><span data-stu-id="25d61-161"> supplies a set of common routed commands spread across several classes: <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.NavigationCommands>, <xref:System.Windows.Input.ComponentCommands>, and <xref:System.Windows.Documents.EditingCommands>.</span></span>  <span data-ttu-id="25d61-162">Queste classi sono costituite solo il <xref:System.Windows.Input.RoutedCommand> oggetti e non la logica di implementazione del comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-162">These classes consist only of the <xref:System.Windows.Input.RoutedCommand> objects and not the implementation logic of the command.</span></span>  <span data-ttu-id="25d61-163">La logica di implementazione è responsabilità dell'oggetto sul quale viene eseguito il comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-163">The implementation logic is the responsibility of the object on which the command is being executed on.</span></span>  
  
<a name="Command_Sources"></a>   
### <a name="command-sources"></a><span data-ttu-id="25d61-164">Origini dei comandi</span><span class="sxs-lookup"><span data-stu-id="25d61-164">Command Sources</span></span>  
 <span data-ttu-id="25d61-165">Un'origine del comando è l'oggetto che richiama il comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-165">A command source is the object which invokes the command.</span></span>  <span data-ttu-id="25d61-166">Sono esempi di origini comando <xref:System.Windows.Controls.MenuItem>, <xref:System.Windows.Controls.Button>, e <xref:System.Windows.Input.KeyGesture>.</span><span class="sxs-lookup"><span data-stu-id="25d61-166">Examples of command sources are <xref:System.Windows.Controls.MenuItem>, <xref:System.Windows.Controls.Button>, and <xref:System.Windows.Input.KeyGesture>.</span></span>  
  
 <span data-ttu-id="25d61-167">Comando origini in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in genere implementato il <xref:System.Windows.Input.ICommandSource> interfaccia.</span><span class="sxs-lookup"><span data-stu-id="25d61-167">Command sources in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] generally implement the <xref:System.Windows.Input.ICommandSource> interface.</span></span>  
  
 <span data-ttu-id="25d61-168"><xref:System.Windows.Input.ICommandSource>espone tre proprietà: <xref:System.Windows.Input.ICommandSource.Command%2A>, <xref:System.Windows.Input.ICommandSource.CommandTarget%2A>, e <xref:System.Windows.Input.ICommandSource.CommandParameter%2A>:</span><span class="sxs-lookup"><span data-stu-id="25d61-168"><xref:System.Windows.Input.ICommandSource> exposes three properties: <xref:System.Windows.Input.ICommandSource.Command%2A>, <xref:System.Windows.Input.ICommandSource.CommandTarget%2A>, and <xref:System.Windows.Input.ICommandSource.CommandParameter%2A>:</span></span>  
  
-   <span data-ttu-id="25d61-169"><xref:System.Windows.Input.ICommandSource.Command%2A>è il comando da eseguire quando viene richiamata l'origine del comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-169"><xref:System.Windows.Input.ICommandSource.Command%2A> is the command to execute when the command source is invoked.</span></span>  
  
-   <span data-ttu-id="25d61-170"><xref:System.Windows.Input.ICommandSource.CommandTarget%2A>è l'oggetto su cui eseguire il comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-170"><xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is the object on which to execute the command.</span></span>  <span data-ttu-id="25d61-171">Vale la pena notare che in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] il <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> proprietà <xref:System.Windows.Input.ICommandSource> è applicabile solo quando il <xref:System.Windows.Input.ICommand> è un <xref:System.Windows.Input.RoutedCommand>.</span><span class="sxs-lookup"><span data-stu-id="25d61-171">It is worth noting that in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> property on <xref:System.Windows.Input.ICommandSource> is only applicable when the <xref:System.Windows.Input.ICommand> is a <xref:System.Windows.Input.RoutedCommand>.</span></span>  <span data-ttu-id="25d61-172">Se il <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> è impostata su un <xref:System.Windows.Input.ICommandSource> e il comando corrispondente non è un <xref:System.Windows.Input.RoutedCommand>, la destinazione del comando viene ignorata.</span><span class="sxs-lookup"><span data-stu-id="25d61-172">If the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is set on an <xref:System.Windows.Input.ICommandSource> and the corresponding command is not a <xref:System.Windows.Input.RoutedCommand>, the command target is ignored.</span></span> <span data-ttu-id="25d61-173">Se il <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> non è impostata, l'elemento con stato attivo della tastiera sarà la destinazione del comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-173">If the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is not set, the element with keyboard focus will be the command target.</span></span>  
  
-   <span data-ttu-id="25d61-174"><xref:System.Windows.Input.ICommandSource.CommandParameter%2A>è un tipo di dati definito dall'utente utilizzato per passare informazioni ai gestori di implementazione del comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-174"><xref:System.Windows.Input.ICommandSource.CommandParameter%2A> is a user-defined data type used to pass information to the handlers implementing the command.</span></span>  
  
 <span data-ttu-id="25d61-175">Il [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] le classi che implementano <xref:System.Windows.Input.ICommandSource> sono <xref:System.Windows.Controls.Primitives.ButtonBase>, <xref:System.Windows.Controls.MenuItem>, <xref:System.Windows.Documents.Hyperlink>, e <xref:System.Windows.Input.InputBinding>.</span><span class="sxs-lookup"><span data-stu-id="25d61-175">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] classes that implement <xref:System.Windows.Input.ICommandSource> are <xref:System.Windows.Controls.Primitives.ButtonBase>, <xref:System.Windows.Controls.MenuItem>, <xref:System.Windows.Documents.Hyperlink>, and <xref:System.Windows.Input.InputBinding>.</span></span>  <span data-ttu-id="25d61-176"><xref:System.Windows.Controls.Primitives.ButtonBase>, <xref:System.Windows.Controls.MenuItem>, e <xref:System.Windows.Documents.Hyperlink> richiamare un comando quando vengono selezionati e una <xref:System.Windows.Input.InputBinding> richiama un comando quando il <xref:System.Windows.Input.InputGesture> associata viene eseguito.</span><span class="sxs-lookup"><span data-stu-id="25d61-176"><xref:System.Windows.Controls.Primitives.ButtonBase>, <xref:System.Windows.Controls.MenuItem>, and <xref:System.Windows.Documents.Hyperlink> invoke a command when they are clicked, and an <xref:System.Windows.Input.InputBinding> invokes a command when the <xref:System.Windows.Input.InputGesture> associated with it is performed.</span></span>  
  
 <span data-ttu-id="25d61-177">Nell'esempio seguente viene illustrato come utilizzare un <xref:System.Windows.Controls.MenuItem> in un <xref:System.Windows.Controls.ContextMenu> come origine di un comando di <xref:System.Windows.Input.ApplicationCommands.Properties%2A> comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-177">The following example shows how to use a <xref:System.Windows.Controls.MenuItem> in a <xref:System.Windows.Controls.ContextMenu> as a command source for the <xref:System.Windows.Input.ApplicationCommands.Properties%2A> command.</span></span>  
  
 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewCmdSourceXAML](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewcmdsourcexaml)]  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewCmdSource](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcmdsource)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewCmdSource](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcmdsource)]  
  
 <span data-ttu-id="25d61-178">In genere, un comando di origine resterà in ascolto il <xref:System.Windows.Input.RoutedCommand.CanExecuteChanged> evento.</span><span class="sxs-lookup"><span data-stu-id="25d61-178">Typically, a command source will listen to the <xref:System.Windows.Input.RoutedCommand.CanExecuteChanged> event.</span></span>  <span data-ttu-id="25d61-179">Questo evento informa l'origine del comando relativamente alla probabile modifica della capacità del comando di essere eseguito sulla destinazione del comando corrente.</span><span class="sxs-lookup"><span data-stu-id="25d61-179">This event informs the command source that the ability of the command to execute on the current command target may have changed.</span></span>  <span data-ttu-id="25d61-180">L'origine del comando può determinare lo stato corrente del <xref:System.Windows.Input.RoutedCommand> utilizzando il <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> metodo.</span><span class="sxs-lookup"><span data-stu-id="25d61-180">The command source can query the current status of the <xref:System.Windows.Input.RoutedCommand> by using the <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> method.</span></span>  <span data-ttu-id="25d61-181">L'origine comando può quindi disabilitarsi, se l'esecuzione del comando non riesce.</span><span class="sxs-lookup"><span data-stu-id="25d61-181">The command source can then disable itself if the command cannot execute.</span></span>  <span data-ttu-id="25d61-182">Un esempio di questo è un <xref:System.Windows.Controls.MenuItem> colore grigio quando non è possibile eseguire un comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-182">An example of this is a <xref:System.Windows.Controls.MenuItem> graying itself out when a command cannot execute.</span></span>  
  
 <span data-ttu-id="25d61-183">Un <xref:System.Windows.Input.InputGesture> può essere utilizzato come un comando di origine.</span><span class="sxs-lookup"><span data-stu-id="25d61-183">An <xref:System.Windows.Input.InputGesture> can be used as a command source.</span></span>  <span data-ttu-id="25d61-184">Due tipi di movimenti di input in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] sono il <xref:System.Windows.Input.KeyGesture> e <xref:System.Windows.Input.MouseGesture>.</span><span class="sxs-lookup"><span data-stu-id="25d61-184">Two types of input gestures in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are the <xref:System.Windows.Input.KeyGesture> and <xref:System.Windows.Input.MouseGesture>.</span></span>  <span data-ttu-id="25d61-185">È possibile considerare un <xref:System.Windows.Input.KeyGesture> come tasto di scelta rapida, ad esempio CTRL + C.</span><span class="sxs-lookup"><span data-stu-id="25d61-185">You can think of a <xref:System.Windows.Input.KeyGesture> as a keyboard shortcut, such as CTRL+C.</span></span>  <span data-ttu-id="25d61-186">Oggetto <xref:System.Windows.Input.KeyGesture> è costituita da un <xref:System.Windows.Input.Key> e un set di <xref:System.Windows.Input.ModifierKeys>.</span><span class="sxs-lookup"><span data-stu-id="25d61-186">A <xref:System.Windows.Input.KeyGesture> is comprised of a <xref:System.Windows.Input.Key> and a set of <xref:System.Windows.Input.ModifierKeys>.</span></span>  <span data-ttu-id="25d61-187">Oggetto <xref:System.Windows.Input.MouseGesture> è costituita da un <xref:System.Windows.Input.MouseAction> e un insieme facoltativo di <xref:System.Windows.Input.ModifierKeys>.</span><span class="sxs-lookup"><span data-stu-id="25d61-187">A <xref:System.Windows.Input.MouseGesture> is comprised of a <xref:System.Windows.Input.MouseAction> and an optional set of <xref:System.Windows.Input.ModifierKeys>.</span></span>  
  
 <span data-ttu-id="25d61-188">Affinché un <xref:System.Windows.Input.InputGesture> per agire come un comando di origine, deve essere associata a un comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-188">In order for an <xref:System.Windows.Input.InputGesture> to act as a command source, it must be associated with a command.</span></span> <span data-ttu-id="25d61-189">Questa operazione può essere eseguita in diversi modi.</span><span class="sxs-lookup"><span data-stu-id="25d61-189">There are a few ways to accomplish this.</span></span>  <span data-ttu-id="25d61-190">Un modo consiste nell'utilizzare un <xref:System.Windows.Input.InputBinding>.</span><span class="sxs-lookup"><span data-stu-id="25d61-190">One way is to use an <xref:System.Windows.Input.InputBinding>.</span></span>  
  
 <span data-ttu-id="25d61-191">Nell'esempio seguente viene illustrato come creare un <xref:System.Windows.Input.KeyBinding> tra un <xref:System.Windows.Input.KeyGesture> e <xref:System.Windows.Input.RoutedCommand>.</span><span class="sxs-lookup"><span data-stu-id="25d61-191">The following example shows how to create a <xref:System.Windows.Input.KeyBinding> between a <xref:System.Windows.Input.KeyGesture> and a <xref:System.Windows.Input.RoutedCommand>.</span></span>  
  
 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewXAMLKeyBinding](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewxamlkeybinding)]  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewKeyBinding](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewkeybinding)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewKeyBinding](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewkeybinding)]  
  
 <span data-ttu-id="25d61-192">Un altro modo per associare un <xref:System.Windows.Input.InputGesture> per un <xref:System.Windows.Input.RoutedCommand> consiste nell'aggiungere il <xref:System.Windows.Input.InputGesture> per il <xref:System.Windows.Input.InputGestureCollection> sul <xref:System.Windows.Input.RoutedCommand>.</span><span class="sxs-lookup"><span data-stu-id="25d61-192">Another way to associate an <xref:System.Windows.Input.InputGesture> to a <xref:System.Windows.Input.RoutedCommand> is to add the <xref:System.Windows.Input.InputGesture> to the <xref:System.Windows.Input.InputGestureCollection> on the <xref:System.Windows.Input.RoutedCommand>.</span></span>  
  
 <span data-ttu-id="25d61-193">Nell'esempio seguente viene illustrato come aggiungere un <xref:System.Windows.Input.KeyGesture> per il <xref:System.Windows.Input.InputGestureCollection> di un <xref:System.Windows.Input.RoutedCommand>.</span><span class="sxs-lookup"><span data-stu-id="25d61-193">The following example shows how to add a <xref:System.Windows.Input.KeyGesture> to the <xref:System.Windows.Input.InputGestureCollection> of a <xref:System.Windows.Input.RoutedCommand>.</span></span>  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewKeyGestureOnCmd](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewkeygestureoncmd)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewKeyGestureOnCmd](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewkeygestureoncmd)]  
  
<a name="Command_Binding"></a>   
### <a name="commandbinding"></a><span data-ttu-id="25d61-194">CommandBinding</span><span class="sxs-lookup"><span data-stu-id="25d61-194">CommandBinding</span></span>  
 <span data-ttu-id="25d61-195">Oggetto <xref:System.Windows.Input.CommandBinding> associa un comando con i gestori di eventi che implementano il comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-195">A <xref:System.Windows.Input.CommandBinding> associates a command with the event handlers that implement the command.</span></span>  
  
 <span data-ttu-id="25d61-196">Il <xref:System.Windows.Input.CommandBinding> classe contiene un <xref:System.Windows.Input.CommandBinding.Command%2A> , proprietà e <xref:System.Windows.Input.CommandBinding.PreviewExecuted>, <xref:System.Windows.Input.CommandBinding.Executed>, <xref:System.Windows.Input.CommandBinding.PreviewCanExecute>, e <xref:System.Windows.Input.CommandBinding.CanExecute> eventi.</span><span class="sxs-lookup"><span data-stu-id="25d61-196">The <xref:System.Windows.Input.CommandBinding> class contains a <xref:System.Windows.Input.CommandBinding.Command%2A> property, and <xref:System.Windows.Input.CommandBinding.PreviewExecuted>, <xref:System.Windows.Input.CommandBinding.Executed>, <xref:System.Windows.Input.CommandBinding.PreviewCanExecute>, and <xref:System.Windows.Input.CommandBinding.CanExecute> events.</span></span>  
  
 <span data-ttu-id="25d61-197"><xref:System.Windows.Input.CommandBinding.Command%2A>il comando è che il <xref:System.Windows.Input.CommandBinding> è associato.</span><span class="sxs-lookup"><span data-stu-id="25d61-197"><xref:System.Windows.Input.CommandBinding.Command%2A> is the command that the <xref:System.Windows.Input.CommandBinding> is being associated with.</span></span>  <span data-ttu-id="25d61-198">I gestori di eventi associati al <xref:System.Windows.Input.CommandBinding.PreviewExecuted> e <xref:System.Windows.Input.CommandBinding.Executed> eventi implementano la logica di comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-198">The event handlers which are attached to the <xref:System.Windows.Input.CommandBinding.PreviewExecuted> and <xref:System.Windows.Input.CommandBinding.Executed> events implement the command logic.</span></span>  <span data-ttu-id="25d61-199">I gestori eventi associati per il <xref:System.Windows.Input.CommandBinding.PreviewCanExecute> e <xref:System.Windows.Input.CommandBinding.CanExecute> eventi determinano se il comando è possibile eseguire il comando sulla destinazione corrente.</span><span class="sxs-lookup"><span data-stu-id="25d61-199">The event handlers attached to the <xref:System.Windows.Input.CommandBinding.PreviewCanExecute> and <xref:System.Windows.Input.CommandBinding.CanExecute> events determine if the command can execute on the current command target.</span></span>  
  
 <span data-ttu-id="25d61-200">Nell'esempio seguente viene illustrato come creare un <xref:System.Windows.Input.CommandBinding> nella radice <xref:System.Windows.Window> di un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="25d61-200">The following example shows how to create a <xref:System.Windows.Input.CommandBinding> on the root <xref:System.Windows.Window> of an application.</span></span>  <span data-ttu-id="25d61-201">Il <xref:System.Windows.Input.CommandBinding> associa il <xref:System.Windows.Input.ApplicationCommands.Open%2A> con <xref:System.Windows.Input.CommandManager.Executed> e <xref:System.Windows.Input.CommandBinding.CanExecute> gestori.</span><span class="sxs-lookup"><span data-stu-id="25d61-201">The <xref:System.Windows.Input.CommandBinding> associates the <xref:System.Windows.Input.ApplicationCommands.Open%2A> command with <xref:System.Windows.Input.CommandManager.Executed> and <xref:System.Windows.Input.CommandBinding.CanExecute> handlers.</span></span>  
  
 [!code-xaml[commandwithhandler#CommandHandlerCommandBinding](../../../../samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml#commandhandlercommandbinding)]  
  
 [!code-csharp[CommandHandlerProcedural#CommandHandlerBindingInit](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandHandlerProcedural/CSharp/Window1.xaml.cs#commandhandlerbindinginit)]
 [!code-vb[CommandHandlerProcedural#CommandHandlerBindingInit](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandHandlerProcedural/visualbasic/window1.xaml.vb#commandhandlerbindinginit)]  
  
 <span data-ttu-id="25d61-202">Successivamente, il <xref:System.Windows.Input.ExecutedRoutedEventHandler> e <xref:System.Windows.Input.CanExecuteRoutedEventHandler> vengono creati.</span><span class="sxs-lookup"><span data-stu-id="25d61-202">Next, the <xref:System.Windows.Input.ExecutedRoutedEventHandler> and a <xref:System.Windows.Input.CanExecuteRoutedEventHandler> are created.</span></span>  <span data-ttu-id="25d61-203">Il <xref:System.Windows.Input.ExecutedRoutedEventHandler> apre un <xref:System.Windows.MessageBox> che viene visualizzata una stringa indicante che è stato eseguito il comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-203">The <xref:System.Windows.Input.ExecutedRoutedEventHandler> opens a <xref:System.Windows.MessageBox> that displays a string saying the command has been executed.</span></span>  <span data-ttu-id="25d61-204">Il <xref:System.Windows.Input.CanExecuteRoutedEventHandler> imposta il <xref:System.Windows.Input.CanExecuteRoutedEventArgs.CanExecute%2A> proprietà `true`.</span><span class="sxs-lookup"><span data-stu-id="25d61-204">The <xref:System.Windows.Input.CanExecuteRoutedEventHandler> sets the <xref:System.Windows.Input.CanExecuteRoutedEventArgs.CanExecute%2A> property to `true`.</span></span>  
  
 [!code-csharp[commandwithhandler#CommandHandlerExecutedHandler](../../../../samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml.cs#commandhandlerexecutedhandler)]
 [!code-vb[commandwithhandler#CommandHandlerExecutedHandler](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/commandWithHandler/VisualBasic/Window1.xaml.vb#commandhandlerexecutedhandler)]  
  
 [!code-csharp[commandwithhandler#CommandHandlerCanExecuteHandler](../../../../samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml.cs#commandhandlercanexecutehandler)]
 [!code-vb[commandwithhandler#CommandHandlerCanExecuteHandler](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/commandWithHandler/VisualBasic/Window1.xaml.vb#commandhandlercanexecutehandler)]  
  
 <span data-ttu-id="25d61-205">Oggetto <xref:System.Windows.Input.CommandBinding> è collegato a un oggetto specifico, come la radice <xref:System.Windows.Window> dell'applicazione o di un controllo.</span><span class="sxs-lookup"><span data-stu-id="25d61-205">A <xref:System.Windows.Input.CommandBinding> is attached to a specific object, such as the root <xref:System.Windows.Window> of the application or a control.</span></span>  <span data-ttu-id="25d61-206">L'oggetto che il <xref:System.Windows.Input.CommandBinding> è collegato a definisce l'ambito dell'associazione.</span><span class="sxs-lookup"><span data-stu-id="25d61-206">The object that the <xref:System.Windows.Input.CommandBinding> is attached to defines the scope of the binding.</span></span>  <span data-ttu-id="25d61-207">Ad esempio, un <xref:System.Windows.Input.CommandBinding> associata a un predecessore del comando di destinazione può essere raggiunto dal <xref:System.Windows.Input.CommandBinding.Executed> evento, ma un <xref:System.Windows.Input.CommandBinding> associata a un discendente del comando di destinazione non può essere raggiunto.</span><span class="sxs-lookup"><span data-stu-id="25d61-207">For example, a <xref:System.Windows.Input.CommandBinding> attached to an ancestor of the command target can be reached by the <xref:System.Windows.Input.CommandBinding.Executed> event, but a <xref:System.Windows.Input.CommandBinding> attached to a descendant of the command target cannot be reached.</span></span>  <span data-ttu-id="25d61-208">Si tratta di una conseguenza diretta del modo in cui un <xref:System.Windows.RoutedEvent> tunnel e bolle dall'oggetto che genera l'evento.</span><span class="sxs-lookup"><span data-stu-id="25d61-208">This is a direct consequence of the way a <xref:System.Windows.RoutedEvent> tunnels and bubbles from the object that raises the event.</span></span>  
  
 <span data-ttu-id="25d61-209">In alcune situazioni il <xref:System.Windows.Input.CommandBinding> associato alla destinazione del comando, ad esempio con il <xref:System.Windows.Controls.TextBox> classe e <xref:System.Windows.Input.ApplicationCommands.Cut%2A>, <xref:System.Windows.Input.ApplicationCommands.Copy%2A>, e <xref:System.Windows.Input.ApplicationCommands.Paste%2A> comandi.</span><span class="sxs-lookup"><span data-stu-id="25d61-209">In some situations the <xref:System.Windows.Input.CommandBinding> is attached to the command target itself, such as with the <xref:System.Windows.Controls.TextBox> class and the <xref:System.Windows.Input.ApplicationCommands.Cut%2A>, <xref:System.Windows.Input.ApplicationCommands.Copy%2A>, and <xref:System.Windows.Input.ApplicationCommands.Paste%2A> commands.</span></span> <span data-ttu-id="25d61-210">Tuttavia, spesso è più conveniente collegare il <xref:System.Windows.Input.CommandBinding> a un predecessore della destinazione del comando, ad esempio principale <xref:System.Windows.Window> oppure l'oggetto di applicazione, soprattutto se lo stesso <xref:System.Windows.Input.CommandBinding> può essere utilizzato per più destinazioni comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-210">Quite often though, it is more convenient to attach the <xref:System.Windows.Input.CommandBinding> to an ancestor of the command target, such as the main <xref:System.Windows.Window> or the Application object, especially if the same <xref:System.Windows.Input.CommandBinding> can be used for multiple command targets.</span></span>  <span data-ttu-id="25d61-211">Si tratta di decisioni di progettazione di cui tenere conto quando si crea l'infrastruttura di esecuzione dei comandi.</span><span class="sxs-lookup"><span data-stu-id="25d61-211">These are design decisions you will want to consider when you are creating your commanding infrastructure.</span></span>  
  
<a name="Commane_Target"></a>   
### <a name="command-target"></a><span data-ttu-id="25d61-212">Destinazione del comando</span><span class="sxs-lookup"><span data-stu-id="25d61-212">Command Target</span></span>  
 <span data-ttu-id="25d61-213">La destinazione del comando è l'elemento su cui viene eseguito il comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-213">The command target is the element on which the command is executed.</span></span>  <span data-ttu-id="25d61-214">Per quanto riguarda un <xref:System.Windows.Input.RoutedCommand>, la destinazione del comando è l'elemento in corrispondenza di cui il routing di <xref:System.Windows.Input.CommandManager.Executed> e <xref:System.Windows.Input.CommandManager.CanExecute> Avvia.</span><span class="sxs-lookup"><span data-stu-id="25d61-214">With regards to a <xref:System.Windows.Input.RoutedCommand>, the command target is the element at which routing of the <xref:System.Windows.Input.CommandManager.Executed> and <xref:System.Windows.Input.CommandManager.CanExecute> starts.</span></span>  <span data-ttu-id="25d61-215">Come indicato in precedenza, in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] il <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> proprietà <xref:System.Windows.Input.ICommandSource> è applicabile solo quando il <xref:System.Windows.Input.ICommand> è un <xref:System.Windows.Input.RoutedCommand>.</span><span class="sxs-lookup"><span data-stu-id="25d61-215">As noted previously, in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> property on <xref:System.Windows.Input.ICommandSource> is only applicable when the <xref:System.Windows.Input.ICommand> is a <xref:System.Windows.Input.RoutedCommand>.</span></span>  <span data-ttu-id="25d61-216">Se il <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> è impostata su un <xref:System.Windows.Input.ICommandSource> e il comando corrispondente non è un <xref:System.Windows.Input.RoutedCommand>, la destinazione del comando viene ignorata.</span><span class="sxs-lookup"><span data-stu-id="25d61-216">If the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is set on an <xref:System.Windows.Input.ICommandSource> and the corresponding command is not a <xref:System.Windows.Input.RoutedCommand>, the command target is ignored.</span></span>  
  
 <span data-ttu-id="25d61-217">L'origine del comando può impostare in modo esplicito la destinazione del comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-217">The command source can explicitly set the command target.</span></span>  <span data-ttu-id="25d61-218">Se la destinazione del comando non viene definita, l'elemento con lo stato attivo verrà usato come destinazione del comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-218">If the command target is not defined, the element with keyboard focus will be used as the command target.</span></span>  <span data-ttu-id="25d61-219">Uno dei vantaggi dell'uso dell'elemento con lo stato attivo come destinazione del comando consiste nel fatto che consente allo sviluppatore di applicazioni di usare la stessa origine del comando per richiamare un comando su più destinazioni senza tenere traccia della destinazione del comando.</span><span class="sxs-lookup"><span data-stu-id="25d61-219">One of the benefits of using the element with keyboard focus as the command target is that it allows the application developer to use the same command source to invoke a command on multiple targets without having to keep track of the command target.</span></span>  <span data-ttu-id="25d61-220">Ad esempio, se un <xref:System.Windows.Controls.MenuItem> richiama il **Incolla** comando in un'applicazione che ha un <xref:System.Windows.Controls.TextBox> controllo e un <xref:System.Windows.Controls.PasswordBox> (controllo), la destinazione può essere il <xref:System.Windows.Controls.TextBox> o <xref:System.Windows.Controls.PasswordBox> a seconda di quale controllo con lo stato attivo.</span><span class="sxs-lookup"><span data-stu-id="25d61-220">For example, if a <xref:System.Windows.Controls.MenuItem> invokes the **Paste** command in an application that has a <xref:System.Windows.Controls.TextBox> control and a <xref:System.Windows.Controls.PasswordBox> control, the target can be either the <xref:System.Windows.Controls.TextBox> or <xref:System.Windows.Controls.PasswordBox> depending on which control has keyboard focus.</span></span>  
  
 <span data-ttu-id="25d61-221">L'esempio seguente mostra come impostare in modo esplicito la destinazione del comando nel markup e nel code-behind.</span><span class="sxs-lookup"><span data-stu-id="25d61-221">The following example shows how to explicitly set the command target in markup and in code behind.</span></span>  
  
 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewXAMLCommandTarget](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewxamlcommandtarget)]  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcommandtargetcodebehind)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcommandtargetcodebehind)]  
  
<a name="Command_Manager"></a>   
### <a name="the-commandmanager"></a><span data-ttu-id="25d61-222">CommandManager</span><span class="sxs-lookup"><span data-stu-id="25d61-222">The CommandManager</span></span>  
 <span data-ttu-id="25d61-223">Il <xref:System.Windows.Input.CommandManager> funge da un numero di comandi funzioni correlate.</span><span class="sxs-lookup"><span data-stu-id="25d61-223">The <xref:System.Windows.Input.CommandManager> serves a number of command related functions.</span></span>  <span data-ttu-id="25d61-224">Fornisce un set di metodi statici per l'aggiunta e rimozione di <xref:System.Windows.Input.CommandManager.PreviewExecuted>, <xref:System.Windows.Input.CommandManager.Executed>, <xref:System.Windows.Input.CommandManager.PreviewCanExecute>, e <xref:System.Windows.Input.CommandManager.CanExecute> gestori di eventi da e verso un elemento specifico.</span><span class="sxs-lookup"><span data-stu-id="25d61-224">It provides a set of static methods for adding and removing <xref:System.Windows.Input.CommandManager.PreviewExecuted>, <xref:System.Windows.Input.CommandManager.Executed>, <xref:System.Windows.Input.CommandManager.PreviewCanExecute>, and <xref:System.Windows.Input.CommandManager.CanExecute> event handlers to and from a specific element.</span></span>  <span data-ttu-id="25d61-225">Fornisce un modo per registrare <xref:System.Windows.Input.CommandBinding> e <xref:System.Windows.Input.InputBinding> gli oggetti in una classe specifica.</span><span class="sxs-lookup"><span data-stu-id="25d61-225">It provides a means to register <xref:System.Windows.Input.CommandBinding> and <xref:System.Windows.Input.InputBinding> objects onto a specific class.</span></span>  <span data-ttu-id="25d61-226">Il <xref:System.Windows.Input.CommandManager> fornisce inoltre un modo, tramite il <xref:System.Windows.Input.CommandManager.RequerySuggested> evento per notificare a un comando quando deve essere generato il <xref:System.Windows.Input.ICommand.CanExecuteChanged> evento.</span><span class="sxs-lookup"><span data-stu-id="25d61-226">The <xref:System.Windows.Input.CommandManager> also provides a means, through the <xref:System.Windows.Input.CommandManager.RequerySuggested> event, to notify a command when it should raise the <xref:System.Windows.Input.ICommand.CanExecuteChanged> event.</span></span>  
  
 <span data-ttu-id="25d61-227">Il <xref:System.Windows.Input.CommandManager.InvalidateRequerySuggested%2A> metodo forza il <xref:System.Windows.Input.CommandManager> per generare il <xref:System.Windows.Input.CommandManager.RequerySuggested> evento.</span><span class="sxs-lookup"><span data-stu-id="25d61-227">The <xref:System.Windows.Input.CommandManager.InvalidateRequerySuggested%2A> method forces the <xref:System.Windows.Input.CommandManager> to raise the <xref:System.Windows.Input.CommandManager.RequerySuggested> event.</span></span>  <span data-ttu-id="25d61-228">Ciò è utile per le condizioni che devono disattivare o attivare un comando ma che non sono condizioni che il <xref:System.Windows.Input.CommandManager> è a conoscenza di.</span><span class="sxs-lookup"><span data-stu-id="25d61-228">This is useful for conditions that should disable/enable a command but are not conditions that the <xref:System.Windows.Input.CommandManager> is aware of.</span></span>  
  
<a name="Command_Library"></a>   
## <a name="command-library"></a><span data-ttu-id="25d61-229">Libreria dei comandi</span><span class="sxs-lookup"><span data-stu-id="25d61-229">Command Library</span></span>  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="25d61-230"> offre un set di comandi predefiniti.</span><span class="sxs-lookup"><span data-stu-id="25d61-230"> provides a set of predefined commands.</span></span>  <span data-ttu-id="25d61-231">Libreria del comando include le classi seguenti: <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.NavigationCommands>, <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Documents.EditingCommands>e <xref:System.Windows.Input.ComponentCommands>.</span><span class="sxs-lookup"><span data-stu-id="25d61-231">The command library consists of the following classes: <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.NavigationCommands>, <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Documents.EditingCommands>, and the <xref:System.Windows.Input.ComponentCommands>.</span></span>  <span data-ttu-id="25d61-232">Queste classi forniscono comandi, ad esempio <xref:System.Windows.Input.ApplicationCommands.Cut%2A>, <xref:System.Windows.Input.NavigationCommands.BrowseBack%2A> e <xref:System.Windows.Input.NavigationCommands.BrowseForward%2A>, <xref:System.Windows.Input.MediaCommands.Play%2A>, <xref:System.Windows.Input.MediaCommands.Stop%2A>, e <xref:System.Windows.Input.MediaCommands.Pause%2A>.</span><span class="sxs-lookup"><span data-stu-id="25d61-232">These classes provide commands such as <xref:System.Windows.Input.ApplicationCommands.Cut%2A>, <xref:System.Windows.Input.NavigationCommands.BrowseBack%2A> and <xref:System.Windows.Input.NavigationCommands.BrowseForward%2A>, <xref:System.Windows.Input.MediaCommands.Play%2A>, <xref:System.Windows.Input.MediaCommands.Stop%2A>, and <xref:System.Windows.Input.MediaCommands.Pause%2A>.</span></span>  
  
 <span data-ttu-id="25d61-233">Molti di questi comandi includono un set di associazioni di input predefinite.</span><span class="sxs-lookup"><span data-stu-id="25d61-233">Many of these commands include a set of default input bindings.</span></span>  <span data-ttu-id="25d61-234">Se, ad esempio, si specifica che l'applicazione gestisce il comando di copia, si ottiene automaticamente l'associazione di tastiera "CTRL+C". Si ottengono anche associazioni per altri dispositivi di input, quali i movimenti della penna [!INCLUDE[TLA2#tla_tpc](../../../../includes/tla2sharptla-tpc-md.md)] e informazioni sulle funzioni vocali.</span><span class="sxs-lookup"><span data-stu-id="25d61-234">For example, if you specify that your application handles the copy command, you automatically get the keyboard binding "CTRL+C" You also get bindings for other input devices, such as [!INCLUDE[TLA2#tla_tpc](../../../../includes/tla2sharptla-tpc-md.md)] pen gestures and speech information.</span></span>  
  
 <span data-ttu-id="25d61-235">Quando si fa riferimento ai comandi delle diverse librerie dei comandi usando [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], in genere è possibile omettere il nome della classe di libreria che espone la proprietà del comando statico.</span><span class="sxs-lookup"><span data-stu-id="25d61-235">When you reference commands in the various command libraries using [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], you can usually omit the class name of the library class that exposes the static command property.</span></span> <span data-ttu-id="25d61-236">Di solito i nomi dei comandi sono stringhe non ambigue ed esistono tipi proprietari che forniscono un raggruppamento logico di comandi, ma che non sono necessari per la risoluzione dell'ambiguità.</span><span class="sxs-lookup"><span data-stu-id="25d61-236">Generally, the command names are unambiguous as strings, and the owning types exist to provide a logical grouping of commands but are not necessary for disambiguation.</span></span> <span data-ttu-id="25d61-237">Ad esempio, è possibile specificare `Command="Cut"` anziché il più dettagliato `Command="ApplicationCommands.Cut"`.</span><span class="sxs-lookup"><span data-stu-id="25d61-237">For instance, you can specify `Command="Cut"` rather than the more verbose `Command="ApplicationCommands.Cut"`.</span></span> <span data-ttu-id="25d61-238">Si tratta di un meccanismo utile integrato nel [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processore per i comandi (più precisamente, è un comportamento del convertitore di tipi di <xref:System.Windows.Input.ICommand>, quali il [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] riferimenti processore in fase di caricamento).</span><span class="sxs-lookup"><span data-stu-id="25d61-238">This is a convenience mechanism that is built in to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processor for commands (more precisely, it is a type converter behavior of <xref:System.Windows.Input.ICommand>, which the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processor references at load time).</span></span>  
  
<a name="creating_commands"></a>   
## <a name="creating-custom-commands"></a><span data-ttu-id="25d61-239">Creazione di comandi personalizzati</span><span class="sxs-lookup"><span data-stu-id="25d61-239">Creating Custom Commands</span></span>  
 <span data-ttu-id="25d61-240">Se i comandi delle classi della libreria dei comandi non soddisfano le proprie esigenze, è possibile creare comandi personalizzati.</span><span class="sxs-lookup"><span data-stu-id="25d61-240">If the commands in the command library classes do not meet your needs, then you can create your own commands.</span></span>  <span data-ttu-id="25d61-241">Questa operazione può essere eseguita in due modi.</span><span class="sxs-lookup"><span data-stu-id="25d61-241">There are two ways to create a custom command.</span></span>  <span data-ttu-id="25d61-242">Il primo è da zero e l'implementazione di <xref:System.Windows.Input.ICommand> interfaccia.</span><span class="sxs-lookup"><span data-stu-id="25d61-242">The first is to start from the ground up and implement the <xref:System.Windows.Input.ICommand> interface.</span></span>  <span data-ttu-id="25d61-243">Viceversa e l'approccio più comune consiste nel creare un <xref:System.Windows.Input.RoutedCommand> o <xref:System.Windows.Input.RoutedUICommand>.</span><span class="sxs-lookup"><span data-stu-id="25d61-243">The other way, and the more common approach, is to create a <xref:System.Windows.Input.RoutedCommand> or a <xref:System.Windows.Input.RoutedUICommand>.</span></span>  
  
 <span data-ttu-id="25d61-244">Per un esempio di creazione di un oggetto personalizzato <xref:System.Windows.Input.RoutedCommand>, vedere [creare un esempio di RoutedCommand personalizzato](http://go.microsoft.com/fwlink/?LinkID=159980).</span><span class="sxs-lookup"><span data-stu-id="25d61-244">For an example of creating a custom <xref:System.Windows.Input.RoutedCommand>, see [Create a Custom RoutedCommand Sample](http://go.microsoft.com/fwlink/?LinkID=159980).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="25d61-245">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="25d61-245">See Also</span></span>  
 <xref:System.Windows.Input.RoutedCommand>  
 <xref:System.Windows.Input.CommandBinding>  
 <xref:System.Windows.Input.InputBinding>  
 <xref:System.Windows.Input.CommandManager>  
 [<span data-ttu-id="25d61-246">Cenni preliminari sull'input</span><span class="sxs-lookup"><span data-stu-id="25d61-246">Input Overview</span></span>](../../../../docs/framework/wpf/advanced/input-overview.md)  
 [<span data-ttu-id="25d61-247">Cenni preliminari sugli eventi indirizzati</span><span class="sxs-lookup"><span data-stu-id="25d61-247">Routed Events Overview</span></span>](../../../../docs/framework/wpf/advanced/routed-events-overview.md)  
 [<span data-ttu-id="25d61-248">Implementare ICommandSource</span><span class="sxs-lookup"><span data-stu-id="25d61-248">Implement ICommandSource</span></span>](../../../../docs/framework/wpf/advanced/how-to-implement-icommandsource.md)  
 [<span data-ttu-id="25d61-249">How to: Add a Command to a MenuItem (Procedura: Aggiungere un comando a un MenuItem)</span><span class="sxs-lookup"><span data-stu-id="25d61-249">How to: Add a Command to a MenuItem</span></span>](http://msdn.microsoft.com/en-us/013d68a0-5373-4a68-bd91-5de574307370)  
 [<span data-ttu-id="25d61-250">Create a Custom RoutedCommand Sample (Creare un esempio di oggetto RoutedCommand personalizzato)</span><span class="sxs-lookup"><span data-stu-id="25d61-250">Create a Custom RoutedCommand Sample</span></span>](http://go.microsoft.com/fwlink/?LinkID=159980)
