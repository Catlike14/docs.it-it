---
title: "Procedura: individuare se è possibile eseguire o meno un processo di stampa all'orario indicato"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-wpf
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- print queues [WPF], timing
- printers [WPF], availability
- print jobs [WPF], timing
ms.assetid: 7e9c8ec1-abf6-4b3d-b1c6-33b35d3c4063
caps.latest.revision: "9"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 9ac89b8dce67c95c78a5dd46e591d84730a68346
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 11/21/2017
---
# <a name="how-to-discover-whether-a-print-job-can-be-printed-at-this-time-of-day"></a><span data-ttu-id="02a3f-102">Procedura: individuare se è possibile eseguire o meno un processo di stampa all'orario indicato</span><span class="sxs-lookup"><span data-stu-id="02a3f-102">How to: Discover Whether a Print Job Can Be Printed At This Time of Day</span></span>
<span data-ttu-id="02a3f-103">Code di stampa non sono sempre disponibili per 24 ore al giorno.</span><span class="sxs-lookup"><span data-stu-id="02a3f-103">Print queues are not always available for 24 hours a day.</span></span> <span data-ttu-id="02a3f-104">Hanno proprietà ora di inizio e fine che è possibile impostare per renderli disponibili in determinati orari del giorno.</span><span class="sxs-lookup"><span data-stu-id="02a3f-104">They have start and end time properties that can be set to make them unavailable at certain times of day.</span></span> <span data-ttu-id="02a3f-105">Questa funzionalità è utilizzabile, ad esempio, per riservare una stampante per l'utilizzo esclusivo di un determinato reparto dopo le 17.00.</span><span class="sxs-lookup"><span data-stu-id="02a3f-105">This feature can be used, for example, to reserve a printer for the exclusive use of a certain department after 5 P.M..</span></span> <span data-ttu-id="02a3f-106">Tale reparto avrebbe una coda diversa per la manutenzione della stampante di altri reparti utilizzare.</span><span class="sxs-lookup"><span data-stu-id="02a3f-106">That department would have a different queue servicing the printer than other departments use.</span></span> <span data-ttu-id="02a3f-107">La coda per gli altri reparti verrebbe impostata per essere disponibile dopo le 17.00, mentre coda quella per il reparto può essere impostata per essere sempre disponibile.</span><span class="sxs-lookup"><span data-stu-id="02a3f-107">The queue for the other departments would be set to be unavailable after 5 P.M., while queue for the favored department could be set to be available at all times.</span></span>  
  
 <span data-ttu-id="02a3f-108">Inoltre, è possono impostare i processi di stampa se stessi come printable solo all'interno di un intervallo di tempo specificato.</span><span class="sxs-lookup"><span data-stu-id="02a3f-108">Moreover, print jobs themselves can be set to be printable only within a specified span of time.</span></span>  
  
 <span data-ttu-id="02a3f-109">Il <xref:System.Printing.PrintQueue> e <xref:System.Printing.PrintSystemJobInfo> classi esposti nel [!INCLUDE[TLA#tla_api#plural](../../../../includes/tlasharptla-apisharpplural-md.md)] di [!INCLUDE[TLA#tla_winfx](../../../../includes/tlasharptla-winfx-md.md)] consentono di controllare in remoto se un determinato processo di stampa è possibile stampare su una determinata coda al momento corrente.</span><span class="sxs-lookup"><span data-stu-id="02a3f-109">The <xref:System.Printing.PrintQueue> and <xref:System.Printing.PrintSystemJobInfo> classes exposed in the [!INCLUDE[TLA#tla_api#plural](../../../../includes/tlasharptla-apisharpplural-md.md)] of [!INCLUDE[TLA#tla_winfx](../../../../includes/tlasharptla-winfx-md.md)] provide a means for remotely checking whether a given print job can print on a given queue at the current time.</span></span>  
  
## <a name="example"></a><span data-ttu-id="02a3f-110">Esempio</span><span class="sxs-lookup"><span data-stu-id="02a3f-110">Example</span></span>  
 <span data-ttu-id="02a3f-111">Nell'esempio riportato di seguito è riportato un esempio che è possibile diagnosticare i problemi di un processo di stampa.</span><span class="sxs-lookup"><span data-stu-id="02a3f-111">The example below is a sample that can diagnose problems with a print job.</span></span>  
  
 <span data-ttu-id="02a3f-112">Esistono due passaggi principali per questo tipo di funzione come indicato di seguito.</span><span class="sxs-lookup"><span data-stu-id="02a3f-112">There are two major steps for this kind of function as follows.</span></span>  
  
1.  <span data-ttu-id="02a3f-113">Lettura di <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> e <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> le proprietà del <xref:System.Printing.PrintQueue> per determinare se l'ora corrente è tra di essi.</span><span class="sxs-lookup"><span data-stu-id="02a3f-113">Read the <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> and <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> properties of the <xref:System.Printing.PrintQueue> to determine whether the current time is between them.</span></span>  
  
2.  <span data-ttu-id="02a3f-114">Lettura di <xref:System.Printing.PrintSystemJobInfo.StartTimeOfDay%2A> e <xref:System.Printing.PrintSystemJobInfo.UntilTimeOfDay%2A> le proprietà del <xref:System.Printing.PrintSystemJobInfo> per determinare se l'ora corrente è tra di essi.</span><span class="sxs-lookup"><span data-stu-id="02a3f-114">Read the <xref:System.Printing.PrintSystemJobInfo.StartTimeOfDay%2A> and <xref:System.Printing.PrintSystemJobInfo.UntilTimeOfDay%2A> properties of the <xref:System.Printing.PrintSystemJobInfo> to determine whether the current time is between them.</span></span>  
  
 <span data-ttu-id="02a3f-115">Tuttavia verificano complicazioni dal fatto che queste proprietà non sono <xref:System.DateTime> oggetti.</span><span class="sxs-lookup"><span data-stu-id="02a3f-115">But complications arise from the fact that these properties are not <xref:System.DateTime> objects.</span></span> <span data-ttu-id="02a3f-116">Sono invece <xref:System.Int32> oggetti che esprimono l'ora del giorno come il numero di minuti trascorsi dalla mezzanotte.</span><span class="sxs-lookup"><span data-stu-id="02a3f-116">Instead they are <xref:System.Int32> objects that express the time of day as the number of minutes since midnight.</span></span> <span data-ttu-id="02a3f-117">Inoltre, non si tratta mezzanotte nel fuso orario corrente, ma la mezzanotte ora UTC (Coordinated Universal Time).</span><span class="sxs-lookup"><span data-stu-id="02a3f-117">Moreover, this is not midnight in the current time zone, but midnight UTC (Coordinated Universal Time).</span></span>  
  
 <span data-ttu-id="02a3f-118">Il primo esempio di codice presenta il metodo statico **ReportQueueAndJobAvailability**, che viene passato un <xref:System.Printing.PrintSystemJobInfo> e chiama i metodi helper per determinare se il processo può essere stampato all'ora corrente e, se non, quando è possibile stampare.</span><span class="sxs-lookup"><span data-stu-id="02a3f-118">The first code example presents the static method **ReportQueueAndJobAvailability**, which is passed a <xref:System.Printing.PrintSystemJobInfo> and calls helper methods to determine whether the job can print at the current time and, if not, when it can print.</span></span> <span data-ttu-id="02a3f-119">Si noti che un <xref:System.Printing.PrintQueue> non viene passato al metodo.</span><span class="sxs-lookup"><span data-stu-id="02a3f-119">Notice that a <xref:System.Printing.PrintQueue> is not passed to the method.</span></span> <span data-ttu-id="02a3f-120">In questo modo il <xref:System.Printing.PrintSystemJobInfo> include un riferimento alla coda nel relativo <xref:System.Printing.PrintSystemJobInfo.HostingPrintQueue%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="02a3f-120">This is because the <xref:System.Printing.PrintSystemJobInfo> includes a reference to the queue in its <xref:System.Printing.PrintSystemJobInfo.HostingPrintQueue%2A> property.</span></span>  
  
 <span data-ttu-id="02a3f-121">I metodi subordinati includono il metodo di overload **ReportAvailabilityAtThisTime** metodo che può accettare un <xref:System.Printing.PrintQueue> o <xref:System.Printing.PrintSystemJobInfo> come parametro.</span><span class="sxs-lookup"><span data-stu-id="02a3f-121">The subordinate methods include the overloaded **ReportAvailabilityAtThisTime** method which can take either a <xref:System.Printing.PrintQueue> or a <xref:System.Printing.PrintSystemJobInfo> as a parameter.</span></span> <span data-ttu-id="02a3f-122">È inoltre disponibile un **TimeConverter**.</span><span class="sxs-lookup"><span data-stu-id="02a3f-122">There is also a **TimeConverter.ConvertToLocalHumanReadableTime**.</span></span> <span data-ttu-id="02a3f-123">Tutti questi metodi sono descritti di seguito.</span><span class="sxs-lookup"><span data-stu-id="02a3f-123">All of these methods are discussed below.</span></span>  
  
 <span data-ttu-id="02a3f-124">Il **ReportQueueAndJobAvailability** metodo inizia con un controllo per verificare se la coda o il processo di stampa non è disponibile in questo momento.</span><span class="sxs-lookup"><span data-stu-id="02a3f-124">The **ReportQueueAndJobAvailability** method begins by checking to see if either the queue or the print job is unavailable at this time.</span></span> <span data-ttu-id="02a3f-125">Se nessuno dei due non è disponibile, viene quindi verificato se la coda non disponibile.</span><span class="sxs-lookup"><span data-stu-id="02a3f-125">If either of them is unavailable, it then checks to see if the queue unavailable.</span></span> <span data-ttu-id="02a3f-126">Se non è disponibile, il metodo segnala tale situazione e il tempo quando la coda sarà nuovamente disponibile.</span><span class="sxs-lookup"><span data-stu-id="02a3f-126">If it is not available, then the method reports this fact and the time when the queue will become available again.</span></span> <span data-ttu-id="02a3f-127">Verifica quindi il processo e se non è disponibile, viene segnalato al successivo quando span quando è possibile stampare.</span><span class="sxs-lookup"><span data-stu-id="02a3f-127">It then checks the job and if it is unavailable, it reports the next time span when it when it can print.</span></span> <span data-ttu-id="02a3f-128">Infine, il metodo segnala l'ora meno recente quando il processo è possibile stampare.</span><span class="sxs-lookup"><span data-stu-id="02a3f-128">Finally, the method reports the earliest time when the job can print.</span></span> <span data-ttu-id="02a3f-129">Si tratta della seconda dei seguenti due volte.</span><span class="sxs-lookup"><span data-stu-id="02a3f-129">This is the later of following two times.</span></span>  
  
-   <span data-ttu-id="02a3f-130">Ora quando la coda di stampa è successivamente disponibile.</span><span class="sxs-lookup"><span data-stu-id="02a3f-130">The time when the print queue is next available.</span></span>  
  
-   <span data-ttu-id="02a3f-131">Ora quando il processo di stampa è disponibile.</span><span class="sxs-lookup"><span data-stu-id="02a3f-131">The time when the print job is next available.</span></span>  
  
 <span data-ttu-id="02a3f-132">Quando si segnalano ore del giorno, il <xref:System.DateTime.ToShortTimeString%2A> metodo viene chiamato anche il metodo che elimina l'anni, mesi e giorni dall'output.</span><span class="sxs-lookup"><span data-stu-id="02a3f-132">When reporting times of day, the <xref:System.DateTime.ToShortTimeString%2A> method is also called because this method suppresses the years, months, and days from the output.</span></span> <span data-ttu-id="02a3f-133">In particolari anni, mesi o giorni, è possibile limitare la disponibilità di una coda di stampa o un processo di stampa.</span><span class="sxs-lookup"><span data-stu-id="02a3f-133">You cannot restrict the availability of either a print queue or a print job to particular years, months, or days.</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#ReportQueueAndJobAvailability](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#reportqueueandjobavailability)]
 [!code-csharp[DiagnoseProblematicPrintJob#ReportQueueAndJobAvailability](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#reportqueueandjobavailability)]
 [!code-vb[DiagnoseProblematicPrintJob#ReportQueueAndJobAvailability](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#reportqueueandjobavailability)]  
  
 <span data-ttu-id="02a3f-134">I due overload del **ReportAvailabilityAtThisTime** metodo sono identiche ad eccezione del tipo passato a essi in modo che solo il <xref:System.Printing.PrintQueue> versione viene presentata di seguito.</span><span class="sxs-lookup"><span data-stu-id="02a3f-134">The two overloads of the **ReportAvailabilityAtThisTime** method are identical except for the type passed to them, so only the <xref:System.Printing.PrintQueue> version is presented below.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="02a3f-135">Il fatto che i metodi sono identici ad eccezione di tipo genera alla domanda perché il codice di esempio non crea un metodo generico **ReportAvailabilityAtThisTime\<T >**.</span><span class="sxs-lookup"><span data-stu-id="02a3f-135">The fact that the methods are identical except for type raises the question of why the sample does not create a generic method **ReportAvailabilityAtThisTime\<T>**.</span></span> <span data-ttu-id="02a3f-136">Il motivo è che tale metodo deve essere limitato a una classe che ha il **StartTimeOfDay** e **UntilTimeOfDay** proprietà che chiama il metodo, ma un metodo generico può essere limitato a un singola classe e l'unica classe comune a entrambi <xref:System.Printing.PrintQueue> e <xref:System.Printing.PrintSystemJobInfo> nell'ereditarietà a struttura ad albero è <xref:System.Printing.PrintSystemObject> che non dispone di tali proprietà.</span><span class="sxs-lookup"><span data-stu-id="02a3f-136">The reason is that such a method would have to be restricted to a class that has the **StartTimeOfDay** and **UntilTimeOfDay** properties that the method calls, but a generic method can only be restricted to a single class and the only class common to both <xref:System.Printing.PrintQueue> and <xref:System.Printing.PrintSystemJobInfo> in the inheritance tree is <xref:System.Printing.PrintSystemObject> which has no such properties.</span></span>  
  
 <span data-ttu-id="02a3f-137">Il **ReportAvailabilityAtThisTime** metodo, come illustrato nell'esempio di codice riportato di seguito, avvia l'inizializzazione di un <xref:System.Boolean> variabile sentinel per `true`.</span><span class="sxs-lookup"><span data-stu-id="02a3f-137">The **ReportAvailabilityAtThisTime** method (presented in the code example below) begins by initializing a <xref:System.Boolean> sentinel variable to `true`.</span></span> <span data-ttu-id="02a3f-138">Verranno ripristinata `false`, se la coda non è disponibile.</span><span class="sxs-lookup"><span data-stu-id="02a3f-138">It will be reset to `false`, if the queue is not available.</span></span>  
  
 <span data-ttu-id="02a3f-139">Successivamente, il metodo controlla se l'inizio e "fino a quando non" volte identico.</span><span class="sxs-lookup"><span data-stu-id="02a3f-139">Next, the method checks to see if the start and "until" times are identical.</span></span> <span data-ttu-id="02a3f-140">In tal caso, la coda è sempre disponibile, il metodo restituisce `true`.</span><span class="sxs-lookup"><span data-stu-id="02a3f-140">If they are, the queue is always available, so the method returns `true`.</span></span>  
  
 <span data-ttu-id="02a3f-141">Se la coda non è disponibile tutto il tempo, il metodo utilizza il metodo statico <xref:System.DateTime.UtcNow%2A> proprietà da ottenere l'ora corrente come un <xref:System.DateTime> oggetto.</span><span class="sxs-lookup"><span data-stu-id="02a3f-141">If the queue is not available all the time, the method uses the static <xref:System.DateTime.UtcNow%2A> property to get the current time as a <xref:System.DateTime> object.</span></span> <span data-ttu-id="02a3f-142">(Ora locale non è necessaria perché il <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> e <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> sono in formato ora UTC.)</span><span class="sxs-lookup"><span data-stu-id="02a3f-142">(We do not need local time because the <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> and <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> properties are themselves in UTC time.)</span></span>  
  
 <span data-ttu-id="02a3f-143">Tuttavia, queste due proprietà non sono <xref:System.DateTime> oggetti.</span><span class="sxs-lookup"><span data-stu-id="02a3f-143">However, these two properties are not <xref:System.DateTime> objects.</span></span> <span data-ttu-id="02a3f-144">Sono <xref:System.Int32>s esprime l'ora come numero di minuti dopo la mezzanotte ora UTC.</span><span class="sxs-lookup"><span data-stu-id="02a3f-144">They are <xref:System.Int32>s expressing the time as the number of minutes-after-UTC-midnight.</span></span> <span data-ttu-id="02a3f-145">Pertanto è necessario convertire il nostro <xref:System.DateTime> oggetto minuti trascorsi dalla mezzanotte.</span><span class="sxs-lookup"><span data-stu-id="02a3f-145">So we do have to convert our <xref:System.DateTime> object to minutes-after-midnight.</span></span> <span data-ttu-id="02a3f-146">Una volta effettuata questa operazione, il metodo controlla semplicemente per verificare se "ora" sia tra l'inizio della coda e "volte, imposta sentinel su false se"ora"non è compreso tra due volte e restituisce sentinel fino a".</span><span class="sxs-lookup"><span data-stu-id="02a3f-146">When that is done, the method simply checks to see whether "now" is between the queue's start and "until" times, sets the sentinel to false if "now" is not between the two times, and returns the sentinel.</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#PrintQueueStartUntil](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#printqueuestartuntil)]
 [!code-csharp[DiagnoseProblematicPrintJob#PrintQueueStartUntil](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#printqueuestartuntil)]
 [!code-vb[DiagnoseProblematicPrintJob#PrintQueueStartUntil](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#printqueuestartuntil)]  
  
 <span data-ttu-id="02a3f-147">Il **TimeConverter** metodo, come illustrato nell'esempio di codice riportato di seguito, non utilizzare alcun metodo introdotto con [!INCLUDE[TLA#tla_winfx](../../../../includes/tlasharptla-winfx-md.md)], pertanto la discussione è breve.</span><span class="sxs-lookup"><span data-stu-id="02a3f-147">The **TimeConverter.ConvertToLocalHumanReadableTime** method (presented in the code example below) does not use any methods introduced with [!INCLUDE[TLA#tla_winfx](../../../../includes/tlasharptla-winfx-md.md)], so the discussion is brief.</span></span> <span data-ttu-id="02a3f-148">Il metodo ha un'attività di conversione doppie: deve accettare un numero intero che esprime minuti dopo la mezzanotte e convertirlo in un momento leggibile e questo deve convertire l'ora locale.</span><span class="sxs-lookup"><span data-stu-id="02a3f-148">The method has a double conversion task: it must take an integer expressing minutes-after-midnight and convert it to a human-readable time and it must convert this to the local time.</span></span> <span data-ttu-id="02a3f-149">Esegue questa operazione creando innanzitutto un <xref:System.DateTime> oggetto che viene impostato sulla mezzanotte ora UTC, quindi viene utilizzato il <xref:System.DateTime.AddMinutes%2A> metodo per aggiungere i minuti che sono stati passati al metodo.</span><span class="sxs-lookup"><span data-stu-id="02a3f-149">It accomplishes this by first creating a <xref:System.DateTime> object that is set to midnight UTC and then it uses the <xref:System.DateTime.AddMinutes%2A> method to add the minutes that were passed to the method.</span></span> <span data-ttu-id="02a3f-150">Restituisce un nuovo <xref:System.DateTime> esprime l'ora originale è stato passato al metodo.</span><span class="sxs-lookup"><span data-stu-id="02a3f-150">This returns a new <xref:System.DateTime> expressing the original time that was passed to the method.</span></span> <span data-ttu-id="02a3f-151">Il <xref:System.DateTime.ToLocalTime%2A> metodo converte quindi l'ora locale.</span><span class="sxs-lookup"><span data-stu-id="02a3f-151">The <xref:System.DateTime.ToLocalTime%2A> method then converts this to local time.</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#TimeConverter](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#timeconverter)]
 [!code-csharp[DiagnoseProblematicPrintJob#TimeConverter](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#timeconverter)]
 [!code-vb[DiagnoseProblematicPrintJob#TimeConverter](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#timeconverter)]  
  
## <a name="see-also"></a><span data-ttu-id="02a3f-152">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="02a3f-152">See Also</span></span>  
 <xref:System.DateTime>  
 <xref:System.Printing.PrintSystemJobInfo>  
 <xref:System.Printing.PrintQueue>  
 [<span data-ttu-id="02a3f-153">Documenti in WPF</span><span class="sxs-lookup"><span data-stu-id="02a3f-153">Documents in WPF</span></span>](../../../../docs/framework/wpf/advanced/documents-in-wpf.md)  
 [<span data-ttu-id="02a3f-154">Panoramica della stampa</span><span class="sxs-lookup"><span data-stu-id="02a3f-154">Printing Overview</span></span>](../../../../docs/framework/wpf/advanced/printing-overview.md)
