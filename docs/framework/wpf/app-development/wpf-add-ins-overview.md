---
title: Cenni preliminari sui componenti aggiuntivi di WPF
ms.date: 03/30/2017
helpviewer_keywords:
- add-ins and XAML browser applications [WPF]
- add-ins overview [WPF]
- add-ins [WPF], performance
- add-ins [WPF], benefits
- .NET Framework add-in model [WPF]
- add-ins [WPF], user interface
- add-ins and the user interface [WPF]
- add-ins [WPF], architecture
- add-ins [WPF], limitations
ms.assetid: 00b4c776-29a8-4dba-b603-280a0cdc2ade
ms.openlocfilehash: 2e5d133a4744124723c0373e3d5974b505936190
ms.sourcegitcommit: efff8f331fd9467f093f8ab8d23a203d6ecb5b60
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/01/2018
ms.locfileid: "43402101"
---
# <a name="wpf-add-ins-overview"></a><span data-ttu-id="3dd72-102">Cenni preliminari sui componenti aggiuntivi di WPF</span><span class="sxs-lookup"><span data-stu-id="3dd72-102">WPF Add-Ins Overview</span></span>
<a name="Introduction"></a> <span data-ttu-id="3dd72-103">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] include un modello di componente aggiuntivo che gli sviluppatori possono usare per creare applicazioni che supportano l'estendibilità mediante componenti aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="3dd72-103">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] includes an add-in model that developers can use to create applications that support add-in extensibility.</span></span> <span data-ttu-id="3dd72-104">Questo modello consente di creare componenti aggiuntivi che si integrano con le funzionalità dell'applicazione estendendole.</span><span class="sxs-lookup"><span data-stu-id="3dd72-104">This add-in model allows the creation of add-ins that integrate with and extend application functionality.</span></span> <span data-ttu-id="3dd72-105">In alcuni scenari le applicazioni devono anche visualizzare [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] fornite dai componenti aggiuntivi. Questo argomento mostra in che modo [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] integra il modello di componente aggiuntivo [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] per consentire questi scenari e illustra l'architettura che sta alla base, i suoi vantaggi e le sue limitazioni.</span><span class="sxs-lookup"><span data-stu-id="3dd72-105">In some scenarios, applications also need to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that are provided by add-ins. This topic shows how [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] augments the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model to enable these scenarios, the architecture behind it, its benefits, and its limitations.</span></span>  
  

  
<a name="Requirements"></a>   
## <a name="prerequisites"></a><span data-ttu-id="3dd72-106">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="3dd72-106">Prerequisites</span></span>  
 <span data-ttu-id="3dd72-107">È necessario avere familiarità con il modello di componente aggiuntivo [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3dd72-107">Familiarity with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model is required.</span></span> <span data-ttu-id="3dd72-108">Per altre informazioni, vedere [Componenti aggiuntivi ed estendibilità](../../../../docs/framework/add-ins/index.md).</span><span class="sxs-lookup"><span data-stu-id="3dd72-108">For more information, see [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md).</span></span>  
  
<a name="AddInsOverview"></a>   
## <a name="add-ins-overview"></a><span data-ttu-id="3dd72-109">Cenni preliminari sui componenti aggiuntivi</span><span class="sxs-lookup"><span data-stu-id="3dd72-109">Add-Ins Overview</span></span>  
 <span data-ttu-id="3dd72-110">Per evitare le complessità legate alla ricompilazione e alla ridistribuzione di un'applicazione per incorporare nuove funzionalità, le applicazioni implementano meccanismi di estendibilità che consentono agli sviluppatori dell'applicazione e a quelli di terze parti di creare altre applicazioni che si integrano con esse.</span><span class="sxs-lookup"><span data-stu-id="3dd72-110">In order to avoid the complexities of application recompilation and redeployment to incorporate new functionality, applications implement extensibility mechanisms that allow developers (both first-party and third-party) to create other applications that integrate with them.</span></span> <span data-ttu-id="3dd72-111">Il metodo più comune per supportare questo tipo di estendibilità consiste nell'usare i componenti aggiuntivi, noti anche come "plug-in".</span><span class="sxs-lookup"><span data-stu-id="3dd72-111">The most common way to support this type of extensibility is through the use of add-ins (also known as "add-ons" and "plug-ins").</span></span> <span data-ttu-id="3dd72-112">Di seguito sono riportati alcuni esempi di applicazioni reali che espongono l'estendibilità mediante componenti aggiuntivi:</span><span class="sxs-lookup"><span data-stu-id="3dd72-112">Examples of real-world applications that expose extensibility with add-ins include:</span></span>  
  
-   <span data-ttu-id="3dd72-113">Componenti aggiuntivi di Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="3dd72-113">Internet Explorer add-ons.</span></span>  
  
-   <span data-ttu-id="3dd72-114">Plug-in di Windows Media Player.</span><span class="sxs-lookup"><span data-stu-id="3dd72-114">Windows Media Player plug-ins.</span></span>  
  
-   <span data-ttu-id="3dd72-115">Componenti aggiuntivi di Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="3dd72-115">Visual Studio add-ins.</span></span>  
  
 <span data-ttu-id="3dd72-116">Il modello di componente aggiuntivo di Windows Media Player, ad esempio, consente agli sviluppatori di terze parti di implementare "plug-in" che estendono Windows Media Player in diversi modi, come tramite la creazione di decodificatori e codificatori per formati multimediali non supportati a livello nativo da Windows Media Player (ad esempio DVD, MP3), effetti audio e interfacce.</span><span class="sxs-lookup"><span data-stu-id="3dd72-116">For example, the Windows Media Player add-in model allows third-party developers to implement "plug-ins" that extend Windows Media Player in a variety of ways, including creating decoders and encoders for media formats that are not supported natively by Windows Media Player (for example, DVD, MP3), audio effects, and skins.</span></span> <span data-ttu-id="3dd72-117">Ogni modello di componente aggiuntivo è creato per esporre funzionalità univoche di un'applicazione, anche se ci sono diversi comportamenti ed entità comuni a tutti i modelli.</span><span class="sxs-lookup"><span data-stu-id="3dd72-117">Each add-in model is built to expose the functionality that is unique to an application, although there are several entities and behaviors that are common to all add-in models.</span></span>  
  
 <span data-ttu-id="3dd72-118">Le tre entità principali delle soluzioni tipiche di estendibilità mediante componenti aggiuntivi sono *contratti*, *componenti aggiuntivi* e *applicazioni host*.</span><span class="sxs-lookup"><span data-stu-id="3dd72-118">The three main entities of typical add-in extensibility solutions are *contracts*, *add-ins*, and *host applications*.</span></span> <span data-ttu-id="3dd72-119">I contratti definiscono la modalità di integrazione dei componenti aggiuntivi con le applicazioni host in due modi:</span><span class="sxs-lookup"><span data-stu-id="3dd72-119">Contracts define how add-ins integrate with host applications in two ways:</span></span>  
  
-   <span data-ttu-id="3dd72-120">I componenti aggiuntivi si integrano con le funzionalità implementate dalle applicazioni host.</span><span class="sxs-lookup"><span data-stu-id="3dd72-120">Add-ins integrate with functionality that is implemented by host applications.</span></span>  
  
-   <span data-ttu-id="3dd72-121">Le applicazioni host espongono funzionalità con cui i componenti aggiuntivi si integrano.</span><span class="sxs-lookup"><span data-stu-id="3dd72-121">Host applications expose functionality for add-ins to integrate with.</span></span>  
  
 <span data-ttu-id="3dd72-122">Per poter usare i componenti aggiuntivi, le applicazioni host devono trovarli e caricarli in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="3dd72-122">In order for add-ins to be used, host applications need to find them and load them at run time.</span></span> <span data-ttu-id="3dd72-123">Di conseguenza, le applicazioni che supportano i componenti aggiuntivi hanno le ulteriori responsabilità seguenti:</span><span class="sxs-lookup"><span data-stu-id="3dd72-123">Consequently, applications that support add-ins have the following additional responsibilities:</span></span>  
  
-   <span data-ttu-id="3dd72-124">**Individuazione**: trovare i componenti aggiuntivi conformi ai contratti supportati dalle applicazioni host.</span><span class="sxs-lookup"><span data-stu-id="3dd72-124">**Discovery**: Finding add-ins that adhere to contracts supported by host applications.</span></span>  
  
-   <span data-ttu-id="3dd72-125">**Attivazione**: caricare ed eseguire i componenti aggiuntivi e stabilire la comunicazione con essi.</span><span class="sxs-lookup"><span data-stu-id="3dd72-125">**Activation**: Loading, running, and establishing communication with add-ins.</span></span>  
  
-   <span data-ttu-id="3dd72-126">**Isolamento**: usare i processi o i domini dell'applicazione per stabilire i limiti di isolamento che proteggono le applicazioni da potenziali problemi di sicurezza e di esecuzione relativi ai componenti aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="3dd72-126">**Isolation**: Using either application domains or processes to establish isolation boundaries that protect applications from potential security and execution problems with add-ins.</span></span>  
  
-   <span data-ttu-id="3dd72-127">**Comunicazione**: consentire ai componenti aggiuntivi e alle applicazioni host di comunicare tra loro oltre i limiti di isolamento, mediante la chiamata a metodi e il passaggio di dati.</span><span class="sxs-lookup"><span data-stu-id="3dd72-127">**Communication**: Allowing add-ins and host applications to communicate with each other across isolation boundaries by calling methods and passing data.</span></span>  
  
-   <span data-ttu-id="3dd72-128">**Gestione della durata**: caricare e scaricare processi e domini dell'applicazione in modo netto e prevedibile (vedere [Domini applicazione](../../../../docs/framework/app-domains/application-domains.md)).</span><span class="sxs-lookup"><span data-stu-id="3dd72-128">**Lifetime Management**: Loading and unloading application domains and processes in a clean, predictable manner (see [Application Domains](../../../../docs/framework/app-domains/application-domains.md)).</span></span>  
  
-   <span data-ttu-id="3dd72-129">**Controllo delle versioni**: assicurare che le applicazioni host e i componenti aggiuntivi possano continuare a comunicare quando vengono create nuove versioni.</span><span class="sxs-lookup"><span data-stu-id="3dd72-129">**Versioning**: Ensuring that host applications and add-ins can still communicate when new versions of either are created.</span></span>  
  
 <span data-ttu-id="3dd72-130">In definitiva, lo sviluppo di un modello di componente aggiuntivo affidabile è un'operazione tutt'altro che banale.</span><span class="sxs-lookup"><span data-stu-id="3dd72-130">Ultimately, developing a robust add-in model is a non-trivial undertaking.</span></span> <span data-ttu-id="3dd72-131">Per questo motivo, [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] fornisce un'infrastruttura per la creazione di modelli di componente aggiuntivo.</span><span class="sxs-lookup"><span data-stu-id="3dd72-131">For this reason, the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] provides an infrastructure for building add-in models.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="3dd72-132">Per informazioni più dettagliate sui componenti aggiuntivi, vedere [Componenti aggiuntivi ed estendibilità](../../../../docs/framework/add-ins/index.md).</span><span class="sxs-lookup"><span data-stu-id="3dd72-132">For more detailed information on add-ins, see [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md).</span></span>  
  
<a name="NETFrameworkAddInModelOverview"></a>   
## <a name="net-framework-add-in-model-overview"></a><span data-ttu-id="3dd72-133">Cenni preliminari sul modello di componente aggiuntivo .NET Framework</span><span class="sxs-lookup"><span data-stu-id="3dd72-133">.NET Framework Add-In Model Overview</span></span>  
 <span data-ttu-id="3dd72-134">Il [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] modello del componente aggiuntivo, disponibili nel <xref:System.AddIn> dello spazio dei nomi, contiene un set di tipi che sono progettati per semplificare lo sviluppo dell'estendibilità di componente aggiuntivo.</span><span class="sxs-lookup"><span data-stu-id="3dd72-134">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model, found in the <xref:System.AddIn> namespace, contains a set of types that are designed to simplify the development of add-in extensibility.</span></span> <span data-ttu-id="3dd72-135">L'unità fondamentale del modello di componente aggiuntivo [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] è il *contratto*, che definisce la modalità di comunicazione tra un'applicazione host e un componente aggiuntivo.</span><span class="sxs-lookup"><span data-stu-id="3dd72-135">The fundamental unit of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model is the *contract*, which defines how a host application and an add-in communicate with each other.</span></span> <span data-ttu-id="3dd72-136">Un contratto viene esposto a un'applicazione host usando una *vista* del contratto specifica dell'applicazione host.</span><span class="sxs-lookup"><span data-stu-id="3dd72-136">A contract is exposed to a host application using a host-application-specific *view* of the contract.</span></span> <span data-ttu-id="3dd72-137">Analogamente, una *vista* del contratto specifica del componente aggiuntivo viene esposta al componente aggiuntivo.</span><span class="sxs-lookup"><span data-stu-id="3dd72-137">Likewise, an add-in-specific *view* of the contract is exposed to the add-in.</span></span> <span data-ttu-id="3dd72-138">Un *adattatore* consente a un'applicazione host e a un componente aggiuntivo di comunicare tra le rispettive viste del contratto.</span><span class="sxs-lookup"><span data-stu-id="3dd72-138">An *adapter* is used to allow a host application and an add-in to communicate between their respective views of the contract.</span></span> <span data-ttu-id="3dd72-139">Contratti, viste e adattatori vengono detti segmenti e un set di segmenti correlati costituisce una *pipeline*.</span><span class="sxs-lookup"><span data-stu-id="3dd72-139">Contracts, views, and adapters are referred to as segments, and a set of related segments constitutes a *pipeline*.</span></span> <span data-ttu-id="3dd72-140">Le pipeline sono gli elementi su cui il modello di componente aggiuntivo [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] si basa per supportare l'individuazione, l'attivazione, l'isolamento di sicurezza, l'isolamento di esecuzione (tramite processi e domini dell'applicazione), la comunicazione, la gestione della durata e il controllo delle versioni.</span><span class="sxs-lookup"><span data-stu-id="3dd72-140">Pipelines are the foundation upon which the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model supports discovery, activation, security isolation, execution isolation (using both application domains and processes), communication, lifetime management, and versioning.</span></span>  
  
 <span data-ttu-id="3dd72-141">Questo supporto consente agli sviluppatori di creare componenti aggiuntivi che si integrano con le funzionalità di un'applicazione host.</span><span class="sxs-lookup"><span data-stu-id="3dd72-141">The sum of this support allows developers to build add-ins that integrate with the functionality of a host application.</span></span> <span data-ttu-id="3dd72-142">Alcuni scenari richiedono tuttavia che le applicazioni host visualizzino [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] fornite dai componenti aggiuntivi. Dal momento che ogni tecnologia di presentazione in [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] ha il proprio modello di implementazione delle [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], il modello di componente aggiuntivo [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] non supporta alcuna tecnologia di presentazione specifica.</span><span class="sxs-lookup"><span data-stu-id="3dd72-142">However, some scenarios require host applications to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] provided by add-ins. Because each presentation technology in the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] has its own model for implementing [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model does not support any particular presentation technology.</span></span> <span data-ttu-id="3dd72-143">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] estende invece il modello di componente aggiuntivo [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] con supporto dell'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] per i componenti aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="3dd72-143">Instead, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model with [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] support for add-ins.</span></span>  
  
<a name="WPFAddInModel"></a>   
## <a name="wpf-add-ins"></a><span data-ttu-id="3dd72-144">Componenti aggiuntivi WPF</span><span class="sxs-lookup"><span data-stu-id="3dd72-144">WPF Add-Ins</span></span>  
 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="3dd72-145">, insieme al modello di componente aggiuntivo [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)], consente di gestire numerosi scenari che richiedono la visualizzazione di [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] dei componenti aggiuntivi nelle applicazioni host. In particolare, questi scenari vengono gestiti da [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] con i due modelli di programmazione seguenti:</span><span class="sxs-lookup"><span data-stu-id="3dd72-145">, in conjunction with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model, allows you to address a wide variety of scenarios that require host applications to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] from add-ins. In particular, these scenarios are addressed by [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] with the following two programming models:</span></span>  
  
1.  <span data-ttu-id="3dd72-146">**Componente aggiuntivo che restituisce un'interfaccia utente**.</span><span class="sxs-lookup"><span data-stu-id="3dd72-146">**The add-in returns a UI**.</span></span> <span data-ttu-id="3dd72-147">Un componente aggiuntivo restituisce un'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] all'applicazione host tramite una chiamata a un metodo, come definito dal contratto.</span><span class="sxs-lookup"><span data-stu-id="3dd72-147">An add-in returns a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to the host application via a method call, as defined by the contract.</span></span> <span data-ttu-id="3dd72-148">Questo scenario viene usato nei casi seguenti:</span><span class="sxs-lookup"><span data-stu-id="3dd72-148">This scenario is used in the following cases:</span></span>  
  
    -   <span data-ttu-id="3dd72-149">L'aspetto di un'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] restituita da un componente aggiuntivo dipende da dati o condizioni esistenti solo in fase di esecuzione, ad esempio report generati in modo dinamico.</span><span class="sxs-lookup"><span data-stu-id="3dd72-149">The appearance of a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is returned by an add-in is dependent on either data or conditions that exist only at run time, such as dynamically generated reports.</span></span>  
  
    -   <span data-ttu-id="3dd72-150">L'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] per i servizi fornita da un componente aggiuntivo è diversa dall'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] delle applicazioni host che possono usare il componente aggiuntivo.</span><span class="sxs-lookup"><span data-stu-id="3dd72-150">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] for services provided by an add-in differs from the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] of the host applications that can use the add-in.</span></span>  
  
    -   <span data-ttu-id="3dd72-151">Il componente aggiuntivo svolge principalmente un servizio per l'applicazione host e segnala lo stato all'applicazione host con un'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3dd72-151">The add-in primarily performs a service for the host application, and reports status to the host application with a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
2.  <span data-ttu-id="3dd72-152">**Componente aggiuntivo che costituisce un'interfaccia utente**.</span><span class="sxs-lookup"><span data-stu-id="3dd72-152">**The add-in is a UI**.</span></span> <span data-ttu-id="3dd72-153">Un componente aggiuntivo è un'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], come definito dal contratto.</span><span class="sxs-lookup"><span data-stu-id="3dd72-153">An add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], as defined by the contract.</span></span> <span data-ttu-id="3dd72-154">Questo scenario viene usato nei casi seguenti:</span><span class="sxs-lookup"><span data-stu-id="3dd72-154">This scenario is used in the following cases:</span></span>  
  
    -   <span data-ttu-id="3dd72-155">Un componente aggiuntivo non fornisce alcun servizio eccetto la sua visualizzazione, come nel caso di un annuncio.</span><span class="sxs-lookup"><span data-stu-id="3dd72-155">An add-in doesn't provide services other than being displayed, such as an advertisement.</span></span>  
  
    -   <span data-ttu-id="3dd72-156">L'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] per i servizi fornita da un componente aggiuntivo è comune a tutte le applicazioni host che possono usare il componente aggiuntivo, ad esempio una calcolatrice o un'interfaccia di selezione colori.</span><span class="sxs-lookup"><span data-stu-id="3dd72-156">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] for services provided by an add-in is common to all host applications that can use that add-in, such as a calculator or color picker.</span></span>  
  
 <span data-ttu-id="3dd72-157">Questi scenari richiedono che gli oggetti dell'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] possano essere passati tra i domini dell'applicazione del componente aggiuntivo e dell'applicazione host.</span><span class="sxs-lookup"><span data-stu-id="3dd72-157">These scenarios require that [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] objects can be passed between host application and add-in application domains.</span></span> <span data-ttu-id="3dd72-158">Poiché il modello di componente aggiuntivo [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] si basa sulla comunicazione remota tra domini dell'applicazione, gli oggetti passati devono poter essere usati in remoto.</span><span class="sxs-lookup"><span data-stu-id="3dd72-158">Since the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model relies on remoting to communicate between application domains, the objects that are passed between them must be remotable.</span></span>  
  
 <span data-ttu-id="3dd72-159">Un oggetto che può essere usato in remoto è un'istanza di una classe che soddisfa una o più delle condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="3dd72-159">A remotable object is an instance of a class that does one or more of the following:</span></span>  
  
-   <span data-ttu-id="3dd72-160">Deriva dal <xref:System.MarshalByRefObject> classe.</span><span class="sxs-lookup"><span data-stu-id="3dd72-160">Derives from the <xref:System.MarshalByRefObject> class.</span></span>  
  
-   <span data-ttu-id="3dd72-161">Implementa l'interfaccia <xref:System.Runtime.Serialization.ISerializable>.</span><span class="sxs-lookup"><span data-stu-id="3dd72-161">Implements the <xref:System.Runtime.Serialization.ISerializable> interface.</span></span>  
  
-   <span data-ttu-id="3dd72-162">Ha il <xref:System.SerializableAttribute> attributo viene applicato.</span><span class="sxs-lookup"><span data-stu-id="3dd72-162">Has the <xref:System.SerializableAttribute> attribute applied.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="3dd72-163">Per altre informazioni relative alla creazione di oggetti [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] che possono essere usati in remoto, vedere [Impostazione degli oggetti per essere utilizzabili in remoto](https://msdn.microsoft.com/library/01197253-3f13-43b7-894d-9683e431192a).</span><span class="sxs-lookup"><span data-stu-id="3dd72-163">For more information regarding the creation of remotable [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] objects, see [Making Objects Remotable](https://msdn.microsoft.com/library/01197253-3f13-43b7-894d-9683e431192a).</span></span>  
  
 <span data-ttu-id="3dd72-164">I tipi [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] di [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] non possono essere usati in remoto.</span><span class="sxs-lookup"><span data-stu-id="3dd72-164">The [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] types are not remotable.</span></span> <span data-ttu-id="3dd72-165">Per risolvere il problema, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] estende il modello di componente aggiuntivo [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] per consentire la visualizzazione nelle applicazioni host dell'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] creata dai componenti aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="3dd72-165">To solve the problem, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model to enable [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] created by add-ins to be displayed from host applications.</span></span> <span data-ttu-id="3dd72-166">Questo supporto è fornito da [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] da due tipi: il <xref:System.AddIn.Contract.INativeHandleContract> interfaccia e due metodi statici implementati dalle <xref:System.AddIn.Pipeline.FrameworkElementAdapters> classe: <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> e <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="3dd72-166">This support is provided by [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] by two types: the <xref:System.AddIn.Contract.INativeHandleContract> interface and two static methods implemented by the <xref:System.AddIn.Pipeline.FrameworkElementAdapters> class: <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span> <span data-ttu-id="3dd72-167">A livello generale, questi tipi e metodi vengono usati nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="3dd72-167">At a high level, these types and methods are used in the following manner:</span></span>  
  
1.  [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="3dd72-168"> è necessario che [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] fornite da componenti aggiuntivi sono classi che derivano direttamente o indirettamente da <xref:System.Windows.FrameworkElement>, ad esempio forme, controlli, controlli utente, pannelli di layout e pagine.</span><span class="sxs-lookup"><span data-stu-id="3dd72-168"> requires that [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] provided by add-ins are classes that derive directly or indirectly from <xref:System.Windows.FrameworkElement>, such as shapes, controls, user controls, layout panels, and pages.</span></span>  
  
2.  <span data-ttu-id="3dd72-169">Ogni volta che il contratto dichiara che un'interfaccia utente verrà passata tra il componente aggiuntivo e l'applicazione host, è necessario dichiararla come un <xref:System.AddIn.Contract.INativeHandleContract> (non un <xref:System.Windows.FrameworkElement>); <xref:System.AddIn.Contract.INativeHandleContract> è una rappresentazione utilizzabile in remoto del componente aggiuntivo [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] che può essere passato attraverso limiti di isolamento.</span><span class="sxs-lookup"><span data-stu-id="3dd72-169">Wherever the contract declares that a UI will be passed between the add-in and the host application, it must be declared as an <xref:System.AddIn.Contract.INativeHandleContract> (not a <xref:System.Windows.FrameworkElement>); <xref:System.AddIn.Contract.INativeHandleContract> is a remotable representation of the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that can be passed across isolation boundaries.</span></span>  
  
3.  <span data-ttu-id="3dd72-170">Prima di essere passato dal dominio applicazione del componente aggiuntivo, un <xref:System.Windows.FrameworkElement> viene fornito come un <xref:System.AddIn.Contract.INativeHandleContract> chiamando <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="3dd72-170">Before being passed from the add-in's application domain, a <xref:System.Windows.FrameworkElement> is packaged as an <xref:System.AddIn.Contract.INativeHandleContract> by calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span>  
  
4.  <span data-ttu-id="3dd72-171">Dopo essere passati al dominio dell'applicazione host, il <xref:System.AddIn.Contract.INativeHandleContract> devono essere convertiti come un <xref:System.Windows.FrameworkElement> chiamando <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="3dd72-171">After being passed to the host application's application domain, the <xref:System.AddIn.Contract.INativeHandleContract> must be repackaged as a <xref:System.Windows.FrameworkElement> by calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span></span>  
  
 <span data-ttu-id="3dd72-172">La modalità <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>, e <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> vengono usati dipende dallo scenario specifico.</span><span class="sxs-lookup"><span data-stu-id="3dd72-172">How <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>, and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> are used depends on the specific scenario.</span></span> <span data-ttu-id="3dd72-173">Le sezioni seguenti forniscono informazioni dettagliate per ogni modello di programmazione.</span><span class="sxs-lookup"><span data-stu-id="3dd72-173">The following sections provide details for each programming model.</span></span>  
  
<a name="ReturnUIFromAddInContract"></a>   
## <a name="add-in-returns-a-user-interface"></a><span data-ttu-id="3dd72-174">Componente aggiuntivo che restituisce un'interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="3dd72-174">Add-In Returns a User Interface</span></span>  
 <span data-ttu-id="3dd72-175">Per fare in modo che un componente aggiuntivo restituisca un'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] a un'applicazione host, è necessario quanto segue:</span><span class="sxs-lookup"><span data-stu-id="3dd72-175">For an add-in to return a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to a host application, the following are required:</span></span>  
  
1.  <span data-ttu-id="3dd72-176">L'applicazione host, il componente aggiuntivo e la pipeline devono essere creati, come descritto nella documentazione di [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] [Componenti aggiuntivi ed estendibilità](../../../../docs/framework/add-ins/index.md).</span><span class="sxs-lookup"><span data-stu-id="3dd72-176">The host application, add-in, and pipeline must be created, as described by the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md) documentation.</span></span>  
  
2.  <span data-ttu-id="3dd72-177">Il contratto deve implementare <xref:System.AddIn.Contract.IContract> e, per restituire un [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], il contratto deve dichiarare un metodo con un valore restituito di tipo <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="3dd72-177">The contract must implement <xref:System.AddIn.Contract.IContract> and, to return a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the contract must declare a method with a return value of type <xref:System.AddIn.Contract.INativeHandleContract>.</span></span>  
  
3.  <span data-ttu-id="3dd72-178">Il [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] che viene passato tra il componente aggiuntivo e l'host dell'applicazione deve derivare direttamente o indirettamente da <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="3dd72-178">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is passed between the add-in and the host application must directly or indirectly derive from <xref:System.Windows.FrameworkElement>.</span></span>  
  
4.  <span data-ttu-id="3dd72-179">Il [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] restituito dal componente aggiuntivo deve essere convertito da un <xref:System.Windows.FrameworkElement> a un <xref:System.AddIn.Contract.INativeHandleContract> prima di oltrepassare il limite di isolamento.</span><span class="sxs-lookup"><span data-stu-id="3dd72-179">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is returned by the add-in must be converted from a <xref:System.Windows.FrameworkElement> to an <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary.</span></span>  
  
5.  <span data-ttu-id="3dd72-180">Il [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] che viene restituito deve essere convertito da un <xref:System.AddIn.Contract.INativeHandleContract> a un <xref:System.Windows.FrameworkElement> dopo aver oltrepassato il limite di isolamento.</span><span class="sxs-lookup"><span data-stu-id="3dd72-180">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is returned must be converted from an <xref:System.AddIn.Contract.INativeHandleContract> to a <xref:System.Windows.FrameworkElement> after crossing the isolation boundary.</span></span>  
  
6.  <span data-ttu-id="3dd72-181">L'applicazione host Visualizza l'oggetto restituito <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="3dd72-181">The host application displays the returned <xref:System.Windows.FrameworkElement>.</span></span>  
  
 <span data-ttu-id="3dd72-182">Per un esempio che illustra come implementare un componente aggiuntivo che restituisce un'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], vedere [Creare un componente aggiuntivo che restituisce un'interfaccia utente](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-returns-a-ui.md).</span><span class="sxs-lookup"><span data-stu-id="3dd72-182">For an example that demonstrates how to implement an add-in that returns a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], see [Create an Add-In That Returns a UI](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-returns-a-ui.md).</span></span>  
  
<a name="AddInIsAUI"></a>   
## <a name="add-in-is-a-user-interface"></a><span data-ttu-id="3dd72-183">Componente aggiuntivo che costituisce un'interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="3dd72-183">Add-In Is a User Interface</span></span>  
 <span data-ttu-id="3dd72-184">Quando un componente aggiuntivo costituisce un'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], è necessario quanto segue:</span><span class="sxs-lookup"><span data-stu-id="3dd72-184">When an add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the following are required:</span></span>  
  
1.  <span data-ttu-id="3dd72-185">L'applicazione host, il componente aggiuntivo e la pipeline devono essere creati, come descritto nella documentazione di [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] [Componenti aggiuntivi ed estendibilità](../../../../docs/framework/add-ins/index.md).</span><span class="sxs-lookup"><span data-stu-id="3dd72-185">The host application, add-in, and pipeline must be created, as described by the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md) documentation.</span></span>  
  
2.  <span data-ttu-id="3dd72-186">L'interfaccia del contratto per il componente aggiuntivo deve implementare <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="3dd72-186">The contract interface for the add-in must implement <xref:System.AddIn.Contract.INativeHandleContract>.</span></span>  
  
3.  <span data-ttu-id="3dd72-187">Il componente aggiuntivo che viene passato all'applicazione host deve derivare direttamente o indirettamente da <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="3dd72-187">The add-in that is passed to the host application must directly or indirectly derive from <xref:System.Windows.FrameworkElement>.</span></span>  
  
4.  <span data-ttu-id="3dd72-188">Il componente aggiuntivo deve essere convertito da un <xref:System.Windows.FrameworkElement> a un <xref:System.AddIn.Contract.INativeHandleContract> prima di oltrepassare il limite di isolamento.</span><span class="sxs-lookup"><span data-stu-id="3dd72-188">The add-in must be converted from a <xref:System.Windows.FrameworkElement> to an <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary.</span></span>  
  
5.  <span data-ttu-id="3dd72-189">Il componente aggiuntivo deve essere convertito da un <xref:System.AddIn.Contract.INativeHandleContract> a un <xref:System.Windows.FrameworkElement> dopo aver oltrepassato il limite di isolamento.</span><span class="sxs-lookup"><span data-stu-id="3dd72-189">The add-in must be converted from an <xref:System.AddIn.Contract.INativeHandleContract> to a <xref:System.Windows.FrameworkElement> after crossing the isolation boundary.</span></span>  
  
6.  <span data-ttu-id="3dd72-190">L'applicazione host Visualizza l'oggetto restituito <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="3dd72-190">The host application displays the returned <xref:System.Windows.FrameworkElement>.</span></span>  
  
 <span data-ttu-id="3dd72-191">Per un esempio che illustra come implementare un componente aggiuntivo che costituisce un'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], vedere [Creare un componente aggiuntivo che costituisce un'interfaccia utente](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-is-a-ui.md).</span><span class="sxs-lookup"><span data-stu-id="3dd72-191">For an example that demonstrates how to implement an add-in that is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], see [Create an Add-In That Is a UI](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-is-a-ui.md).</span></span>  
  
<a name="ReturningMultipleUIsFromAnAddIn"></a>   
## <a name="returning-multiple-uis-from-an-add-in"></a><span data-ttu-id="3dd72-192">Restituzione di più interfacce utente da un componente aggiuntivo</span><span class="sxs-lookup"><span data-stu-id="3dd72-192">Returning Multiple UIs from an Add-In</span></span>  
 <span data-ttu-id="3dd72-193">I componenti aggiuntivi spesso forniscono più [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] per la visualizzazione nelle applicazioni host.</span><span class="sxs-lookup"><span data-stu-id="3dd72-193">Add-ins often provide multiple [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] for host applications to display.</span></span> <span data-ttu-id="3dd72-194">Considerare, ad esempio un componente aggiuntivo che costituisce un'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] che fornisce anche informazioni sullo stato all'applicazione host, sempre sotto forma di [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3dd72-194">For example, consider an add-in that is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that also provides status information to the host application, also as a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="3dd72-195">Un componente aggiuntivo di questo tipo può essere implementato usando una combinazione di tecniche dei modelli [Componente aggiuntivo che restituisce un'interfaccia utente](#ReturnUIFromAddInContract) e [Componente aggiuntivo che costituisce un'interfaccia utente](#AddInIsAUI).</span><span class="sxs-lookup"><span data-stu-id="3dd72-195">An add-in like this can be implemented by using a combination of techniques from both the [Add-In Returns a User Interface](#ReturnUIFromAddInContract) and [Add-In Is a User Interface](#AddInIsAUI) models.</span></span>  
  
<a name="AddInsAndXBAPs"></a>   
## <a name="add-ins-and-xaml-browser-applications"></a><span data-ttu-id="3dd72-196">Componenti aggiuntivi e applicazioni browser XAML</span><span class="sxs-lookup"><span data-stu-id="3dd72-196">Add-Ins and XAML Browser Applications</span></span>  
 <span data-ttu-id="3dd72-197">Negli esempi illustrati fino a questo momento l'applicazione host era un'applicazione autonoma installata.</span><span class="sxs-lookup"><span data-stu-id="3dd72-197">In the examples so far, the host application has been an installed standalone application.</span></span> <span data-ttu-id="3dd72-198">Anche le [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] possono però ospitare componenti aggiuntivi, sebbene con i requisiti di compilazione e implementazione aggiuntivi seguenti:</span><span class="sxs-lookup"><span data-stu-id="3dd72-198">But [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] can also host add-ins, albeit with the following additional build and implementation requirements:</span></span>  
  
-   <span data-ttu-id="3dd72-199">Il manifesto dell'applicazione [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] deve essere appositamente configurato per scaricare la pipeline (cartelle e assembly) e l'assembly del componente aggiuntivo nella cache dell'applicazione [!INCLUDE[TLA#tla_clickonce](../../../../includes/tlasharptla-clickonce-md.md)] sul computer client, nella stessa cartella dell'applicazione [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3dd72-199">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] application manifest must be configured specially to download the pipeline (folders and assemblies) and add-in assembly to the [!INCLUDE[TLA#tla_clickonce](../../../../includes/tlasharptla-clickonce-md.md)] application cache on the client machine, in the same folder as the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span></span>  
  
-   <span data-ttu-id="3dd72-200">Il codice [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] che consente di individuare e caricare i componenti aggiuntivi deve usare la cache dell'applicazione [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] per [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] come percorso della pipeline e del componente aggiuntivo.</span><span class="sxs-lookup"><span data-stu-id="3dd72-200">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] code to discover and load add-ins must use the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] application cache for the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] as the pipeline and add-in location.</span></span>  
  
-   <span data-ttu-id="3dd72-201">L'applicazione [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] deve caricare il componente aggiuntivo in un contesto di sicurezza speciale se tale componente fa riferimento a file separati che si trovano nel sito di origine. Se sono ospitati da applicazioni [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)], i componenti aggiuntivi possono fare riferimento unicamente ai file separati che si trovano nel sito di origine dell'applicazione host.</span><span class="sxs-lookup"><span data-stu-id="3dd72-201">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] must load the add-in into a special security context if the add-in references loose files that are located at the site of origin; when hosted by [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)], add-ins can only reference loose files that are located at the host application's site of origin.</span></span>  
  
 <span data-ttu-id="3dd72-202">Queste attività sono descritte in dettaglio nelle sottosezioni seguenti.</span><span class="sxs-lookup"><span data-stu-id="3dd72-202">These tasks are described in detail in the following subsections.</span></span>  
  
### <a name="configuring-the-pipeline-and-add-in-for-clickonce-deployment"></a><span data-ttu-id="3dd72-203">Configurazione della pipeline e del componente aggiuntivo per la distribuzione ClickOnce</span><span class="sxs-lookup"><span data-stu-id="3dd72-203">Configuring the Pipeline and Add-In for ClickOnce Deployment</span></span>  
 <span data-ttu-id="3dd72-204">Le applicazioni [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] vengono scaricate in una cartella sicura nella cache di distribuzione [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] ed eseguite da questa posizione.</span><span class="sxs-lookup"><span data-stu-id="3dd72-204">[!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] are downloaded to and run from a safe folder in the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] deployment cache.</span></span> <span data-ttu-id="3dd72-205">Affinché un'applicazione [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] ospiti un componente aggiuntivo, anche l'assembly della pipeline e del componente aggiuntivo deve essere scaricato nella cartella sicura.</span><span class="sxs-lookup"><span data-stu-id="3dd72-205">In order for an [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] to host an add-in, the pipeline and add-in assembly must also be downloaded to the safe folder.</span></span> <span data-ttu-id="3dd72-206">A tale scopo, è necessario configurare il manifesto dell'applicazione per includere l'assembly della pipeline e del componente aggiuntivo per il download.</span><span class="sxs-lookup"><span data-stu-id="3dd72-206">To achieve this, you need to configure the application manifest to include both the pipeline and add-in assembly for download.</span></span> <span data-ttu-id="3dd72-207">Questo risulta più semplice in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], anche se l'assembly della pipeline e del componente aggiuntivo deve trovarsi nella cartella radice del progetto di applicazione [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] host affinché [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] rilevi gli assembly della pipeline.</span><span class="sxs-lookup"><span data-stu-id="3dd72-207">This is most easily done in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], although the pipeline and add-in assembly needs to be in the host [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project's root folder in order for [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] to detect the pipeline assemblies.</span></span>  
  
 <span data-ttu-id="3dd72-208">Di conseguenza, il primo passaggio consiste nel compilare l'assembly della pipeline e del componente aggiuntivo nella radice del progetto di applicazione [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], impostando l'output di compilazione di ogni progetto di assembly della pipeline e di assembly del componente aggiuntivo.</span><span class="sxs-lookup"><span data-stu-id="3dd72-208">Consequently, the first step is to build the pipeline and add-in assembly to the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project's root by setting the build output of each pipeline assembly and add-in assembly projects.</span></span> <span data-ttu-id="3dd72-209">La tabella seguente mostra i percorsi dell'output di compilazione per i progetti di assembly della pipeline e il progetto di assembly del componente aggiuntivo che si trovano nella stessa soluzione e cartella radice del progetto di applicazione [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] host.</span><span class="sxs-lookup"><span data-stu-id="3dd72-209">The following table shows the build output paths for pipeline assembly projects and add-in assembly project that are in the same solution and root folder as the host [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project.</span></span>  
  
 <span data-ttu-id="3dd72-210">Tabella 1: Percorsi dell'output di compilazione per gli assembly della pipeline ospitati da un'applicazione XBAP</span><span class="sxs-lookup"><span data-stu-id="3dd72-210">Table 1: Build Output Paths for the Pipeline Assemblies That Are Hosted by an XBAP</span></span>  
  
|<span data-ttu-id="3dd72-211">Progetto di assembly della pipeline</span><span class="sxs-lookup"><span data-stu-id="3dd72-211">Pipeline assembly project</span></span>|<span data-ttu-id="3dd72-212">Percorso dell'output di compilazione</span><span class="sxs-lookup"><span data-stu-id="3dd72-212">Build output path</span></span>|  
|-------------------------------|-----------------------|  
|<span data-ttu-id="3dd72-213">Contratto</span><span class="sxs-lookup"><span data-stu-id="3dd72-213">Contract</span></span>|`..\HostXBAP\Contracts\`|  
|<span data-ttu-id="3dd72-214">Vista del componente aggiuntivo</span><span class="sxs-lookup"><span data-stu-id="3dd72-214">Add-In View</span></span>|`..\HostXBAP\AddInViews\`|  
|<span data-ttu-id="3dd72-215">Adattatore sul lato del componente aggiuntivo</span><span class="sxs-lookup"><span data-stu-id="3dd72-215">Add-In-Side Adapter</span></span>|`..\HostXBAP\AddInSideAdapters\`|  
|<span data-ttu-id="3dd72-216">Adattatore sul lato host</span><span class="sxs-lookup"><span data-stu-id="3dd72-216">Host-Side Adapter</span></span>|`..\HostXBAP\HostSideAdapters\`|  
|<span data-ttu-id="3dd72-217">Componente aggiuntivo</span><span class="sxs-lookup"><span data-stu-id="3dd72-217">Add-In</span></span>|`..\HostXBAP\AddIns\WPFAddIn1`|  
  
 <span data-ttu-id="3dd72-218">Il passaggio successivo consiste nello specificare gli assembly della pipeline e l'assembly del componente aggiuntivo come file di contenuto [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] eseguendo questa procedura:</span><span class="sxs-lookup"><span data-stu-id="3dd72-218">The next step is to specify the pipeline assemblies and add-in assembly as the [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] content files in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] by doing the following:</span></span>  
  
1.  <span data-ttu-id="3dd72-219">Includere l'assembly della pipeline e del componente aggiuntivo nel progetto facendo clic con il pulsante destro del mouse su ogni cartella della pipeline in Esplora soluzioni e scegliendo **Includi nel progetto**.</span><span class="sxs-lookup"><span data-stu-id="3dd72-219">Including the pipeline and add-in assembly in the project by right-clicking each pipeline folder in Solution Explorer and choosing **Include In Project**.</span></span>  
  
2.  <span data-ttu-id="3dd72-220">Impostare il valore per **Azione di compilazione** di ogni assembly della pipeline e del componente aggiuntivo su **Contenuto** nella finestra **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="3dd72-220">Setting the **Build Action** of each pipeline assembly and add-in assembly to **Content** from the **Properties** window.</span></span>  
  
 <span data-ttu-id="3dd72-221">Il passaggio finale consiste nel configurare il manifesto dell'applicazione per includere i file di assembly della pipeline e il file di assembly del componente aggiuntivo per il download.</span><span class="sxs-lookup"><span data-stu-id="3dd72-221">The final step is to configure the application manifest to include the pipeline assembly files and add-in assembly file for download.</span></span> <span data-ttu-id="3dd72-222">I file devono trovarsi all'interno di cartelle nella radice della cartella contenuta nella cache [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] occupata dall'applicazione [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3dd72-222">The files should be located in folders at the root of the folder in the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] cache that the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] application occupies.</span></span> <span data-ttu-id="3dd72-223">La configurazione può essere effettuata in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] eseguendo questa procedura:</span><span class="sxs-lookup"><span data-stu-id="3dd72-223">The configuration can be achieved in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] by doing the following:</span></span>  
  
1.  <span data-ttu-id="3dd72-224">Fare clic con il pulsante destro del mouse sul progetto [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], scegliere **Proprietà**, fare clic su **Pubblica** e quindi fare clic sul pulsante **File applicazione**.</span><span class="sxs-lookup"><span data-stu-id="3dd72-224">Right-click the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project, click **Properties**, click **Publish**, and then click the **Application Files** button.</span></span>  
  
2.  <span data-ttu-id="3dd72-225">Nella finestra di dialogo **File applicazione** impostare il valore di **Stato pubblicazione** di ogni DLL della pipeline e del componente aggiuntivo su **Includi (Auto)** e impostare il valore di **Gruppo di download** per ogni DLL della pipeline e del componente aggiuntivo su **(Obbligatorio)**.</span><span class="sxs-lookup"><span data-stu-id="3dd72-225">In the **Application Files** dialog, set the **Publish Status** of each pipeline and add-in DLL to **Include (Auto)**, and set the **Download Group** for each pipeline and add-in DLL to **(Required)**.</span></span>  
  
### <a name="using-the-pipeline-and-add-in-from-the-application-base"></a><span data-ttu-id="3dd72-226">Uso della pipeline e del componente aggiuntivo dalla base dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="3dd72-226">Using the Pipeline and Add-In from the Application Base</span></span>  
 <span data-ttu-id="3dd72-227">Quando la pipeline e il componente aggiuntivo sono configurati per la distribuzione [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)], vengono scaricati nella stessa cartella della cache [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] in cui si trova l'applicazione [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3dd72-227">When the pipeline and add-in are configured for [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] deployment, they are downloaded to the same [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] cache folder as the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span></span> <span data-ttu-id="3dd72-228">Per usare la pipeline e il componente aggiuntivo dall'applicazione [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], il codice [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] deve ottenerli dalla base dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="3dd72-228">To use the pipeline and add-in from the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] code must get them from the application base.</span></span> <span data-ttu-id="3dd72-229">I diversi tipi e membri del modello di componente aggiuntivo [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] per l'uso di pipeline e componenti aggiuntivi forniscono uno speciale supporto per questo scenario.</span><span class="sxs-lookup"><span data-stu-id="3dd72-229">The various types and members of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model for using pipelines and add-ins provide special support for this scenario.</span></span> <span data-ttu-id="3dd72-230">In primo luogo, il percorso è identificato dal <xref:System.AddIn.Hosting.PipelineStoreLocation.ApplicationBase> valore di enumerazione.</span><span class="sxs-lookup"><span data-stu-id="3dd72-230">Firstly, the path is identified by the <xref:System.AddIn.Hosting.PipelineStoreLocation.ApplicationBase> enumeration value.</span></span> <span data-ttu-id="3dd72-231">Questo valore viene usato con gli overload dei membri pertinenti del componente aggiuntivo per l'uso delle pipeline, che includono quanto segue:</span><span class="sxs-lookup"><span data-stu-id="3dd72-231">You use this value with overloads of the pertinent add-in members for using pipelines that include the following:</span></span>  
  
-   <xref:System.AddIn.Hosting.AddInStore.FindAddIns%28System.Type%2CSystem.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.FindAddIns%28System.Type%2CSystem.AddIn.Hosting.PipelineStoreLocation%2CSystem.String%5B%5D%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.Rebuild%28System.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.Update%28System.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
### <a name="accessing-the-hosts-site-of-origin"></a><span data-ttu-id="3dd72-232">Accesso al sito di origine dell'host</span><span class="sxs-lookup"><span data-stu-id="3dd72-232">Accessing the Host's Site of Origin</span></span>  
 <span data-ttu-id="3dd72-233">Per assicurare che un componente aggiuntivo possa fare riferimento ai file del sito di origine, tale componente deve essere caricato con lo stesso isolamento di sicurezza dell'applicazione host.</span><span class="sxs-lookup"><span data-stu-id="3dd72-233">To ensure that an add-in can reference files from the site of origin, the add-in must be loaded with security isolation that is equivalent to the host application.</span></span> <span data-ttu-id="3dd72-234">Questo livello di sicurezza è identificato dal <xref:System.AddIn.Hosting.AddInSecurityLevel.Host?displayProperty=nameWithType> valore di enumerazione e passato al <xref:System.AddIn.Hosting.AddInToken.Activate%2A> metodo quando un componente aggiuntivo viene attivato.</span><span class="sxs-lookup"><span data-stu-id="3dd72-234">This security level is identified by the <xref:System.AddIn.Hosting.AddInSecurityLevel.Host?displayProperty=nameWithType> enumeration value, and passed to the <xref:System.AddIn.Hosting.AddInToken.Activate%2A> method when an add-in is activated.</span></span>  
  
<a name="WPFAddInModelArchitecture"></a>   
## <a name="wpf-add-in-architecture"></a><span data-ttu-id="3dd72-235">Architettura dei componenti aggiuntivi WPF</span><span class="sxs-lookup"><span data-stu-id="3dd72-235">WPF Add-In Architecture</span></span>  
 <span data-ttu-id="3dd72-236">Livello più alto, come abbiamo visto, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] abilita [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] componenti aggiuntivi per implementare [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] (che derivano direttamente o indirettamente da <xref:System.Windows.FrameworkElement>) usando <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> e <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="3dd72-236">At the highest level, as we've seen, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] enables [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-ins to implement [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] (that derive directly or indirectly from <xref:System.Windows.FrameworkElement>) using <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span></span> <span data-ttu-id="3dd72-237">Il risultato è che l'applicazione host viene restituito un <xref:System.Windows.FrameworkElement> che viene visualizzato da [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] nell'applicazione host.</span><span class="sxs-lookup"><span data-stu-id="3dd72-237">The result is that the host application is returned a <xref:System.Windows.FrameworkElement> that is displayed from [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] in the host application.</span></span>  
  
 <span data-ttu-id="3dd72-238">Nel caso di scenari semplici di componenti aggiuntivi dell'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], gli sviluppatori non necessitano di maggiori dettagli.</span><span class="sxs-lookup"><span data-stu-id="3dd72-238">For simple [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] add-in scenarios, this is as much detail as a developer needs.</span></span> <span data-ttu-id="3dd72-239">Nel caso di scenari più complessi, in particolare quando si tenta di usare servizi [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] aggiuntivi come layout, risorse e data binding, è necessaria una conoscenza più dettagliata del modo in cui [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] estende il modello di componente aggiuntivo [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] con il supporto dell'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], al fine di comprenderne i vantaggi e le limitazioni.</span><span class="sxs-lookup"><span data-stu-id="3dd72-239">For more complex scenarios, particularly those that try to utilize additional [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] services such as layout, resources, and data binding, more detailed knowledge of how [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model with [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] support is required to understand its benefits and limitations.</span></span>  
  
 <span data-ttu-id="3dd72-240">Fondamentalmente, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] non passa un'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] da un componente aggiuntivo a un'applicazione host. [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] passa invece l'handle di finestra Win32 per l'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] usando l'interoperabilità [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3dd72-240">Fundamentally, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] doesn't pass a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] from an add-in to a host application; instead, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] passes the Win32 window handle for the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] by using [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] interoperability.</span></span> <span data-ttu-id="3dd72-241">Di conseguenza, quando un'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] viene passata da un componente aggiuntivo a un'applicazione host, si verifica quanto segue:</span><span class="sxs-lookup"><span data-stu-id="3dd72-241">As such, when a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] from an add-in is passed to a host application, the following occurs:</span></span>  
  
-   <span data-ttu-id="3dd72-242">Sul lato del componente aggiuntivo, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] acquisisce un handle di finestra per l'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] che verrà visualizzata dall'applicazione host.</span><span class="sxs-lookup"><span data-stu-id="3dd72-242">On the add-in side, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] acquires a window handle for the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that will be displayed by the host application.</span></span> <span data-ttu-id="3dd72-243">L'handle di finestra viene incapsulato da interna [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] classe che deriva da <xref:System.Windows.Interop.HwndSource> e implementa <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="3dd72-243">The window handle is encapsulated by an internal [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] class that derives from <xref:System.Windows.Interop.HwndSource> and implements <xref:System.AddIn.Contract.INativeHandleContract>.</span></span> <span data-ttu-id="3dd72-244">Un'istanza di questa classe viene restituita da <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> e viene effettuato il marshalling dal dominio di applicazione del componente aggiuntivo al dominio dell'applicazione host.</span><span class="sxs-lookup"><span data-stu-id="3dd72-244">An instance of this class is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> and is marshaled from the add-in's application domain to the host application's application domain.</span></span>  
  
-   <span data-ttu-id="3dd72-245">Sul lato dell'applicazione host, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] riassembla il <xref:System.Windows.Interop.HwndSource> come interna [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] classe che deriva da <xref:System.Windows.Interop.HwndHost> e consuma <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="3dd72-245">On the host application side, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] repackages the <xref:System.Windows.Interop.HwndSource> as an internal [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] class that derives from <xref:System.Windows.Interop.HwndHost> and consumes <xref:System.AddIn.Contract.INativeHandleContract>.</span></span> <span data-ttu-id="3dd72-246">Un'istanza di questa classe viene restituita da <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> all'applicazione host.</span><span class="sxs-lookup"><span data-stu-id="3dd72-246">An instance of this class is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> to the host application.</span></span>  
  
 <span data-ttu-id="3dd72-247"><xref:System.Windows.Interop.HwndHost> disponibile per visualizzare [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], identificato dall'handle di finestra, dalla [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3dd72-247"><xref:System.Windows.Interop.HwndHost> exists to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], identified by window handles, from [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span></span> <span data-ttu-id="3dd72-248">Per altre informazioni, vedere [Interoperatività di WPF e Win32](../../../../docs/framework/wpf/advanced/wpf-and-win32-interoperation.md).</span><span class="sxs-lookup"><span data-stu-id="3dd72-248">For more information, see [WPF and Win32 Interoperation](../../../../docs/framework/wpf/advanced/wpf-and-win32-interoperation.md).</span></span>  
  
 <span data-ttu-id="3dd72-249">In breve, <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, e <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> esiste per l'handle della finestra per consentire un' [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] deve essere passato da un componente aggiuntivo a un'applicazione host, in cui viene incapsulato da un <xref:System.Windows.Interop.HwndHost> e visualizzato l'host dell'applicazione [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3dd72-249">In summary, <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> exist to allow the window handle for a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to be passed from an add-in to a host application, where it is encapsulated by a <xref:System.Windows.Interop.HwndHost> and displayed the host application's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="3dd72-250">Poiché l'applicazione host ottiene un' <xref:System.Windows.Interop.HwndHost>, l'applicazione host non è possibile convertire l'oggetto restituito da <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> al tipo viene implementato dal componente aggiuntivo (ad esempio, un <xref:System.Windows.Controls.UserControl>).</span><span class="sxs-lookup"><span data-stu-id="3dd72-250">Because the host application gets an <xref:System.Windows.Interop.HwndHost>, the host application cannot convert the object that is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> to the type it is implemented as by the add-in (for example, a <xref:System.Windows.Controls.UserControl>).</span></span>  
  
 <span data-ttu-id="3dd72-251">Per sua natura, <xref:System.Windows.Interop.HwndHost> presenta alcune limitazioni che influiscono sul modo in cui ospitare le applicazioni possono usarle.</span><span class="sxs-lookup"><span data-stu-id="3dd72-251">By its nature, <xref:System.Windows.Interop.HwndHost> has certain limitations that affect how host applications can use them.</span></span> <span data-ttu-id="3dd72-252">Tuttavia [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] estende <xref:System.Windows.Interop.HwndHost> con diverse funzionalità per scenari di componente aggiuntivo.</span><span class="sxs-lookup"><span data-stu-id="3dd72-252">However, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends <xref:System.Windows.Interop.HwndHost> with several capabilities for add-in scenarios.</span></span> <span data-ttu-id="3dd72-253">Di seguito sono illustrati i vantaggi e le limitazioni.</span><span class="sxs-lookup"><span data-stu-id="3dd72-253">These benefits and limitations are described below.</span></span>  
  
<a name="WPFAddInModelBenefits"></a>   
## <a name="wpf-add-in-benefits"></a><span data-ttu-id="3dd72-254">Vantaggi dei componenti aggiuntivi WPF</span><span class="sxs-lookup"><span data-stu-id="3dd72-254">WPF Add-In Benefits</span></span>  
 <span data-ttu-id="3dd72-255">In quanto [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] componente aggiuntivo [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] vengono visualizzate dalle applicazioni host tramite una classe interna che deriva da <xref:System.Windows.Interop.HwndHost>, tali [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] sono vincolate dalle funzionalità del <xref:System.Windows.Interop.HwndHost> rispetto a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] servizi, ad esempio i layout, rendering, l'associazione dati, stili, modelli e le risorse.</span><span class="sxs-lookup"><span data-stu-id="3dd72-255">Because [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] are displayed from host applications using an internal class that derives from <xref:System.Windows.Interop.HwndHost>, those [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] are constrained by the capabilities of <xref:System.Windows.Interop.HwndHost> with respect to [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] services such as layout, rendering, data binding, styles, templates, and resources.</span></span> <span data-ttu-id="3dd72-256">Tuttavia [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] potenzia interna di quest ' <xref:System.Windows.Interop.HwndHost> sottoclasse con funzionalità aggiuntive che includono quanto segue:</span><span class="sxs-lookup"><span data-stu-id="3dd72-256">However, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] augments its internal <xref:System.Windows.Interop.HwndHost> subclass with additional capabilities that include the following:</span></span>  
  
-   <span data-ttu-id="3dd72-257">Passaggio tra l'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] di un'applicazione host e l'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] di un componente aggiuntivo tramite tasto TAB.</span><span class="sxs-lookup"><span data-stu-id="3dd72-257">Tabbing between a host application's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] and an add-in's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="3dd72-258">Si noti che la "componente aggiuntivo è una [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" modello di programmazione richiede che l'adattatore lato componente aggiuntivo eseguire l'override <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> per abilitare la tabulazione, se il componente aggiuntivo sia completamente attendibile o parzialmente attendibile.</span><span class="sxs-lookup"><span data-stu-id="3dd72-258">Note that the "add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programming model requires the add-in-side adapter to override <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> to enable tabbing, whether the add-in is fully trusted or partially trusted.</span></span>  
  
-   <span data-ttu-id="3dd72-259">Rispetto dei requisiti di accessibilità per le [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] dei componenti aggiuntivi visualizzate dalle [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] delle applicazioni host.</span><span class="sxs-lookup"><span data-stu-id="3dd72-259">Honoring accessibility requirements for add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that are displayed from host application [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span></span>  
  
-   <span data-ttu-id="3dd72-260">Abilitazione dell'esecuzione sicura delle applicazioni [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] in diversi scenari di dominio dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="3dd72-260">Enabling [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications to run safely in multiple application domain scenarios.</span></span>  
  
-   <span data-ttu-id="3dd72-261">Protezione contro l'accesso illegale agli handle di finestra dell'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] dei componenti aggiuntivi in caso di esecuzione dei componenti aggiuntivi con isolamento di sicurezza, ovvero una sandbox di sicurezza con attendibilità parziale.</span><span class="sxs-lookup"><span data-stu-id="3dd72-261">Preventing illegal access to add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] window handles when add-ins run with security isolation (that is, a partial-trust security sandbox).</span></span> <span data-ttu-id="3dd72-262">La chiamata a <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> garantisce questa sicurezza:</span><span class="sxs-lookup"><span data-stu-id="3dd72-262">Calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> ensures this security:</span></span>  
  
    -   <span data-ttu-id="3dd72-263">Per il "componente aggiuntivo che restituisce un [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" modello di programmazione, l'unico modo per passare l'handle di finestra per un componente aggiuntivo [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] attraverso l'isolamento consiste nel chiamare limiti <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="3dd72-263">For the "add-in returns a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programming model, the only way to pass the window handle for an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] across the isolation boundary is to call <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span>  
  
    -   <span data-ttu-id="3dd72-264">Per il "componente aggiuntivo è una [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" di programmazione del modello, si esegue l'override <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> sull'adattatore lato componente aggiuntivo e chiamando <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> (come illustrato negli esempi precedenti) è obbligatorio, nonché la chiamata dell'adattatore lato componente aggiuntivo `QueryContract` implementazione dall'adattatore sul lato host.</span><span class="sxs-lookup"><span data-stu-id="3dd72-264">For the "add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programming model, overriding <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> on the add-in-side adapter and calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> (as shown in the preceding examples) is required, as is calling the add-in-side adapter's `QueryContract` implementation from the host-side adapter.</span></span>  
  
-   <span data-ttu-id="3dd72-265">Protezione dell'esecuzione per più domini dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="3dd72-265">Providing multiple application domain execution protection.</span></span> <span data-ttu-id="3dd72-266">A causa delle limitazioni relative ai domini dell'applicazione, le eccezioni non gestite generate nei domini dell'applicazione del componente aggiuntivo provocano un arresto anomalo dell'intera applicazione, anche in presenza di un limite di isolamento.</span><span class="sxs-lookup"><span data-stu-id="3dd72-266">Due to limitations with application domains, unhandled exceptions that are thrown in add-in application domains cause the entire application to crash, even though the isolation boundary exists.</span></span> <span data-ttu-id="3dd72-267">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] e il modello di componente aggiuntivo [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] offrono tuttavia un modo semplice per ovviare a questo problema e migliorare la stabilità dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="3dd72-267">However, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] and the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model provide a simple way to work around this problem and improve application stability.</span></span> <span data-ttu-id="3dd72-268">Oggetto [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] componente aggiuntivo che consente di visualizzare una [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] consente di creare un <xref:System.Windows.Threading.Dispatcher> per il thread che il dominio dell'applicazione viene eseguita, se l'applicazione host è un [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="3dd72-268">A [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] add-in that displays a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] creates a <xref:System.Windows.Threading.Dispatcher> for the thread that the application domain runs on, if the host application is a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] application.</span></span> <span data-ttu-id="3dd72-269">È possibile rilevare le eccezioni tutti non gestite che si verificano nel dominio dell'applicazione tramite la gestione di <xref:System.Windows.Threading.Dispatcher.UnhandledException> eventi del [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] componente aggiuntivo <xref:System.Windows.Threading.Dispatcher>.</span><span class="sxs-lookup"><span data-stu-id="3dd72-269">You can detect all unhandled exceptions that occur in the application domain by handling the <xref:System.Windows.Threading.Dispatcher.UnhandledException> event of the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] add-in's <xref:System.Windows.Threading.Dispatcher>.</span></span> <span data-ttu-id="3dd72-270">È possibile ottenere il <xref:System.Windows.Threading.Dispatcher> dal <xref:System.Windows.Threading.Dispatcher.CurrentDispatcher%2A> proprietà.</span><span class="sxs-lookup"><span data-stu-id="3dd72-270">You can get the <xref:System.Windows.Threading.Dispatcher> from the <xref:System.Windows.Threading.Dispatcher.CurrentDispatcher%2A> property.</span></span>  
  
<a name="WPFAddInModelLimitations"></a>   
## <a name="wpf-add-in-limitations"></a><span data-ttu-id="3dd72-271">Limitazioni dei componenti aggiuntivi WPF</span><span class="sxs-lookup"><span data-stu-id="3dd72-271">WPF Add-In Limitations</span></span>  
 <span data-ttu-id="3dd72-272">Oltre ai vantaggi che [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] aggiunge ai comportamenti predefiniti forniti da <xref:System.Windows.Interop.HwndSource>, <xref:System.Windows.Interop.HwndHost>e gli handle di finestra, esistono anche alcune limitazioni aggiuntivo [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] che vengono visualizzate dalle applicazioni host:</span><span class="sxs-lookup"><span data-stu-id="3dd72-272">Beyond the benefits that [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] adds to the default behaviors supplied by <xref:System.Windows.Interop.HwndSource>, <xref:System.Windows.Interop.HwndHost>, and window handles, there are also limitations for add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that are displayed from host applications:</span></span>  
  
-   <span data-ttu-id="3dd72-273">Le [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] dei componenti aggiuntivi visualizzate da un'applicazione host non rispettano il comportamento dell'area di visualizzazione dell'applicazione host.</span><span class="sxs-lookup"><span data-stu-id="3dd72-273">Add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] displayed from a host application do not respect the host application's clipping behavior.</span></span>  
  
-   <span data-ttu-id="3dd72-274">Il concetto di *spazio aereo* negli scenari di interoperabilità si applica anche ai componenti aggiuntivi (vedere [Cenni preliminari sulle aree di tecnologia](../../../../docs/framework/wpf/advanced/technology-regions-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="3dd72-274">The concept of *airspace* in interoperability scenarios also applies to add-ins (see [Technology Regions Overview](../../../../docs/framework/wpf/advanced/technology-regions-overview.md)).</span></span>  
  
-   <span data-ttu-id="3dd72-275">I servizi di [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] di un'applicazione host, come l'ereditarietà delle risorse, il data binding e l'esecuzione di comandi, non sono automaticamente disponibili per le [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] del componente aggiuntivo.</span><span class="sxs-lookup"><span data-stu-id="3dd72-275">A host application's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] services, such as resource inheritance, data binding, and commanding, are not automatically available to add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span></span> <span data-ttu-id="3dd72-276">Per fornire questi servizi al componente aggiuntivo è necessario aggiornare la pipeline.</span><span class="sxs-lookup"><span data-stu-id="3dd72-276">To provide these services to the add-in, you need to update the pipeline.</span></span>  
  
-   <span data-ttu-id="3dd72-277">L'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] di un componente aggiuntivo non può essere ruotata, ridimensionata, inclinata o modificata in altro modo da una trasformazione (vedere [Cenni preliminari sulle trasformazioni](../../../../docs/framework/wpf/graphics-multimedia/transforms-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="3dd72-277">An add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] cannot be rotated, scaled, skewed, or otherwise affected by a transformation (see [Transforms Overview](../../../../docs/framework/wpf/graphics-multimedia/transforms-overview.md)).</span></span>  
  
-   <span data-ttu-id="3dd72-278">Contenuto del componente aggiuntivo [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] che viene eseguito il rendering mediante operazioni di disegno di <xref:System.Drawing> dello spazio dei nomi può includere la fusione alfa.</span><span class="sxs-lookup"><span data-stu-id="3dd72-278">Content inside add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that is rendered by drawing operations from the <xref:System.Drawing> namespace can include alpha blending.</span></span> <span data-ttu-id="3dd72-279">Tuttavia, sia l'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] di un componente aggiuntivo che l'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] dell'applicazione host che lo contiene devono essere opache al 100%. In altre parole, la proprietà `Opacity` deve essere impostata su 1 in entrambi i casi.</span><span class="sxs-lookup"><span data-stu-id="3dd72-279">However, both an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] and the host application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that contains it must be 100% opaque; in other words, the `Opacity` property on both must be set to 1.</span></span>  
  
-   <span data-ttu-id="3dd72-280">Se il <xref:System.Windows.Window.AllowsTransparency%2A> proprietà di una finestra nell'applicazione host che contiene un componente aggiuntivo [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] è impostata su `true`, il componente aggiuntivo è invisibile.</span><span class="sxs-lookup"><span data-stu-id="3dd72-280">If the <xref:System.Windows.Window.AllowsTransparency%2A> property of a window in the host application that contains an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] is set to `true`, the add-in is invisible.</span></span> <span data-ttu-id="3dd72-281">Questo accade anche se l'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] del componente aggiuntivo è opaca al 100%, ovvero se la proprietà `Opacity` ha un valore pari a 1.</span><span class="sxs-lookup"><span data-stu-id="3dd72-281">This is true even if the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] is 100% opaque (that is, the `Opacity` property has a value of 1).</span></span>  
  
-   <span data-ttu-id="3dd72-282">L'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] di un componente aggiuntivo deve essere visualizzata sopra ad altri elementi [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] nella stessa finestra di primo livello.</span><span class="sxs-lookup"><span data-stu-id="3dd72-282">An add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] must appear on top of other [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] elements in the same top-level window.</span></span>  
  
-   <span data-ttu-id="3dd72-283">Senza la parte di un componente aggiuntivo [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] può essere sottoposto a rendering utilizzando un <xref:System.Windows.Media.VisualBrush>.</span><span class="sxs-lookup"><span data-stu-id="3dd72-283">No portion of an add-in's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] can be rendered using a <xref:System.Windows.Media.VisualBrush>.</span></span> <span data-ttu-id="3dd72-284">Il componente aggiuntivo può invece creare uno snapshot dell'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] generata per creare una bitmap che può essere passata all'applicazione host usando i metodi definiti dal contratto.</span><span class="sxs-lookup"><span data-stu-id="3dd72-284">Instead, the add-in may take a snapshot of the generated [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to create a bitmap that can be passed to the host application using methods defined by the contract.</span></span>  
  
-   <span data-ttu-id="3dd72-285">Non è possibile riprodurre file multimediali da un <xref:System.Windows.Controls.MediaElement> in un componente aggiuntivo [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3dd72-285">Media files cannot be played from a <xref:System.Windows.Controls.MediaElement> in an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
-   <span data-ttu-id="3dd72-286">Gli eventi del mouse generati per l'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] del componente aggiuntivo non vengono ricevuti né generati dall'applicazione host e la proprietà `IsMouseOver` dell'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] dell'applicazione host è impostata su `false`.</span><span class="sxs-lookup"><span data-stu-id="3dd72-286">Mouse events generated for the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] are neither received nor raised by the host application, and the `IsMouseOver` property for host application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] has a value of `false`.</span></span>  
  
-   <span data-ttu-id="3dd72-287">Quando lo stato attivo passa da un controllo a un altro nell'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] di un componente aggiuntivo, gli eventi `GotFocus` e `LostFocus` non vengono ricevuti né generati dall'applicazione host.</span><span class="sxs-lookup"><span data-stu-id="3dd72-287">When focus shifts between controls in an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the `GotFocus` and `LostFocus` events are neither received nor raised by the host application.</span></span>  
  
-   <span data-ttu-id="3dd72-288">La parte di un'applicazione host contenente l'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] di un componente aggiuntivo appare bianca quando viene stampata.</span><span class="sxs-lookup"><span data-stu-id="3dd72-288">The portion of a host application that contains an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] appears white when printed.</span></span>  
  
-   <span data-ttu-id="3dd72-289">Tutti i dispatcher (vedere <xref:System.Windows.Threading.Dispatcher>) creato dal componente aggiuntivo [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] devono essere arrestati manualmente prima che il componente aggiuntivo proprietario venga scaricato se l'applicazione host continua l'esecuzione.</span><span class="sxs-lookup"><span data-stu-id="3dd72-289">All dispatchers (see <xref:System.Windows.Threading.Dispatcher>) created by the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] must be shut down manually before the owner add-in is unloaded if the host application continues execution.</span></span> <span data-ttu-id="3dd72-290">Il contratto può implementare metodi che consentono all'applicazione host di segnalare il componente aggiuntivo prima che questo venga scaricato, permettendo così all'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] del componente aggiuntivo di arrestare i dispatcher.</span><span class="sxs-lookup"><span data-stu-id="3dd72-290">The contract can implement methods that allow the host application to signal the add-in before the add-in is unloaded, thereby allowing the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to shut down its dispatchers.</span></span>  
  
-   <span data-ttu-id="3dd72-291">Se un componente aggiuntivo [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] è un <xref:System.Windows.Controls.InkCanvas> o contiene un <xref:System.Windows.Controls.InkCanvas>, non è possibile scaricare il componente aggiuntivo.</span><span class="sxs-lookup"><span data-stu-id="3dd72-291">If an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] is an <xref:System.Windows.Controls.InkCanvas> or contains an <xref:System.Windows.Controls.InkCanvas>, you cannot unload the add-in.</span></span>  
  
<a name="PerformanceOptimization"></a>   
## <a name="performance-optimization"></a><span data-ttu-id="3dd72-292">Ottimizzazione delle prestazioni</span><span class="sxs-lookup"><span data-stu-id="3dd72-292">Performance Optimization</span></span>  
 <span data-ttu-id="3dd72-293">Per impostazione predefinita, quando si usano più domini dell'applicazione, tutti gli assembly [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] richiesti da ogni applicazione vengono caricati nel dominio.</span><span class="sxs-lookup"><span data-stu-id="3dd72-293">By default, when multiple application domains are used, the various [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] assemblies required by each application are all loaded into that application's domain.</span></span> <span data-ttu-id="3dd72-294">Di conseguenza, il tempo necessario per creare nuovi domini dell'applicazione e avviare le applicazioni al loro interno potrebbe influire sulle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="3dd72-294">As a result, the time required for creating new application domains and starting applications in them might affect performance.</span></span> <span data-ttu-id="3dd72-295">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] consente tuttavia di ridurre i tempi di avvio indicando alle applicazioni di condividere gli assembly tra i vari domini dell'applicazione, se già caricati.</span><span class="sxs-lookup"><span data-stu-id="3dd72-295">However, the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] provides a way for you to reduce start times by instructing applications to share assemblies across application domains if they are already loaded.</span></span> <span data-ttu-id="3dd72-296">Eseguire questa operazione usando il <xref:System.LoaderOptimizationAttribute> attributo, che deve essere applicato al metodo del punto di ingresso (`Main`).</span><span class="sxs-lookup"><span data-stu-id="3dd72-296">You do this by using the <xref:System.LoaderOptimizationAttribute> attribute, which must be applied to the entry point method (`Main`).</span></span> <span data-ttu-id="3dd72-297">In questo caso, è necessario usare soltanto il codice per implementare la definizione dell'applicazione (vedere [Cenni preliminari sulla gestione di applicazioni](../../../../docs/framework/wpf/app-development/application-management-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="3dd72-297">In this case, you must use only code to implement your application definition (see [Application Management Overview](../../../../docs/framework/wpf/app-development/application-management-overview.md)).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3dd72-298">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="3dd72-298">See Also</span></span>  
 <xref:System.LoaderOptimizationAttribute>  
 [<span data-ttu-id="3dd72-299">Componenti aggiuntivi ed estendibilità</span><span class="sxs-lookup"><span data-stu-id="3dd72-299">Add-ins and Extensibility</span></span>](../../../../docs/framework/add-ins/index.md)  
 [<span data-ttu-id="3dd72-300">Domini dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="3dd72-300">Application Domains</span></span>](../../../../docs/framework/app-domains/application-domains.md)  
 [<span data-ttu-id="3dd72-301">Panoramica di .NET framework Remoting</span><span class="sxs-lookup"><span data-stu-id="3dd72-301">.NET Framework Remoting Overview</span></span>](https://msdn.microsoft.com/library/eccb1d31-0a22-417a-97fd-f4f1f3aa4462)  
 [<span data-ttu-id="3dd72-302">Oggetti remotizzabili</span><span class="sxs-lookup"><span data-stu-id="3dd72-302">Making Objects Remotable</span></span>](https://msdn.microsoft.com/library/01197253-3f13-43b7-894d-9683e431192a)  
 [<span data-ttu-id="3dd72-303">Procedure relative alle proprietà</span><span class="sxs-lookup"><span data-stu-id="3dd72-303">How-to Topics</span></span>](../../../../docs/framework/wpf/app-development/how-to-topics.md)
